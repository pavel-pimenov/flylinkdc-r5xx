------------------------------------------------------------------------
r15736 | pavel.pimenov@gmail.com | 2013-10-17 07:09:57 +0400 (Чт, 17 окт 2013) | 1 line

# Забытые const
------------------------------------------------------------------------
r15735 | pavel.pimenov@gmail.com | 2013-10-17 06:57:09 +0400 (Чт, 17 окт 2013) | 4 lines

* (Fixed issue 1348) Зависает при старте на закрытии окон приватных сообщений
   http://code.google.com/p/flylinkdc/issues/detail?id=1348
   Убрал явные вызовы SettingsManager::getInstance()->save(); автоапдейте
   т.к. возможны локи + менеджер сам разберется когда ему записаться на диск.
------------------------------------------------------------------------
r15734 | pavel.pimenov@gmail.com | 2013-10-16 21:08:33 +0400 (Ср, 16 окт 2013) | 4 lines

# Issue http://code.google.com/p/flylinkdc/issues/detail?id=1330
 Откатил фикс через экран FLYLINKDC_ISSUE_1330 т.к. сломалась подгрузка Ip из базы
 нужно подумать как сделать лучше т.к. эффект проявляется только для adc

------------------------------------------------------------------------
r15733 | pavel.pimenov@gmail.com | 2013-10-16 21:02:17 +0400 (Ср, 16 окт 2013) | 1 line

# Astyle
------------------------------------------------------------------------
r15732 | pavel.pimenov@gmail.com | 2013-10-16 20:59:49 +0400 (Ср, 16 окт 2013) | 8 lines

# Issue 1344 Убрал struct Hash
  http://code.google.com/p/flylinkdc/issues/detail?id=1344
# std::unordered_set< перевел на boost::unordered_set< 
  std::unordered_map< перевел на boost::unordered_map<
  http://stackoverflow.com/questions/17016175/c-unordered-map-using-a-custom-class-type-as-the-key
 

  
------------------------------------------------------------------------
r15731 | pavel.pimenov@gmail.com | 2013-10-16 20:56:04 +0400 (Ср, 16 окт 2013) | 2 lines

# Иногда звался fire(ClientListener::UsersUpdated(), this, v); для пустого массива OnlineUserList v;
  обощил код и исключил лишнюю пустышку-fire
------------------------------------------------------------------------
r15730 | pavel.pimenov@gmail.com | 2013-10-16 19:19:16 +0400 (Ср, 16 окт 2013) | 1 line

# Убрал мертвые struct hash<HashValue<T>* > и struct equal_to<HashValue<T>*>
------------------------------------------------------------------------
r15729 | pavel.pimenov@gmail.com | 2013-10-16 19:15:45 +0400 (Ср, 16 окт 2013) | 1 line

# В hash<HashValue<T> > не понял зачем hvHash инитим в 0
------------------------------------------------------------------------
r15728 | pavel.pimenov@gmail.com | 2013-10-16 19:13:15 +0400 (Ср, 16 окт 2013) | 2 lines

# [fly-server] Добавил dcassert-ы на m_closed - в нескольких дампах видел зависон в этом месте и пока причину не понял.
  (вешается в момент отработки потока к флай серверу и закрытию целевого окна мышой)
------------------------------------------------------------------------
r15727 | pavel.pimenov@gmail.com | 2013-10-16 18:51:30 +0400 (Ср, 16 окт 2013) | 2 lines

# Добавил защиту от вызова fire(ClientListener::UsersUpdated() с пустым OnlineUserList
  TODO - возможно в некоторых местах можно сделать reserve
------------------------------------------------------------------------
r15726 | pavel.pimenov@gmail.com | 2013-10-16 18:47:26 +0400 (Ср, 16 окт 2013) | 1 line

# В NmdcHub::refreshUserList забыли reserve
------------------------------------------------------------------------
r15725 | pavel.pimenov@gmail.com | 2013-10-16 18:44:01 +0400 (Ср, 16 окт 2013) | 1 line

# unordered_set -> boost::unordered_set
------------------------------------------------------------------------
r15724 | pavel.pimenov@gmail.com | 2013-10-16 18:42:49 +0400 (Ср, 16 окт 2013) | 2 lines

# Вернул возможность отключить фичу SCALOLAZ_HUB_SWITCH_BTN и пересмотрел алгоритм 
  работы с отключением списка юзеров и обмена окон чата со списком.
------------------------------------------------------------------------
r15723 | pavel.pimenov@gmail.com | 2013-10-16 18:29:09 +0400 (Ср, 16 окт 2013) | 2 lines

* (Fixed issue 1342) Панели чата и списка юзеров случайно менялись местами
  https://code.google.com/p/flylinkdc/issues/detail?id=1342
------------------------------------------------------------------------
r15722 | pavel.pimenov@gmail.com | 2013-10-16 18:25:44 +0400 (Ср, 16 окт 2013) | 2 lines

# Добавил диагностику в CImageDataObject
# Убрал мертвый метод static T& intersect(T& t1, const T& t2)
------------------------------------------------------------------------
r15721 | pavel.pimenov | 2013-10-16 12:30:20 +0400 (Ср, 16 окт 2013) | 4 lines

# Поправка к фиксу https://code.google.com/p/flylinkdc/source/detail?r=15709
  - Если на некоторой итерации вернется размер меньше буфера пытались плюсом заказывать так-же frameBufferSize без корректировки размера
    если таких кусков будет много - потеряем много лишней памяти.
  - Добавлено логирование ошибок при вызове InternetReadFile также если функция вернула ошибку - считаем что загрузка не удалась (раньше мы могли вернуть битый буфер)
------------------------------------------------------------------------
r15720 | a.rainman@gmail.com | 2013-10-16 11:56:50 +0400 (Ср, 16 окт 2013) | 1 line

# AStyle.
------------------------------------------------------------------------
r15719 | a.rainman@gmail.com | 2013-10-16 11:51:07 +0400 (Ср, 16 окт 2013) | 1 line

* (Fixed Issue 1330) Неверное отображение IP адреса на ADC-хабе https://code.google.com/p/flylinkdc/issues/detail?id=1330 .
------------------------------------------------------------------------
r15718 | a.rainman@gmail.com | 2013-10-16 09:08:39 +0400 (Ср, 16 окт 2013) | 1 line

# Issue 1231 Неверный подсчёт общей шары на хабе: после переподключения к хабу проблема более-менее стабильно повторяется, собственно накатал диагностики, но частично её выключил, что бы остальным не мешала. Суть бага локализовал, однако причину пока не понял, пилю дальше.
------------------------------------------------------------------------
r15717 | pavel.pimenov@gmail.com | 2013-10-16 07:18:04 +0400 (Ср, 16 окт 2013) | 1 line

#
------------------------------------------------------------------------
r15716 | pavel.pimenov@gmail.com | 2013-10-16 07:15:48 +0400 (Ср, 16 окт 2013) | 1 line

#
------------------------------------------------------------------------
r15715 | pavel.pimenov@gmail.com | 2013-10-16 07:14:08 +0400 (Ср, 16 окт 2013) | 1 line

#
------------------------------------------------------------------------
r15714 | pavel.pimenov@gmail.com | 2013-10-16 06:53:20 +0400 (Ср, 16 окт 2013) | 1 line

#
------------------------------------------------------------------------
r15713 | pavel.pimenov@gmail.com | 2013-10-16 06:45:14 +0400 (Ср, 16 окт 2013) | 1 line

# Маркер проблемы https://code.google.com/p/flylinkdc/issues/detail?id=1335
------------------------------------------------------------------------
r15710 | a.rainman@gmail.com | 2013-10-16 05:52:41 +0400 (Ср, 16 окт 2013) | 2 lines

* Вернул в ежовой опцию "Использовать ',' при обращении к Нику в чате, вместо
':'", по умолчанию вкл.
------------------------------------------------------------------------
r15709 | pavel.pimenov@gmail.com | 2013-10-15 21:12:47 +0400 (Вт, 15 окт 2013) | 8 lines

# Исправлен баг загрузки из инета getBinaryDataFromInet (сломал тут http://code.google.com/p/flylinkdc/source/detail?r=15704)
  Словил на файле RSS wget -c -t1 "http://dcsamara.net/rss.php" --output-document=rss.txt
  В середине на третьей итерации пришел ответ размером не равный numberOfBytesToRead (читал порциями по 4096 байт)
  а я думал, что обрубок приходит всегда в конце.
  тестовый код:
  std::vector<uint8_t> l_bin_data;
  const size_t l_bin_size = Util::getBinaryDataFromInet(Text::toT(g_full_user_agent).c_str(), 4096, "http://dcsamara.net/rss.php", l_bin_data, 500);
  
------------------------------------------------------------------------
r15708 | pavel.pimenov@gmail.com | 2013-10-15 20:39:56 +0400 (Вт, 15 окт 2013) | 3 lines

# Серую не выпускать!
# issue 1319 Исправлен фильтр по расположению http://code.google.com/p/flylinkdc/issues/detail?id=1319
# Возможно сломал что-то другое - падает в дебаге на assert-ах
------------------------------------------------------------------------
r15707 | pavel.pimenov@gmail.com | 2013-10-15 19:44:54 +0400 (Вт, 15 окт 2013) | 1 line

# Log
------------------------------------------------------------------------
r15706 | pavel.pimenov@gmail.com | 2013-10-15 19:14:10 +0400 (Вт, 15 окт 2013) | 2 lines

# Добавлен вывод в лог ошибки совместного доступа к файлу Favorites.xml
  LogManager::getInstance()->message("FavoriteManager::save error = " + e.getError());
------------------------------------------------------------------------
r15705 | pavel.pimenov@gmail.com | 2013-10-15 19:12:42 +0400 (Вт, 15 окт 2013) | 4 lines

# Issue 1231 https://code.google.com/p/flylinkdc/issues/detail?id=1231
  Добавил диагностику - падаем при переподключении к хабу.
  в релизе не позволяем m_availableBytes становиться < 0
  
------------------------------------------------------------------------
r15704 | pavel.pimenov@gmail.com | 2013-10-15 19:09:27 +0400 (Вт, 15 окт 2013) | 2 lines

* (Closed issue 1340) http://code.google.com/p/flylinkdc/issues/detail?id=1340
  - Размер ключа 128 байт. в AutoUpdateObject::checkSignXML не заказываем 4к
------------------------------------------------------------------------
r15703 | pavel.pimenov@gmail.com | 2013-10-15 18:34:07 +0400 (Вт, 15 окт 2013) | 1 line

# Astyle
------------------------------------------------------------------------
r15702 | a.rainman@gmail.com | 2013-10-15 13:34:58 +0400 (Вт, 15 окт 2013) | 5 lines

# Обозначил фичу PPA_USER_COMMANDS_HUBS_SET, нашёл в ней проблему и поправил: теперь в методах removeHubUserCommands и removeUserCommand адрес удаляется из коллекции m_userCommandsHubUrl если для него не осталось комманд, и соответственно нет проблемы с тем, что метод isHubExistsL ошибочно возвращает true. p.s: оптимизация на сравнение строк всё так же действует но теперь только в релизе за счёт механизма отложенной инициализации, по этой причине условие с matchHub прошу не менять.
# В ежовой включил обратно фичу IRAINMAN_USE_SHARED_SPIN_LOCK_FOR_USERS, в обычной всё так же используется обычная секция.
# Добавлена директива SCALOLAZ_CHAT_REFFERING_TO_NICK для локализации соответствующей фичи.
# [public-build]

------------------------------------------------------------------------
r15701 | a.rainman@gmail.com | 2013-10-15 12:44:19 +0400 (Вт, 15 окт 2013) | 3 lines

# Убрал в хидер однострочные ClientManager::updateNick.
# Косметика: g_isShutdown -> isShutdown().
# В ежовой проверка isShutdown() не нужна в ShareManager::internal_calcShareSize(), ибо данная функция зовётся строго при определённых условиях, и её вызов невозможен при завершении работы.
------------------------------------------------------------------------
r15700 | pavel.pimenov | 2013-10-15 11:28:52 +0400 (Вт, 15 окт 2013) | 4 lines

# Функция getChatRefferingToNick() не использует мемберов класса - делаем ее static
  TODO - узнать историю появления галки CHAT_REFFERING_TO_NICK и в чем от нее бонус
# В BufferedSocket::resizeInBuf заказываем память при нехватке по bad_alloc пока не дойдем до 1К
# virtual bool eof() const
------------------------------------------------------------------------
r15699 | pavel.pimenov | 2013-10-15 10:47:22 +0400 (Вт, 15 окт 2013) | 3 lines

* (Fixed Issue 1338) Скорость скачки и завершение скачки.
# Вернул ошибочно удаленный метод virtual bool eof() в FilteredOutputStream в результате чего он звался из базового OutputStream а там всегда возвращается false

------------------------------------------------------------------------
r15698 | a.rainman@gmail.com | 2013-10-15 10:32:27 +0400 (Вт, 15 окт 2013) | 3 lines

* Ежовая:
  ~ По умолчанию количество сегментов для закачки рассчитываем в авто режиме вместо жёстко установленного значения.
  - Отсутствует опция "Использовать ',' при обращении к Нику в чате, вместо ':'", ник всегда отделяется запятой.
------------------------------------------------------------------------
r15697 | a.rainman@gmail.com | 2013-10-15 09:49:42 +0400 (Вт, 15 окт 2013) | 5 lines

# Упразднил resizeInBuf() в ежовой ибо код избыточен, я нечто подобное однажды уже выпиливал из Socket::getSocketOptInt.
# Из Socket::getSocketOptInt в ежовой убрал бессмысленную инициализацию 0.
# Исправление для BufferedSocket::threadConnect - проверяем socketIsDisconecting.
# Косметика кода - избавление от магических констант, замена на MAX_SOCKET_BUFFER_SIZE.
# [public-build]
------------------------------------------------------------------------
r15696 | a.rainman@gmail.com | 2013-10-15 09:48:21 +0400 (Вт, 15 окт 2013) | 1 line

# Поправил косяк в FilteredOutputStream::write.
------------------------------------------------------------------------
r15695 | pavel.pimenov@gmail.com | 2013-10-15 06:45:26 +0400 (Вт, 15 окт 2013) | 5 lines

# Временно вернул буфер сокетов к размеру 64к в не зависимости от версии винды
  Жалобы
  http://code.google.com/p/flylinkdc/issues/detail?id=1338
  http://code.google.com/p/flylinkdc/issues/detail?id=1339
  
------------------------------------------------------------------------
r15694 | pavel.pimenov@gmail.com | 2013-10-12 11:57:24 +0400 (Сб, 12 окт 2013) | 3 lines

# Убрал лишние транзакции к sqlite в CFlylinkDBManager::flush_lost_json_statistic
# Исключил лишний запрос к БД (select tth from fly_hash where id=?)
# При поиске IP скидываем только в базу. объект - user не трогаем.
------------------------------------------------------------------------
r15693 | pavel.pimenov@gmail.com | 2013-10-11 20:27:01 +0400 (Пт, 11 окт 2013) | 1 line

# Log
------------------------------------------------------------------------
r15692 | pavel.pimenov@gmail.com | 2013-10-11 20:06:03 +0400 (Пт, 11 окт 2013) | 3 lines

# В FavoriteManager заведена мапа для детекта отсутствия userCommands на указанном хабе
  (при этом исключается полный перебор всех хабов)
# Убрал красный цвет пунктирной оконтовки текущей закладки
------------------------------------------------------------------------
r15691 | pavel.pimenov@gmail.com | 2013-10-11 19:55:14 +0400 (Пт, 11 окт 2013) | 1 line

# Убрал копипаст в FilteredInputStream и в FilteredOutputStream
------------------------------------------------------------------------
r15690 | pavel.pimenov@gmail.com | 2013-10-11 19:08:08 +0400 (Пт, 11 окт 2013) | 1 line

# Astyle [public-build]
------------------------------------------------------------------------
r15689 | pavel.pimenov@gmail.com | 2013-10-11 19:03:39 +0400 (Пт, 11 окт 2013) | 2 lines

* (Fixed issue 1333) Часть 2 http://code.google.com/p/flylinkdc/issues/detail?id=1333
  Размер буферов нельзя забирать из getSocketOptInt - они без инициализации вертают 8k. (ставим константу = 64K)
------------------------------------------------------------------------
r15686 | pavel.pimenov | 2013-10-11 13:49:25 +0400 (Пт, 11 окт 2013) | 2 lines

* (Fixed issue 1333) Скорость отдачи файлов ограничена (3-4Мб/сек)
  http://code.google.com/p/flylinkdc/issues/detail?id=1333
------------------------------------------------------------------------
r15685 | tret2003 | 2013-10-11 10:46:16 +0400 (Пт, 11 окт 2013) | 1 line

# Не сохраняем пустые значения в файл настроек хабов.
------------------------------------------------------------------------
r15684 | tret2003 | 2013-10-11 06:59:45 +0400 (Пт, 11 окт 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1289, created 2013-10-11 09:57:14 +0700
   Total in database:
    - ISP - 1403
    - ISPs logo - 1412
    - Address range - 5983
   Archive CustomLocations.7z created by NightOrion


------------------------------------------------------------------------
r15683 | pavel.pimenov@gmail.com | 2013-10-11 06:59:42 +0400 (Пт, 11 окт 2013) | 1 line

# del [public-build]
------------------------------------------------------------------------
r15682 | pavel.pimenov@gmail.com | 2013-10-11 06:58:53 +0400 (Пт, 11 окт 2013) | 1 line

# Log
------------------------------------------------------------------------
r15681 | tret2003 | 2013-10-10 20:35:35 +0400 (Чт, 10 окт 2013) | 1 line

# Правка проекта VS2012
------------------------------------------------------------------------
r15680 | pavel.pimenov@gmail.com | 2013-10-10 20:03:01 +0400 (Чт, 10 окт 2013) | 1 line

# Исправлена ошибка с Detach для комбика подделки под другие клиенты IDC_CLIENT_ID_BOX
------------------------------------------------------------------------
r15679 | pavel.pimenov@gmail.com | 2013-10-10 19:46:11 +0400 (Чт, 10 окт 2013) | 9 lines

* # В Thread::start передаем значение стека. если первый раз поток не создался - пытаемся второй раз с меньшим стеком. (обычно он не создается от нехватки ресурсов)
  # При конвертации данных в таблицу fly_last_ip_nick_hub исключил возможные появление дублей и заменил exists с distinct на group by
  TODO - попробовать джойн на большой таблице
  # Сократил размер стека для некоторых потоков до 64к
  # Предельный размер стек вернул на 1М вместо 2М для x86 и 4M для x64
* # Рефакторинг в VideoPreview
* # Хаб поддержки adcs://adcs.flylinkdc.com:2780 вынес в конфиг


------------------------------------------------------------------------
r15676 | pavel.pimenov@gmail.com | 2013-10-10 07:10:28 +0400 (Чт, 10 окт 2013) | 2 lines

# log [public-build]

------------------------------------------------------------------------
r15675 | pavel.pimenov@gmail.com | 2013-10-10 06:58:06 +0400 (Чт, 10 окт 2013) | 7 lines

* fix https://www.crash-server.com/Problem.aspx?ClientID=ppa&ProblemID=41191
# _beginthreadex второй раз не звать - там ошибка с кодом 12
 TODO
 - если код 12 то пытаться создать поток с меньшим размером стека?
 - научится собирать размер потребляемого стека для потоков и заказывать адекватный размер?

 
------------------------------------------------------------------------
r15674 | pavel.pimenov@gmail.com | 2013-10-10 06:22:21 +0400 (Чт, 10 окт 2013) | 1 line

# Astyle
------------------------------------------------------------------------
r15673 | pavel.pimenov@gmail.com | 2013-10-10 06:18:21 +0400 (Чт, 10 окт 2013) | 2 lines

* (Closed issue 1332) Пропала информация со вкладок
   http://code.google.com/p/flylinkdc/issues/detail?id=1332 
------------------------------------------------------------------------
r15672 | pavel.pimenov@gmail.com | 2013-10-10 06:09:10 +0400 (Чт, 10 окт 2013) | 2 lines

* fix https://crash-server.com/Problem.aspx?ClientID=ppa&ProblemID=41196
  fix https://crash-server.com/Problem.aspx?ClientID=ppa&ProblemID=41198
------------------------------------------------------------------------
r15671 | pavel.pimenov@gmail.com | 2013-10-09 23:51:57 +0400 (Ср, 09 окт 2013) | 1 line

# Astyle [public-build]
------------------------------------------------------------------------
r15670 | pavel.pimenov@gmail.com | 2013-10-09 23:29:22 +0400 (Ср, 09 окт 2013) | 1 line

# Log
------------------------------------------------------------------------
r15669 | pavel.pimenov@gmail.com | 2013-10-09 23:11:40 +0400 (Ср, 09 окт 2013) | 1 line

# В окне логирования первым вывожу команду поиска - на нетбуках не видно
------------------------------------------------------------------------
r15603 | pavel.pimenov@gmail.com | 2013-10-09 22:00:37 +0400 (Ср, 09 окт 2013) | 1 line

# Не собиралось.
------------------------------------------------------------------------
r15602 | pavel.pimenov@gmail.com | 2013-10-09 21:49:30 +0400 (Ср, 09 окт 2013) | 1 line

# Astyle [public-build]
------------------------------------------------------------------------
r15601 | pavel.pimenov@gmail.com | 2013-10-09 21:48:51 +0400 (Ср, 09 окт 2013) | 2 lines

# Исправлена ошибка конвертации рейтинга
  https://www.dropbox.com/s/xp5ifufgn6i7dd6/pic3245574.PNG
------------------------------------------------------------------------
r15600 | a.rainman@gmail.com | 2013-10-09 21:14:05 +0400 (Ср, 09 окт 2013) | 3 lines

# Расставил забытые SCALOLAZ_BRIGHTEN_LOCATION_WITH_LASTIP в гуй и PPA_INCLUDE_LASTIP_AND_USER_RATIO в ядре.
# Более полное и корректное вырезание функционала Socket::setInBufSize и Socket::setOutBufSize директивой FLYLINKDC_SUPPORT_WIN_XP.
# Фикс сборки в общем.
------------------------------------------------------------------------
r15599 | pavel.pimenov@gmail.com | 2013-10-09 20:28:35 +0400 (Ср, 09 окт 2013) | 1 line

# CriticalSectionLocker CSL(CS) экран + Astyle
------------------------------------------------------------------------
r15596 | pavel.pimenov@gmail.com | 2013-10-09 19:37:45 +0400 (Ср, 09 окт 2013) | 110 lines

# Изменения из гит

* # Обновили mediainfo

+ FTP (custom builds only): support of UTF-8 file names
  x MPEG-4/MOV: ScanOrder was using "stored" value instead of "displayed" value
  x MXF: Detection of Dolby E was not working in some cases (regression in 0.7.62)

* # Перевел несколько коллекций на boost::unordered_map (делал тест под С++ 2010: http://www.rsdn.ru/forum/cpp/5323260.1 )

* № Поправка в HubFrame::closeAll

FavoriteManager::getInstance()->prepareClose() нужно звать только при закрытии всех

* # При какрытии всех хабов HubFrame::closeAll удаляем быстро все юзерские комманды

через вызов FavoriteManager::getInstance()->prepareClose();
# Из UserCommand выкинул лишний StringList m_displayName - она парсился на каждой операции с массивом
  метод getDisplayName - конструирует его на лету по мере надобности.

* # Забыл FastSharedLock l(csUserCommand); и вернул removeUserCommand в ~Client() - стреляет на Assert-е

* # Поправил расчет в FavoriteManager::removeUserCommand

* # Astyle

* # Выходим из void BufferedSocket::threadConnect если клиент ушел на разрушение.

* # В обработке SET_WINDOW_TITLE не обновляем текст окна если он не поменялся и не зовем SetMDIFrameMenu

* # Добавлен метод FavoriteManager::prepareClose() - ускоряем завершение приложения удаляя массив userCommands сразу весь, а не по одной записи с поиском

# Диагностика дупликатного вызова FavoriteManager::removeUserCommand DUP
# Диагностика дупликатного вызова FavoriteManager::getFavoriteHubEntry DUP
# Исключил двойные поиски в избранных FavoriteManager::getInstance()->getFavoriteHubEntry
# Удален дубликатный вызов FavoriteManager::getInstance()->removeUserCommand(getHubUrl()); в Client::~Client()

* # Забытый ctrlGroups.Detach(); в ~FavHubGroupsDlg()

* # В User::initRatio ник может быть пустым - в случае DHT пока игнорируем.

TODO - брать CID ?

* # Добавил тест http://tinodidriksen.com/2009/07/09/cpp-map-speeds/

TODO - унести тесты в отдельную репку

* # Убрал параметр GET_USER_INFO и пересмотрел алгоритм сохранения галочек включения файл-листа (иногда он глючил и терял галки)

# Не отрабатываем MainFrame::onTimer пока содаются фреймы хабов

* # [miniupnp] 2013/10/07

- fixed potential buffer overrun in miniwget.c
  - Modified UPNP_GetValidIGD() to check for ExternalIpAddress

* # Пересмотрен алгоритм сохранения IP в базу данных в окне поиска SearchFrame::addSearchResult

# Исправлен CFlyUserRatioInfo - ждем теста Артема на отсуствие пропаданий IP-адресов

* # В CFlylinkDBManager::store_all_ratio_and_last_ip при сохранении только last_ip не вычисляем ID для ника.

* # Убрал drop table fly_last_ip (не работает откат на предыдущю версию)

* # SO_RCVBUF и SO_SNDBUF для XP выставляются в 64к для Vista и выше остаются динамическими.

* # Вернул m_disconnecting = true в void BufferedSocket::shutdown()

# Отключил тест в Identity
# Обновил mediainfo

* # Удалил IRAINMAN_INCLUDE_SOCKET_IN_BUFFER_OPTION

в соответствии с  src\chromium\home\chrome-svn\tarball\chromium\src\net\socket\tcp_client_socket_win.cc
  под XP буфер делаем 64 (его почему-то сделали 128к) а под вистой и выше не делаем установку размера буфера - винда сама подбирает оптимальный
  // Increase the socket buffer sizes from the default sizes for WinXP.  In
  // performance testing, there is substantial benefit by increasing from 8KB
  // to 64KB.
  // See also:
  //    http://support.microsoft.com/kb/823764/EN-US
  // On Vista, if we manually set these sizes, Vista turns off its receive
  // window auto-tuning feature.
  //    http://blogs.msdn.com/wndp/archive/2006/05/05/Winhec-blog-tcpip-2.aspx
  // Since Vista's auto-tune is better than any static value we can could set,
  // only change these on pre-vista machines.

# Починил включение логирование протокола RIP_USE_LOG_PROTOCOL
# В HubFrame::onTimer раз в минуту зовем ClientManager::infoUpdated(client)
  раньше звали по всемклиентам в ClientManager - при наличии большого кол-ва вызывало долгую блокировку

* # Вернул обводку неактивной вкладки черным цветом

* # Добавил revision.h (пока не научился генерировать его из гит-а

# .gitignore

* # .gitignore

* # [mediainfo] Исправлена сборка с MEDIAINFO_DEMUX

* * [mediainfo][merge]

Option for setting a default frame rate in the case there is no frame rate meta in the stream
# Удалил EditAndContinue

* # Изменил алгоритм работы с рейтингом ( таблица fly_last_ip при первом запуске конвертируется в fly_last_ip_nick_hub)

# В Util::getExternalIP добавлена валидация IP4 адреса


------------------------------------------------------------------------
r15591 | pavel.pimenov@gmail.com | 2013-10-03 07:07:42 +0400 (Чт, 03 окт 2013) | 1 line

# Astyle
------------------------------------------------------------------------
r15590 | pavel.pimenov@gmail.com | 2013-10-03 07:06:59 +0400 (Чт, 03 окт 2013) | 4 lines

# Issue 1314  http://code.google.com/p/flylinkdc/issues/detail?id=1314
  CFlyUserRatioInfo::initRatio не всегда зовем на запись 
  TODO - рейтинг на неделе перепишу. сейчас он возможно сломается т.к. сильно не тестил.

------------------------------------------------------------------------
r15589 | pavel.pimenov@gmail.com | 2013-10-03 07:02:01 +0400 (Чт, 03 окт 2013) | 2 lines

# Защита от повторного создания таймера
  Странный стек в http://code.google.com/p/flylinkdc/issues/detail?id=1328
------------------------------------------------------------------------
r15588 | pavel.pimenov@gmail.com | 2013-10-02 23:13:02 +0400 (Ср, 02 окт 2013) | 4 lines

# Issue 1323  http://code.google.com/p/flylinkdc/issues/detail?id=1323
  Упростил отрисовку закладок. выкинул метод "сглаживания углов" AddArc и tabsPatch3D
  Активная вкладка выделяется красным пунктиром.
  TODO - вообще отказаться от GDI+ в этом месте
------------------------------------------------------------------------
r15587 | tret2003 | 2013-10-02 19:44:01 +0400 (Ср, 02 окт 2013) | 1 line

# Исправил падение/зависание при повторной попытке войти на хаб, который делает переадресацию на другой хаб.
------------------------------------------------------------------------
r15586 | pavel.pimenov | 2013-10-02 09:58:48 +0400 (Ср, 02 окт 2013) | 3 lines

# Инициализацию для смайлов ctrlClient.Initialize() не зовем при создании фрейма. 
  метод автоматом зовется если появится смайлик.
  TODO - окно чата создавать отложенно
------------------------------------------------------------------------
r15585 | tret2003 | 2013-10-02 09:28:44 +0400 (Ср, 02 окт 2013) | 1 line

# Не создаём архивы с исходниками и бинарниками если сборка не удалась
------------------------------------------------------------------------
r15584 | pavel.pimenov | 2013-10-02 08:34:45 +0400 (Ср, 02 окт 2013) | 1 line

# fix сopy-paste 
------------------------------------------------------------------------
r15583 | a.rainman@gmail.com | 2013-10-02 03:14:36 +0400 (Ср, 02 окт 2013) | 1 line

# [lang] Требуется обновление локализаций 
------------------------------------------------------------------------
r15582 | a.rainman@gmail.com | 2013-10-02 02:19:17 +0400 (Ср, 02 окт 2013) | 2 lines

# log
# Убрал дубликаты, добавил свежие изменения.
------------------------------------------------------------------------
r15581 | pavel.pimenov@gmail.com | 2013-10-01 22:34:05 +0400 (Вт, 01 окт 2013) | 1 line

# Astyle [public-build]
------------------------------------------------------------------------
r15580 | pavel.pimenov@gmail.com | 2013-10-01 22:33:41 +0400 (Вт, 01 окт 2013) | 1 line

# DHT - продолжает работать при закрытии. пока ругаюсь в дебаге по флажку а в релизе выхожу.
------------------------------------------------------------------------
r15579 | pavel.pimenov@gmail.com | 2013-10-01 22:19:58 +0400 (Вт, 01 окт 2013) | 3 lines

* (fixed issue 1320) На вкладках иконки хабов не соответствуют теме
   http://code.google.com/p/flylinkdc/issues/detail?id=1320
   Мой баг иконки грузились до загрузи темок.
------------------------------------------------------------------------
r15578 | pavel.pimenov@gmail.com | 2013-10-01 20:59:15 +0400 (Вт, 01 окт 2013) | 2 lines

# issue 1324 Добавляем в лог номера портов при пробросе
  http://code.google.com/p/flylinkdc/issues/detail?id=1324
------------------------------------------------------------------------
r15577 | pavel.pimenov@gmail.com | 2013-10-01 20:03:10 +0400 (Вт, 01 окт 2013) | 1 line

# Глючный авто-мерж
------------------------------------------------------------------------
r15576 | pavel.pimenov@gmail.com | 2013-10-01 19:55:50 +0400 (Вт, 01 окт 2013) | 7 lines

Merged revision(s) 15575 from branches/flylinkdc-r4xx:
# [fly-server] 
  Добавлен сборк метрик 
    - Кол-во друзей
    - Кол-во потоков (пока текущее в момент измерения)
........

------------------------------------------------------------------------
r15565 | pavel.pimenov@gmail.com | 2013-09-29 17:04:47 +0400 (Вс, 29 сен 2013) | 1 line

# [fly-serve] к Статистики добавлено кол-во юзеров getCountFavsUsers
------------------------------------------------------------------------
r15563 | pavel.pimenov@gmail.com | 2013-09-29 16:05:11 +0400 (Вс, 29 сен 2013) | 1 line

# При закрытии приложения не зовем UPDATE_USER_JOIN и REMOVE_USER в части FavoriteManager
------------------------------------------------------------------------
r15560 | a.rainman@gmail.com | 2013-09-28 15:34:40 +0400 (Сб, 28 сен 2013) | 6 lines

# Корректировка алгоритма расчёта getMaxSegments для авто режима.
# Из QueueManager::saveQueue убрал логирование времени выполнения. Там же поправил лишнюю рекурсивную блокировку (фича IRAINMAN_USE_SEPARATE_CS_IN_QUEUE_MANAGER).
* (Fixed Issue 1318) Версии r5xx отдают клиенту на той стороне отладочные сообщения вместо протокольного "File Not Available". https://code.google.com/p/flylinkdc/issues/detail?id=1318
# Дабы не копить изменения - выпуск на публику, ошибки искать будет проще, да и номер версии красивый :)
# [public-build]

------------------------------------------------------------------------
r15559 | a.rainman@gmail.com | 2013-09-28 15:33:36 +0400 (Сб, 28 сен 2013) | 1 line

# Косметика.
------------------------------------------------------------------------
r15558 | a.rainman@gmail.com | 2013-09-28 15:28:22 +0400 (Сб, 28 сен 2013) | 3 lines

# Ревизия IRAINMAN_NON_COPYABLE_FAV_USERS и IRAINMAN_NON_COPYABLE_FAV_DIRS и связного кода. Ошибок не обнаружено, поправлена пара мелких допущений + косметика кода.
# getFavoriteUsersNames возвращает список ников без пустых строк, это проверяется внутри, поэтому проверка для него в СhatCtrl излишняя.
# Убрал копипасту из DirectoryListingFrame::onDownloadFavoriteDirs.
------------------------------------------------------------------------
r15557 | a.rainman@gmail.com | 2013-09-28 12:32:04 +0400 (Сб, 28 сен 2013) | 3 lines

* (Fixed Issue 1318) Версии r5xx отдают клиенту на той стороне отладочные сообщения вместо протокольного "File Not Available". https://code.google.com/p/flylinkdc/issues/detail?id=1318
# log.
# [public-build]
------------------------------------------------------------------------
r15556 | a.rainman@gmail.com | 2013-09-28 11:48:09 +0400 (Сб, 28 сен 2013) | 2 lines

# (Fixed Issue 1291) Исчезли сообщения о статусе передачи (недостаточно места на диске, ожидайте своей очереди, и т.д.) https://code.google.com/p/flylinkdc/issues/detail?id=1291
# [public-build]
------------------------------------------------------------------------
r15555 | a.rainman@gmail.com | 2013-09-28 11:03:40 +0400 (Сб, 28 сен 2013) | 1 line

# +r15554 - не во всех сочетаниях директив собиралось.
------------------------------------------------------------------------
r15554 | a.rainman@gmail.com | 2013-09-28 10:22:03 +0400 (Сб, 28 сен 2013) | 3 lines

# Issue 1316: Падение при поиске на r502-rc2.4 (на rc2.2 проблемы нет). - добавлена тестовая директива IRAINMAN_USE_SHARED_SPIN_LOCK_FOR_USERS для локализации гейзенбага, выключена директивой IRAINMAN_USE_NON_RECURSIVE_BEHAVIOR.
# [public-build]

------------------------------------------------------------------------
r15553 | a.rainman@gmail.com | 2013-09-28 09:31:34 +0400 (Сб, 28 сен 2013) | 1 line

# Поправил пару мелких недочётов в QueueManager.
------------------------------------------------------------------------
r15552 | a.rainman@gmail.com | 2013-09-28 04:59:49 +0400 (Сб, 28 сен 2013) | 3 lines

# Тест для Issue 1316: умирание при поиске на rc2.4
# Необходимо ибо в r15531 пофиксили не понятно что, поскольку в период rc2.2 -> rc2.4 в тех краях ничего не менялось.
# [public-build]
------------------------------------------------------------------------
r15551 | a.rainman@gmail.com | 2013-09-28 03:30:32 +0400 (Сб, 28 сен 2013) | 1 line

# Убрал из CFlylinkDBManager::get_country_sqlite пустое перетирание нолей нолями :) Мало того, что эта структура зачем инициализируется собственным конструктором, так ещё в функции, которая возвращает статус выполнения в неиспользуемые данные опять пишут.
------------------------------------------------------------------------
r15550 | a.rainman@gmail.com | 2013-09-28 03:22:16 +0400 (Сб, 28 сен 2013) | 1 line

# AStyle.
------------------------------------------------------------------------
r15549 | a.rainman@gmail.com | 2013-09-28 03:16:58 +0400 (Сб, 28 сен 2013) | 3 lines

# Защитил список избранных путей для загрузки (favoriteDirs) спин локом.
# Оптимизация работы с контейнером favoriteDirs - разрезаем строку с расширениями только при изменении а в FavoriteManager::getDownloadDirectory, которая зовётся при старте каждой закачки, уже ничего не трогаем.
# Поправил недочёты в апи, и реализации при работе с favoriteDirs.
------------------------------------------------------------------------
r15548 | a.rainman@gmail.com | 2013-09-28 03:08:22 +0400 (Сб, 28 сен 2013) | 1 line

# В дополнение к функции Util::splitSetting добавлены splitSettingAndReplaceSpace и toSettingString.
------------------------------------------------------------------------
r15547 | a.rainman@gmail.com | 2013-09-28 02:34:20 +0400 (Сб, 28 сен 2013) | 5 lines

# Мелкие фиксы в SettingsManager::set:
 - замена пробелов в списках параметров является молчаливой корректировкой, о которой не надо сообщать.
 - забыли убрать пробелы из PROT_USERS (Списка защищённых от проверок и автобана юзеров).
 - корректировка значений BANDWIDTH_LIMIT_START и BANDWIDTH_LIMIT_END должна быть в пределах 0-23.

------------------------------------------------------------------------
r15546 | a.rainman@gmail.com | 2013-09-27 23:51:16 +0400 (Пт, 27 сен 2013) | 3 lines

* Поправил вывод статусных сообщений в окне хаба при старте программы когда кто то из друзей входит в сеть или выходит из сети.
# Убрал g_isStartupProcess из обработки событий в HubFrame... двух этажную даже :)
# p.s: Всё же очень плохо когда код утыкан подобными проверками, по хорошему надо делать так: при старте откладывать обработку (это очень легко, достаточно группировать события, что уже реализовано во всех окнах, и просто запускать таймер позже, и для ядра тоже самое - TimerManager надо стартовать позже, логика отложенного запуска там уже реализована, осталось только унести запуск таймера на момент после прогрузки всех хабов, к примеру). А для того что бы при завершении работы корректно завершаться не флажки нужны, ибо это не безопасно, поскольку сложно отследить всю последовательность вызовов за флажком, а надо переставлять указатель с функции для обычной работы на функцию для режима выключения, пусть это немного сложнее (больше кода), но зато по коду (из названия функции) сразу видно какой именно кусок логики при завершении не выполняется, а следовательно гораздо легче найти ошибку, а точнее гораздо сложнее её допустить, ибо вряд ли случайно будет отключен метод именуемый saveToDb или что то аналогичное.
------------------------------------------------------------------------
r15545 | a.rainman@gmail.com | 2013-09-27 22:00:12 +0400 (Пт, 27 сен 2013) | 2 lines

# Ревью к r15534 - почищен код, поправлены найденные ошибки, кое где не добавляли юзера в коллекцию, а то и параметры не применяли :(
# Критично в FavoriteManager::setUploadLimit и FavoriteManager::setFlag
------------------------------------------------------------------------
r15544 | a.rainman@gmail.com | 2013-09-27 21:55:24 +0400 (Пт, 27 сен 2013) | 1 line

# В дебаге при разрушении CFlylinkDBManager выводим статистку по использованию кеша географического месторасположения.
------------------------------------------------------------------------
r15543 | a.rainman@gmail.com | 2013-09-27 21:54:56 +0400 (Пт, 27 сен 2013) | 2 lines

# Косметика.
# Прибил избыточный класс CFlyClosedFlag.
------------------------------------------------------------------------
r15542 | tret2003 | 2013-09-27 21:38:03 +0400 (Пт, 27 сен 2013) | 1 line

# Исправлено отображение флага страны из кэша
------------------------------------------------------------------------
r15541 | pavel.pimenov@gmail.com | 2013-09-27 21:34:30 +0400 (Пт, 27 сен 2013) | 2 lines

# safe_destroy_timer(); зову после m_closed = true;
  TODO m_closed - засунуть в CFlyTimerAdapter
------------------------------------------------------------------------
r15540 | pavel.pimenov@gmail.com | 2013-09-27 21:05:34 +0400 (Пт, 27 сен 2013) | 3 lines

# Вернул оконные таймеры для всех хабов 
  Спасибо Ежику, что нашел косяк
  https://code.google.com/p/flylinkdc/source/detail?r=15539
------------------------------------------------------------------------
r15539 | pavel.pimenov@gmail.com | 2013-09-27 20:12:39 +0400 (Пт, 27 сен 2013) | 5 lines

# Обобщил виндовый таймер через класс CFlyTimerAdapter 
  Отказался от подписки всех гуевых окон на TimerManagerListener
   - Из-за него возникает куча дедлоков
   - При отрытии 140 хабов они все висят в подписке и перебираются спикером.
   - Виндовый таймер теперь активируется только для активного окна и при потере активности разрушается.
------------------------------------------------------------------------
r15538 | a.rainman@gmail.com | 2013-09-27 20:02:14 +0400 (Пт, 27 сен 2013) | 1 line

# Исправление для FavoriteManager::getUserUrl - возвращали ссылку на мембер объекта из коллекции.
------------------------------------------------------------------------
r15537 | a.rainman@gmail.com | 2013-09-27 19:46:34 +0400 (Пт, 27 сен 2013) | 1 line

# Заменил магическое \x09 на сишный \t.
------------------------------------------------------------------------
r15536 | pavel.pimenov@gmail.com | 2013-09-27 19:45:02 +0400 (Пт, 27 сен 2013) | 4 lines

# Рефакторинг HttpConnection
  нашел багу - если открыть окно публичных хабов стартует HttpConnection
  и если сразу закрыть приложение то прога еще некоторое время висит в void BufferedSocket::threadConnect
  как поправить корректно пока незнаю - повесил ругалку dcassert(!ClientManager::isShutdown());
------------------------------------------------------------------------
r15535 | tret2003 | 2013-09-27 19:44:38 +0400 (Пт, 27 сен 2013) | 1 line

# Дополнение r15533
------------------------------------------------------------------------
r15534 | pavel.pimenov@gmail.com | 2013-09-27 19:36:52 +0400 (Пт, 27 сен 2013) | 4 lines

# Фиксы в FavoriteManager
 - Минимизировал обращение к FavoriteManager из HubFrame::onSpeaker
 - Если нет друзей вообще - обращаемся к менеджеру без блокировок.
# При разрушении не зовем void ClientManager::on(UserUpdated
------------------------------------------------------------------------
r15533 | pavel.pimenov@gmail.com | 2013-09-27 18:39:49 +0400 (Пт, 27 сен 2013) | 1 line

# Перенес толстый код из хедера в AdcSupports.cpp
------------------------------------------------------------------------
r15532 | pavel.pimenov@gmail.com | 2013-09-27 07:16:26 +0400 (Пт, 27 сен 2013) | 1 line

# Log [public-build]
------------------------------------------------------------------------
r15531 | pavel.pimenov@gmail.com | 2013-09-27 07:03:09 +0400 (Пт, 27 сен 2013) | 3 lines

* (Fixed issue 1316) Умирание при поиске на rc2.4
  http://code.google.com/p/flylinkdc/issues/detail?id=1316

------------------------------------------------------------------------
r15530 | a.rainman@gmail.com | 2013-09-26 22:59:24 +0400 (Чт, 26 сен 2013) | 3 lines

* Поправлены падения при добавлении плохих источников обратно к закачке в окне "Очередь скачивания".
# В QueueManager::UserQueue::addL поправлен недочёт с расстановкой закачек в очереди.
# [public-build]
------------------------------------------------------------------------
r15529 | tret2003 | 2013-09-26 21:52:23 +0400 (Чт, 26 сен 2013) | 1 line

# [lang] an auto commit from localization system...
------------------------------------------------------------------------
r15521 | pavel.pimenov@gmail.com | 2013-09-26 07:12:34 +0400 (Чт, 26 сен 2013) | 1 line

# log
------------------------------------------------------------------------
r15520 | pavel.pimenov@gmail.com | 2013-09-26 06:44:26 +0400 (Чт, 26 сен 2013) | 1 line

# Убрал из заголовка GR_USEROBJECTS
------------------------------------------------------------------------
r15519 | pavel.pimenov@gmail.com | 2013-09-25 21:20:01 +0400 (Ср, 25 сен 2013) | 1 line

# Убрал экспериментальный swap
------------------------------------------------------------------------
r15518 | pavel.pimenov@gmail.com | 2013-09-25 21:14:34 +0400 (Ср, 25 сен 2013) | 2 lines

# Нашел случаи когда при ClientManager::isShutdown() работает DHT и вешается на локах
  помогаем ему быстрее закончить работу пока через флажки
------------------------------------------------------------------------
r15517 | pavel.pimenov@gmail.com | 2013-09-25 21:12:56 +0400 (Ср, 25 сен 2013) | 1 line

# Забыл убрать MENU_REFRESH_MEDIAINFO
------------------------------------------------------------------------
r15515 | pavel.pimenov@gmail.com | 2013-09-25 19:58:35 +0400 (Ср, 25 сен 2013) | 1 line

# Отключил лишний спам !getEmptyStringParamBit в _DEBUG
------------------------------------------------------------------------
r15514 | pavel.pimenov@gmail.com | 2013-09-25 19:32:41 +0400 (Ср, 25 сен 2013) | 1 line

# Astyle
------------------------------------------------------------------------
r15513 | pavel.pimenov@gmail.com | 2013-09-25 19:32:11 +0400 (Ср, 25 сен 2013) | 1 line

# Опечатка.
------------------------------------------------------------------------
r15512 | pavel.pimenov@gmail.com | 2013-09-25 19:30:26 +0400 (Ср, 25 сен 2013) | 1 line

# Довырезал ребилд медиаинфы
------------------------------------------------------------------------
r15511 | pavel.pimenov@gmail.com | 2013-09-25 19:27:26 +0400 (Ср, 25 сен 2013) | 2 lines

* (Started issue 1314) http://code.google.com/p/flylinkdc/issues/detail?id=1314
  - Для параметров EM и DE оптимизируем доступ когда значения строк пустые (не делаем блокировку)
------------------------------------------------------------------------
r15510 | pavel.pimenov@gmail.com | 2013-09-25 19:22:33 +0400 (Ср, 25 сен 2013) | 1 line

# Отключил ребилд медиаинфы
------------------------------------------------------------------------
r15509 | pavel.pimenov@gmail.com | 2013-09-25 18:35:36 +0400 (Ср, 25 сен 2013) | 1 line

# Убрал экран PPA_ENABLE_STRING_INFO_DIC_IN_IDENTITY
------------------------------------------------------------------------
r15508 | pavel.pimenov@gmail.com | 2013-09-25 18:32:58 +0400 (Ср, 25 сен 2013) | 1 line

# Убрал копипаст #define TAG(x,y) (x + (y << 8))
------------------------------------------------------------------------
r15507 | pavel.pimenov | 2013-09-25 15:53:22 +0400 (Ср, 25 сен 2013) | 3 lines

# Не согласен с r15506 :)
  tstring Identity::getHubs() не может вертать "0" т.к. юзер как минимум сидит на этом хабе.
  а для наглядности там должна быть пустота null (не определенность)
------------------------------------------------------------------------
r15506 | a.rainman@gmail.com | 2013-09-25 15:40:54 +0400 (Ср, 25 сен 2013) | 2 lines

* Допо-е к issue 1313 Не показывать в колонке "хабы" левую информацию в виде 0
(0/0/0): для наглядности отображаем просто 0 без расшифровки.
------------------------------------------------------------------------
r15505 | tret2003 | 2013-09-25 12:47:39 +0400 (Ср, 25 сен 2013) | 1 line

# [lang] an auto commit from localization system...
------------------------------------------------------------------------
r15504 | tret2003 | 2013-09-25 12:19:42 +0400 (Ср, 25 сен 2013) | 1 line

# Правка локализации скачано/роздано
------------------------------------------------------------------------
r15503 | pavel.pimenov | 2013-09-25 10:00:44 +0400 (Ср, 25 сен 2013) | 1 line

# Забыл отключить отладочный спам в Identity
------------------------------------------------------------------------
r15502 | pavel.pimenov | 2013-09-25 09:58:06 +0400 (Ср, 25 сен 2013) | 5 lines

* (Fixed issue 1313) Не показывать в колонке "хабы" левую информацию в виде 0 (0/0/0) 
   на толстых хабах это не отдается но при этом клиент выполняет холостые операции вида
   hubs.resize(64);
   hubs.resize(snwprintf(&hubs[0], hubs.size(), _T("%u (%u/%u/%u)"),

------------------------------------------------------------------------
r15501 | pavel.pimenov@gmail.com | 2013-09-25 06:52:25 +0400 (Ср, 25 сен 2013) | 1 line

# Log [public-build]
------------------------------------------------------------------------
r15500 | tret2003 | 2013-09-25 06:37:01 +0400 (Ср, 25 сен 2013) | 1 line

# Откатил r15494, проблема несколько глубже.
------------------------------------------------------------------------
r15498 | pavel.pimenov@gmail.com | 2013-09-25 06:25:28 +0400 (Ср, 25 сен 2013) | 1 line

# Сбор статистики появления параметров и их значений в void Identity::setStringParam
------------------------------------------------------------------------
r15497 | pavel.pimenov@gmail.com | 2013-09-24 23:07:33 +0400 (Вт, 24 сен 2013) | 1 line

# Astyle [public-build]
------------------------------------------------------------------------
r15496 | pavel.pimenov@gmail.com | 2013-09-24 23:06:41 +0400 (Вт, 24 сен 2013) | 5 lines

# Говно-вкладки. часть 2
 Часто используемые иконки создаем один раз исключая массовые вызовы ::LoadImage
 HIconWrapper WinUtil::g_HubOnIcon(IDR_HUB);
 HIconWrapper WinUtil::g_HubOffIcon(IDR_HUB_OFF);
 TODO - причесать код.
------------------------------------------------------------------------
r15495 | tret2003 | 2013-09-24 21:19:01 +0400 (Вт, 24 сен 2013) | 1 line

# Дополнение к r15494. забыл коммент к ссылке
------------------------------------------------------------------------
r15494 | tret2003 | 2013-09-24 20:08:22 +0400 (Вт, 24 сен 2013) | 2 lines

* (Fixed  issue 1312) Не отображаются смайлы, отличные от выбранного пакета.
  https://code.google.com/p/flylinkdc/issues/detail?id=1312
------------------------------------------------------------------------
r15493 | pavel.pimenov@gmail.com | 2013-09-24 17:32:16 +0400 (Вт, 24 сен 2013) | 1 line

# Индексы иконок храним в uint16_t а не в long
------------------------------------------------------------------------
r15492 | pavel.pimenov@gmail.com | 2013-09-24 17:20:56 +0400 (Вт, 24 сен 2013) | 1 line

# Мертвый член
------------------------------------------------------------------------
r15491 | pavel.pimenov@gmail.com | 2013-09-24 17:20:09 +0400 (Вт, 24 сен 2013) | 1 line

# Убрал лишние бреки после return
------------------------------------------------------------------------
r15490 | pavel.pimenov@gmail.com | 2013-09-24 16:53:34 +0400 (Вт, 24 сен 2013) | 1 line

# Говно-вкладки. Создавали два объекта new HIconWrapper при этом рисовали всегда одним!
------------------------------------------------------------------------
r15489 | pavel.pimenov@gmail.com | 2013-09-24 16:51:38 +0400 (Вт, 24 сен 2013) | 1 line

# jconcpp - фиксы с переполнением при sprintf
------------------------------------------------------------------------
r15488 | a.rainman@gmail.com | 2013-09-24 15:43:13 +0400 (Вт, 24 сен 2013) | 4 lines

# Оптимизация в QueueFrame::QueueItemInfo::getText - убрал множественную блокировку для колонки COLUMN_STATUS.
# Чуть почистил код в том месте.
# log.
# [public-build]
------------------------------------------------------------------------
r15487 | a.rainman@gmail.com | 2013-09-24 14:57:28 +0400 (Вт, 24 сен 2013) | 4 lines

* Добавлена возможность перепроверки нескольких файлов сразу из контекстного меню в окне "Очередь скачивания".
* Поправлена логика работы для проверки целостности маленьких файлов (меньше 64кБ) и отсутствующих файлов
# Мелкая оптимизация в диагностиках QueueManager::UserQueue::removeL - сначала проверяем боевое условие, а лишь потом дебажное.
# [public-build]
------------------------------------------------------------------------
r15486 | a.rainman@gmail.com | 2013-09-24 12:45:57 +0400 (Вт, 24 сен 2013) | 2 lines

# +r15481 - ошибся в условии - как следствие автоматом (по заврешению) из очереди не удалялись скачанные файлы.
# [public-build]
------------------------------------------------------------------------
r15485 | a.rainman@gmail.com | 2013-09-24 12:31:25 +0400 (Вт, 24 сен 2013) | 4 lines

* Частичный перенос оптимизаций из ежовой в основную ветку в области лишнего копирования данных.
# включил IRAINMAN_NON_COPYABLE_FAV_DIRS.
# log
# [public-build]
------------------------------------------------------------------------
r15484 | a.rainman@gmail.com | 2013-09-24 12:05:30 +0400 (Вт, 24 сен 2013) | 7 lines

# Технологический коммит.
# Из QueueItem::removeSourceL убрал проверку, маскирующую потенциальные проблемы.
# В QueueManager::getDownload считаем загруженные байты - критично.
# Оптимизация в QueueItem::addSourceL и QueueItem::removeSourceL за счёт использования семантики перемещения толстого объекта Source.
# Оптимизация за счёт перевода контейнеров с толстыми данными, и (или) контейнеров из которых производится удаление из произвольного места с vector на deque ( http://www.baptiste-wicht.com/2012/12/cpp-benchmark-vector-list-deque/ )
# [public-build]

------------------------------------------------------------------------
r15483 | a.rainman@gmail.com | 2013-09-24 12:04:36 +0400 (Вт, 24 сен 2013) | 1 line

# Добавил директиву AUTOUPDATE_NOT_DISABLE возможности полного управления настройками авто-апдейта в ежовой.
------------------------------------------------------------------------
r15482 | a.rainman@gmail.com | 2013-09-24 11:34:46 +0400 (Вт, 24 сен 2013) | 1 line

# Косметика.
------------------------------------------------------------------------
r15481 | a.rainman@gmail.com | 2013-09-24 09:22:53 +0400 (Вт, 24 сен 2013) | 7 lines

# Ищу причину падений https://www.crash-server.com/Problem.aspx?ClientID=ppa&ProblemID=39674 и им подобных (их в трекере много, как подберусь ближе к исправлени, сгребу их в кучу). Благо у меня под нагрузкой более-менее стабильно повторяется.
# QueueManager - немного почистил код - сократил количество блокировок, идущих подряд, при этом чуть увеличив их длительность.
# Issue 1082 - http://code.google.com/p/flylinkdc/issues/detail?id=1082 - почищен код.
# QueueItem::isFinished и QueueItem::isChunkDownloaded - теперь требуют внешней блокировки.
# Убрал неоднозначный goto из QueueManager::removeSource - неоднозначный поскольку в коде есть блокировка - вряд ли это приводило к дедлокам, однако данный код мог скрывать проблему.
# В QueueItem::calcAverageSpeedAndCalcAndGetDownloadedBytesL() убрал дебажный вывод в лог, ибо под нагрзкой студия тормозит от всех этих сообщений.
# [public-build]
------------------------------------------------------------------------
r15480 | pavel.pimenov@gmail.com | 2013-09-24 06:40:52 +0400 (Вт, 24 сен 2013) | 1 line

# Log
------------------------------------------------------------------------
r15479 | a.rainman@gmail.com | 2013-09-24 05:26:17 +0400 (Вт, 24 сен 2013) | 4 lines

# log.
# Подправил лог: 
* В ежовой исправлено зависание при активной закачке если был включён DHT. В обычной версии этого бага нет.

------------------------------------------------------------------------
r15478 | a.rainman@gmail.com | 2013-09-24 05:23:50 +0400 (Вт, 24 сен 2013) | 3 lines

* В ежовой исправлено зависание при активной закачке.
# IRAINMAN_USE_SEPARATE_CS_IN_QUEUE_MANAGER - поправил DeadLock.
# log
------------------------------------------------------------------------
r15477 | a.rainman@gmail.com | 2013-09-24 00:39:04 +0400 (Вт, 24 сен 2013) | 1 line

# log.
------------------------------------------------------------------------
r15476 | a.rainman@gmail.com | 2013-09-24 00:26:19 +0400 (Вт, 24 сен 2013) | 2 lines

# AStyle.
# [public-build]
------------------------------------------------------------------------
r15475 | a.rainman@gmail.com | 2013-09-24 00:25:48 +0400 (Вт, 24 сен 2013) | 2 lines

# Небольшая оптимизация: замена list на более эффективные deque и vector в соответствующих условиям местах http://www.baptiste-wicht.com/2012/12/cpp-benchmark-vector-list-deque/
p.s: три последних коммита это всё за сегодняшний вечер, до этого я не Флаем занимался и отлаживать что то большое со сложными зависимостями сегодня к вечеру возможности уже не было никакой, однако мелочи доделать по недавним коммитам возможность была.
------------------------------------------------------------------------
r15474 | a.rainman@gmail.com | 2013-09-23 23:55:26 +0400 (Пн, 23 сен 2013) | 4 lines

# Ревизия ChatCtrl.
# Исправлена ошибка в ChatCtrl::onSize, есть вероятность что частично уйдут проблемы со слетающим режимом прокрутки в окне чата. Причина: 0 - допустимое значение на выходе функции http://msdn.microsoft.com/ru-ru/library/1z3s90k4(v=vs.90).aspx
# В ChatCtrl::get_URL - убрал не используемый параметр - он там гарантированно не нужен потому что текст ссылки парсится и заменяется на другой в процессе.
# Мелкая оптимизация в ChatCtrl::HitIP - минимальная длинна строки для IPv4 = 7 (пример: 1.1.1.1)
------------------------------------------------------------------------
r15473 | a.rainman@gmail.com | 2013-09-23 23:07:05 +0400 (Пн, 23 сен 2013) | 3 lines

# На всякий случай ещё раз посмотрел весь BufferedSocket:
  - убрал у m_state модификатор volitile, т.к. теперь он изменяется только в одном потоке (потоке сокета), до этого он так же изменялся в методе shutdown, который мог вызываться из других потоков.
  - в ежовой заинлайнил addTask, причина - очень короткая функция.
------------------------------------------------------------------------
r15472 | tret2003 | 2013-09-23 21:37:52 +0400 (Пн, 23 сен 2013) | 1 line

# Не проверяем лишний раз на ссылки, к r15471
------------------------------------------------------------------------
r15471 | tret2003 | 2013-09-23 21:25:48 +0400 (Пн, 23 сен 2013) | 2 lines

* (Fixed  issue 1304) Ломаются ссылкив чате.
  https://code.google.com/p/flylinkdc/issues/detail?id=1304
------------------------------------------------------------------------
r15470 | tret2003 | 2013-09-23 20:33:44 +0400 (Пн, 23 сен 2013) | 1 line

# Дополнение r15469, убрал лишние параметры
------------------------------------------------------------------------
r15469 | pavel.pimenov@gmail.com | 2013-09-23 19:42:46 +0400 (Пн, 23 сен 2013) | 1 line

# Добавил 2 хаба
------------------------------------------------------------------------
r15468 | pavel.pimenov@gmail.com | 2013-09-23 19:29:36 +0400 (Пн, 23 сен 2013) | 4 lines

# [cppcheck 1.61]
  - Добавлены забытые инициализации мемберов
  - Убрал мертвый код void TigerHash::tigerCompress
  - Вокне поиска показываем последний поисковый запрос (вместо спама в лог)
------------------------------------------------------------------------
r15467 | pavel.pimenov@gmail.com | 2013-09-23 19:06:58 +0400 (Пн, 23 сен 2013) | 1 line

# Log
------------------------------------------------------------------------
r15466 | a.rainman@gmail.com | 2013-09-23 18:49:54 +0400 (Пн, 23 сен 2013) | 5 lines

# +r15462: 
 - в ежовой вернул inline в сокетах.
 - вернул ник в Identity - критичное изменение, ибо без этого невозможно корректная работа на ADC хабах.
 - поправил сборку без PPA_INCLUDE_LASTIP_AND_USER_RATIO
 - TODO: вынести из getStringParam и setStringParam - словарные строки в отдельные методы, ибо они и так везде зовутся явным образом.
------------------------------------------------------------------------
r15465 | pavel.pimenov | 2013-09-23 16:26:06 +0400 (Пн, 23 сен 2013) | 1 line

# [cppcheck 1.61] Забыта инициализация _debugOwnersState в конструкторе
------------------------------------------------------------------------
r15464 | tret2003 | 2013-09-23 15:01:33 +0400 (Пн, 23 сен 2013) | 1 line

# Дополнение r15458, fix сборки в VS2012
------------------------------------------------------------------------
r15463 | pavel.pimenov | 2013-09-23 14:24:35 +0400 (Пн, 23 сен 2013) | 1 line

# Убил экран IRAINMAN_NON_COPYABLE_DATA_IN_UPLOAD_MANAGER
------------------------------------------------------------------------
r15462 | pavel.pimenov | 2013-09-23 14:20:35 +0400 (Пн, 23 сен 2013) | 3 lines

# - Убил экраны USE_GET_NICK_T_IN_IDENTITY и IRAINMAN_ENABLE_STRING_INFO_POOL_IN_IDENTITY
  - Исправлен баг с хранением в CFlyUserRatioInfo критической секции как мембера
  - Убрал хранение коопии ника в Identity и User 
------------------------------------------------------------------------
r15461 | pavel.pimenov | 2013-09-23 11:56:00 +0400 (Пн, 23 сен 2013) | 1 line

# Убрал лишний мембер m_last_ip_id в классе CFlyRatioItem + вирутальный деструктор тоже там не нужен.
------------------------------------------------------------------------
r15460 | a.rainman@gmail.com | 2013-09-22 01:30:56 +0400 (Вс, 22 сен 2013) | 1 line

# Убрал TIGER_ARCH64 для 32х битных ежовых версий. MSVC гораздо хуже векторизует этот код чем Intel CPP.
------------------------------------------------------------------------
r15459 | a.rainman@gmail.com | 2013-09-21 18:20:32 +0400 (Сб, 21 сен 2013) | 2 lines

# AStyle
# [public-build]
------------------------------------------------------------------------
r15458 | a.rainman@gmail.com | 2013-09-21 18:20:17 +0400 (Сб, 21 сен 2013) | 1 line

# Вероятно исправлено Issue 1280: Зависание при завершении приложения (после согласия на обновление) https://code.google.com/p/flylinkdc/issues/detail?id=1280 тоже самое касается сопутствующих проблем c зависаниями в тех краях - исправлено упрощением кода.
------------------------------------------------------------------------
r15457 | a.rainman@gmail.com | 2013-09-21 18:11:47 +0400 (Сб, 21 сен 2013) | 1 line

# Убрал мёртвое из Thread.
------------------------------------------------------------------------
r15456 | a.rainman@gmail.com | 2013-09-21 18:11:00 +0400 (Сб, 21 сен 2013) | 1 line

# Убрал навящевую диагностику из flattabctrl. Если она действительно нужна - гораздо полезнее добавить счётчик вызовов.
------------------------------------------------------------------------
r15455 | a.rainman@gmail.com | 2013-09-21 18:09:06 +0400 (Сб, 21 сен 2013) | 1 line

# 0 -> nullptr.
------------------------------------------------------------------------
r15454 | a.rainman@gmail.com | 2013-09-21 18:07:50 +0400 (Сб, 21 сен 2013) | 1 line

* В ежовой исправлено падение при завершении приложения если был включён DHT. В обычной версии данного нет.
------------------------------------------------------------------------
r15453 | pavel.pimenov@gmail.com | 2013-09-21 09:37:37 +0400 (Сб, 21 сен 2013) | 1 line

* r502-rc2 [public-build]
------------------------------------------------------------------------
r15452 | pavel.pimenov@gmail.com | 2013-09-21 09:30:08 +0400 (Сб, 21 сен 2013) | 1 line

* leveldb 1.14
------------------------------------------------------------------------
r15450 | pavel.pimenov@gmail.com | 2013-09-20 20:31:23 +0400 (Пт, 20 сен 2013) | 1 line

# log [public-build]
------------------------------------------------------------------------
r15449 | pavel.pimenov@gmail.com | 2013-09-20 19:28:34 +0400 (Пт, 20 сен 2013) | 4 lines

# issue 1301 http://code.google.com/p/flylinkdc/issues/detail?id=1301
  - Перенес толстый код их h в cpp файлы
  - Функциям добавил суффикс L где нужна внешняя блокировка
 
------------------------------------------------------------------------
r15448 | pavel.pimenov@gmail.com | 2013-09-20 18:58:16 +0400 (Пт, 20 сен 2013) | 7 lines

# issue 1301 http://code.google.com/p/flylinkdc/issues/detail?id=1301
  - typedef std::list<Download*> DownloadList; заменил на 
    typedef std::vector<Download*> DownloadArray;
  т.к. в коде нескольк раз встречается код вида qi->getDownloadsL().size() без лока
  а в случае std::list это перебор всех элементов по цепочке!

 
------------------------------------------------------------------------
r15447 | pavel.pimenov@gmail.com | 2013-09-20 18:35:02 +0400 (Пт, 20 сен 2013) | 2 lines

# Исправлена ошибка загрузки битой очереди закачек в CFlylinkDBManager::load_queue() 
  (словил Слава - как получилось пока не понятно)
------------------------------------------------------------------------
r15444 | pavel.pimenov | 2013-09-20 10:05:37 +0400 (Пт, 20 сен 2013) | 1 line

# Починил пропадание кнопок отключения юзеров после переключения фреймов.
------------------------------------------------------------------------
r15443 | pavel.pimenov | 2013-09-20 09:23:46 +0400 (Пт, 20 сен 2013) | 2 lines

# fix https://crash-server.com/Problem.aspx?ClientID=ppa&ProblemID=36887

------------------------------------------------------------------------
r15440 | pavel.pimenov@gmail.com | 2013-09-19 19:02:44 +0400 (Чт, 19 сен 2013) | 1 line

# Убрал лишнюю проверку в CFlylinkDBManager::store_all_ratio_and_last_i
------------------------------------------------------------------------
r15439 | pavel.pimenov@gmail.com | 2013-09-19 18:45:34 +0400 (Чт, 19 сен 2013) | 1 line

# Log [public-build]
------------------------------------------------------------------------
r15438 | pavel.pimenov@gmail.com | 2013-09-19 18:21:52 +0400 (Чт, 19 сен 2013) | 2 lines

# issue 1298 http://code.google.com/p/flylinkdc/issues/detail?id=1298
  Кто-то затирает IP в пустоту. поймать в дебаге
------------------------------------------------------------------------
r15437 | pavel.pimenov@gmail.com | 2013-09-19 18:19:48 +0400 (Чт, 19 сен 2013) | 11 lines

# Попытка исправить падения при завершении приложения или закрития всех вкладок
  https://crash-server.com/Problem.aspx?ClientID=ppa&ProblemID=38156
  https://crash-server.com/Problem.aspx?ClientID=ppa&ProblemID=22636
  https://crash-server.com/Problem.aspx?ClientID=ppa&ProblemID=38151
  https://crash-server.com/Problem.aspx?ClientID=ppa&ProblemID=38282
  https://crash-server.com/Problem.aspx?ClientID=ppa&ProblemID=38145
  https://crash-server.com/Problem.aspx?ClientID=ppa&ProblemID=38176
  https://crash-server.com/Problem.aspx?ClientID=ppa&ProblemID=38272 
  https://crash-server.com/Problem.aspx?ClientID=ppa&ProblemID=38290
  https://crash-server.com/Problem.aspx?ClientID=ppa&ProblemID=38291
  
------------------------------------------------------------------------
r15436 | tret2003 | 2013-09-19 10:29:19 +0400 (Чт, 19 сен 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1288, created 2013-09-19 13:25:45 +0700
   Total in database:
    - ISP - 1404
    - ISPs logo - 1413
    - Address range - 5983
   Archive CustomLocations.7z created by NightOrion


------------------------------------------------------------------------
r15435 | pavel.pimenov | 2013-09-19 10:19:38 +0400 (Чт, 19 сен 2013) | 3 lines

* (Fixed issue 1297) http://code.google.com/p/flylinkdc/issues/detail?id=1297
  - Добавил визуализацию флага страны в окнах передачи и поиска.
  - TODO - убрать копипаст и обобщить код визуализации в этих окнах.
------------------------------------------------------------------------
r15434 | pavel.pimenov@gmail.com | 2013-09-19 07:06:45 +0400 (Чт, 19 сен 2013) | 2 lines

* (Fixed issue 1297) Дырки в GeoIP - не показывает даже флага страны
   http://code.google.com/p/flylinkdc/issues/detail?id=1297
------------------------------------------------------------------------
r15430 | pavel.pimenov@gmail.com | 2013-09-18 22:38:34 +0400 (Ср, 18 сен 2013) | 2 lines

# Попытка исправить падения вида https://crash-server.com/Problem.aspx?ClientID=ppa&ProblemID=38156

------------------------------------------------------------------------
r15429 | pavel.pimenov@gmail.com | 2013-09-18 21:19:53 +0400 (Ср, 18 сен 2013) | 1 line

# Astyle [public-build]
------------------------------------------------------------------------
r15428 | a.rainman@gmail.com | 2013-09-18 20:29:36 +0400 (Ср, 18 сен 2013) | 1 line

# +r15425: поправлена сборка без FLYLINKDC_CALC_MEMORY_USAGE и IRAINMAN_INCLUDE_SMILE.
------------------------------------------------------------------------
r15427 | pavel.pimenov@gmail.com | 2013-09-18 19:21:24 +0400 (Ср, 18 сен 2013) | 2 lines

# boost::replace_all(p_text, _T("\r"), _T("\n")); -> std::replace(p_text.begin(),p_text.end(), _T('\r'), _T('\n'));
  
------------------------------------------------------------------------
r15425 | pavel.pimenov@gmail.com | 2013-09-18 18:58:16 +0400 (Ср, 18 сен 2013) | 11 lines

# destroyMessagePanel(true) - Фикс падения при завершении (потестить и пока серую не выпускать)
 - Обобщил метод bool CAGEmotionSetup::reCreateEmotionSetup()
 - Исключил лишние операции при разрушение/запуске приложения.
  - Не тикаем в void PopupManager::on(TimerManagerListener::Second
  - В void ChatCtrl::AppendText смайлы не создаются пока активируется приложение
  - Вернул счетчик g_CountSTATS - он закрывает повторные посылки обновления статусного окна
    прошу не отключать анализ флажков вот так 
    IRainman fix: no needs anymore https://code.google.com/p/flylinkdc/source/detail?r=15113
    без подтверждения dcassert-ом
  - В void LogManager::message кидали мессагу для хинта fire(LogManagerListener::Message(), msg); 
    даже когда приложение находится в переходном состоянии.
------------------------------------------------------------------------
r15424 | pavel.pimenov@gmail.com | 2013-09-18 18:38:10 +0400 (Ср, 18 сен 2013) | 2 lines

# [fly-server] Проверка кода возврата GetProcessMemoryInfo (под wine оно не работает)
  
------------------------------------------------------------------------
r15423 | pavel.pimenov@gmail.com | 2013-09-18 18:34:03 +0400 (Ср, 18 сен 2013) | 4 lines

# Ускорено разрушение таймеров в CGDIImage::OnTimer если приложение закрывается
  Оптимизирована отписка в CGDIImage::UnregisterCallback. когда в чате много смайлов накопляется - std::set там большой
  TODO - Разобраться и гасить таймеры перед разрушением все сразу
  TODO - Заведен еще один флаш CGDIImage::g_isShutdown Ежу не возмущаться. после стабилизации все флажки оптимизнутся
------------------------------------------------------------------------
r15422 | a.rainman@gmail.com | 2013-09-17 22:57:21 +0400 (Вт, 17 сен 2013) | 2 lines

# +r15420 - исправлена установка ограничителя скорости сразу после старта программы 
# [public-build]
------------------------------------------------------------------------
r15421 | pavel.pimenov@gmail.com | 2013-09-17 22:22:31 +0400 (Вт, 17 сен 2013) | 1 line

# [public-build]
------------------------------------------------------------------------
r15420 | pavel.pimenov@gmail.com | 2013-09-17 22:20:55 +0400 (Вт, 17 сен 2013) | 4 lines

# Исправлено падение ThrottleManager::getInstance()->updateLimits()
  https://www.crash-server.com/DumpGroup.aspx?ClientID=ppa&Login=Guest&DumpGroupID=92659
  если лимитер включен - он активируется через минуту после старта.

------------------------------------------------------------------------
r15419 | pavel.pimenov@gmail.com | 2013-09-17 22:00:28 +0400 (Вт, 17 сен 2013) | 1 line

# Astyle
------------------------------------------------------------------------
r15418 | pavel.pimenov@gmail.com | 2013-09-17 21:47:01 +0400 (Вт, 17 сен 2013) | 2 lines

# Закрыл аssert в PrivateFrame::~PrivateFrame
  пока не понял почему падаем в отладке при закрытии фрейма
------------------------------------------------------------------------
r15417 | a.rainman@gmail.com | 2013-09-17 21:21:41 +0400 (Вт, 17 сен 2013) | 1 line

# Started Issue 1289: https://code.google.com/p/flylinkdc/issues/detail?id=1289 - убрал TO из запрещённых, ибо это кусок официального протокола.
------------------------------------------------------------------------
r15416 | pavel.pimenov@gmail.com | 2013-09-17 21:18:07 +0400 (Вт, 17 сен 2013) | 1 line

# m_ctrlMessageContainer унес в BaseChatFrame (серую пока не выпускать)
------------------------------------------------------------------------
r15415 | a.rainman@gmail.com | 2013-09-17 21:12:24 +0400 (Вт, 17 сен 2013) | 1 line

# +r15410 - исправление недочётов: унёс инициализацию внутрь менеджеров. Исправил поздний вызов ResourceManager::startup().
------------------------------------------------------------------------
r15414 | a.rainman@gmail.com | 2013-09-17 20:57:30 +0400 (Вт, 17 сен 2013) | 1 line

# Started Issue 1293 https://code.google.com/p/flylinkdc/issues/detail?id=1293
------------------------------------------------------------------------
r15413 | a.rainman@gmail.com | 2013-09-17 20:57:12 +0400 (Вт, 17 сен 2013) | 1 line

# +r15410 - исправлено ошибочно потерянное обновление лимитов ограничителя при изменении настроек.
------------------------------------------------------------------------
r15412 | pavel.pimenov@gmail.com | 2013-09-17 18:09:46 +0400 (Вт, 17 сен 2013) | 3 lines

# issue 1293 http://code.google.com/p/flylinkdc/issues/detail?id=1293
  Оставил SPIN_LOCK_TRACE_RECURSIVE_ENTRY только для Ежика - подождем вдруг он починит велик.

------------------------------------------------------------------------
r15411 | pavel.pimenov@gmail.com | 2013-09-17 18:03:15 +0400 (Вт, 17 сен 2013) | 1 line

# Astyle
------------------------------------------------------------------------
r15410 | pavel.pimenov@gmail.com | 2013-09-17 18:01:41 +0400 (Вт, 17 сен 2013) | 2 lines

# SettingsManager::newInstance(); грузился позже из-за этого некоторые логи при старте не велись.
  Добавил диагностику - всем проверять клиента под _DEBUG
------------------------------------------------------------------------
r15409 | pavel.pimenov@gmail.com | 2013-09-17 06:53:23 +0400 (Вт, 17 сен 2013) | 2 lines

# Убрал dcassert в HubFrame::onFollow и CFlyUserRatioInfo::flushRatio()
# Запуск автоапдейта выполняется раньше (TODO - серую буз теста не выпускать)
------------------------------------------------------------------------
r15408 | pavel.pimenov@gmail.com | 2013-09-16 19:18:04 +0400 (Пн, 16 сен 2013) | 1 line

# Log
------------------------------------------------------------------------
r15407 | pavel.pimenov@gmail.com | 2013-09-16 17:53:03 +0400 (Пн, 16 сен 2013) | 1 line

# Log
------------------------------------------------------------------------
r15405 | pavel.pimenov | 2013-09-16 15:23:05 +0400 (Пн, 16 сен 2013) | 3 lines

# Добавка к r15404 убрал избыточные m_Page1(nullptr), m_Page2(nullptr), m_Page3(nullptr)
  Дима! имена ты выбрал не удачные. если они у тебя по номерам то може тлучше массив [3] завести?
  а если уж именовать то - дай осознаные названия страничкам 
------------------------------------------------------------------------
r15404 | scalolaz_scat@mail.ru | 2013-09-16 14:55:22 +0400 (Пн, 16 сен 2013) | 1 line

# фикс окна About
------------------------------------------------------------------------
r15403 | pavel.pimenov | 2013-09-16 14:31:59 +0400 (Пн, 16 сен 2013) | 4 lines

# Добавлен флаг TimerManager::g_isStartupProcess для быстрого фикса зависания в момент старта большого кол-ва хабов в _DEBUG режиме
  TODO - сделать красивше 
# В flush_lost_json_statistic скидываем на сервер 30 записей пачкой а не 10
  TODO - размер сброса вынести в конфигурацию 
------------------------------------------------------------------------
r15402 | pavel.pimenov | 2013-09-16 13:28:38 +0400 (Пн, 16 сен 2013) | 1 line

# Сократил размер UserInfo выкинул флаг bool m_isFav - SORT_FAVUSERS_FIRST по дефолту выключен и не думаю что включается многими.
------------------------------------------------------------------------
r15401 | pavel.pimenov | 2013-09-16 12:19:08 +0400 (Пн, 16 сен 2013) | 6 lines

* (Closed issue 1286) Сократить размер занимаемой памяти для хранения локаций CustomNetworkIndex
   http://code.google.com/p/flylinkdc/issues/detail?id=1286
CustomNetworkIndex стал размером:
  uint8_t m_country_cache_index;
  int32_t m_location_cache_index;

------------------------------------------------------------------------
r15400 | tret2003 | 2013-09-15 19:31:11 +0400 (Вс, 15 сен 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1287, created 2013-09-15 06:15:30 +0700
   Total in database:
    - ISP - 1404
    - ISPs logo - 1413
    - Address range - 5983
   Archive CustomLocations.7z created by NightOrion


------------------------------------------------------------------------
r15399 | tret2003 | 2013-09-15 16:35:38 +0400 (Вс, 15 сен 2013) | 1 line

# Поправил поиск расположения по IP в кэше, к инфе из кэша прибавлялся + в начало.
------------------------------------------------------------------------
r15398 | tret2003 | 2013-09-14 22:02:23 +0400 (Сб, 14 сен 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1286, created 2013-09-14 10:05:52 +0700
   Total in database:
    - ISP - 1404
    - ISPs logo - 1413
    - Address range - 5980
   Archive CustomLocations.7z created by NightOrion


------------------------------------------------------------------------
r15395 | pavel.pimenov@gmail.com | 2013-09-14 15:23:01 +0400 (Сб, 14 сен 2013) | 2 lines

# [mediainfo][merge][public-build]
 + AAC: option for instantaneous bitrate in fast detect mode (MediaInfoLib only)
------------------------------------------------------------------------
r15394 | pavel.pimenov@gmail.com | 2013-09-14 15:18:04 +0400 (Сб, 14 сен 2013) | 5 lines

* Исправлена работа с GeoIPCountryWhois.csv. для 192.168 - показывал флаг Италии.
  - Файлы  CustomLocations.ini и GeoIPCountryWhois.csv
    перенесены в отдельную БД FlylinkDC_locations.sqlite (изменилась структура)
  - Для поиска стран и провайдеров добалвен локальный кэш - не делаются запросы к sqlite если IP попал в ранее загруженные диапазон
  - Исправлена отрисовка флага страны. Дима заложил бомбочку в виде константы 258
------------------------------------------------------------------------
r15390 | pavel.pimenov@gmail.com | 2013-09-14 07:07:17 +0400 (Сб, 14 сен 2013) | 1 line

# Log
------------------------------------------------------------------------
r15389 | pavel.pimenov@gmail.com | 2013-09-14 06:50:19 +0400 (Сб, 14 сен 2013) | 1 line

# Log
------------------------------------------------------------------------
r15388 | a.rainman@gmail.com | 2013-09-13 16:39:39 +0400 (Пт, 13 сен 2013) | 2 lines

# Вероятно исправлено Issue 1280.
# [public-build]
------------------------------------------------------------------------
r15387 | a.rainman@gmail.com | 2013-09-13 16:39:16 +0400 (Пт, 13 сен 2013) | 2 lines

# В ~UserConnection() сперва выполняем диагностику.
# В HttpConnection::on(BufferedSocketListener::Line поправлена последовательность вызовов: сперва надо звать removeListeners(), а уже потом disconnect().
------------------------------------------------------------------------
r15386 | pavel.pimenov | 2013-09-13 10:06:39 +0400 (Пт, 13 сен 2013) | 11 lines

#В r14914 Ежом был удален блок сохранение результата парсинга GeoIpCountryWhois.csv в базу данных!
{
	CFlyLog l_geo_log_sqlite("[GeoIp-sqlite]");
	CFlylinkDBManager::getInstance()->save_geoip(l_sqlite_array);
}
Это привело к багу, по которому не отображаются флаги стран после любого обновления GeoIpCountryWhois.csv
Алексей! это уже вредительство какое-то :(
Прошу перестать рандомно все рефакторить ломая отлаженный ранее код.
ты наверно не понимаешь, что флаем пользуется пока еще много людей?


------------------------------------------------------------------------
r15385 | pavel.pimenov@gmail.com | 2013-09-13 06:48:09 +0400 (Пт, 13 сен 2013) | 5 lines

* (Started issue 1280) http://code.google.com/p/flylinkdc/issues/detail?id=1280
  - Исключаем зависание при закрытии приложения
  - TODO в нормально режиме поставить таймаут. если больше N сек спим - выходить
    пусть даже будет краш.

------------------------------------------------------------------------
r15384 | pavel.pimenov@gmail.com | 2013-09-13 05:36:07 +0400 (Пт, 13 сен 2013) | 9 lines

# Повторно захоронил 
  IRAINMAN_USE_MEMORY_CACHED_CUSTOM_NETWORK_INDEX 
  IRAINMAN_USE_CUSTOM_LOCATION_VALIDATOR
Мне тяжело читать код в таком виде, когда он изрезан весь экспериментальным дефайнами.
если хочется поупражняться - для этого есть ветки.
IRAINMAN_USE_MEMORY_CACHED_CUSTOM_NETWORK_INDEX не нужна - я эту часть перепишу сам.
а про IRAINMAN_USE_CUSTOM_LOCATION_VALIDATOR мы уже говорили - его в боевом флае не будет никогда.
если дорог код - перетаскивай его в другой файл.

------------------------------------------------------------------------
r15383 | a.rainman@gmail.com | 2013-09-13 05:15:05 +0400 (Пт, 13 сен 2013) | 2 lines

# Astyle.
# [public-build]
------------------------------------------------------------------------
r15382 | a.rainman@gmail.com | 2013-09-13 05:13:54 +0400 (Пт, 13 сен 2013) | 2 lines

# Технологический коммит - убрал стрёмный код при использовании GetDlgItemText, заменив на свой кошерный макрос GET_TEXT.
# Обновил WinUtil::GetWindowText - теперь они возвращают размер строки для удобства использования.
------------------------------------------------------------------------
r15381 | a.rainman@gmail.com | 2013-09-13 05:13:38 +0400 (Пт, 13 сен 2013) | 1 line

# Исправление для релиза 1>windows\EmoticonsDlg.cpp(453): warning C4189: 'l_res' : local variable is initialized but not referenced. В дебаге убирать не стал, ибо там не дописана диагностика.
------------------------------------------------------------------------
r15380 | a.rainman@gmail.com | 2013-09-13 03:29:46 +0400 (Пт, 13 сен 2013) | 1 line

# Откатил r15378 поскольку IRAINMAN_USE_CUSTOM_LOCATION_VALIDATOR без  IRAINMAN_USE_MEMORY_CACHED_CUSTOM_NETWORK_INDEX не соберётся, да и лишний кусок кода был снесён коммитом.
------------------------------------------------------------------------
r15379 | pavel.pimenov@gmail.com | 2013-09-12 23:34:11 +0400 (Чт, 12 сен 2013) | 1 line

# log [public-build]
------------------------------------------------------------------------
r15378 | pavel.pimenov@gmail.com | 2013-09-12 22:55:32 +0400 (Чт, 12 сен 2013) | 2 lines

# (Started issue 1278) Удалил мертвый дейфайн IRAINMAN_USE_MEMORY_CACHED_CUSTOM_NETWORK_INDEX
  http://code.google.com/p/flylinkdc/issues/detail?id=1278 
------------------------------------------------------------------------
r15377 | pavel.pimenov@gmail.com | 2013-09-12 22:40:33 +0400 (Чт, 12 сен 2013) | 3 lines

# Маркеры
  http://code.google.com/p/flylinkdc/issues/detail?id=1278
  http://code.google.com/p/flylinkdc/issues/detail?id=1279
------------------------------------------------------------------------
r15376 | pavel.pimenov@gmail.com | 2013-09-12 22:06:04 +0400 (Чт, 12 сен 2013) | 1 line

# (Started issue 1276) UserInfoBased наследуется от Speaker!
------------------------------------------------------------------------
r15375 | pavel.pimenov@gmail.com | 2013-09-12 20:43:36 +0400 (Чт, 12 сен 2013) | 3 lines

# HIconWrapper
  - ThemeManager::getResourceLibInstance() вертает NULL - не пытаемся грузить иконку
  - GetModuleHandle(nullptr) зовем один раз (он ведь не меняется для процесса никогда?
------------------------------------------------------------------------
r15374 | pavel.pimenov@gmail.com | 2013-09-12 20:39:04 +0400 (Чт, 12 сен 2013) | 1 line

# Легкий рефакторинг
------------------------------------------------------------------------
r15373 | pavel.pimenov@gmail.com | 2013-09-12 20:32:57 +0400 (Чт, 12 сен 2013) | 1 line

# miniupnpc/README
------------------------------------------------------------------------
r15372 | pavel.pimenov@gmail.com | 2013-09-12 20:00:57 +0400 (Чт, 12 сен 2013) | 8 lines

# Ругалка dcassert(sock != INVALID_SOCKET); в string Socket::getLocalIp() 
# В Speaker убрал мембер ListenerList tmp; - сделал локальным.
# В HubFrame::openWindow восстанавливаем p_windowtype
# bool HubFrame::updateUser не детектим фаворитов через менеджер если не стоит флаг BOOLSETTING(SORT_FAVUSERS_FIRST) 
  по дефолту он выключен - у всех лишние блокировки при загрузке проги
# В void removeTab(HWND aWnd) возможен вызов когда tabs.empty()
  поствил ловушку под отладкой. причину пока не нашел.
# Из Client выкинул лишний мембер string localIp;
------------------------------------------------------------------------
r15371 | pavel.pimenov@gmail.com | 2013-09-12 18:46:05 +0400 (Чт, 12 сен 2013) | 6 lines

# NmdcHub
  - Залогировал случаи когда юзер сообщает что у него шара == -1
    при этом шару превращаем в 0!
  - Залогировал поисковый запрос (по нему будет понятно почему в поиске ничего нет - например кривой Ip адрес или порт)
    TODO - вывести последний посковый запрос во фрейм поиска а не в системный лог
    (как проще это сделать пока не придумал. - место там есть после локального фильтра)
------------------------------------------------------------------------
r15370 | pavel.pimenov@gmail.com | 2013-09-12 18:08:47 +0400 (Чт, 12 сен 2013) | 1 line

# Log
------------------------------------------------------------------------
r15367 | pavel.pimenov@gmail.com | 2013-09-12 06:58:12 +0400 (Чт, 12 сен 2013) | 1 line

# Исправил сохранение галки - "Включить юзеров в окне хаба"
------------------------------------------------------------------------
r15366 | pavel.pimenov@gmail.com | 2013-09-11 23:15:18 +0400 (Ср, 11 сен 2013) | 1 line

# log [public-build]
------------------------------------------------------------------------
r15365 | pavel.pimenov@gmail.com | 2013-09-11 22:53:17 +0400 (Ср, 11 сен 2013) | 10 lines

# Заткнул очередное падение вида
https://www.crash-server.com/UploadedReport.aspx?DumpID=782809
Как повторить в отладке:
 Обновил, перегрузил. Открыл с десяток хабов из списка избранных. Решил подключить ещё несколько из списка интернет-хабов. Пару открыл удачно, 
 пару   закрыл после отказа в соединении. И падение после клика по пункту "Соединение" в контекстном меню.
падает стабильно. почему объекты оказываются без окон пока не знаю..




------------------------------------------------------------------------
r15362 | pavel.pimenov@gmail.com | 2013-09-11 21:39:16 +0400 (Ср, 11 сен 2013) | 3 lines

* Исправлено падение при открытии окна "О программе" 
  https://www.crash-server.com/Problem.aspx?ClientID=ppa&ProblemID=35187
  Забываем инициализировать указатели в конструкторе и не используем умные указатели
------------------------------------------------------------------------
r15360 | pavel.pimenov@gmail.com | 2013-09-11 20:45:21 +0400 (Ср, 11 сен 2013) | 1 line

# Log [public-build]
------------------------------------------------------------------------
r15359 | pavel.pimenov@gmail.com | 2013-09-11 20:44:13 +0400 (Ср, 11 сен 2013) | 1 line

# Причесал GeneralPage::GetLangByFile
------------------------------------------------------------------------
r15358 | pavel.pimenov@gmail.com | 2013-09-11 20:06:00 +0400 (Ср, 11 сен 2013) | 1 line

* r502-rc1
------------------------------------------------------------------------
r15357 | pavel.pimenov@gmail.com | 2013-09-11 20:01:57 +0400 (Ср, 11 сен 2013) | 3 lines

# Исправлена утечка при закрытии фреймов и чуток ускорена смерть приложения 
  (не разрушаем Win-API объекты явно зовем только delete как и было раньше в случае мемберов) 

------------------------------------------------------------------------
r15356 | a.rainman@gmail.com | 2013-09-11 19:54:59 +0400 (Ср, 11 сен 2013) | 6 lines

# Директивой IRAINMAN_USE_REAL_LOCALISATION_IN_SETTINGS выпилил код с жёстко вшитым списком файлов локализаций, ибо:
 - получение списка файлов от ФС так или иначе требуется,
 - мнимое ускорение в редко используемом месте коде (одна из страниц окна настроек) явно не компенсирует отсутствия проверки файла локализации при парсинге со всеми вытекающими из этого последствиями,
 - жёстко вшитый список файлов локализаций - это лишние проблемы, поскольку он не генерируется автоматически, а это лишние проблемы, к примеру кто то изменит описание языка, а в коде останется старое.
 В общем этого безобразия мне точно не нужно :) Да и вообще советую подумать зачем это сделано, имхо: ничего кроме проблем жёстко вшитый в код список не даёт.
p.s: этот момент рефакторили долго, а в итоге добавили лишь лишних телодвижений и сомнительную оптимизацию куска кода, который очень редко, даже не на каждом запуске приложения, зовётся, ладно бы если на парсинге этих файлов был хотя бы лаг гуя, так и его нет, и это даже на тестовом одноядерном калькуляторе Celeron M 900 МГц.
------------------------------------------------------------------------
r15355 | a.rainman@gmail.com | 2013-09-11 19:29:45 +0400 (Ср, 11 сен 2013) | 2 lines

# Полностью захоронил временную директиву IRAINMAN_USE_CRUTH_FOR_WIN8_SUPPORT для коррекции работы с кривой реализацией WinAPI в Windows 8 preview.
# +r15354 - в ежовой обратно разблокировал возможность полной настройки автоапдейта, не нужны эти ежечасные проверки.
------------------------------------------------------------------------
r15354 | tret2003 | 2013-09-11 18:54:36 +0400 (Ср, 11 сен 2013) | 2 lines

* (Fixed  issue 1272) разблокирован выбор времени обновления для беток, они выходят не так часто, для ночных сборок оставлено ежечасное обновление.
  https://code.google.com/p/flylinkdc/issues/detail?id=1272
------------------------------------------------------------------------
r15353 | pavel.pimenov@gmail.com | 2013-09-11 18:40:23 +0400 (Ср, 11 сен 2013) | 4 lines

# Убрал лишнее преобразование Text::toT(Util::getFilePath(fname)).c_str() для получения размера сектора в HashManager::Hasher::fastHash
	// TODO - размер сектора определять один раз для одной буквы через массив от A до Z и не звать GetDiskFreeSpace на каждый файл
 	// TODO - узнать зачем его вообще определять? :)
  
------------------------------------------------------------------------
r15352 | pavel.pimenov@gmail.com | 2013-09-11 18:35:47 +0400 (Ср, 11 сен 2013) | 1 line

# fix https://crash-server.com/Problem.aspx?ClientID=ppa&ProblemID=37756
------------------------------------------------------------------------
r15351 | pavel.pimenov@gmail.com | 2013-09-11 18:33:54 +0400 (Ср, 11 сен 2013) | 1 line

# Astyle
------------------------------------------------------------------------
r15350 | pavel.pimenov@gmail.com | 2013-09-11 18:31:56 +0400 (Ср, 11 сен 2013) | 3 lines

# [fly-server] 
  - Добавлен анализ размера файлов базы данных и свободного места на диске где лежит sqlite база.
  - TODO - добавить диагностику для случаев когда мало место на этом диске.
------------------------------------------------------------------------
r15349 | pavel.pimenov@gmail.com | 2013-09-11 06:43:49 +0400 (Ср, 11 сен 2013) | 2 lines

# Исправил dcassert в HubFrame::onCustomDraw
# Рефакторинг менюшек - чтобы случайно не дернуть не созданное ранее динамическое меню.
------------------------------------------------------------------------
r15348 | pavel.pimenov@gmail.com | 2013-09-10 22:54:33 +0400 (Вт, 10 сен 2013) | 6 lines

# Маркер падения https://crash-server.com/Problem.aspx?ClientID=ppa&ProblemID=38000
  очень похоже что client иногда может быть == nullptr :)
* Исправлены падения вида https://crash-server.com/Problem.aspx?ClientID=ppa&ProblemID=22225
  менюшки теперь разрушаются только в деструкторе. причину почему не работет разрушение при деактивации фрейма я не нашел.
  но т.к. они ресурсов не много кушают и жать их будут не на всех хабах то и так сойдет :)
  TODO вместо разрушения менюшки можно зачищать.
------------------------------------------------------------------------
r15347 | tret2003 | 2013-09-10 22:11:01 +0400 (Вт, 10 сен 2013) | 1 line

# Переделал r15226
------------------------------------------------------------------------
r15346 | tret2003 | 2013-09-10 22:04:51 +0400 (Вт, 10 сен 2013) | 1 line

# Заменил "EmoPacks\\" на Util::getEmoPacksPath()
------------------------------------------------------------------------
r15344 | pavel.pimenov@gmail.com | 2013-09-10 19:56:02 +0400 (Вт, 10 сен 2013) | 2 lines

* (Fixed issue 1264) Не работает обновление IP через DHT
  https://code.google.com/p/flylinkdc/issues/detail?id=1264
------------------------------------------------------------------------
r15343 | a.rainman@gmail.com | 2013-09-10 19:37:38 +0400 (Вт, 10 сен 2013) | 3 lines

# Первёл QueueItemList с list на dqueue, тест -   http://www.baptiste-wicht.com/2012/12/cpp-benchmark-vector-list-deque/
# Сборка серой и ежовой:
# [public-build]
------------------------------------------------------------------------
r15342 | a.rainman@gmail.com | 2013-09-10 19:09:35 +0400 (Вт, 10 сен 2013) | 1 line

# +r15335 Перевёл PriorityArray обратно на vector, этот массив вообще очень редко создаётся.
------------------------------------------------------------------------
r15341 | pavel.pimenov@gmail.com | 2013-09-10 18:57:34 +0400 (Вт, 10 сен 2013) | 1 line

# Log
------------------------------------------------------------------------
r15340 | pavel.pimenov@gmail.com | 2013-09-10 18:41:01 +0400 (Вт, 10 сен 2013) | 1 line

* r502-beta116
------------------------------------------------------------------------
r15337 | pavel.pimenov@gmail.com | 2013-09-10 18:28:43 +0400 (Вт, 10 сен 2013) | 2 lines

# Откатил r15324 
  Падение https://crash-server.com/Bug.aspx?ClientID=ppa&ProblemID=27659 остается не разгаданным
------------------------------------------------------------------------
r15336 | a.rainman@gmail.com | 2013-09-10 18:23:07 +0400 (Вт, 10 сен 2013) | 2 lines

# Astyle.
# [public-build]
------------------------------------------------------------------------
r15335 | a.rainman@gmail.com | 2013-09-10 18:22:44 +0400 (Вт, 10 сен 2013) | 3 lines

# +r15333 - забыли блокировки в нескольких местах, при этом в QueueItem::getNextSegmentL блокировали рекурсивно лишний раз.
# Поправил использование list в контейнере для приоритетов ибо там не предсказуемый размер, и никакого резервирования не зовётся.
# Убрал обвёртку над calcAverageSpeedAndCalcAndGetDownloadedBytesL с блокировкой - блокируем сознательно.
------------------------------------------------------------------------
r15334 | a.rainman@gmail.com | 2013-09-10 18:19:13 +0400 (Вт, 10 сен 2013) | 1 line

# +r15324 - в ежовой убрал сомнительный фикс на валидность указателя - не поможет ведь это, даже по стеку видно, что падает после разыименования :(
------------------------------------------------------------------------
r15333 | pavel.pimenov | 2013-09-10 16:18:45 +0400 (Вт, 10 сен 2013) | 9 lines

* (Fixed Issue 1268) Падаем при расчете средней скорости скачивания. 
   http://code.google.com/p/flylinkdc/issues/detail?id=1268
 - Унес функциональность void QueueManager::on(TimerManagerListener::Second
   ниже в метод в calcPriorityAndGetRunningFiles он за один проход расчитывает среднюю скорость и размер скачанного + защищен секцией.
 - Ежику посмотреть на calcAverageSpeedAndDownloadedBytesL и calcAverageSpeedAndDownloadedBytes. возможно в его версии нужно что-то подпилить.
TODO
   Почему-то typedef std::list<QueueItemPtr> QueueItemList; сделали списком.
   vector должен быть быстрее + можно во многих местах делать reserved 
   или там инвалидация где-то мешает?
------------------------------------------------------------------------
r15332 | pavel.pimenov | 2013-09-10 14:24:34 +0400 (Вт, 10 сен 2013) | 6 lines

# Issue 1268: Падаем при расчете средней скорости скачивания. 
 http://code.google.com/p/flylinkdc/issues/detail?id=1268
 - Убрал двойной лок и обход коллеции в 
    q->calcAndUpdateAverageSpeed();
    q->calcAndUpdateDownloadedBytes()
 - TODO причина падения не найдена
------------------------------------------------------------------------
r15331 | pavel.pimenov | 2013-09-10 12:11:22 +0400 (Вт, 10 сен 2013) | 10 lines

* (Fixed issue 1270) 48 падения в QueueFrame::onBrowseList 
  http://code.google.com/p/flylinkdc/issues/detail?id=1270
# Активировал IRAINMAN_NON_COPYABLE_SOURCE_LIST_IN_QUEUE_MANAGER навсегда.
  хотя в некоторых местах там зовется вложенный менеджер QueueManager::getInstance()-> 
  и накладывается избыточная рекурсивная блокировка UniqueLock lqi(QueueItem::cs);
# TODO
 В некоторых местах зовется пара операций без Lock-а в менеджере и сами функции без суффикса L
 QueueManager::getInstance()->setAutoPriority(l_target, false);
 QueueManager::getInstance()->setPriority(l_target, p);

------------------------------------------------------------------------
r15330 | pavel.pimenov@gmail.com | 2013-09-10 06:57:34 +0400 (Вт, 10 сен 2013) | 2 lines

# Отметил проблемные места в LRESULT QueueFrame::onContextMenu
  http://code.google.com/p/flylinkdc/issues/detail?id=1270
------------------------------------------------------------------------
r15329 | pavel.pimenov@gmail.com | 2013-09-10 06:55:18 +0400 (Вт, 10 сен 2013) | 1 line

# Убрал внешний лок
------------------------------------------------------------------------
r15328 | pavel.pimenov@gmail.com | 2013-09-10 06:09:51 +0400 (Вт, 10 сен 2013) | 1 line

# Маркер падения http://code.google.com/p/flylinkdc/issues/detail?id=1270 
------------------------------------------------------------------------
r15324 | pavel.pimenov@gmail.com | 2013-09-10 00:14:14 +0400 (Вт, 10 сен 2013) | 2 lines

# Исправлено падение https://crash-server.com/Bug.aspx?ClientID=ppa&ProblemID=27659
  при выборе команды - переподключить всех отключенных.
------------------------------------------------------------------------
r15323 | pavel.pimenov@gmail.com | 2013-09-10 00:04:53 +0400 (Вт, 10 сен 2013) | 4 lines

# Маркеры проблем beta 115
   http://code.google.com/p/flylinkdc/issues/detail?id=1268
   http://code.google.com/p/flylinkdc/issues/detail?id=1269
   https://crash-server.com/Problem.aspx?ClientID=ppa&ProblemID=37287
------------------------------------------------------------------------
r15313 | pavel.pimenov@gmail.com | 2013-09-09 19:58:10 +0400 (Пн, 09 сен 2013) | 1 line

# [fly-server] Подправлен алгоритм сброса телеметрии из локальной базы на сервер.
------------------------------------------------------------------------
r15312 | pavel.pimenov@gmail.com | 2013-09-09 19:40:39 +0400 (Пн, 09 сен 2013) | 1 line

* r502-beta115
------------------------------------------------------------------------
r15311 | pavel.pimenov@gmail.com | 2013-09-09 19:38:18 +0400 (Пн, 09 сен 2013) | 7 lines

# [fly-server] Доработан алгоритм передачи телеметрии
  - Первая передача выполняется после 2 минут работы приложения (за это время на большинства системах флай выходит на рабочий режим и подгружает все хабы)
  - Добавлена новая локальная БД FlylinkDC_stat.sqlite с таблицей  fly_statistic
    * При завершении делается слепок статистики и синхронно скидывается в локальную базу данных (чтобы быстрее завершиться приложению)
    * При следующем запуске асинхронно вычитывается последние 10 записей телеметрии и скидывается на флай сервер.
    * Если в процессе работы не получается передать данные на сервер. статистика не теряется и сохраняется в FlylinkDC_stat.sqlite

------------------------------------------------------------------------
r15309 | a.rainman@gmail.com | 2013-09-09 15:56:09 +0400 (Пн, 09 сен 2013) | 2 lines

# Issue 1244: временно, до исправления DHT, а может и чуть на дольше (если ещё ошибки найду), выключил IRAINMAN_ENABLE_STRING_INFO_POOL_IN_IDENTITY так же в серой и ежовой.
# [public-build]
------------------------------------------------------------------------
r15308 | a.rainman@gmail.com | 2013-09-09 15:06:04 +0400 (Пн, 09 сен 2013) | 1 line

# Исправление сборки без IRAINMAN_INCLUDE_GDI_OLE.
------------------------------------------------------------------------
r15307 | pavel.pimenov | 2013-09-09 14:21:32 +0400 (Пн, 09 сен 2013) | 2 lines

# Отключаем void MainFrame::UpdateLayout пока стартуют фреймы хабов [public-build]
# Дополнение к фиксу падений на аним-смайлах http://code.google.com/p/flylinkdc/issues/detail?id=1255
------------------------------------------------------------------------
r15306 | pavel.pimenov | 2013-09-09 14:07:13 +0400 (Пн, 09 сен 2013) | 2 lines

* (Fixed issue 1267) Фильтр CDM-отладчика не фильтрует по сохранённым строкам [public-build]

------------------------------------------------------------------------
r15305 | pavel.pimenov | 2013-09-09 13:44:47 +0400 (Пн, 09 сен 2013) | 4 lines

# [public-build]  
  - Контроль кол-ва анимированных смайлов текущее/максимальное
  - Кол-во попыток использования мертвого GDIImage

------------------------------------------------------------------------
r15304 | pavel.pimenov | 2013-09-09 13:19:45 +0400 (Пн, 09 сен 2013) | 3 lines

* (Closed issue 1266) Анимация смайлов зовется даже если их не видно. [merge][public-build]  
   http://code.google.com/p/flylinkdc/issues/detail?id=1266

------------------------------------------------------------------------
r15301 | tret2003 | 2013-09-08 20:28:35 +0400 (Вс, 08 сен 2013) | 1 line

# Поправил выдачу сообщения об ошибке загрузки анимированного смайла, ошибка выдавалась в журнал в случае удачной загрузки.
------------------------------------------------------------------------
r15298 | pavel.pimenov@gmail.com | 2013-09-08 00:36:56 +0400 (Вс, 08 сен 2013) | 1 line

# Astyle
------------------------------------------------------------------------
r15288 | pavel.pimenov@gmail.com | 2013-09-07 14:24:23 +0400 (Сб, 07 сен 2013) | 1 line

# log [public-build]
------------------------------------------------------------------------
r15287 | pavel.pimenov@gmail.com | 2013-09-07 13:50:49 +0400 (Сб, 07 сен 2013) | 1 line

* r502-beta114
------------------------------------------------------------------------
r15286 | pavel.pimenov@gmail.com | 2013-09-07 13:49:49 +0400 (Сб, 07 сен 2013) | 3 lines

* (Closed issue 1261) Отображение уже скачанных файлов в очереди закачек
   http://www.flickr.com/photos/96019675@N02/9689755077/
 TODO - убрать копипаст кода унести его в сервисную функцию
------------------------------------------------------------------------
r15282 | pavel.pimenov@gmail.com | 2013-09-07 12:57:52 +0400 (Сб, 07 сен 2013) | 1 line

# Ругаемся в случае кривого файла автоапдейта
------------------------------------------------------------------------
r15273 | pavel.pimenov@gmail.com | 2013-09-07 00:10:12 +0400 (Сб, 07 сен 2013) | 1 line

# [fly-server] опечатка
------------------------------------------------------------------------
r15270 | pavel.pimenov@gmail.com | 2013-09-06 21:11:40 +0400 (Пт, 06 сен 2013) | 1 line

# Log [public-build]
------------------------------------------------------------------------
r15269 | pavel.pimenov@gmail.com | 2013-09-06 20:49:01 +0400 (Пт, 06 сен 2013) | 4 lines

* Откатил - r15260 from trunk/windows/flattabctrl.h:
 # Рефакторинг в рисователе закладок.
   глючит - разбираться сегодня уже не буду.

------------------------------------------------------------------------
r15263 | pavel.pimenov@gmail.com | 2013-09-06 19:20:27 +0400 (Пт, 06 сен 2013) | 1 line

# Log
------------------------------------------------------------------------
r15262 | pavel.pimenov@gmail.com | 2013-09-06 18:54:55 +0400 (Пт, 06 сен 2013) | 1 line

* r502-beta113
------------------------------------------------------------------------
r15261 | pavel.pimenov@gmail.com | 2013-09-06 18:54:18 +0400 (Пт, 06 сен 2013) | 1 line

# Astyle [public-build]
------------------------------------------------------------------------
r15260 | pavel.pimenov@gmail.com | 2013-09-06 18:53:49 +0400 (Пт, 06 сен 2013) | 1 line

# Рефакторинг в рисователе закладок.
------------------------------------------------------------------------
r15259 | pavel.pimenov@gmail.com | 2013-09-06 18:41:18 +0400 (Пт, 06 сен 2013) | 2 lines

#[fly-server] Вернулся обратно на виндовый таймер т.к. с TimerManagerListener получил зависон
 Ну и Ежик не вспомнил зачем он вернул TimerManagerListener :)
------------------------------------------------------------------------
r15258 | pavel.pimenov@gmail.com | 2013-09-06 18:30:12 +0400 (Пт, 06 сен 2013) | 3 lines

# Вернул смайл :-)
 Изменил кей в конфиге EmoticonsFile на EmoticonsFileFlylinkDC - чтобы включился дефолтный смайл-пак у старых клиентов FlylinkSmilesInternational.xml
 (аналогичное сделал и в r4xx)
------------------------------------------------------------------------
r15257 | a.rainman@gmail.com | 2013-09-06 15:22:34 +0400 (Пт, 06 сен 2013) | 1 line

# +r15239 - не везде поправили namespace.
------------------------------------------------------------------------
r15256 | tret2003 | 2013-09-06 12:32:39 +0400 (Пт, 06 сен 2013) | 2 lines

* (Fixed  issue 1256) Русские названия в фалах.
  http://code.google.com/p/flylinkdc/issues/detail?id=1256
------------------------------------------------------------------------
r15255 | pavel.pimenov | 2013-09-06 10:53:04 +0400 (Пт, 06 сен 2013) | 1 line

# [public-build] Убрал "толстые" методы из *.h файла.
------------------------------------------------------------------------
r15254 | pavel.pimenov | 2013-09-06 10:46:17 +0400 (Пт, 06 сен 2013) | 19 lines

* (Fixed issue 419) Фильтр команд в CMD-отладчике. 
  http://code.google.com/p/flylinkdc/issues/detail?id=419
  - Добавлен фильтрация по IP, включению и исключению подстроки в текст сообщения
  - В void UserConnection::on(BufferedSocketListener::Line и в void UserConnection::send(const string& aString)
    в отладчик передавался IP без порта. поправил на getRemoteIp()
  - Добавлено сохранение значений фильтров и галок в базу данных (не удобно когда они теряются после закрытия окна/программы)
  - В окошко Ip можно вводить 22 символа (даже если оно меньше по размеру - включится скроллер. авторы забыли флаг ES_AUTOHSCROLL
  - В фильтр включения и исключения можно помещать до 100 символов.
  - Регулярные выражения не приделывал (оно наверно не нужно?)
  p.s.
  - Приношу извинения за невнимательность к пользователям
    в истории изменения  файлов CDMDebugFrame.cpp CDMDebugFrame.h с 2010 года 
    правили всякую фигню про С++ не добавляя функционала, который просят :(

  TODO
   - Удалить локализацию 	CDM_WATCHING 
   - CDM_WATCHING_ALL изменилось значение.


------------------------------------------------------------------------
r15253 | pavel.pimenov@gmail.com | 2013-09-06 07:07:34 +0400 (Пт, 06 сен 2013) | 1 line

# Log
------------------------------------------------------------------------
r15252 | pavel.pimenov@gmail.com | 2013-09-06 06:49:08 +0400 (Пт, 06 сен 2013) | 4 lines

# [mediainfo][merge]
+ DCP AssetMap (AM), PackageList (PKL) and CompositionPlaylist (CPL): basic support (update)
+ IMF AssetMap (AM), PackageList (PKL) and CompositionPlaylist (CPL): basic support (update)
x MXF: wrong seek with Audio in clip mode
------------------------------------------------------------------------
r15251 | pavel.pimenov@gmail.com | 2013-09-06 06:47:35 +0400 (Пт, 06 сен 2013) | 1 line

* Исправлено падение https://crash-server.com/DumpGroup.aspx?ClientID=ppa&DumpGroupID=89276
------------------------------------------------------------------------
r15245 | pavel.pimenov@gmail.com | 2013-09-05 22:56:38 +0400 (Чт, 05 сен 2013) | 3 lines

* (fixed issue 1249) Увеличить длину фильтра в отладчике команд
  http://code.google.com/p/flylinkdc/issues/detail?id=1249
  TODO - добавить фильтр не только по IP а по любой подстроке?
------------------------------------------------------------------------
r15244 | pavel.pimenov@gmail.com | 2013-09-05 22:39:39 +0400 (Чт, 05 сен 2013) | 1 line

# Вернул потерянные файлы PeerWeb_*.bmp в автоапдейт
------------------------------------------------------------------------
r15243 | pavel.pimenov@gmail.com | 2013-09-05 22:35:45 +0400 (Чт, 05 сен 2013) | 15 lines

# (issue 1252) Отсутствуют файлы картинок в смайлпаке, ссылки из пакетов на них есть.
  http://code.google.com/p/flylinkdc/issues/detail?id=1252
  - Вернул PeerWeb
PeerWeb/12.bmp
PeerWeb/icon1.bmp
PeerWeb/icon13.bmp
PeerWeb/icon14.bmp
PeerWeb/icon15.bmp
PeerWeb/icon17.bmp
PeerWeb/icon18.bmp
PeerWeb/icon19.bmp
PeerWeb/icon23.bmp
PeerWeb/icon40.bmp
PeerWeb/icon8.bmp
  
------------------------------------------------------------------------
r15242 | pavel.pimenov@gmail.com | 2013-09-05 22:33:31 +0400 (Чт, 05 сен 2013) | 1 line

# Вернул потерянные файлы RadoX_*.bmp в автоапдейт
------------------------------------------------------------------------
r15241 | pavel.pimenov@gmail.com | 2013-09-05 22:22:15 +0400 (Чт, 05 сен 2013) | 20 lines

# (issue 1252) Отсутствуют файлы картинок в смайлпаке, ссылки из пакетов на них есть.
  http://code.google.com/p/flylinkdc/issues/detail?id=1252
  - Вернул картинки из пакета RadoX (не понял кто их удалил. TODO поместить в автоапдейтер
RadoX_001.bmp
RadoX_004.bmp
RadoX_006.bmp
RadoX_008.bmp
RadoX_010.bmp
RadoX_026.bmp
RadoX_027.bmp
RadoX_029.bmp
RadoX_031.bmp
RadoX_032.bmp
RadoX_037.bmp
RadoX_052.bmp
RadoX_054.bmp
RadoX_061.bmp
RadoX_077.bmp
RadoX_113.bmp

------------------------------------------------------------------------
r15240 | pavel.pimenov@gmail.com | 2013-09-05 22:20:10 +0400 (Чт, 05 сен 2013) | 1 line

# Log
------------------------------------------------------------------------
r15239 | pavel.pimenov@gmail.com | 2013-09-05 21:04:02 +0400 (Чт, 05 сен 2013) | 1 line

# Убрал using namespace std; из h файла!
------------------------------------------------------------------------
r15233 | pavel.pimenov@gmail.com | 2013-09-05 18:53:50 +0400 (Чт, 05 сен 2013) | 2 lines

# Thread.h выкинул код не _WIN32
  Данная ветка будет собираться только под виндой - экраны мне мешают комфортно смотреть на код
------------------------------------------------------------------------
r15232 | pavel.pimenov@gmail.com | 2013-09-05 18:50:38 +0400 (Чт, 05 сен 2013) | 5 lines

# [fly-server]
  Начал разбираться как работает флай сервер - чуть сума не сошел от экранов!
   - Выкинул WORKAROUND_FOR_A_BUG_IN_THE_IMPLEMENTATION_RESULTING_IN_ENDLESS_WAITING_IN_A_BACKGROUND_THREAD и FLY_SERVER_USE_SIMPLE_THREAD
p.s.
  Ежика прошу сильно не рефакторить код флай-сервера - есть много других косяков и мест где можно пошалить.
------------------------------------------------------------------------
r15231 | pavel.pimenov@gmail.com | 2013-09-05 18:43:04 +0400 (Чт, 05 сен 2013) | 9 lines

# Когда работает флай сервер - текст на лейбле про облака зеленый.
  TODO - Дима если хочет может накрутить туда свистелок/перделок в виде плавного изменения градиентного цвета :)
# Звали addFlyServerTask даже если ListView пустой.
  TODO 
  - Вспомнить зачем Ежик убрал виндовый onTimer и вернул глючный TimerManagerListener
  Я уже второй раз в этом месте ловлю дед-лок.
  - Перед созданием нитки fly-server-а в обработке onTimer обойти видимый ListView и оценить необходимость вызова
    обход обобщить для обоих классов ListView (поиск и список файлов).

------------------------------------------------------------------------
r15227 | pavel.pimenov | 2013-09-05 14:20:10 +0400 (Чт, 05 сен 2013) | 9 lines

# Исправлен вывод смайлов если их нет (выводится просто текст)
  http://code.google.com/p/flylinkdc/issues/detail?id=1252
# Убран лишний "/" при открытии tth-history.leveldb
  то прилетела диагностика об ошибках при открытии базы
    "LevelDB":"IO error: D:\\Абрикос FlylinkDC++\\Settings\\\\tth-history.leveldb\\MANIFEST-000428: Неверный дескриптор.\r\n"
# TODO - запускать функцию ремонта базы если не открывается со статусом Corruption.
    "LevelDB":"Corruption: 2 missing files; e.g.: C:\\Users\\Admin\\AppData\\Roaming\\FlylinkDC++\\/tth-history.leveldb/000012.sst"
    "LevelDB":"Corruption: CURRENT file does not end with newline"
  
------------------------------------------------------------------------
r15226 | tret2003 | 2013-09-05 08:16:12 +0400 (Чт, 05 сен 2013) | 1 line

# Переосмысление r15181
------------------------------------------------------------------------
r15225 | pavel.pimenov@gmail.com | 2013-09-05 06:59:59 +0400 (Чт, 05 сен 2013) | 4 lines

# Забыл восстановить значение галки отключения списка юзеров.
# Маркеры падения за ночь.
  Падаем иногда при разрушении GDI объектов... пока не понял причину

------------------------------------------------------------------------
r15224 | tret2003 | 2013-09-05 06:26:48 +0400 (Чт, 05 сен 2013) | 1 line

# [lang] an auto commit from localization system...
------------------------------------------------------------------------
r15222 | pavel.pimenov@gmail.com | 2013-09-04 23:48:13 +0400 (Ср, 04 сен 2013) | 1 line

# Log
------------------------------------------------------------------------
r15220 | pavel.pimenov@gmail.com | 2013-09-04 23:14:23 +0400 (Ср, 04 сен 2013) | 1 line

# Фикс с сохранением видимости юзер листов setUserListState (если не активировали окно - то сохраняем буферную переменную)
------------------------------------------------------------------------
r15219 | pavel.pimenov@gmail.com | 2013-09-04 22:56:07 +0400 (Ср, 04 сен 2013) | 2 lines

* r502-beta112
# Astyle [public-build]
------------------------------------------------------------------------
r15218 | pavel.pimenov@gmail.com | 2013-09-04 22:43:34 +0400 (Ср, 04 сен 2013) | 6 lines

* (Started Issue 1252) http://code.google.com/p/flylinkdc/issues/detail?id=1252
  - Отключил загрузку при старте всех смайлов (смайлы подгружаются по мере появления в чате или при активации диалога)
  - Нашел висячие ссылки
  TODO 
  - Возможно что-то отвалилось. кто часто пользуется смайлами пишите замечания в блог или в issue

------------------------------------------------------------------------
r15217 | pavel.pimenov@gmail.com | 2013-09-04 22:39:25 +0400 (Ср, 04 сен 2013) | 5 lines

* (Fixed issue 1255) Попытка исправить падение при переключении смайл-паков
   http://code.google.com/p/flylinkdc/issues/detail?id=1255
  Пока реализовал через отдельный контейнер,
  TODO - подумать и приостанавливать разрушение CGDIImage пока работает onTimer
  отключить фичу можно экраном FLYLINKDC_USE_CHECK_GDIIMAGE_LIVE
------------------------------------------------------------------------
r15216 | pavel.pimenov@gmail.com | 2013-09-04 22:05:08 +0400 (Ср, 04 сен 2013) | 12 lines

* (issue 1242) http://code.google.com/p/flylinkdc/issues/detail?id=1242
Отключив стартовое заполнение ListView-ов сэкономил еще 20 м памяти
+ ускорил запуск. 
Юзера в фоновые хабы добавляются теперь только в контейнер
а в визуальный GUI объект прбрасываются только после первой активации фрейма.

До исправления 472 метра
http://www.flickr.com/photos/96019675@N02/9671616243/
После 449 м
http://www.flickr.com/photos/96019675@N02/9674845888/

Возможно что-то сломалось.
------------------------------------------------------------------------
r15214 | pavel.pimenov@gmail.com | 2013-09-04 21:31:06 +0400 (Ср, 04 сен 2013) | 1 line

# Log
------------------------------------------------------------------------
r15213 | pavel.pimenov@gmail.com | 2013-09-04 21:09:23 +0400 (Ср, 04 сен 2013) | 1 line

# Нашел заначку Димы :)
------------------------------------------------------------------------
r15212 | pavel.pimenov@gmail.com | 2013-09-04 21:08:26 +0400 (Ср, 04 сен 2013) | 2 lines

* r502-beta111
# Astyle [public-build]
------------------------------------------------------------------------
r15211 | pavel.pimenov@gmail.com | 2013-09-04 21:06:23 +0400 (Ср, 04 сен 2013) | 4 lines

# Макркер зависания в void SearchFrame::on(TimerManagerListener::Second
  получилось один раз при открытии файл-листа из окна поиска.
# Маркер падения https://www.crash-server.com/DumpGroup.aspx?ClientID=ppa&Login=Guest&DumpGroupID=85462
  http://www.flickr.com/photos/96019675@N02/9674384618/
------------------------------------------------------------------------
r15210 | tret2003 | 2013-09-04 21:02:51 +0400 (Ср, 04 сен 2013) | 1 line

# Дополнение r15182, правка проекта VS2012
------------------------------------------------------------------------
r15209 | pavel.pimenov@gmail.com | 2013-09-04 20:56:25 +0400 (Ср, 04 сен 2013) | 2 lines

* (Fixed issue 1253) Падение XP SP3 при открытии ченжлога при автоапдейте.
   http://code.google.com/p/flylinkdc/issues/detail?id=1253
------------------------------------------------------------------------
r15208 | tret2003 | 2013-09-04 20:38:48 +0400 (Ср, 04 сен 2013) | 1 line

# +r15155 поправил assert
------------------------------------------------------------------------
r15207 | pavel.pimenov@gmail.com | 2013-09-04 20:16:38 +0400 (Ср, 04 сен 2013) | 2 lines

# Рефакторинг - сократил время жизни или область видимости некоторых переменных
  TODO в SearchFrame массив columns используется начиная с 7 элемента (оптимизнуть при случае или вообще отказаться от массива)
------------------------------------------------------------------------
r15206 | pavel.pimenov@gmail.com | 2013-09-04 19:57:29 +0400 (Ср, 04 сен 2013) | 1 line

# Маркеры падения http://code.google.com/p/flylinkdc/issues/detail?id=1253 
------------------------------------------------------------------------
r15205 | pavel.pimenov@gmail.com | 2013-09-04 19:53:22 +0400 (Ср, 04 сен 2013) | 2 lines

* (issue 1253) Падение XP SP3 при открытии ченжлога при автоапдейте.
  http://code.google.com/p/flylinkdc/issues/detail?id=1253
------------------------------------------------------------------------
r15204 | pavel.pimenov@gmail.com | 2013-09-04 19:44:28 +0400 (Ср, 04 сен 2013) | 1 line

# [fly-server] Регистрируем ошибки с базами данных sqlite и levelDB для последующего анализа наиболее частых проблем.
------------------------------------------------------------------------
r15201 | pavel.pimenov | 2013-09-04 15:53:54 +0400 (Ср, 04 сен 2013) | 6 lines

* Ежик Ускорятор! протри клавиатуру и глаза :) два раза нажал кнопку "!" баге больше года  
  r10320 "Небольшое ускорение проверки сертификатов File::getSize(cert) == -1 -> !File::isExist(cert)"
  TODO 
  - Добавить проверку checkCertificate из AirDC
  - Послать пример опечатки в PVS Studio
  Предлагаю не оптимизировать места, которые не используются и не отлаживаются после изменений.
------------------------------------------------------------------------
r15200 | a.rainman@gmail.com | 2013-09-04 15:15:16 +0400 (Ср, 04 сен 2013) | 1 line

# +r15176 - добавил комментарий.
------------------------------------------------------------------------
r15199 | a.rainman@gmail.com | 2013-09-04 15:12:33 +0400 (Ср, 04 сен 2013) | 1 line

# +r15176 - вернул в ежовой корректное удаление объектов при выключении в дестуркторе RoutingTable. Так же убрал лишние safe_delete.
------------------------------------------------------------------------
r15198 | a.rainman@gmail.com | 2013-09-04 14:41:58 +0400 (Ср, 04 сен 2013) | 1 line

# +15181 - в ежовой убрал сомнительный код при генерации списка локалей в настройках.
------------------------------------------------------------------------
r15197 | a.rainman@gmail.com | 2013-09-04 14:41:40 +0400 (Ср, 04 сен 2013) | 1 line

# +r15190 - убрал лишнюю проверку.
------------------------------------------------------------------------
r15196 | pavel.pimenov@gmail.com | 2013-09-04 07:05:20 +0400 (Ср, 04 сен 2013) | 1 line

# Log
------------------------------------------------------------------------
r15194 | pavel.pimenov@gmail.com | 2013-09-04 03:42:53 +0400 (Ср, 04 сен 2013) | 1 line

# Astyle [public-build]
------------------------------------------------------------------------
r15193 | pavel.pimenov@gmail.com | 2013-09-04 03:38:56 +0400 (Ср, 04 сен 2013) | 4 lines

* Исправлено падение в https://crash-server.com/Problem.aspx?ClientID=ppa&ProblemID=13229
  Не зовем событие STATS пока выполняется инициализаци приложения
  при разрушение поставил проверку в dcassert(!ClientManager::isShutdown());
  таймер уже должен быть отключен
------------------------------------------------------------------------
r15192 | pavel.pimenov@gmail.com | 2013-09-04 03:16:49 +0400 (Ср, 04 сен 2013) | 6 lines

# Убрал tstring m_target; из CFlyTargetInfo
  Подозрительное падение при удалении в LRESULT TransferView::onSpeaker
  https://crash-server.com/DumpGroup.aspx?ClientID=ppa&DumpGroupID=88685
  http://www.flickr.com/photos/96019675@N02/9668951266/


------------------------------------------------------------------------
r15191 | pavel.pimenov@gmail.com | 2013-09-03 22:42:14 +0400 (Вт, 03 сен 2013) | 1 line

# В OMenu::InsertSeparator заменил велик на boost::replace_all(mi->text, _T("&"), Util::emptyStringT)
------------------------------------------------------------------------
r15190 | pavel.pimenov@gmail.com | 2013-09-03 22:28:19 +0400 (Вт, 03 сен 2013) | 3 lines

* Возможно, исправлено падение fix https://crash-server.com/Bug.aspx?ClientID=ppa&ProblemID=36467
# В void OMenu::CheckOwnerDrawn странный код if (mii.fType &= MFT_OWNERDRAW) 
# и if ((*this) != NULL) это что за трандец?
------------------------------------------------------------------------
r15189 | scalolaz_scat@mail.ru | 2013-09-03 20:45:12 +0400 (Вт, 03 сен 2013) | 4 lines

# Дополнение к r15178: 
(сделать так, с права налево, галочка, иконка активного подключения и потом кнопка смены панелей, которая пропадает
...
а то тыкаеш по галочке и она убегает из под курсора)
------------------------------------------------------------------------
r15188 | pavel.pimenov@gmail.com | 2013-09-03 20:36:45 +0400 (Вт, 03 сен 2013) | 1 line

# Log
------------------------------------------------------------------------
r15187 | pavel.pimenov@gmail.com | 2013-09-03 19:25:29 +0400 (Вт, 03 сен 2013) | 1 line

# Astyle [public-build]
------------------------------------------------------------------------
r15186 | pavel.pimenov@gmail.com | 2013-09-03 19:24:56 +0400 (Вт, 03 сен 2013) | 1 line

* r502-beta110
------------------------------------------------------------------------
r15185 | pavel.pimenov@gmail.com | 2013-09-03 19:20:18 +0400 (Вт, 03 сен 2013) | 1 line

# Обобщил флаг bool closed
------------------------------------------------------------------------
r15182 | pavel.pimenov@gmail.com | 2013-09-03 19:05:27 +0400 (Вт, 03 сен 2013) | 4 lines

* (Started issue 1251) В диалоге хеширования отражать факт обработки файла медиаинфой и TTH
# В DB-менеджере запись хеширования идет в отдельной тразакции
  даже если обработка медиаинфы зависнет или упадет - при следующем запуска этот файл не будет обрабатываться.
  
------------------------------------------------------------------------
r15181 | tret2003 | 2013-09-03 12:21:43 +0400 (Вт, 03 сен 2013) | 2 lines

* Не парсим лишний раз файлы локализация для извлечения наименования языка для известных официально поддерживаемых локализаций.
# Убрал из проекта удаленный файл.
------------------------------------------------------------------------
r15180 | a.rainman@gmail.com | 2013-09-03 04:56:51 +0400 (Вт, 03 сен 2013) | 1 line

# log.
------------------------------------------------------------------------
r15179 | scalolaz_scat@mail.ru | 2013-09-02 22:50:13 +0400 (Пн, 02 сен 2013) | 1 line

# Пнул серую [public-build]
------------------------------------------------------------------------
r15178 | scalolaz_scat@mail.ru | 2013-09-02 20:16:38 +0400 (Пн, 02 сен 2013) | 1 line

# Фикс кнопки "Показать список пользователей"
------------------------------------------------------------------------
r15177 | pavel.pimenov@gmail.com | 2013-09-01 07:46:32 +0400 (Вс, 01 сен 2013) | 1 line

# Log
------------------------------------------------------------------------
r15176 | pavel.pimenov@gmail.com | 2013-09-01 07:31:38 +0400 (Вс, 01 сен 2013) | 5 lines

# Откатил фикс в RoutingTable::~RoutingTable
  падаем в этом месте https://www.crash-server.com/DumpGroup.aspx?ClientID=ppa&Login=Guest&DumpGroupID=87734
  пока не понял причину.


------------------------------------------------------------------------
r15175 | pavel.pimenov@gmail.com | 2013-09-01 07:23:42 +0400 (Вс, 01 сен 2013) | 1 line

# Log
------------------------------------------------------------------------
r15174 | tret2003 | 2013-08-31 22:53:28 +0400 (Сб, 31 авг 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1285, created 2013-09-01 01:14:36 +0700
   Total in database:
    - ISP - 1404
    - ISPs logo - 1413
    - Address range - 5978
   Archive CustomLocations.7z created by NightOrion


------------------------------------------------------------------------
r15173 | pavel.pimenov@gmail.com | 2013-08-31 12:06:13 +0400 (Сб, 31 авг 2013) | 2 lines

# Возможно исправлено падение https://www.crash-server.com/DumpGroup.aspx?ClientID=ppa&Login=Guest&DumpGroupID=87207
  BootstrapManager::deleteInstance(); разрушаем раньше чем SearchManager::deleteInstance();
------------------------------------------------------------------------
r15172 | pavel.pimenov@gmail.com | 2013-08-31 11:14:23 +0400 (Сб, 31 авг 2013) | 1 line

# Исправлено падение https://crash-server.com/Problem.aspx?ClientID=ppa&ProblemID=36103
------------------------------------------------------------------------
r15171 | a.rainman@gmail.com | 2013-08-30 21:42:00 +0400 (Пт, 30 авг 2013) | 1 line

# Косметика.
------------------------------------------------------------------------
r15170 | pavel.pimenov@gmail.com | 2013-08-30 21:21:06 +0400 (Пт, 30 авг 2013) | 1 line

# Забыл одну коробку
------------------------------------------------------------------------
r15169 | pavel.pimenov@gmail.com | 2013-08-30 21:18:36 +0400 (Пт, 30 авг 2013) | 2 lines

# Отключил копирование в коробку и ubuntuOne
  теперь все лежит в http://www.fly-server.ru/install/r5xx/src-bin/
------------------------------------------------------------------------
r15168 | a.rainman@gmail.com | 2013-08-30 20:07:45 +0400 (Пт, 30 авг 2013) | 1 line

# +r15164 - вирутальный деструктор лишний там.
------------------------------------------------------------------------
r15167 | a.rainman@gmail.com | 2013-08-30 19:53:25 +0400 (Пт, 30 авг 2013) | 1 line

# log
------------------------------------------------------------------------
r15166 | pavel.pimenov@gmail.com | 2013-08-30 19:53:15 +0400 (Пт, 30 авг 2013) | 1 line

#
------------------------------------------------------------------------
r15165 | pavel.pimenov@gmail.com | 2013-08-30 19:41:25 +0400 (Пт, 30 авг 2013) | 1 line

# Astyle
------------------------------------------------------------------------
r15164 | a.rainman@gmail.com | 2013-08-30 19:15:02 +0400 (Пт, 30 авг 2013) | 6 lines

# +r15160 и r15162 однако ошибок много! Аккуратнее прошу писать!
1) забыли виртуальный дестуктор у базового класса.
2) добавили лишний мембер в наследника.
3) бессмысленно звали parseTarget() в createParent() - ведь файл листы всегда грузятся в один поток, стало быть раз создаём подзапись значит это 100% не файл лист, а false поставился в конструкторе.
4) В TransferView::ItemInfo::update зря звали parseTarget() когда просто могли скопировать уже полученное значение.
Всё поправлено.
------------------------------------------------------------------------
r15163 | tret2003 | 2013-08-30 19:10:09 +0400 (Пт, 30 авг 2013) | 1 line

# [minizip] PVS V809 Verifying that a pointer value is not NULL is not required. The 'if (ptr != NULL)' check can be removed 
------------------------------------------------------------------------
r15162 | pavel.pimenov@gmail.com | 2013-08-30 19:04:04 +0400 (Пт, 30 авг 2013) | 1 line

# TransferView::g_user_icon перевел на HIconWrapper
------------------------------------------------------------------------
r15161 | a.rainman@gmail.com | 2013-08-30 18:47:38 +0400 (Пт, 30 авг 2013) | 1 line

# +r15155 - убрал опасную (безусловную) инициализацию.
------------------------------------------------------------------------
r15160 | pavel.pimenov@gmail.com | 2013-08-30 18:46:11 +0400 (Пт, 30 авг 2013) | 4 lines

# В отрисовке прогресса часто звалась операция определения скачки файл-листов
  ii->getText(COLUMN_PATH).find(Text::toT(Util::getListPath())) != string::npos 
 || ii->getText(COLUMN_PATH).find(Text::toT(Util::getConfigPath())) != string::npos
 Обобщил эту часть через класс CFlyTargetInfo и расчитываю факт файл-листа в момент инициализации
------------------------------------------------------------------------
r15159 | tret2003 | 2013-08-30 18:40:12 +0400 (Пт, 30 авг 2013) | 1 line

# [minizip] Дополнение к15054, правка проекта SV2012
------------------------------------------------------------------------
r15157 | pavel.pimenov@gmail.com | 2013-08-30 18:05:26 +0400 (Пт, 30 авг 2013) | 2 lines

# Маркеры для рефакторинга 
  Двойное обращение к менеджеру - склеить вместе
------------------------------------------------------------------------
r15156 | pavel.pimenov@gmail.com | 2013-08-30 18:01:05 +0400 (Пт, 30 авг 2013) | 1 line

# Не зовем MessagePanel::onEmoticons когда начали разрушаться (иногда падает под _DEBUG)
------------------------------------------------------------------------
r15155 | pavel.pimenov@gmail.com | 2013-08-30 17:58:24 +0400 (Пт, 30 авг 2013) | 2 lines

# CBarShader new [] /delete[] перевел на vector
  TODO может double - сильно жирно для этого класса - хватит и float?
------------------------------------------------------------------------
r15154 | pavel.pimenov@gmail.com | 2013-08-30 17:55:44 +0400 (Пт, 30 авг 2013) | 1 line

# [minizip] Добавил либу для будущей распаковки архива смайлов
------------------------------------------------------------------------
r15152 | pavel.pimenov | 2013-08-30 13:33:36 +0400 (Пт, 30 авг 2013) | 7 lines

# Поправленны пути к gif смайлам
  EmoPacks\SmilesMegaPack\bye.gif и EmoPacks\SmilesMegaPack\rip1.gif смотрели на другую папку и не грузились.
# [merge][AirDC++] К FileFindIter добавлена метод 
 bool FileFindIter::DirData::isLink() const
 {
	return (dwFileAttributes & FILE_ATTRIBUTE_REPARSE_POINT) > 0;
 }
------------------------------------------------------------------------
r15151 | tret2003 | 2013-08-30 09:55:07 +0400 (Пт, 30 авг 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1284, created 2013-08-30 12:52:47 +0700
   Total in database:
    - ISP - 1404
    - ISPs logo - 1413
    - Address range - 5977
   Archive CustomLocations.7z created by NightOrion


------------------------------------------------------------------------
r15150 | tret2003 | 2013-08-30 08:43:44 +0400 (Пт, 30 авг 2013) | 1 line

# [Log]
------------------------------------------------------------------------
r15149 | pavel.pimenov@gmail.com | 2013-08-30 06:16:44 +0400 (Пт, 30 авг 2013) | 1 line

# Пнул ревизию
------------------------------------------------------------------------
r15148 | pavel.pimenov@gmail.com | 2013-08-30 06:01:01 +0400 (Пт, 30 авг 2013) | 1 line

# Log - Серую не выпускать.
------------------------------------------------------------------------
r15147 | pavel.pimenov@gmail.com | 2013-08-30 05:43:00 +0400 (Пт, 30 авг 2013) | 3 lines

* r502-beta109 (Тестовый билд - на публику не выпускать. проверяю, что не сломан автоапдейт)
* SQLite3.8.0.1

------------------------------------------------------------------------
r15145 | a.rainman@gmail.com | 2013-08-30 00:14:23 +0400 (Пт, 30 авг 2013) | 1 line

# Более полное выпиливание FLYLINKDC_USE_CS_CLIENT_SOCKET.
------------------------------------------------------------------------
r15144 | pavel.pimenov@gmail.com | 2013-08-29 23:23:38 +0400 (Чт, 29 авг 2013) | 3 lines

# [Autoupdate][!!!!] Cерую и бетку пока не выпускать без проверки того, что автообновка работает корректно
  Изменения - Если файлы не изменились, то не качаем файл цифровой подписи (экономия трафика)
  TODO - смайлы распространять в виде zip файлов и раскрывать из него на лету.
------------------------------------------------------------------------
r15143 | pavel.pimenov@gmail.com | 2013-08-29 23:16:07 +0400 (Чт, 29 авг 2013) | 1 line

# [Autoupdate] Косметика.
------------------------------------------------------------------------
r15142 | a.rainman@gmail.com | 2013-08-29 22:54:40 +0400 (Чт, 29 авг 2013) | 1 line

# Комментарий о возможной утечке при закрытии.
------------------------------------------------------------------------
r15141 | a.rainman@gmail.com | 2013-08-29 21:48:44 +0400 (Чт, 29 авг 2013) | 2 lines

# Вероятно исправил проблему с падениями в области гуя при завершении приложения. Вероятно теперь будет утекать при закрытии, но это единичный объект и всё равно закрываемся - в общем пока не критично.
# [public-build]
------------------------------------------------------------------------
r15139 | a.rainman@gmail.com | 2013-08-29 20:34:23 +0400 (Чт, 29 авг 2013) | 1 line

# Более строгая типизация для IRAINMAN_NON_COPYABLE_USER_DATA_IN_CLIENT_MANAGER. После удаления мапы с никами падать перестало, но пока остались странности - надо разобраться. Попозже включу её в ежовой, для тестов фича вообще шикарна, да и небольшая экономия по памяти будет.
------------------------------------------------------------------------
r15138 | pavel.pimenov@gmail.com | 2013-08-29 20:34:09 +0400 (Чт, 29 авг 2013) | 15 lines

# issue 1242 http://code.google.com/p/flylinkdc/issues/detail?id=1242
   - Исправлен баг CDC dc(::GetDC(hWnd)); нужно CDCHandle dc(::GetDC(hWnd)); т.к. ~CDC() зовет DeleteDC
   - Убрал ZION_TABS
   - Убрал using namespace Gdiplus; из хедера - опасно.
   - Выкинул созданеи в конструкторе 300 иконок
      HIconWrapper* m_hIcon;
      HIconWrapper* m_hStateIcon;
      теперь они создаются динамически - потетсить частоту и может быть придумать кеширование.
   TODO
    - Убрать копипаст
	TabInfo* t = *i;
	if (row == t->m_row &&
        pt.x >= t->m_xpos &&
        pt.x < t->m_xpos + t->getWidth())
    - long p_icon, long p_stateIcon сократить тип с long (зачем такое длинное число для иконки)
------------------------------------------------------------------------
r15137 | a.rainman@gmail.com | 2013-08-29 20:28:57 +0400 (Чт, 29 авг 2013) | 3 lines

# Возможно исправлены Issue 1245 и Issue 1246 - проверка, возможно был недочёт в BufferedSocket::checkEvents(). Для более полного теста включил ожидание завершения работы сокетов при выключении.
# Тестируем в серой и ежовой, ловим висюки, и падения при закрытии. Бетку пока не собираем!
# [public-build]
------------------------------------------------------------------------
r15136 | pavel.pimenov@gmail.com | 2013-08-29 20:12:39 +0400 (Чт, 29 авг 2013) | 2 lines

# Убрал создание иконки std::unique_ptr<HIconWrapper> m_ShutdownIcon когад она не нужна.
# Astyle
------------------------------------------------------------------------
r15135 | pavel.pimenov@gmail.com | 2013-08-29 18:56:34 +0400 (Чт, 29 авг 2013) | 9 lines

# issue 1242 http://code.google.com/p/flylinkdc/issues/detail?id=1242
  - В закладках в режиме GDI+ создавалась лишняя кисть CPen и никогда не использовалась порождая 150 лишних GDI объектов
   TODO 
   - Если выключить IRAINMAN_USE_GDI_PLUS_TAB вообще не собирается - позже поправить
   - Выкинуть созданеи в конструкторе 300 иконок
      HIconWrapper* m_hIcon;
      HIconWrapper* m_hStateIcon;


------------------------------------------------------------------------
r15133 | pavel.pimenov | 2013-08-29 10:06:10 +0400 (Чт, 29 авг 2013) | 4 lines

# (Closed issue 1247) Не сохраняется положение разделителя между чатом и списком
  http://code.google.com/p/flylinkdc/issues/detail?id=1247
# Исправлено падение при клике правой мышкой по закладке не активированного хаба.
# Зачищаем del /S /F /Q ipch\*.ipch при ребилде
------------------------------------------------------------------------
r15128 | a.rainman@gmail.com | 2013-08-28 21:24:11 +0400 (Ср, 28 авг 2013) | 3 lines

# log.
# [public-build]

------------------------------------------------------------------------
r15127 | pavel.pimenov@gmail.com | 2013-08-28 20:50:34 +0400 (Ср, 28 авг 2013) | 2 lines

* r502-beta108
# Log
------------------------------------------------------------------------
r15126 | pavel.pimenov@gmail.com | 2013-08-28 20:27:53 +0400 (Ср, 28 авг 2013) | 2 lines

# Вернул проверки на разрушение в void ClientManager::putOnline и void ClientManager::putOffline
  когда "умираем" эти методы звать уже не нужно
------------------------------------------------------------------------
r15125 | pavel.pimenov@gmail.com | 2013-08-28 20:17:56 +0400 (Ср, 28 авг 2013) | 10 lines

# issue 1242 http://code.google.com/p/flylinkdc/issues/detail?id=1242
  - Убрал из фрейма хабов меню OMenu tabMenu и OMenu userMenu
    теперь создаю не 150 экземпляров а только два для того фрейма, который активируется.
  - Добавлен метод virtual void onInvalidateAfterActiveTab(HWND aWnd) {}
    для перерисовки активированного фрейма - пока не пашет
    и при переключение закладок мерцает.
  - Обращение к getFavoriteHubEntry делаем так-же динамически по мере активации фрейма а не для всех сразу.

TODO - Убрать мерцание фоновых фреймов при переключении
     - Убрать медленную перерисовку всех 150 говно-закладок 
------------------------------------------------------------------------
r15124 | pavel.pimenov@gmail.com | 2013-08-28 19:34:25 +0400 (Ср, 28 авг 2013) | 1 line

# [fly-server] Возможность сбора статистики на зеркальном сервере (вдруг основной перегрузят)
------------------------------------------------------------------------
r15123 | pavel.pimenov@gmail.com | 2013-08-28 19:06:37 +0400 (Ср, 28 авг 2013) | 1 line

# Косметика.
------------------------------------------------------------------------
r15122 | pavel.pimenov@gmail.com | 2013-08-28 06:41:13 +0400 (Ср, 28 авг 2013) | 3 lines

# Вернул dcassert(!isShutdown()); в ClientManager::putOnline и void ClientManager::putOffline
# Добавлен метод зданмия имени нитке SetThreadName (пока не используется)
# Исправил падение void CFlyUserRatioInfo::flushRatio() возникающее когда клиент зависает при выключении
------------------------------------------------------------------------
r15121 | a.rainman@gmail.com | 2013-08-28 06:36:08 +0400 (Ср, 28 авг 2013) | 3 lines

* В список несовместимого ПО добавлен DTX Toolbar. Причина: https://www.crash-server.com/SearchResult.aspx?ClientID=ppa&Stack=searchresultstb .
# p.s: пока вроде всё.
# [public-build]
------------------------------------------------------------------------
r15120 | a.rainman@gmail.com | 2013-08-28 05:21:09 +0400 (Ср, 28 авг 2013) | 2 lines

* В список несовместимого ПО добавлен browserprotect. Причины: https://www.crash-server.com/SearchResult.aspx?ClientID=ppa&Stack=browserprotect , http://forum.kasperskyclub.ru/index.php?showtopic=40411 , http://virusinfo.info/showthread.php?t=135758 .
# [public-build]
------------------------------------------------------------------------
r15119 | a.rainman@gmail.com | 2013-08-28 03:32:55 +0400 (Ср, 28 авг 2013) | 6 lines

# Технологический коммит.
# При выключении не зовём clearAvailableBytes().
# При выключении забыли оптимизнуть DHT, исправлено.
# Из ClientManager::putOffline убрал лишнюю проверку на isShutdown().
# [public-build]

------------------------------------------------------------------------
r15118 | a.rainman@gmail.com | 2013-08-28 02:59:15 +0400 (Ср, 28 авг 2013) | 6 lines

# Технологический коммит.
# Оптимизация для макроса GET_TEXT - исключаем использование дополнительного буфера.
# Поправлена ошибка для ныне не используемого ClientProfileDlg::updateTag() - писали значение во временную переменную.
# Убрал небольшой кусочек копипасты в InputBox.
# Поправил недочёт в макросе ATTACH_AND_SET_TEXT - необходимо обязательно оборачивать код макроса с несколькими операторами в скобки для корректного условного вызова!
# [public-build]
------------------------------------------------------------------------
r15117 | a.rainman@gmail.com | 2013-08-28 01:53:30 +0400 (Ср, 28 авг 2013) | 3 lines

# Унёс из гуй в ядро вызов SearchManager::disconnect().
# Убрал из гуй дубликатный вызов ConnectionManager::disconnect() ибо он уже зовётся в ядре.
# [public-build]
------------------------------------------------------------------------
r15116 | a.rainman@gmail.com | 2013-08-28 01:34:21 +0400 (Ср, 28 авг 2013) | 2 lines

# +r15113 - поскольку мы теперь корректно ожидаем завершения всех событий TimerManager то в лишних проверках в MainFrame нет необходимости. p.s: g_CountSTATS убрал поскольку он не нужен ибо баг с несколькими ежесекундными тиками уже давно исправлен.
# Оптимизация в PopupManager::AutoRemove - не зовём GET_TICK в цикле, и не получаем значение настройки в цикле.
------------------------------------------------------------------------
r15115 | a.rainman@gmail.com | 2013-08-28 01:30:09 +0400 (Ср, 28 авг 2013) | 1 line

# [!] Откатил r15110-r15111.
------------------------------------------------------------------------
r15114 | pavel.pimenov@gmail.com | 2013-08-27 23:44:19 +0400 (Вт, 27 авг 2013) | 1 line

# Убрал лишнее из VideoPreview
------------------------------------------------------------------------
r15113 | a.rainman@gmail.com | 2013-08-27 22:58:24 +0400 (Вт, 27 авг 2013) | 1 line

# Добавил ожидание завершения работы потока TimerManager. TODO: убрать лишние проверки из рантайма.
------------------------------------------------------------------------
r15112 | pavel.pimenov@gmail.com | 2013-08-27 22:53:11 +0400 (Вт, 27 авг 2013) | 1 line

# fix https://www.crash-server.com/DumpGroup.aspx?ClientID=ppa&Login=Guest&DumpGroupID=86322
------------------------------------------------------------------------
r15111 | pavel.pimenov@gmail.com | 2013-08-27 22:18:20 +0400 (Вт, 27 авг 2013) | 1 line

# Забыл разрешить конфликт
------------------------------------------------------------------------
r15110 | pavel.pimenov@gmail.com | 2013-08-27 22:07:50 +0400 (Вт, 27 авг 2013) | 1 line

# [!]Откатил r15081 + r15079 + r15108- ищу причину зависания
------------------------------------------------------------------------
r15108 | a.rainman@gmail.com | 2013-08-27 21:48:03 +0400 (Вт, 27 авг 2013) | 2 lines

# Ускорил выключение - не ждём завершения работы сокетов.

------------------------------------------------------------------------
r15107 | a.rainman@gmail.com | 2013-08-27 21:19:33 +0400 (Вт, 27 авг 2013) | 2 lines

* В списке публичных интернет хабов исправлена подсветка хабов, находящихся в списках избранных и недавно посещённых: для списков без протокольных префиксов проверки не работали.
# [public-build]
------------------------------------------------------------------------
r15106 | a.rainman@gmail.com | 2013-08-27 21:19:26 +0400 (Вт, 27 авг 2013) | 1 line

# +r15103 - поправлен некорректный (двойной) вызов функций остановки ClientManager.
------------------------------------------------------------------------
r15105 | a.rainman@gmail.com | 2013-08-27 21:19:19 +0400 (Вт, 27 авг 2013) | 1 line

# +r15101 - r15102: Восстановил работу консольного режима для ввода пароля.
------------------------------------------------------------------------
r15104 | pavel.pimenov@gmail.com | 2013-08-27 20:36:28 +0400 (Вт, 27 авг 2013) | 1 line

* r502-beta108 (пока только для теста)
------------------------------------------------------------------------
r15103 | pavel.pimenov@gmail.com | 2013-08-27 20:35:14 +0400 (Вт, 27 авг 2013) | 3 lines

# Ишу причину зависания
  Добавлен метод установки флага начала разрушения ClientManager
  ClientManager::getInstance()->prepare_shutdown();
------------------------------------------------------------------------
r15102 | pavel.pimenov@gmail.com | 2013-08-27 20:30:12 +0400 (Вт, 27 авг 2013) | 2 lines

# Поправка к https://code.google.com/p/flylinkdc/source/detail?r=15101
  Корректная обработка GET_PASSWORD если фрейм не активный.
------------------------------------------------------------------------
r15101 | pavel.pimenov@gmail.com | 2013-08-27 19:02:17 +0400 (Вт, 27 авг 2013) | 10 lines

# Issue 1242 Часть 2 http://code.google.com/p/flylinkdc/issues/detail?id=1242
 - Убрал почти все объекты в динамику 
   TODO 1 Убрать менюшки в динамическое создание
	OMenu tabMenu;
	OMenu userMenu;
   сейчас они создаются для каждого хаба
   TODO 2 обобщить CreateSimpleStatusBar но для этого BaseChatFrame должен быть наследник от MDITabChildWindowImpl
   TODO 3 const FavoriteHubEntry *fhe = FavoriteManager::getInstance()->getFavoriteHubEntry(Text::fromT(server));
   убрать в отложенное в момент активации (один раз)
   TODO 4 Убрать resetMessageCtrl m_ctrlMessage сейчас хранится в двух местах.
------------------------------------------------------------------------
r15100 | a.rainman@gmail.com | 2013-08-27 18:45:01 +0400 (Вт, 27 авг 2013) | 3 lines

# +r15094 включил IRAINMAN_ENABLE_STRING_INFO_POOL_IN_IDENTITY в серой и ежовой ибо без этого как то сложно пофиксить Issue 1244.
# TODO: найти когда и кто похерил фичу IRAINMAN_EXCHANGED_UPNP_ALGORITHM, а главное зачем, ибо фича в случае неудачного проброса, к примеру если порт занят другим приложением, пробовала сменить порт и пробросить ещё раз.
# Уточнил зависимость UPDATE_CON_STATUS_ON_FAV_HUBS_IN_REALTIME от IRAINMAN_USE_NON_RECURSIVE_BEHAVIOR.
------------------------------------------------------------------------
r15099 | pavel.pimenov@gmail.com | 2013-08-27 18:43:03 +0400 (Вт, 27 авг 2013) | 1 line

# Маркер проблемы http://code.google.com/p/flylinkdc/issues/detail?id=1245
------------------------------------------------------------------------
r15094 | pavel.pimenov@gmail.com | 2013-08-27 18:07:01 +0400 (Вт, 27 авг 2013) | 2 lines

# Отключил IRAINMAN_ENABLE_STRING_INFO_POOL_IN_IDENTITY пока не починится баг
  http://code.google.com/p/flylinkdc/issues/detail?id=1244
------------------------------------------------------------------------
r15093 | a.rainman@gmail.com | 2013-08-27 16:08:45 +0400 (Вт, 27 авг 2013) | 1 line

# Косметика в отчёте по пользователю.
------------------------------------------------------------------------
r15092 | a.rainman@gmail.com | 2013-08-27 15:00:04 +0400 (Вт, 27 авг 2013) | 1 line

# log.
------------------------------------------------------------------------
r15091 | a.rainman@gmail.com | 2013-08-27 14:48:52 +0400 (Вт, 27 авг 2013) | 3 lines

# (Started issue 1242) Часть 1 http://code.google.com/p/flylinkdc/issues/detail?id=1242
# Мелкие исправления для r15083.
# [public-build]
------------------------------------------------------------------------
r15090 | pavel.pimenov@gmail.com | 2013-08-26 21:47:27 +0400 (Пн, 26 авг 2013) | 1 line

# Astyle
------------------------------------------------------------------------
r15089 | pavel.pimenov@gmail.com | 2013-08-26 21:46:57 +0400 (Пн, 26 авг 2013) | 1 line

* Упс. fix https://crash-server.com/Bug.aspx?ClientID=ppa&ProblemID=35830
------------------------------------------------------------------------
r15088 | pavel.pimenov@gmail.com | 2013-08-26 21:42:00 +0400 (Пн, 26 авг 2013) | 1 line

# log
------------------------------------------------------------------------
r15086 | pavel.pimenov@gmail.com | 2013-08-26 20:58:26 +0400 (Пн, 26 авг 2013) | 2 lines

* r502-bet107
 - SQLite 3.8.0 http://sqlite.org/releaselog/3_8_0.html
------------------------------------------------------------------------
r15083 | pavel.pimenov@gmail.com | 2013-08-26 20:34:07 +0400 (Пн, 26 авг 2013) | 22 lines

* (Started issue 1242) Часть 1 http://code.google.com/p/flylinkdc/issues/detail?id=1242

Реализован вариант 1 ("Создавать GUI кнопки только когда фрейм становится активным.")
- В заголовок вывел кол-во GDI объектов используемых программой
- Сократил потребление GDI c 9400 до 3100
- Создаются два экземпляра кнопок MessagePanel для фрейма хаба и приватных мессаг
  TODO - оставить один экземпляр
  При активации фрейм - создаем кнопочки, предыдущий удаляем
  TODO - убрать в onBeforeActiveTab цикл обхода всех фреймов а помнить предыдущий
  в переменной.
- Во время запуска фреймов лочим void HubFrame::UpdateLayout через флажек
  BaseChatFrame::g_isStartupProcess
  (на ноуте заметно быстрее запустилось)
- Унести в динамику другие общие GUI объекты BaseChatFrame
  * CStatusBarCtrl m_ctrlStatus
  * CEdit ctrlMessage;
  * CFlyToolTipCtrl m_ctrlLastLines;

- В HIconWrapper создаем объекты с флагом LR_SHARED и не зовем для них DestroyIcon
  (хотя и если позвать тоже работает :)
- Удалил ошметки OnFinalMessage
- TODO в CAnimatedButton::onClose пока в отладке падаем ReleaseDC вертает ошибку т.к. m_hWnd == NULL
------------------------------------------------------------------------
r15081 | a.rainman@gmail.com | 2013-08-26 19:35:32 +0400 (Пн, 26 авг 2013) | 6 lines

# Технологический коммит.
# Добавил функцию preparingCoreToShutdown(), подготавливающую ядро к выключению. В ней в первую очередь останавливаем TimerManager.
# Заменил счётчик в BufferedSocket и IndexManager на простую переменную.
# Дебажные диагностики в DHT сделал явно дебажными.
# [public-build]

------------------------------------------------------------------------
r15079 | a.rainman@gmail.com | 2013-08-26 17:59:00 +0400 (Пн, 26 авг 2013) | 5 lines

# Технологический коммит.
# Исправление для деструктора Identity. Сам ещё потестирую может всё таки локализую проблемное место. Но этот фикс так или иначе нужен для корректного освобождения памяти пулом строк во время работы, да и лок в деструкторе логически не нужен поскольку к этому объекту уже никто не должен обращаться.
# Сократил длину блокировки в StringPool::addString.
# Небольшое ускорение при выключении - сначала выполняем лёгкие shutdown от которых зависят фоновые процессы, а уже потом тормозим ClientManager поскольку это длинная синхронная операция.
# [public-build]
------------------------------------------------------------------------
r15078 | tret2003 | 2013-08-26 11:27:39 +0400 (Пн, 26 авг 2013) | 1 line

# [lang] an auto commit from localization system...
------------------------------------------------------------------------
r15077 | pavel.pimenov | 2013-08-26 10:21:32 +0400 (Пн, 26 авг 2013) | 2 lines

* (fixed issue 1243) Поиск медиаинформации в файлах не содержащих ее (zip и прочее)
  http://code.google.com/p/flylinkdc/issues/detail?id=1243
------------------------------------------------------------------------
r15076 | tret2003 | 2013-08-26 09:39:32 +0400 (Пн, 26 авг 2013) | 1 line

# Дополнение r15048
------------------------------------------------------------------------
r15075 | tret2003 | 2013-08-26 08:40:29 +0400 (Пн, 26 авг 2013) | 1 line

* (To Issue 1243) Ошибка в кодировке сообщения об ошибке.
------------------------------------------------------------------------
r15070 | tret2003 | 2013-08-24 20:05:06 +0400 (Сб, 24 авг 2013) | 1 line

# Дополнение r15048
------------------------------------------------------------------------
r15069 | a.rainman@gmail.com | 2013-08-24 17:18:40 +0400 (Сб, 24 авг 2013) | 2 lines

# (Fixed Issue 1237) В _DEBUG конфигурации падаем в LRESULT HubFrame::onFollow - забыли вызов Util::formatDchubUrl при редиректе.
# [public-build]
------------------------------------------------------------------------
r15068 | pavel.pimenov@gmail.com | 2013-08-23 22:46:25 +0400 (Пт, 23 авг 2013) | 1 line

# Astyle
------------------------------------------------------------------------
r15067 | a.rainman@gmail.com | 2013-08-23 22:24:23 +0400 (Пт, 23 авг 2013) | 1 line

# log.
------------------------------------------------------------------------
r15063 | pavel.pimenov@gmail.com | 2013-08-23 21:57:10 +0400 (Пт, 23 авг 2013) | 2 lines

* del /S /F /Q ipch\*.ipch
# Log
------------------------------------------------------------------------
r15059 | a.rainman@gmail.com | 2013-08-23 21:31:13 +0400 (Пт, 23 авг 2013) | 4 lines

# Технологический коммит.
# Issue 1231: Неверный подсчёт общей шары на хабе - провожу дальнейшую проверку кода: в HubFrame добавил забытую установку флажка needsUpdateStats для события CONNECTED.
# Директивой IRAINMAN_NOT_USE_COUNT_UPDATE_INFO_IN_LIST_VIEW_CTRL вырезал сомнительный функционал, поскольку проблему, описанную в r4612 мне повторить так и не удалось на текущем коде, что в общем то вполне ожидаемо, ибо логика работа с тех пор сильно изменилась.
# Исправление для SCALOLAZ_HUB_MODE - окно должно быть полностью создано перед подпиской на события!
------------------------------------------------------------------------
r15058 | pavel.pimenov@gmail.com | 2013-08-23 21:14:01 +0400 (Пт, 23 авг 2013) | 1 line

* r502-bet106
------------------------------------------------------------------------
r15057 | a.rainman@gmail.com | 2013-08-23 20:39:57 +0400 (Пт, 23 авг 2013) | 1 line

# Issue 1231: Неверный подсчёт общей шары на хабе - убрал генерацию лишнего STATS в окне хаба.
------------------------------------------------------------------------
r15056 | a.rainman@gmail.com | 2013-08-23 20:25:40 +0400 (Пт, 23 авг 2013) | 4 lines

# Issue 1231: Неверный подсчёт общей шары на хабе
# Убрал блокировку при доступе к m_availableBytes поскольку это не помогло, да и не могло помочь поскольку все функции изменения значения вызываются в одном потоке, а точнее в потоке сокета в Client. К тому же прошу обратить внимание вот на какой момент: попробуйте переподключиться к хабу, и в какой то момент объём шары хаба станет равным 0, или какому то другому значению, что не верно, но при этом атомарность данной операции будет соблюдаться благодаря секции.
# p.s: пока провожу эксперимент, и текущий код нельзя считать окончательным.
# [public-build]
------------------------------------------------------------------------
r15055 | tret2003 | 2013-08-23 20:11:38 +0400 (Пт, 23 авг 2013) | 2 lines

# Почистил старый код в formatParams()
* Поправил кодировку при клике на магнет ссылку (неверно передавалось имя).
------------------------------------------------------------------------
r15054 | a.rainman@gmail.com | 2013-08-23 19:25:58 +0400 (Пт, 23 авг 2013) | 2 lines

* Частичный перенос оптимизаций ядра для работы на многоядерных процессорах из ежовой версии в основную, так же осуществлён перенос части оптимизаций в области исключения лишнего копирования данных.
# [public-build]
------------------------------------------------------------------------
r15053 | a.rainman@gmail.com | 2013-08-23 19:01:22 +0400 (Пт, 23 авг 2013) | 2 lines

# +r15045 - поправлены ошибки сборки для x64.
# Косметика.
------------------------------------------------------------------------
r15052 | pavel.pimenov@gmail.com | 2013-08-23 18:57:42 +0400 (Пт, 23 авг 2013) | 1 line

# Astyle
------------------------------------------------------------------------
r15049 | tret2003 | 2013-08-23 18:48:30 +0400 (Пт, 23 авг 2013) | 1 line

# Дополнение r15045 compilation fix
------------------------------------------------------------------------
r15048 | a.rainman@gmail.com | 2013-08-23 18:43:40 +0400 (Пт, 23 авг 2013) | 5 lines

# Технологический коммит.
# Начал унификацию фич IRAINMAN_ENABLE_STRING_INFO_POOL_IN_IDENTITY и PPA_ENABLE_STRING_INFO_DIC_IN_IDENTITY часть 1.
# Фича IRAINMAN_ENABLE_STRING_INFO_POOL_IN_IDENTITY почищена от эксперементальных директив и вынесена в отдельный класс StringPool с ежеминутной уборкой.
# Наконец то обнаружил проблему, приводившую к падениям // [6] https://www.box.com/shared/2ab012dd83f6b41eedbf в деструкторе Identity при закрытии программы. Попробую поправить в ближайщее время.
# [public-build]
------------------------------------------------------------------------
r15046 | pavel.pimenov@gmail.com | 2013-08-23 18:14:16 +0400 (Пт, 23 авг 2013) | 3 lines

# Вернул отображение памяти в заголовке в основной сборке.
  http://code.google.com/p/flylinkdc/source/detail?r=15044
  
------------------------------------------------------------------------
r15045 | pavel.pimenov@gmail.com | 2013-08-23 18:08:40 +0400 (Пт, 23 авг 2013) | 11 lines

* (Started issue 1235) http://code.google.com/p/flylinkdc/issues/detail?id=1235
 Добавлены параметры 
   -  CompatibilityManager::getProcessorsCount()
   -  CompatibilityManager::getOSVersionOrWine()
   -  CFlylinkDBManager::getCountQueueSources()
   -  CompatibilityManager::getTotalPhysMemory()
   -  UPNPStatus
*  Issue 1231: 	Неверный подсчёт общей шары на хабе
   http://code.google.com/p/flylinkdc/issues/detail?id=1231
   getAvailableBytes - зовем раньше, других версий пока нет. 
   
------------------------------------------------------------------------
r15044 | a.rainman@gmail.com | 2013-08-23 17:01:17 +0400 (Пт, 23 авг 2013) | 4 lines

* Отключил отображение информации о потреблении памяти в заголовке для всех версий
# Отключил FLYLINKDC_CALC_MEMORY_USAGE ибо при сборе статистики через FlyServer в отображении этой инфы уже нет никакой необходимости, а без этих данных заголовок проги смотрится гораздо приятнее.
# Issue 1235: Сбор телеметрии и отчетов о динамики работы клиента - поправил константы для GR_GDIOBJECTS_PEAK и GR_USEROBJECTS_PEAK.
# [public-build]
------------------------------------------------------------------------
r15043 | a.rainman@gmail.com | 2013-08-23 15:33:44 +0400 (Пт, 23 авг 2013) | 3 lines

* Исправлено падение при использовании "Файл"->"Сравнить скачанные списки", благодарность за репорт Gap51.
# ListMatcher переведён на BackgroundTaskExecuter для возможности ожидания завершения фонового потока, и исключения проблем при завершении приложения.
# [public-build]
------------------------------------------------------------------------
r15042 | tret2003 | 2013-08-23 12:18:16 +0400 (Пт, 23 авг 2013) | 1 line

# [Log]
------------------------------------------------------------------------
r15041 | tret2003 | 2013-08-23 12:10:07 +0400 (Пт, 23 авг 2013) | 1 line

* Исправлена проблема вывода магнет ссылки в спаме от плееров, когда имя файла не на английском языке. Возможно из-за исправления сломалось что-то ещё, что работает с formatParams(). Исправление доступно пока только в ночных сборках, прошу всесторонне проверить.
------------------------------------------------------------------------
r15040 | scalolaz_scat@mail.ru | 2013-08-23 11:50:40 +0400 (Пт, 23 авг 2013) | 1 line

# Правка шаблонов плееров
------------------------------------------------------------------------
r15039 | pavel.pimenov@gmail.com | 2013-08-23 06:53:10 +0400 (Пт, 23 авг 2013) | 1 line

# [build] Изменил место хранение бинарей,отладочных символов и исходников
------------------------------------------------------------------------
r15038 | a.rainman@gmail.com | 2013-08-22 23:00:34 +0400 (Чт, 22 авг 2013) | 3 lines

# Косметика кода.
# [public-build]

------------------------------------------------------------------------
r15037 | pavel.pimenov@gmail.com | 2013-08-22 22:34:54 +0400 (Чт, 22 авг 2013) | 1 line

# Log
------------------------------------------------------------------------
r15036 | tret2003 | 2013-08-22 22:02:44 +0400 (Чт, 22 авг 2013) | 2 lines

# Поправил экран NIGHTORION_USE_STATISTICS_REQUEST
# Фикс вывода магнетки в чат при спаме от WMP 
------------------------------------------------------------------------
r15035 | pavel.pimenov@gmail.com | 2013-08-22 21:49:30 +0400 (Чт, 22 авг 2013) | 1 line

* r502-beta105
------------------------------------------------------------------------
r15034 | pavel.pimenov@gmail.com | 2013-08-22 21:38:35 +0400 (Чт, 22 авг 2013) | 1 line

# Опечатка.
------------------------------------------------------------------------
r15033 | pavel.pimenov@gmail.com | 2013-08-22 21:37:49 +0400 (Чт, 22 авг 2013) | 2 lines

# TODO Заменить работу с виндовым файерволом на классы их libjingle winfirewall.*
 chromium\home\src_tarball\tarball\chromium\src\third_party\libjingle\source\talk\base
------------------------------------------------------------------------
r15032 | pavel.pimenov@gmail.com | 2013-08-22 21:34:56 +0400 (Чт, 22 авг 2013) | 1 line

# Забытые Detach() приводили к падению в _DEBUG
------------------------------------------------------------------------
r15031 | pavel.pimenov@gmail.com | 2013-08-22 21:32:01 +0400 (Чт, 22 авг 2013) | 6 lines

* (Started issue 1241) Часть 3 [miniupnpc] - Достать имя роутера и скинуть его в лог + собрать статистику
   http://code.google.com/p/flylinkdc/issues/detail?id=1241
   - Добавлен парсинг параметра modelDescription - в нем корректно лежит модель роутера а не просто WAN Device
     http://www.flickr.com/photos/96019675@N02/9569185347/

   
------------------------------------------------------------------------
r15030 | a.rainman@gmail.com | 2013-08-22 21:29:47 +0400 (Чт, 22 авг 2013) | 1 line

# Выключил тестовые диагностики TEST_NEW_FINALIZE_MERKLE_THREE и TEST_NEW_REDUCE_BLOCKS_MERKLE_THREE - новому коду уже несколько месяцев, а проблем так и не возникло, однако двойной расчёт сильно тормозит процесс хеширования в дебаге.
------------------------------------------------------------------------
r15029 | a.rainman@gmail.com | 2013-08-22 21:11:27 +0400 (Чт, 22 авг 2013) | 1 line

# Мелкая оптимизация в NIGHTORION_USE_STATISTICS_REQUEST - проверяем настройки до запуска потока.
------------------------------------------------------------------------
r15028 | a.rainman@gmail.com | 2013-08-22 20:22:15 +0400 (Чт, 22 авг 2013) | 10 lines

* Оптимизировано потребление оперативной памяти программой.
# Технологический коммит.
# (Closed Issue 1238) https://code.google.com/p/flylinkdc/issues/detail?id=1238
# Отключена IRAINMAN_USE_NICKS_IN_CM. Мапу users пока удалять не стал, ибо от неё пользы слишком много, в будущем подумаю, но вряд ли есть смысл от неё избавляться.
# Поправлены ошибки с флажками g_isShutdown.
# Удалил устаревшую функцию ClientManager::getNick.
# Выключил USE_FLYLINKDC_VLD, ибо 3>LINK : fatal error LNK1104: cannot open file 'vld.lib' - TODO: добавить краткий мануал по установке VLD.
# Поправлены допущения в WinUtil::parseDchubUrl, касается вызова Util::formatDchubUrl.
# Добавлена Util::isDcppHub.
# [public-build]
------------------------------------------------------------------------
r15027 | tret2003 | 2013-08-22 18:37:29 +0400 (Чт, 22 авг 2013) | 1 line

# Прописал пути в проекте 2012 для VLD lib
------------------------------------------------------------------------
r15026 | tret2003 | 2013-08-22 17:45:20 +0400 (Чт, 22 авг 2013) | 1 line

# Дополнение к r15024
------------------------------------------------------------------------
r15025 | tret2003 | 2013-08-22 14:32:16 +0400 (Чт, 22 авг 2013) | 1 line

# Поправил кодировку комментариев
------------------------------------------------------------------------
r15024 | tret2003 | 2013-08-22 14:05:30 +0400 (Чт, 22 авг 2013) | 1 line

# Настройка для отправки статистики
------------------------------------------------------------------------
r15023 | pavel.pimenov@gmail.com | 2013-08-22 06:31:21 +0400 (Чт, 22 авг 2013) | 3 lines

* (Started issue 1241) Часть 2 http://code.google.com/p/flylinkdc/issues/detail?id=1241
   Если включен режим UPNP сохраняем для статистики имя роутера
   TODO на моем NetGear 3500 имя пока не определяется корректно и возвращает просто "WAN Device"
------------------------------------------------------------------------
r15022 | pavel.pimenov@gmail.com | 2013-08-21 22:12:39 +0400 (Ср, 21 авг 2013) | 3 lines

* (Started issue 1241) Часть 1 [miniupnpc] - Достать имя роутера и скинуть его в лог + собрать статистику
   http://code.google.com/p/flylinkdc/issues/detail?id=1241
   Добавил вывод в лог результата проброса портов и название роутера
------------------------------------------------------------------------
r15020 | pavel.pimenov@gmail.com | 2013-08-21 19:36:01 +0400 (Ср, 21 авг 2013) | 1 line

# Astyle + Лог + Убрал лишние include
------------------------------------------------------------------------
r15019 | pavel.pimenov@gmail.com | 2013-08-21 19:29:59 +0400 (Ср, 21 авг 2013) | 41 lines

* (Started issue 1235) Расширен сбор параметров работы флайлинка
Контролируем
 - Кол-ва файлов, хабов, время старта/останова ядра и гуя, расход дескрипторов и т.д.
Передача идет при старте, раз в час 
TODO - сделать передачу при завершении (если клиент проработал больее часа)

Пример пакета 
{
 "CID":"UA5QNTVOCMMC2RXEUV7WCBNBBXWSL2ISIFTJSCA",
 "Client":"FlylinkDC++ r502-beta88 build 12084",
 "Handle":
 {
  "GDI":"416",
  "GDIPeak":"795",
  "Handle":"383",
  "UserObj":"179",
  "UserObjPeak":"182"
 },
 "ID":"24",
 "Memory":
 {
  "PeakWorkingSetSize":"38223872",
  "WorkingSetSize":"38182912"
 },
 "Stat":
 {
  "Files":"0",
  "Hubs":"0",
  "Size":"6372248134",
  "Users":"2"
 },
 "Time":
 {
  "Current":"2013-08-21 17:09:11",
  "PrevShutdownCORE":"624",
  "PrevShutdownGUI":"1186",
  "Start":"2013-08-21 17:09:11",
  "StartCore":"5648",
  "StartGUI":"1201"
 } 
}
------------------------------------------------------------------------
r15018 | pavel.pimenov@gmail.com | 2013-08-21 19:12:07 +0400 (Ср, 21 авг 2013) | 2 lines

# Закрыл вызов updateNick_internal после начала закрытия клиента. раньше продолжали идти мессаги из ::on(Line
  TODO - кривовато, посмотреть позже как сделать лучше
------------------------------------------------------------------------
r15017 | tret2003 | 2013-08-21 18:52:21 +0400 (Ср, 21 авг 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1283, created 2013-08-21 16:06:30 +0700
   Total in database:
    - ISP - 1404
    - ISPs logo - 1413
    - Address range - 5976
   Archive CustomLocations.7z created by NightOrion


------------------------------------------------------------------------
r15016 | pavel.pimenov | 2013-08-21 14:24:10 +0400 (Ср, 21 авг 2013) | 2 lines

* (Fixed issue 1231) Возможно исправил неверный подсчёт общей шары на хабе.

------------------------------------------------------------------------
r15015 | a.rainman@gmail.com | 2013-08-21 12:07:46 +0400 (Ср, 21 авг 2013) | 1 line

# Добавлена Text::normalizeStringEnding для ChatCtrl.
------------------------------------------------------------------------
r15014 | pavel.pimenov | 2013-08-21 11:47:38 +0400 (Ср, 21 авг 2013) | 1 line

* (Closed issue 1126) Несколько окон хеширования после попытки закрытия
------------------------------------------------------------------------
r15013 | a.rainman@gmail.com | 2013-08-21 11:35:38 +0400 (Ср, 21 авг 2013) | 1 line

# +r14999: ответ на вопрос про InitializeCriticalSectionAndSpinCount и исправление поломки в ClientManager::updateNick_internal - нельзя добавлять в контейнер ссылку на внешний объект.
------------------------------------------------------------------------
r15012 | pavel.pimenov@gmail.com | 2013-08-21 05:23:11 +0400 (Ср, 21 авг 2013) | 5 lines

# Astyle
 TODO
  - Протестировать отложенное создание MessagePanel m_msgPanel (в момент активации фрейма)
    ускорит загрузку при большом кол-ве хабов на слабых нетбуках
  - Вывод личек делать в том-же фрейме в виде дополнительного окна со сплиттером (исключит создание дополнительных окон про спам и рекламу хабов при старте)
------------------------------------------------------------------------
r15010 | pavel.pimenov@gmail.com | 2013-08-21 04:47:21 +0400 (Ср, 21 авг 2013) | 1 line

# [setup] http://flylinkdc.no-ip.org:8888/app/flylinkdc-factory/flylinkdc.html Заменил на ->  http://www.fly-server.ru/install/custom
------------------------------------------------------------------------
r15003 | pavel.pimenov@gmail.com | 2013-08-20 20:27:38 +0400 (Вт, 20 авг 2013) | 1 line

# Исправлен плохой баг в isEqualsSubstringIgnoreCase - в дереве шары не отображались рекурсивные галки (Спасибо NightOrion)
------------------------------------------------------------------------
r14999 | pavel.pimenov@gmail.com | 2013-08-20 19:41:22 +0400 (Вт, 20 авг 2013) | 3 lines

# В Дебаге отключил __PROFILER_ENABLED__
# В void ClientManager::updateNick_internal убрал непонятный финт с IRAINMAN_NON_COPYABLE_USER_DATA_IN_CLIENT_MANAGER

------------------------------------------------------------------------
r14997 | tret2003 | 2013-08-20 11:20:18 +0400 (Вт, 20 авг 2013) | 1 line

# [lang] an auto commit from localization system...
------------------------------------------------------------------------
r14996 | a.rainman@gmail.com | 2013-08-20 00:05:25 +0400 (Вт, 20 авг 2013) | 4 lines

# Issue 1238 [Рефакторинг] Убрать пожирание памяти картой ников и тормоза в void ClientManager::updateNick_internal
# Добавил директиву IRAINMAN_USE_NICKS_IN_CM дабы можно было провести сравнительный тест потребления ресурсов. На публику с выключенной IRAINMAN_USE_NICKS_IN_CM просьба НЕ ВЫПУСКАТЬ даже в серой, ибо ломается часть функционала. К примеру http://code.google.com/p/flylinkdc/issues/detail?id=100 а так же вообще открытие файл листа у юзера по ссылке на хаб! До кучи ClientManager::findLegacyUser используется в SearchManager, но я пока не понял как это работает. Ну и ещё будет куча косметических эффектов - как только юзер уйдёт в оффлайн, то его ник во многих местах сразу же перестанет отображаться.
# В общем коллекция всё же нужна, сравнительный анализ со стронгом пока не проводил, но скорее всего в стронге ошибка, и там не везде где необходимо запоминают ник.
# p.s: Ники для ADC юзеров в nicks не сохраняются, и над этим надо тоже подумать, но при этом не сломать их корректную привязку по хабам.
------------------------------------------------------------------------
r14995 | a.rainman@gmail.com | 2013-08-19 22:57:55 +0400 (Пн, 19 авг 2013) | 3 lines

# Issue 1236 [crash-server] Падение клиента при активной закачке каталога LostFilm ~3.6Tb)
# Почистил код.
# [public-build]
------------------------------------------------------------------------
r14993 | pavel.pimenov@gmail.com | 2013-08-19 22:28:21 +0400 (Пн, 19 авг 2013) | 32 lines

# Маркер тормозов в void ClientManager::updateNick_internal - мапа g_nicks заполняется всеми никами на хабе
  TODO - Найти когда сломали или зачем это делается.

у флая при подключении к allavtovo.ru в коллекцию влетает все 14 тыс записей

!!!!!!!!!!!!!!!!!!!!!!!!!!!! ClientManager::updateNick_internal count = 14907 nicks.size() = 223 nick = [Depo2]Sergey
!!!!!!!!!!!!!!!!!!!!!!!!!!!! ClientManager::updateNick_internal count = 14908 nicks.size() = 224 nick = ICSamsom
!!!!!!!!!!!!!!!!!!!!!!!!!!!! ClientManager::updateNick_internal count = 14909 nicks.size() = 225 nick = newbie2233
!!!!!!!!!!!!!!!!!!!!!!!!!!!! ClientManager::updateNick_internal count = 14910 nicks.size() = 225 nick = (BBB)Rhiozd
!!!!!!!!!!!!!!!!!!!!!!!!!!!! ClientManager::updateNick_internal count = 14911 nicks.size() = 226 nick = giufgiufglfd
!!!!!!!!!!!!!!!!!!!!!!!!!!!! ClientManager::updateNick_internal count = 14912 nicks.size() = 227 nick = User821081_
!!!!!!!!!!!!!!!!!!!!!!!!!!!! ClientManager::updateNick_internal count = 14913 nicks.size() = 228 nick = С‡СЏС‡СЏ121321412
!!!!!!!!!!!!!!!!!!!!!!!!!!!! ClientManager::updateNick_internal count = 14914 nicks.size() = 229 nick = Ratis9998
!!!!!!!!!!!!!!!!!!!!!!!!!!!! ClientManager::updateNick_internal count = 14915 nicks.size() = 230 nick = jaxx_on
!!!!!!!!!!!!!!!!!!!!!!!!!!!! ClientManager::updateNick_internal count = 14916 nicks.size() = 231 nick = archersigma
!!!!!!!!!!!!!!!!!!!!!!!!!!!! ClientManager::updateNick_internal count = 14917 nicks.size() = 232 nick = Jony3000
!!!!!!!!!!!!!!!!!!!!!!!!!!!! ClientManager::updateNick_internal count = 14918 nicks.size() = 233 nick = kiri@na
!!!!!!!!!!!!!!!!!!!!!!!!!!!! ClientManager::updateNick_internal count = 14919 nicks.size() = 234 nick = РІРёС‚Р°Р»РёР№РјРёС…РµРµРІ
!!!!!!!!!!!!!!!!!!!!!!!!!!!! ClientManager::updateNick_internal count = 14920 nicks.size() = 235 nick = [HUN]kljdarerjk

При этом в аналогичном методе StrongDC++ sqlite 
при открытии аналогичного хаба - всего 15 вызовов.
!!!!!!!!!!!!!!!!!!!!!!!!!!!! ClientManager::updateNick count = 9 nicks.size() = 7 nick = OpChat
!!!!!!!!!!!!!!!!!!!!!!!!!!!! ClientManager::updateNick count = 10 nicks.size() = 8 nick = РџРћР›РћР–РС‚РµР»СЊРЅС‹Р№
!!!!!!!!!!!!!!!!!!!!!!!!!!!! ClientManager::updateNick count = 11 nicks.size() = 9 nick = LiMoNaDa
!!!!!!!!!!!!!!!!!!!!!!!!!!!! ClientManager::updateNick count = 12 nicks.size() = 10 nick = #Р“РѕР»РѕСЃРѕРІР°РЅРёСЏ РЅР° AllAvtovo.ru#
!!!!!!!!!!!!!!!!!!!!!!!!!!!! ClientManager::updateNick count = 13 nicks.size() = 11 nick = Terminator
!!!!!!!!!!!!!!!!!!!!!!!!!!!! ClientManager::updateNick count = 14 nicks.size() = 12 nick = MaxFox
NmdcHub::onLine Unknown command $BotList #Голосования на AllAvtovo.ru#$$OpChat$$Terminator$$Testovii$$
!!!!!!!!!!!!!!!!!!!!!!!!!!!! ClientManager::updateNick count = 15 nicks.size() = 13 nick = ffddded


------------------------------------------------------------------------
r14992 | a.rainman@gmail.com | 2013-08-19 21:51:39 +0400 (Пн, 19 авг 2013) | 1 line

# r14991 - мелкая оптимизация в ежеминутном событии менеджера очереди.
------------------------------------------------------------------------
r14991 | a.rainman@gmail.com | 2013-08-19 21:22:06 +0400 (Пн, 19 авг 2013) | 4 lines

# Issue 1236 [crash-server] Падение клиента при активной закачке каталога LostFilm ~3.6Tb)
# Исправил ошибку, допущенные в результате исправления бага: в QueueManager::FileQueue::findPFSSourcesL не разобравшись удалили блокировку - на обычную версию это, пока, не влияет, так что её пересобирать не надо, а вот в ежовой это вызвало бы проблемы.
# p.s: то, как в данный момент пофикшена Issue 1236 мне видится не правильным, скорее всего проблема в другом, а если точнее то связана проблема с перепилом Identity.
# [public-build]
------------------------------------------------------------------------
r14990 | a.rainman@gmail.com | 2013-08-19 21:21:56 +0400 (Пн, 19 авг 2013) | 23 lines

# [test]
# Перемерил с нормальными механизмами измерения FastAlloc, получил ожидаемые результаты:
Instruction number = 21 // удаление через delete.
Hole time = 0.372379
Call count = 5000000
Average time = 7.44758e-008
===============================================
Instruction number = 2 // выделение через new.
Hole time = 0.617497
Call count = 5000000
Average time = 1.23499e-007
===============================================
Instruction number = 11 // удаление через FastAlloc
Hole time = 0.243647
Call count = 5000000
Average time = 4.87295e-008
===============================================
Instruction number = 1 // выделение через FastAlloc
Hole time = 0.417308
Call count = 5000000
Average time = 8.34616e-008
===============================================
p.s: тест на самом деле всё ещё не совсем честный, ибо для совсем честного тестирования надо исключить оптимизации выделения памяти менеджером ОС, т.е. для данного теста выделения и удаления памяти должны происходить параллельно в двух потоках, а то сейчас получается, что первый алгоритм выделяет память, а для второго она уже зарезервирована системой :) но дальше тестировать мне сие уже ленно, ибо своё любопытство я полностью удовлетворил. В общем, как я и говорил ранее: FastAlloc хороший аллокатор для специфических задач, но надо понимать как он работает, ибо это не замена менеджера памяти.
------------------------------------------------------------------------
r14989 | pavel.pimenov@gmail.com | 2013-08-19 20:51:09 +0400 (Пн, 19 авг 2013) | 2 lines

# Убрал dcassert в setLastNick - для DHT он пустой
  TODO усложнить проверку чтобы dcassert ругался только когда не DHT?
------------------------------------------------------------------------
r14987 | pavel.pimenov@gmail.com | 2013-08-19 20:48:07 +0400 (Пн, 19 авг 2013) | 2 lines

* [merge] Устранены 2 утечки в CryptoManager.  (Спасибо reg)
  https://bitbucket.org/3F/flightsdc/commits/220b9ce93f3332087492ec3747f86ef29fe88118
------------------------------------------------------------------------
r14986 | pavel.pimenov@gmail.com | 2013-08-19 20:15:53 +0400 (Пн, 19 авг 2013) | 1 line

# r502-beta104
------------------------------------------------------------------------
r14985 | pavel.pimenov@gmail.com | 2013-08-19 20:14:44 +0400 (Пн, 19 авг 2013) | 2 lines

# В void QueueManager::FileQueue::findPFSSourcesL оставил старый вариант заполнения массива и последующее ее сравнение
# Маркер падения в LRESULT HubFrame::onFollow http://code.google.com/p/flylinkdc/issues/detail?id=1237
------------------------------------------------------------------------
r14984 | pavel.pimenov@gmail.com | 2013-08-19 19:53:12 +0400 (Пн, 19 авг 2013) | 3 lines

# В void QueueManager::FileQueue::findPFSSourcesL не делаем лишний вызов sl.reserve
  раньше всегда заказывали 10 элементов

------------------------------------------------------------------------
r14983 | pavel.pimenov@gmail.com | 2013-08-19 19:40:59 +0400 (Пн, 19 авг 2013) | 4 lines

* (Closed issue 1236)  Шаг-3 http://code.google.com/p/flylinkdc/issues/detail?id=1236
  Убрал копипаст в коде void QueueManager::FileQueue::findPFSSourcesL
  http://www.flickr.com/photos/96019675@N02/9548194802/
  TODO - Причесать место до конца - сделав SourceListBuffer отдельным классом c методом заполнения плохих и хорошиш источников.
------------------------------------------------------------------------
r14982 | pavel.pimenov@gmail.com | 2013-08-19 19:20:47 +0400 (Пн, 19 авг 2013) | 3 lines

# issue 1236  Шаг-2 http://code.google.com/p/flylinkdc/issues/detail?id=1236
  Исправлено падение в void QueueManager::on(TimerManagerListener::Minute
  Защищаем секцией весь цикл формирования массива PartsInfoReqParam
------------------------------------------------------------------------
r14981 | pavel.pimenov@gmail.com | 2013-08-19 19:02:31 +0400 (Пн, 19 авг 2013) | 3 lines

# issue 1236  Шаг-1 http://code.google.com/p/flylinkdc/issues/detail?id=1236
  Функция void QueueItem::getPartialInfoL имеет суффикс L при этом содержит внутри лишний SharedLock l(cs) 
  TODO - Может Ежику в своем SharedLock придумать в дебаге диагностику когда лочат рекурсивно
------------------------------------------------------------------------
r14980 | a.rainman@gmail.com | 2013-08-16 21:22:07 +0400 (Пт, 16 авг 2013) | 4 lines

# [test]
# В первом приближении добавил измерение времени, проведённого тестируемым кодом в режиме ядра и в пользовательском режиме, это пригодится для алгоритмических тестов.
# Код базируется на GetThreadTimes и его можно включить директивой USE_THREAD_TIMES_FOR_PERF_CHECK
# Пока код отключён, поскольку я не уверен, что его использование вообще имеет смысл поскольку разрешение у GetThreadTimes значительно ниже чем у QueryPerformanceCounter, да и необходимо допилить раздельный вывод ядерного и пользовательского режимов.
------------------------------------------------------------------------
r14979 | a.rainman@gmail.com | 2013-08-16 20:33:56 +0400 (Пт, 16 авг 2013) | 1 line

# [test] увеличил количество циклов выполнения теста в релизе со 100 млн. итераций до MAX_INT, что составляет ~4.3 млрд. итераций для 32х битной платформы. Всё таки это тест и его время выполнения не так критично, ибо гораздо важнее точность полученных результатов.
------------------------------------------------------------------------
r14975 | pavel.pimenov@gmail.com | 2013-08-16 20:04:55 +0400 (Пт, 16 авг 2013) | 1 line

# [setup] Удаляем ID региональной сборки в Software\FlylinkDC++\VID при ее деинсталляции
------------------------------------------------------------------------
r14974 | a.rainman@gmail.com | 2013-08-16 19:40:20 +0400 (Пт, 16 авг 2013) | 1 line

# [test] закрепляем выполнение теста на опредлённом процессоре функцией SetThreadAffinityMask.
------------------------------------------------------------------------
r14973 | a.rainman@gmail.com | 2013-08-16 18:24:09 +0400 (Пт, 16 авг 2013) | 6 lines

# Исправления для самодельного Флаевского профайлера, часть1:
# Добавлен консольный лог
# Упрощена декларация тестов
# Исправлены кривые измерения в начале тестирования из-за отсуствия вывода процессора из режимов оптимизирующих потребление энергии.
# Запрещена оптимизация компилятором тестового цикла.
# Настройки проекта установлены в максимальную оптимизацию.
------------------------------------------------------------------------
r14972 | pavel.pimenov@gmail.com | 2013-08-16 15:26:54 +0400 (Пт, 16 авг 2013) | 38 lines

# [tests] Тест критических секци (typedef boost::lock_guard<boost::detail::spinlock> BoostFastLock; - почему-то не заработал - 4 тест пока пустой без лока)
Делаем 100 000 000 итераций вида

  {
    XXXLock l(l_fcs);
    l_count++;
  }

Где XXXLock - разные типы секций

D:\vc10\r5xx\test\Release>test-console.exe
400000000
Instruction number = 4
Hole time = 1.78872       <============= Без блокировки
Call count = 100000000
Average time = 1.78872e-008
===============================================
Instruction number = 3
Hole time = 4.39481       <============= boost::lock_guard<boost::recursive_mutex> BoostLock;
Call count = 100000000
Average time = 4.39481e-008
===============================================
Instruction number = 2
Hole time = 3.51735       <============= FastLock
Call count = 100000000
Average time = 3.51735e-008
===============================================
Instruction number = 1
Hole time = 3.24233       <============= Lock с простой критической секцией от винды
Call count = 100000000
Average time = 3.24233e-008
===============================================

Отрытые вопросы 
1. почему FastLock тормознее CriticalSection ? Велосипед Ежика не удался?
2. почему вешается  boost::lock_guard<boost::detail::spinlock> BoostFastLock ?

TODO проверить оригинальный FastCriticalSection из DC++
------------------------------------------------------------------------
r14970 | pavel.pimenov@gmail.com | 2013-08-16 09:48:28 +0400 (Пт, 16 авг 2013) | 1 line

# [test]
------------------------------------------------------------------------
r14965 | pavel.pimenov@gmail.com | 2013-08-15 23:09:10 +0400 (Чт, 15 авг 2013) | 1 line

# Log
------------------------------------------------------------------------
r14964 | pavel.pimenov@gmail.com | 2013-08-15 22:38:39 +0400 (Чт, 15 авг 2013) | 9 lines

# Исправлен баг в функции isTTHShared
* mediainfo
 x Side car files: better support of demux/decoding, N19 part
 x Side car files: better support of demux/decoding, N19 part
 x Side car files: better support of demux/decoding, SCC part
 x Side car files: better support of demux/decoding, SubRip part, update
 x Side car files: better support of demux/decoding, SubRip part


------------------------------------------------------------------------
r14961 | tret2003 | 2013-08-15 22:23:05 +0400 (Чт, 15 авг 2013) | 1 line

# Отключил вывод сообщения о сборе статистики, юзер народ шугливый и беспощадный.
------------------------------------------------------------------------
r14960 | tret2003 | 2013-08-15 21:51:01 +0400 (Чт, 15 авг 2013) | 1 line

# [lang] an auto commit from localization system...
------------------------------------------------------------------------
r14959 | tret2003 | 2013-08-15 21:49:37 +0400 (Чт, 15 авг 2013) | 1 line

# Поправил вывод текста сообщения о сборе статистики
------------------------------------------------------------------------
r14958 | pavel.pimenov@gmail.com | 2013-08-15 21:30:14 +0400 (Чт, 15 авг 2013) | 1 line

# [setup] Убрал лишние ""
------------------------------------------------------------------------
r14957 | pavel.pimenov@gmail.com | 2013-08-15 21:27:34 +0400 (Чт, 15 авг 2013) | 1 line

# Откат удаления хаба
------------------------------------------------------------------------
r14956 | pavel.pimenov@gmail.com | 2013-08-15 21:23:32 +0400 (Чт, 15 авг 2013) | 1 line

# [setup] Неверно удален vip_free_harkov_volia_maxnet
------------------------------------------------------------------------
r14955 | pavel.pimenov@gmail.com | 2013-08-15 21:11:20 +0400 (Чт, 15 авг 2013) | 1 line

# Log
------------------------------------------------------------------------
r14954 | pavel.pimenov@gmail.com | 2013-08-15 20:39:50 +0400 (Чт, 15 авг 2013) | 1 line

* r502-beta103
------------------------------------------------------------------------
r14953 | pavel.pimenov@gmail.com | 2013-08-15 20:29:58 +0400 (Чт, 15 авг 2013) | 5 lines

* (Closed issue 1230) При просмотре листов других пользователей перестали подкрашиваться файлы, которые есть у меня в шаре (Спасибо S.Artyukhov)
   сломал когда чинил падение при закрытии программы пока файл-лист парсится :(
   https://code.google.com/p/flylinkdc/issues/detail?id=1230

  
------------------------------------------------------------------------
r14952 | pavel.pimenov@gmail.com | 2013-08-15 19:29:37 +0400 (Чт, 15 авг 2013) | 2 lines

# Фикс падения при снятии галки с шары
  http://www.flickr.com/photos/96019675@N02/9515345001/
------------------------------------------------------------------------
r14951 | a.rainman@gmail.com | 2013-08-15 18:49:09 +0400 (Чт, 15 авг 2013) | 6 lines

* Включил назад фичу опционального отображения флага страны в окне хаба.
# Технологический коммиит.
# Директиву IRAINMAN_USE_MEMORY_CACHED_CUSTOM_NETWORK_INDEX выключил во всех конфигурациях, тест завершён. Как и обещал, включу назад везде после переделки фичи на кеш для БД.
# В ежовой временно выключил IRAINMAN_USE_CUSTOM_LOCATION_VALIDATOR , включу назад после доделки кеша, ибо функционал валидатора пока сильно от него зависит.
# Удалил тестовую директиву IRAINMAN_NOT_USE_DB_FOR_IP_NETWORK, жаль, что из тестеров мне так никто и не отписался, больше никаких публичных тестов на промежуточном коде проводить не буду, ибо только время потерял.
# [public-build]
------------------------------------------------------------------------
r14950 | tret2003 | 2013-08-15 18:30:00 +0400 (Чт, 15 авг 2013) | 1 line

# [lang] an auto commit from localization system...
------------------------------------------------------------------------
r14949 | tret2003 | 2013-08-15 18:29:46 +0400 (Чт, 15 авг 2013) | 1 line

* Добавил информирование о сборе анонимной статистики.
------------------------------------------------------------------------
r14948 | a.rainman@gmail.com | 2013-08-15 17:47:38 +0400 (Чт, 15 авг 2013) | 6 lines

# issue 1235 Сбор телеметрии и отчетов о динамики работы клиента
   http://code.google.com/p/flylinkdc/issues/detail?id=1235
# Почистил код
# Перевёл отправку данных на расписание раз в час, и директивой FLYLINKDC_USE_GATHER_STATISTICS_PLANER убрал планирование, поскольку пока оно не нужно.
# Защитник из StatisticSender убрал ибо он защищает только запуск потока, и не следит за выполнением т.е. ничего не делает по сути. Корректно защищаемся внутри CFlyServerAdapter::CFlyServerJSON::pushStatistic().
# [public-build]
------------------------------------------------------------------------
r14947 | pavel.pimenov@gmail.com | 2013-08-15 17:00:57 +0400 (Чт, 15 авг 2013) | 3 lines

* (Started issue 1235) Сбор телеметрии и отчетов о динамики работы клиента
   http://code.google.com/p/flylinkdc/issues/detail?id=1235
# transferView.prepareClose(); в галвной форме вызвал выше чтобы раньше отписаться при завершении приложения.
------------------------------------------------------------------------
r14946 | a.rainman@gmail.com | 2013-08-15 16:39:42 +0400 (Чт, 15 авг 2013) | 16 lines

* (Fixed Issue 1227) Не работает автоматический поиск альтернативных источников https://code.google.com/p/flylinkdc/issues/detail?id=1227 .
# Сломали в r14553
Было: 
if (qi->getSize() == sr->getSize() && !qi->isSourceL(sr->getUser()))
Стало:
if (qi->getSize() == sr->getSize())
{
	bool l_is_source = false;
	{
		UniqueLock l(QueueItem::cs);
		l_is_source = qi->isSourceL(sr->getUser());
	}
	if (l_is_source)

Вдвоём проглядели :(
# [public-build]
------------------------------------------------------------------------
r14945 | pavel.pimenov@gmail.com | 2013-08-15 16:23:18 +0400 (Чт, 15 авг 2013) | 2 lines

# Astyle 
# CFlySafeGuard сделал шаблонным
------------------------------------------------------------------------
r14944 | a.rainman@gmail.com | 2013-08-15 15:39:51 +0400 (Чт, 15 авг 2013) | 3 lines

# Issue 1234 Доработать разбор тега для NMDC протокола.
# Мелкая оптимизация в доп. к r14938: сначала выполняем все compare, а уже потом начинаем использовать find, так же перенёс проверки нестандартных тегов в хвост свитча.
# Добавил сборку нераспознанного в отладке.
------------------------------------------------------------------------
r14943 | pavel.pimenov@gmail.com | 2013-08-15 11:03:15 +0400 (Чт, 15 авг 2013) | 1 line

# Дополнение к r14922 в CFlyServerJSON::postQuery к версии дописываем HE в виде суффикса для детекта обращения Ежик-версии к медиасерверу
------------------------------------------------------------------------
r14942 | pavel.pimenov@gmail.com | 2013-08-15 10:29:24 +0400 (Чт, 15 авг 2013) | 3 lines

# [fly-server] 
  - Залогировал ошибку при вызове InternetSetOption
  - в CInternetHandle не зовем ::InternetCloseHandle(m_hInternet) для "плохого" дескриптора
------------------------------------------------------------------------
r14941 | pavel.pimenov@gmail.com | 2013-08-15 05:22:37 +0400 (Чт, 15 авг 2013) | 2 lines

# Поправка к r14939. rep = 0 зря убрал (она юзается как параметр)
# [PVS-Studio] в dcassert убрал одноразовый цикл
------------------------------------------------------------------------
r14939 | pavel.pimenov@gmail.com | 2013-08-15 04:51:52 +0400 (Чт, 15 авг 2013) | 3 lines

# [PVS-Studio] V814 Decreased performance. The 'wcslen' function was called multiple times inside the body of a loop. chatctrl.cpp 235
  TODO - Спросить в чем бонус этого лямбда-велика, а после заменить его на сервисный метод в Text, или заменить на boost::replace_all
  
------------------------------------------------------------------------
r14938 | a.rainman@gmail.com | 2013-08-14 23:46:26 +0400 (Ср, 14 авг 2013) | 2 lines

* (Started Issue 1234) Доработать разбор тега для NMDC протокола.
# [public-build]
------------------------------------------------------------------------
r14937 | a.rainman@gmail.com | 2013-08-14 23:19:51 +0400 (Ср, 14 авг 2013) | 1 line

# TODO: Issue 659.
------------------------------------------------------------------------
r14936 | pavel.pimenov@gmail.com | 2013-08-14 23:14:14 +0400 (Ср, 14 авг 2013) | 1 line

# Убрал #define _CRTDBG_MAP_ALLOC - используем VLD (http://vld.codeplex.com)
------------------------------------------------------------------------
r14935 | a.rainman@gmail.com | 2013-08-14 22:06:21 +0400 (Ср, 14 авг 2013) | 1 line

# Поправка отображения известных SU, в AdcSupports::KnownSupports инитили флаг SEGA_FEATURE_BIT 0. Баг косметический, ибо переменная флаг используется только в отчёте по юзеру.
------------------------------------------------------------------------
r14934 | scalolaz_scat@mail.ru | 2013-08-14 20:16:49 +0400 (Ср, 14 авг 2013) | 2 lines

* ( Fixed Issue 1228 ): Не работает поиск текста из чата в Google
https://code.google.com/p/flylinkdc/issues/detail?id=1228
------------------------------------------------------------------------
r14933 | a.rainman@gmail.com | 2013-08-14 15:46:41 +0400 (Ср, 14 авг 2013) | 10 lines

* Частичный перенос оптимизаций из ежовой версии в основную ветку:
  + По возможности снижены нагрузки на систему за счёт использования спинлоков вместо полноценных критических секций с рекурсией.
  + В первом приближении начато включение элементов для перевода ядра в режим работы, оптимизированный под многопроцессорные системы.
# TODO: фичу с трассированием дедлоков необходимо доработать для поддержки спинлоков - т.е. добавить диагностику рекурсивного входа. Однако существует проблема, которую не понятно как решать: диагностировать SharedSpinLock с помощью обычный крит секций будет сложно, и придётся лепить адовую конструкцию из двух крит секций :)
# Поправлены зависимости включения, фичи: IRAINMAN_NON_COPYABLE_USER_QUEUE_ON_USER_CONNECTED_OR_DISCONECTED,
IRAINMAN_NON_COPYABLE_SOURCE_LIST_IN_QUEUE_MANAGER,
IRAINMAN_NON_COPYABLE_CLIENTS_IN_CLIENT_MANAGER
зависят от IRAINMAN_USE_RECURSIVE_SHARED_CRITICAL_SECTION.
# Через пару дней перетащу оптимизации зависящие от IRAINMAN_USE_SHARED_SPIN_LOCK. Пока тестируем в серой не начнёт ли виснуть где.
# [public-build]
------------------------------------------------------------------------
r14932 | a.rainman@gmail.com | 2013-08-14 15:27:12 +0400 (Ср, 14 авг 2013) | 1 line

# Исправлены элементы синхронизации для RSSManager.
------------------------------------------------------------------------
r14931 | a.rainman@gmail.com | 2013-08-14 12:48:31 +0400 (Ср, 14 авг 2013) | 1 line

# +r14917 ещё немного почистил строки локализаций.
------------------------------------------------------------------------
r14930 | a.rainman@gmail.com | 2013-08-14 12:31:32 +0400 (Ср, 14 авг 2013) | 7 lines

# Технологический коммит.
# Добавлена директива со звучным названием WORKAROUND_FOR_A_BUG_IN_THE_IMPLEMENTATION_RESULTING_IN_ENDLESS_WAITING_IN_A_BACKGROUND_THREAD , предназначенная для закостыливания бага.
# Директивой FLY_SERVER_USE_SIMPLE_THREAD переключил CFlyServerQueryThread с использования BackgroundTaskExecuter на Thread. TODO: после исправления WORKAROUND_FOR_A_BUG_IN_THE_IMPLEMENTATION_RESULTING_IN_ENDLESS_WAITING_IN_A_BACKGROUND_THREAD функционал FLY_SERVER_USE_SIMPLE_THREAD тоже надо удалить.
# Пара мелких оптимизаций:
 - вернул ручную очистку очереди запросов через clear() ибо лишние действия с move не нужны для локальных объектов. TODO: вероятно надо убрать мемберы, тоже сделав их локальными, поскольку они используются только в одной функции.
 - заменил CriticalSection на простую переменную и Thread::ConditionLockerWithSpin.
# [public-build]
------------------------------------------------------------------------
r14927 | tret2003 | 2013-08-14 09:42:24 +0400 (Ср, 14 авг 2013) | 1 line

# Опечатка от r14926
------------------------------------------------------------------------
r14926 | tret2003 | 2013-08-14 08:34:18 +0400 (Ср, 14 авг 2013) | 1 line

# Дополнение по рекомендации r14895
------------------------------------------------------------------------
r14922 | a.rainman@gmail.com | 2013-08-13 23:25:20 +0400 (Вт, 13 авг 2013) | 1 line

# Issue 804 Выпуск официальной ежовой версии (с ограниченным функционалом и оптимизацией в сторону высоких нагрузок).
------------------------------------------------------------------------
r14921 | pavel.pimenov@gmail.com | 2013-08-13 22:51:08 +0400 (Вт, 13 авг 2013) | 13 lines

* [minupnp] miniupnpc-1.8.20130801 http://miniupnp.free.fr/files/

2013/08/01:
  define MAXHOSTNAMELEN if not already done

2013/06/06:
  update upnpreplyparse to allow larger values (128 chars instead of 64)

2013/05/14:
  Update upnpreplyparse to take into account "empty" elements
  validate upnpreplyparse.c code with "make check"

TODO - проверить что ничего не отвалилось
------------------------------------------------------------------------
r14920 | tret2003 | 2013-08-13 22:47:25 +0400 (Вт, 13 авг 2013) | 1 line

# Очепятки фиск
------------------------------------------------------------------------
r14917 | a.rainman@gmail.com | 2013-08-13 20:45:24 +0400 (Вт, 13 авг 2013) | 4 lines

# Технологический коммит.
# Почистил функционал копирования инфы о юзере в окне хаба.
# Подготовка к реализации Issue 659 Пункт "копировать" в меню лс.
# Необходимо обновление локализаций.
------------------------------------------------------------------------
r14916 | a.rainman@gmail.com | 2013-08-13 16:49:24 +0400 (Вт, 13 авг 2013) | 2 lines

# log.
# [public-build]
------------------------------------------------------------------------
r14915 | a.rainman@gmail.com | 2013-08-13 16:34:05 +0400 (Вт, 13 авг 2013) | 11 lines

* Доброго времени суток! Опытных пользователей прошу провести тест на потребление ресурсов программой. Для проведения теста необходимо создать две одинаковые конфигурации (одни и те же хабы, одна и та же шара), для одной конфигурации использовать серую версию, а для другой ежовую - https://code.google.com/p/flylinkdc/issues/detail?id=804 , разумеется обе конфигурации должны работать параллельно на одной и той же машине. Необходимо сравнить:
  - скорость запуска,
  - скорость открытия больших хабов,
  - потребление памяти сразу после загрузки программы,
  - потребление памяти после суток работы, или более длительного периода.

Для честного проведения теста временно отключена фича отображающая флаг страны в окне чата, не волнуйтесь, скоро переработаю данную фичу, и включу назад уже для всех фреймов, да и работать она будет шустрее. Жаль, что от автора фичи я этого так и не дождался :(
С уважением, Ёж.

# Для проведения теста добавлена директива IRAINMAN_NOT_USE_DB_FOR_IP_NETWORK, полностью выключающая функционал сохранения в БД данных баз CustomLocation и GeoIP.
# p.s: сейчас заполню лог, и залью его, на нём же запущу публичный билд.
------------------------------------------------------------------------
r14914 | a.rainman@gmail.com | 2013-08-13 14:52:46 +0400 (Вт, 13 авг 2013) | 5 lines

# Технологический коммит.
# Поправлена ошибка в парсере кустомлока - сначала искали в строке, а потом её тримили, мелкая оптимизация там же за счёт выкидывания лишнего обрезания строки.
# Вернул директивами IRAINMAN_USE_MEMORY_CACHED_CUSTOM_NETWORK_INDEX и IRAINMAN_USE_CUSTOM_LOCATION_VALIDATOR возможность проверки файла CustomLocation - фичи выключены, чуть попозже перепилю фичу с хранением данных в памяти на режим кеша для БД
# Упаковку CustomNetworkIndex пока включить не удалось из-за наличия внутри строки.
# Исправил предупреждения компилятора в Util::GetTextResource.
------------------------------------------------------------------------
r14913 | a.rainman@gmail.com | 2013-08-13 14:21:34 +0400 (Вт, 13 авг 2013) | 1 line

# Почистил Identity от останков переходного кода.
------------------------------------------------------------------------
r14912 | a.rainman@gmail.com | 2013-08-12 20:07:05 +0400 (Пн, 12 авг 2013) | 1 line

# Небольшая оптимизация в отрисовке флагов стран в окне хаба. TODO Диме: зачистить данный код, и навести там порядок. Хватит уже делать прототип, и сваливать от проблемы. Если всё же дальше прототипа не получается, то прошу хотя бы ограничивать внесённый код экраном. В общем, господа, пожалуйста пишите чистый, хороший код, доделывать его кроме вас - некому.
------------------------------------------------------------------------
r14908 | tret2003 | 2013-08-12 13:52:43 +0400 (Пн, 12 авг 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1281, created 2013-08-12 16:12:11 +0700
   Total in database:
    - ISP - 1404
    - ISPs logo - 1413
    - Address range - 5972
   Archive CustomLocations.7z created by NightOrion


------------------------------------------------------------------------
r14907 | a.rainman@gmail.com | 2013-08-12 13:26:47 +0400 (Пн, 12 авг 2013) | 1 line

# AStyle.
------------------------------------------------------------------------
r14906 | a.rainman@gmail.com | 2013-08-12 13:25:57 +0400 (Пн, 12 авг 2013) | 3 lines

# Переработал и включил фичу PPA_ENABLE_STRING_INFO_DIC_IN_IDENTITY
# Подготовка к созданию специального класса в виде объединённого пула строк на базе фич PPA_ENABLE_STRING_INFO_DIC_IN_IDENTITY и IRAINMAN_ENABLE_STRING_INFO_POOLING
# [public-build]
------------------------------------------------------------------------
r14905 | tret2003 | 2013-08-12 01:48:50 +0400 (Пн, 12 авг 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1279, created 2013-08-12 03:59:59 +0700
   Total in database:
    - ISP - 1404
    - ISPs logo - 1413
    - Address range - 5971
   Archive CustomLocations.7z created by NightOrion


------------------------------------------------------------------------
r14904 | a.rainman@gmail.com | 2013-08-12 00:39:46 +0400 (Пн, 12 авг 2013) | 2 lines

* Восстановил, не понятно в какой момент похеренный, функционал обновления IP при старте.
# [public-build]
------------------------------------------------------------------------
r14903 | tret2003 | 2013-08-11 22:48:34 +0400 (Вс, 11 авг 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1278, created 2013-08-12 01:32:06 +0700
   Total in database:
    - ISP - 1405
    - ISPs logo - 1414
    - Address range - 5971
   Archive CustomLocations.7z created by NightOrion


------------------------------------------------------------------------
r14902 | tret2003 | 2013-08-11 21:54:09 +0400 (Вс, 11 авг 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1276, created 2013-08-12 00:28:51 +0700
   Total in database:
    - ISP - 1404
    - ISPs logo - 1413
    - Address range - 5969
   Archive CustomLocations.7z created by NightOrion


------------------------------------------------------------------------
r14901 | tret2003 | 2013-08-10 20:15:20 +0400 (Сб, 10 авг 2013) | 1 line

# Убираем меню по пкм с заголовков таблицы поиск-шпиона
------------------------------------------------------------------------
r14900 | tret2003 | 2013-08-10 19:55:33 +0400 (Сб, 10 авг 2013) | 1 line

# [lang] an auto commit from localization system...
------------------------------------------------------------------------
r14899 | tret2003 | 2013-08-10 17:23:43 +0400 (Сб, 10 авг 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1275, created 2013-08-10 19:34:08 +0700
   Total in database:
    - ISP - 1404
    - ISPs logo - 1413
    - Address range - 5969
   Archive CustomLocations.7z created by NightOrion


------------------------------------------------------------------------
r14898 | tret2003 | 2013-08-09 23:23:24 +0400 (Пт, 09 авг 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1273, created 2013-08-10 01:53:04 +0700
   Total in database:
    - ISP - 1405
    - ISPs logo - 1414
    - Address range - 5970
   Archive CustomLocations.7z created by NightOrion


------------------------------------------------------------------------
r14897 | tret2003 | 2013-08-09 20:41:34 +0400 (Пт, 09 авг 2013) | 3 lines

* (Closed  issue 1136) Большая часть предустановленных для провайдера Воля (явно локальных)хабов - не работает
https://code.google.com/p/flylinkdc/issues/detail?id=1136

------------------------------------------------------------------------
r14896 | tret2003 | 2013-08-09 08:04:09 +0400 (Пт, 09 авг 2013) | 1 line

# Дополнение r14895
------------------------------------------------------------------------
r14895 | tret2003 | 2013-08-09 06:59:10 +0400 (Пт, 09 авг 2013) | 2 lines

# Убрал класс FlyListViewCtrl, в нём добавлялся только один метод перекрашивания, который есть в ExListViewCtrl, на него и заменил.
# Заменил GetItemText на ExGetItemText. Получение элемента таблицы стало проще.
------------------------------------------------------------------------
r14894 | tret2003 | 2013-08-08 23:23:09 +0400 (Чт, 08 авг 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1271, created 2013-08-09 01:44:59 +0700
   Total in database:
    - ISP - 1399
    - ISPs logo - 1408
    - Address range - 5953
   Archive CustomLocations.7z created by NightOrion


------------------------------------------------------------------------
r14893 | tret2003 | 2013-08-07 20:22:58 +0400 (Ср, 07 авг 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1270, created 2013-08-07 22:07:39 +0700
   Total in database:
    - ISP - 1399
    - ISPs logo - 1408
    - Address range - 5947
   Archive CustomLocations.7z created by NightOrion


------------------------------------------------------------------------
r14890 | tret2003 | 2013-08-07 18:52:39 +0400 (Ср, 07 авг 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1269, created 2013-08-07 21:28:13 +0700
   Total in database:
    - ISP - 1399
    - ISPs logo - 1408
    - Address range - 5947
   Archive CustomLocations.7z created by NightOrion


------------------------------------------------------------------------
r14889 | scalolaz_scat@mail.ru | 2013-08-07 13:53:06 +0400 (Ср, 07 авг 2013) | 1 line

# к r14882 : Выбор цвета хабов в Настройки Цвета
------------------------------------------------------------------------
r14887 | tret2003 | 2013-08-06 21:52:40 +0400 (Вт, 06 авг 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1268, created 2013-08-07 00:38:17 +0700
   Total in database:
    - ISP - 1398
    - ISPs logo - 1407
    - Address range - 5946
   Archive CustomLocations.7z created by NightOrion


------------------------------------------------------------------------
r14886 | tret2003 | 2013-08-06 13:11:38 +0400 (Вт, 06 авг 2013) | 1 line

# [lang] an auto commit from localization system...
------------------------------------------------------------------------
r14885 | scalolaz_scat@mail.ru | 2013-08-06 12:48:26 +0400 (Вт, 06 авг 2013) | 2 lines

# к r14882, r14884 : копипастная подЦветка хабов для "Недавних хабов"
# [public-build]
------------------------------------------------------------------------
r14884 | scalolaz_scat@mail.ru | 2013-08-06 12:40:03 +0400 (Вт, 06 авг 2013) | 1 line

# к r14882 : Запрещаем контекстное меню для хабов на заголовках колонок
------------------------------------------------------------------------
r14883 | tret2003 | 2013-08-06 09:11:42 +0400 (Вт, 06 авг 2013) | 1 line

# Добавил файлы в проект VS2012
------------------------------------------------------------------------
r14882 | scalolaz_scat@mail.ru | 2013-08-06 02:33:58 +0400 (Вт, 06 авг 2013) | 12 lines

* ( Closed Issue 258 ) : В окне "Интернет хабы" подсвечивать хабы, присутствующие в "Списке избранных хабов"
https://code.google.com/p/flylinkdc/issues/detail?id=258

На данный момент используются цвета:
Имеющийся хаб : цвет "Список файлов - Уже расшарено"
Автоподключение хаба: цвет "Список файлов - Уже качал..."

+ На имеющихся в "Избранном" хабах отключаем пункт "Добавить в Избранное" и включаем пункт "Удалить хаб из Избранных"

#(Если требуются персональные цвета для Публичных хабов - создайте Issue)
#(Если подобная подЦветка требуется окну "Недавние хабы" - создайте Issue)
# ТоДо: при добавлении хабов добавить Ник и Пароль из Настроек программы.
------------------------------------------------------------------------
r14881 | tret2003 | 2013-08-05 22:20:41 +0400 (Пн, 05 авг 2013) | 3 lines

* (Closed  issue 1183) в архиве с бинарниками лишняя папка common
https://code.google.com/p/flylinkdc/issues/detail?id=210
# Убрал неиспользуемый больше файл
------------------------------------------------------------------------
r14880 | a.rainman@gmail.com | 2013-08-05 20:04:01 +0400 (Пн, 05 авг 2013) | 2 lines

# Поправил ошибку в диагностике.
# [public-build]
------------------------------------------------------------------------
r14879 | a.rainman@gmail.com | 2013-08-05 19:51:28 +0400 (Пн, 05 авг 2013) | 2 lines

# AStyle.
# [public-build]
------------------------------------------------------------------------
r14878 | a.rainman@gmail.com | 2013-08-05 19:51:22 +0400 (Пн, 05 авг 2013) | 1 line

# Поправил ошибку в диагностике.
------------------------------------------------------------------------
r14877 | a.rainman@gmail.com | 2013-08-05 19:34:55 +0400 (Пн, 05 авг 2013) | 3 lines

# Почистил элементы синхронизации для CFlyServerAdapter.
# Локализовал косяк с криво работающим функционалом - проблема где то в коде который общается с сервером, думал ранее что причина зависаний была в кривом механизме ожидания завершения фоновых процессов, ан нет, она как была где то в глубине с самого начала, так там и осталась. Пока сделал так что бы гарантированно не повисло.
# [public-build]
------------------------------------------------------------------------
r14876 | a.rainman@gmail.com | 2013-08-05 19:27:35 +0400 (Пн, 05 авг 2013) | 1 line

# Небольшие исправления в SearchFrame.
------------------------------------------------------------------------
r14875 | a.rainman@gmail.com | 2013-08-05 18:10:34 +0400 (Пн, 05 авг 2013) | 2 lines

# Более менее зачистил код для работы с FlyServer.
# Поправил ошибки с инициализацией в SearchFrame.
------------------------------------------------------------------------
r14874 | a.rainman@gmail.com | 2013-08-05 15:09:14 +0400 (Пн, 05 авг 2013) | 1 line

# Почистил очередь событий в HubFrame.
------------------------------------------------------------------------
r14873 | a.rainman@gmail.com | 2013-08-04 20:06:19 +0400 (Вс, 04 авг 2013) | 2 lines

# (Fixed Issue 1161) пункт 4, остальное done.
# Большая просьба при обновлении локалей не переносить, и не дописывать того чего нет в английской версии.
------------------------------------------------------------------------
r14872 | scalolaz_scat@mail.ru | 2013-08-04 11:10:17 +0400 (Вс, 04 авг 2013) | 3 lines

# [About] : заготовка странички "История Версий"
- страница пока отключена, т.к. код получения Лога изменений не написан.
(ТоДо: Issue 1220)
------------------------------------------------------------------------
r14871 | scalolaz_scat@mail.ru | 2013-08-04 09:56:40 +0400 (Вс, 04 авг 2013) | 2 lines

# Дополнение к r14861: my first enum
# [public-build]
------------------------------------------------------------------------
r14870 | scalolaz_scat@mail.ru | 2013-08-04 09:54:17 +0400 (Вс, 04 авг 2013) | 2 lines

* (Closed Issue 671) : 	Наведение порядка в меню настроек
https://code.google.com/p/flylinkdc/issues/detail?id=671
------------------------------------------------------------------------
r14865 | a.rainman@gmail.com | 2013-08-02 20:28:24 +0400 (Пт, 02 авг 2013) | 3 lines

* r502-beta102
# [public-build]

------------------------------------------------------------------------
r14864 | a.rainman@gmail.com | 2013-08-02 18:40:02 +0400 (Пт, 02 авг 2013) | 1 line

# log.
------------------------------------------------------------------------
r14863 | pavel.pimenov@gmail.com | 2013-08-02 18:38:51 +0400 (Пт, 02 авг 2013) | 1 line

# Astyle
------------------------------------------------------------------------
r14861 | scalolaz_scat@mail.ru | 2013-08-02 12:42:27 +0400 (Пт, 02 авг 2013) | 4 lines

* (Closed Issue 276) : 	В диалоге "О программе" ссылки "Домашняя страница" и "Обсуждения новых версий" одинаковые.
https://code.google.com/p/flylinkdc/issues/detail?id=276
* (Started Issue 1215) : [memory leak] Утекает ресурс в окне О Программе
https://code.google.com/p/flylinkdc/issues/detail?id=1215
------------------------------------------------------------------------
r14858 | pavel.pimenov | 2013-08-02 08:51:14 +0400 (Пт, 02 авг 2013) | 3 lines

# Рефакторинг для коммита http://code.google.com/p/flylinkdc/source/detail?r=14844
  Добавлен метод Text::isEqualsSubstringIgnoreCase с диагностикой параметров для исключения лишнего создание временного объекта string при обходах каталогов шары.

------------------------------------------------------------------------
r14857 | a.rainman@gmail.com | 2013-08-02 03:24:44 +0400 (Пт, 02 авг 2013) | 1 line

# log.
------------------------------------------------------------------------
r14856 | a.rainman@gmail.com | 2013-08-02 02:59:37 +0400 (Пт, 02 авг 2013) | 2 lines

# +r14854 - не собиралось :(
# [public-build]
------------------------------------------------------------------------
r14855 | a.rainman@gmail.com | 2013-08-02 01:43:40 +0400 (Пт, 02 авг 2013) | 3 lines

# AStyle.
# [public-build]

------------------------------------------------------------------------
r14854 | tret2003 | 2013-08-01 23:17:04 +0400 (Чт, 01 авг 2013) | 2 lines

* (Closed  issue 1186) Локализация: Файл=>Convert TTH history SQLite -> LevelDB
https://code.google.com/p/flylinkdc/issues/detail?id=1186
------------------------------------------------------------------------
r14853 | a.rainman@gmail.com | 2013-08-01 22:14:39 +0400 (Чт, 01 авг 2013) | 1 line

# +r14852 постпроход по флажкам - косметика.
------------------------------------------------------------------------
r14852 | a.rainman@gmail.com | 2013-08-01 21:54:42 +0400 (Чт, 01 авг 2013) | 6 lines

# Дальнейшие улучшения отчёта по пользователю.
# Впилил назад известные функции клиентов.
# Зачистил код.
# TODO мне: чуть упаковать биты в Identity, ибо есть свободные места, а из словарика и пула для строк сделать один мощный класс, который будет вносить минимальные накладные расходы.
# p.s: AStyle - унчи :(
# [public-build]
------------------------------------------------------------------------
r14851 | scalolaz_scat@mail.ru | 2013-08-01 21:00:37 +0400 (Чт, 01 авг 2013) | 1 line

# Исправление критической ошибки, приводящей к замыканию Ежей :)
------------------------------------------------------------------------
r14850 | pavel.pimenov@gmail.com | 2013-08-01 20:51:44 +0400 (Чт, 01 авг 2013) | 2 lines

# CustomCompressExt.ini -> CustomCompressExt.txt чтобы не потерялось.
  (сейчас конфигурация расширений лежит в облаке)
------------------------------------------------------------------------
r14848 | tret2003 | 2013-08-01 20:07:39 +0400 (Чт, 01 авг 2013) | 1 line

# [lang] an auto commit from localization system...
------------------------------------------------------------------------
r14847 | scalolaz_scat@mail.ru | 2013-08-01 19:47:27 +0400 (Чт, 01 авг 2013) | 1 line

* к r14846 : Для "Изменения" Избранных Путей по кнопке "Browse" открываем имеющийся путь
------------------------------------------------------------------------
r14846 | scalolaz_scat@mail.ru | 2013-08-01 19:05:50 +0400 (Чт, 01 авг 2013) | 2 lines

* (Close Issue 711) Нельзя изменить название избранного пути
https://code.google.com/p/flylinkdc/issues/detail?id=711
------------------------------------------------------------------------
r14845 | pavel.pimenov@gmail.com | 2013-08-01 18:23:13 +0400 (Чт, 01 авг 2013) | 2 lines

# Удалил неиспользуемый контейнер StringSet Util::g_compress_ext;

------------------------------------------------------------------------
r14844 | pavel.pimenov@gmail.com | 2013-08-01 18:19:52 +0400 (Чт, 01 авг 2013) | 10 lines

# TODO Поставил метки копипасты кода вида
  string temp = j->substr(0, x.size()); 
   if (stricmp(temp, x) == 0)
     ...
 Недостатки - создается временная переменная string - обрубок от строки x и потом зовется сравнение.
 Решение - добавить инлайн фукнкцию в Text:: где звать сразу _strncmpi http://msdn.microsoft.com/en-us/library/chd90w8e%28v=vs.71%29.aspx



  
------------------------------------------------------------------------
r14843 | pavel.pimenov@gmail.com | 2013-08-01 18:14:03 +0400 (Чт, 01 авг 2013) | 1 line

# [r4xx][merge] Astyle
------------------------------------------------------------------------
r14842 | scalolaz_scat@mail.ru | 2013-08-01 18:12:07 +0400 (Чт, 01 авг 2013) | 3 lines

# Небольшое дополнение к r14760:
- Флаг страны перемещён перед флагом провайдера
- Настройки Интерфейса - вкл/выкл флага страны
------------------------------------------------------------------------
r14841 | a.rainman@gmail.com | 2013-08-01 17:35:02 +0400 (Чт, 01 авг 2013) | 3 lines

# Исправлена проблема с пассивным режимом для NMDC хабов, можно выпускать бетку!
# Дальнейшие улучшения отчёта по пользователю.
# [public-build]
------------------------------------------------------------------------
r14840 | a.rainman@gmail.com | 2013-08-01 17:32:08 +0400 (Чт, 01 авг 2013) | 1 line

# AStyle.
------------------------------------------------------------------------
r14839 | a.rainman@gmail.com | 2013-08-01 15:30:15 +0400 (Чт, 01 авг 2013) | 3 lines

# Дальнейшие улучшения отчёта по пользователю.
# Подготовка к впиливанию назад отображения известных функций клиента.
# [public-build]
------------------------------------------------------------------------
r14838 | pavel.pimenov | 2013-08-01 11:52:03 +0400 (Чт, 01 авг 2013) | 2 lines

* (Closed issue 1113) Не всегда отрисовывал колонку "Рейтинг" в списке файл-листов http://code.google.com/p/flylinkdc/issues/detail?id=1113
# Экран FLYLINKDC_USE_MEDIAINFO_SERVER отключал не все фичи флай-сервера. 
------------------------------------------------------------------------
r14833 | a.rainman@gmail.com | 2013-08-01 02:26:14 +0400 (Чт, 01 авг 2013) | 2 lines

# Дальнейшие улучшения отчёта по пользователю.
# [public-build]
------------------------------------------------------------------------
r14832 | a.rainman@gmail.com | 2013-08-01 01:47:30 +0400 (Чт, 01 авг 2013) | 6 lines

* Удалены опции, позволяющие добавлять в описание пользователя свободные слоты и лимит отдачи - это избыточная функция поскольку данные о лимите уже есть в теге. В тег мне также хотелось добавить и количество свободных слотов, но некоторые хабы меня с таким тегом не пустили :( Собственно по этой же причине у ежовой версии нет в конце названия приложения приписки о том, что она ежовая. Подход таких проверок мне видится неправильным, ибо он тормозит развитие клиентов. В связи с вышесказанным прошу админов хабов поделиться доводами о том с какой целью некоторые из них вводят подобные проверки, ибо мне сие вообще не понятно, и видится абсурдным. С уважением, Ёж.
# Опции удалены директивой IRAINMAN_ENABLE_SLOTS_AND_LIMIT_IN_DESCRIPTION
# Тудушка повешана на директиву IRAINMAN_ENABLE_FREE_SLOTS_IN_TAG, позже надо всё таки включить её, ибо подавляющее большинство хабов с ней пускают.
# p.s: в т.ч. и за отсутствие подобного геммороя при любых, даже самых мелких изменениях, я люблю ADC протокол! :)
# [public-build]

------------------------------------------------------------------------
r14831 | tret2003 | 2013-07-31 21:56:05 +0400 (Ср, 31 июл 2013) | 1 line

# [lang] an auto commit from localization system...
------------------------------------------------------------------------
r14830 | a.rainman@gmail.com | 2013-07-31 21:51:57 +0400 (Ср, 31 июл 2013) | 3 lines

* Улучшена обратная совместимость при миграции с клиентов, хранящих список недавних хабов в файле конфигурации.
# [public-build]

------------------------------------------------------------------------
r14829 | a.rainman@gmail.com | 2013-07-31 21:51:52 +0400 (Ср, 31 июл 2013) | 1 line

# Проштудировал этап загрузки и добавил в лог пропущенные, относительно тяжёлые, компоненты и операции.
------------------------------------------------------------------------
r14828 | a.rainman@gmail.com | 2013-07-31 20:56:49 +0400 (Ср, 31 июл 2013) | 2 lines

# Дальнейшие улучшения отчёта по пользователю.
# [public-build]
------------------------------------------------------------------------
r14827 | a.rainman@gmail.com | 2013-07-31 19:53:00 +0400 (Ср, 31 июл 2013) | 3 lines

# Убрал лишние проверки.
	if (i > _fileArray.size()) return L"";
	if (i > _folderArray.size()) return L"";
------------------------------------------------------------------------
r14825 | a.rainman@gmail.com | 2013-07-31 19:42:41 +0400 (Ср, 31 июл 2013) | 1 line

# Починил сборку утилиты FlyUpdate.
------------------------------------------------------------------------
r14824 | a.rainman@gmail.com | 2013-07-31 19:31:08 +0400 (Ср, 31 июл 2013) | 1 line

# +r14822 - без PPA_INCLUDE_LASTIP_AND_USER_RATIO не собиралось.
------------------------------------------------------------------------
r14823 | pavel.pimenov@gmail.com | 2013-07-31 18:52:02 +0400 (Ср, 31 июл 2013) | 2 lines

# Оключил загрузку FavoriteManager::recentload(SimpleXML& aXml) хабы у нас давно уже в базе лежат.

------------------------------------------------------------------------
r14822 | pavel.pimenov@gmail.com | 2013-07-31 18:40:05 +0400 (Ср, 31 июл 2013) | 4 lines

* (Closed Issue 949) Всплывашки в ячейке "Расположение" в списке юзеров
   http://code.google.com/p/flylinkdc/issues/detail?id=949
   TODO - функции DrawThemeBackground вообще не выполнялись т.к. GetWindowTheme возвращает нулик
   TODO - причесать копипась ctrlUsers.SetItemFilled с SCALOLAZ_BRIGHTEN_LOCATION_WITH_LASTIP
------------------------------------------------------------------------
r14821 | a.rainman@gmail.com | 2013-07-31 18:36:58 +0400 (Ср, 31 июл 2013) | 1 line

# Issue 1121: [crash-server] Деление на 0 в QueueManager::FileQueue::findAutoSearch - забытая блокировка в деструкторе.
------------------------------------------------------------------------
r14820 | pavel.pimenov@gmail.com | 2013-07-31 18:34:15 +0400 (Ср, 31 июл 2013) | 3 lines

# [FileUpdateSearch] 
   Убраны ошибочные проверки if (i > _fileArray.size()) return L""; должно быть if (i >= _fileArray.size()) return L""; если хотелись защитится от выхода за границы.
   TODO проверить автообновку на серой
------------------------------------------------------------------------
r14819 | pavel.pimenov@gmail.com | 2013-07-31 18:30:28 +0400 (Ср, 31 июл 2013) | 1 line

# Исправлена утечка ReleaseDC в CAnimatedButton::onClose
------------------------------------------------------------------------
r14818 | pavel.pimenov@gmail.com | 2013-07-31 18:28:19 +0400 (Ср, 31 июл 2013) | 1 line

# Прибрал мусорок
------------------------------------------------------------------------
r14817 | pavel.pimenov@gmail.com | 2013-07-31 18:26:47 +0400 (Ср, 31 июл 2013) | 1 line

# Маркеры к http://code.google.com/p/flylinkdc/issues/detail?id=1121
------------------------------------------------------------------------
r14816 | a.rainman@gmail.com | 2013-07-31 17:59:08 +0400 (Ср, 31 июл 2013) | 3 lines

* Улучшения в отчёте по пользователю.
# Для директивы IRAINMAN_ENABLE_STRING_INFO_POOLING добавил возможность отключения сборки мусора - STRING_INFO_POOL_GC, и пока выключил дабы было удобнее тестировать.
# [public-build]
------------------------------------------------------------------------
r14813 | tret2003 | 2013-07-31 07:16:18 +0400 (Ср, 31 июл 2013) | 1 line

# [lang] an auto commit from localization system...
------------------------------------------------------------------------
r14812 | a.rainman@gmail.com | 2013-07-31 02:38:49 +0400 (Ср, 31 июл 2013) | 7 lines

* Произведён отказ от хранения тега клиента, теперь вместо него выводится человекопонятное имя приложения с версией. Операторов прошу не волноваться, все подробности о клиенте доступны либо в соседних колонках, либо в отчёте о пользователе.
* Дальнейшая оптимизация потребления памяти.
# Добавлен сервисный класс NmdcSupports, в связи с этим окончательно переработаны механизмы разбора "магического байта" в MyInfo.
# Добавлена директива IRAINMAN_ENABLE_STRING_INFO_POOLING, активирующая быстрый пул строк со сборкой мусора для Identity. По умолчанию везде вкл.
# Директиву PPA_ENABLE_STRING_INFO_DIC_IN_IDENTITY везде выключил, и оставил только для тестов.
# Вот теперь в Identity действительно оптимизировано потребление памяти!
# [public-build]
------------------------------------------------------------------------
r14811 | a.rainman@gmail.com | 2013-07-31 02:20:10 +0400 (Ср, 31 июл 2013) | 1 line

* r502-beta101
------------------------------------------------------------------------
r14810 | pavel.pimenov@gmail.com | 2013-07-30 23:18:24 +0400 (Вт, 30 июл 2013) | 1 line

# Astyle
------------------------------------------------------------------------
r14809 | pavel.pimenov@gmail.com | 2013-07-30 23:17:54 +0400 (Вт, 30 июл 2013) | 2 lines

# Иногда возикает вызов с p_upload_download_stats.empty()
  в этом случае не пытаемся заполнять таблицу fly_ratio
------------------------------------------------------------------------
r14808 | scalolaz_scat@mail.ru | 2013-07-30 22:46:32 +0400 (Вт, 30 июл 2013) | 1 line

# Убрал какаш... лишнее
------------------------------------------------------------------------
r14807 | a.rainman@gmail.com | 2013-07-30 21:52:07 +0400 (Вт, 30 июл 2013) | 1 line

# Похоронил настройки "половые настройки клиента" :) директивой IRAINMAN_TEMPORARY_DISABLE_XXX_ICON - не знаю кто и когда будет этот функционал перерабатывать, и надо ли это вообще. Однако всё же прошу фичу не удалять, может потом руки у кого доберутся.
------------------------------------------------------------------------
r14806 | a.rainman@gmail.com | 2013-07-30 21:46:02 +0400 (Вт, 30 июл 2013) | 1 line

# r14804 - const.
------------------------------------------------------------------------
r14805 | a.rainman@gmail.com | 2013-07-30 21:31:33 +0400 (Вт, 30 июл 2013) | 1 line

# Без SSA_IPGRANT_FEATURE не собиралось.
------------------------------------------------------------------------
r14804 | tret2003 | 2013-07-30 21:25:42 +0400 (Вт, 30 июл 2013) | 1 line

# Дополнение r14803, не собиралось
------------------------------------------------------------------------
r14803 | a.rainman@gmail.com | 2013-07-30 20:17:31 +0400 (Вт, 30 июл 2013) | 5 lines

* Исправлена ошибка: функционал сохранения LastIP в БД иногда затирал реальный IP пользователя устаревшим значением, или вообще заменял его пустой строкой. Насколько давно появился данный баг точно сказать не могу, но в версиях r502-beta99-100 он проявился в полной мере, и вылез наружу, Ёж.
# Окончательно похерил строковый SU из Identity.
# Поправлены многочисленные проблемы из-за некорректных флажков в классе User.
# Нашёл хитрый баг с пассивным режимом на nmdc хабах, пока доделал не до конца, так что на статус юзера на nmdc хабах внимания не обращайте, и бетку на публику не выпускайте.
# [public-build]
------------------------------------------------------------------------
r14802 | pavel.pimenov@gmail.com | 2013-07-30 18:57:15 +0400 (Вт, 30 июл 2013) | 2 lines

* (Closed issue 1123)  IPGuard.ini и IPGrant.ini загружаются при старте каждый раз даже если отключены!
   http://code.google.com/p/flylinkdc/issues/detail?id=1123
------------------------------------------------------------------------
r14801 | pavel.pimenov@gmail.com | 2013-07-30 18:48:32 +0400 (Вт, 30 июл 2013) | 1 line

#
------------------------------------------------------------------------
r14800 | a.rainman@gmail.com | 2013-07-30 15:03:10 +0400 (Вт, 30 июл 2013) | 1 line

# +r14799 - убрал параметр по умолчанию из UserConnectionListener::MaxedOut.
------------------------------------------------------------------------
r14799 | tret2003 | 2013-07-30 13:59:18 +0400 (Вт, 30 июл 2013) | 2 lines

* Исправлена обработка события при скачивании, если нет доступных слотов.
# Добавил отсутствующий файл в проект VS2012.
------------------------------------------------------------------------
r14798 | tret2003 | 2013-07-30 10:32:55 +0400 (Вт, 30 июл 2013) | 2 lines

* Исправлено падение https://crash-server.com/Problem.aspx?ClientID=ppa&ProblemID=13134

------------------------------------------------------------------------
r14796 | tret2003 | 2013-07-30 06:42:11 +0400 (Вт, 30 июл 2013) | 1 line

# [Astyle] Заменил параметр на --suffix=none.
------------------------------------------------------------------------
r14795 | tret2003 | 2013-07-30 06:30:43 +0400 (Вт, 30 июл 2013) | 1 line

# [Astyle] Не оставляем оригинальные файлы после правки стиля.
------------------------------------------------------------------------
r14794 | pavel.pimenov@gmail.com | 2013-07-30 06:16:18 +0400 (Вт, 30 июл 2013) | 1 line

# Astyle
------------------------------------------------------------------------
r14793 | a.rainman@gmail.com | 2013-07-30 00:53:58 +0400 (Вт, 30 июл 2013) | 3 lines

# Косметика в интерфейсе: пользовательские меню, окно контакт листа.
# Требуется обновление локализаций.
# [public-build]
------------------------------------------------------------------------
r14792 | pavel.pimenov@gmail.com | 2013-07-29 22:32:56 +0400 (Пн, 29 июл 2013) | 4 lines

# Thread - добавил проверку INVALID_HANDLE_VALUE + в исключении логируем errno 
  TODO - двойной вызов _beginthreadex выглядит криво! Ежик подумай еще раз - тебе должно быть стыдно за такой код.
# [AirDC++][merge] _CrtSetDbgFlag(_CRTDBG_ALLOC_MEM_DF | _CRTDBG_LEAK_CHECK_DF);
 
------------------------------------------------------------------------
r14791 | pavel.pimenov@gmail.com | 2013-07-29 22:00:01 +0400 (Пн, 29 июл 2013) | 6 lines

# Добавлен макрос GC_INC_UINT для инкремента параметров без вызова get/set
# В isSupports добавлен контроль параметров с большими буквами.
# Убрал лишние PROFILE_THREAD_SCOPED
# LevelDB - буфер записи сократил с 4M до 1M и убрал утечку delete m_options.env 
  (TODO delete m_options.comparator )

------------------------------------------------------------------------
r14790 | a.rainman@gmail.com | 2013-07-29 21:12:39 +0400 (Пн, 29 июл 2013) | 1 line

* Функционал загрузки локальной истории чата для хабов при открытии окна оставлен только в ежовой версии.
------------------------------------------------------------------------
r14789 | a.rainman@gmail.com | 2013-07-29 21:01:28 +0400 (Пн, 29 июл 2013) | 1 line

# Косметика кода.
------------------------------------------------------------------------
r14788 | a.rainman@gmail.com | 2013-07-29 20:40:29 +0400 (Пн, 29 июл 2013) | 7 lines

* Исправлена ошибка r502 бета 99 - у DHT юзеров отображался пустой ник.
# Дальнейшие оптимизации и наведение порядка в Identity.
# Начат переходной процесс полного избавления от хранения Supports.
# Добавлен сервисный класс AdcSupports.
# (Closed Issue 1112) http://code.google.com/p/flylinkdc/issues/detail?id=1112
# Чувствую, что в этом месяце я останусь голодным, ничего не заработаю, и не высплюсь, но зато Флаю липпосакцию сделаю, да косяки доисторические исправлю.
# [public-build]
------------------------------------------------------------------------
r14786 | a.rainman@gmail.com | 2013-07-29 15:29:41 +0400 (Пн, 29 июл 2013) | 1 line

# Почистил Thread::start().
------------------------------------------------------------------------
r14784 | tret2003 | 2013-07-29 03:57:46 +0400 (Пн, 29 июл 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1267, created 2013-07-29 05:55:12 +0700
   Total in database:
    - ISP - 1398
    - ISPs logo - 1407
    - Address range - 5945
   Archive CustomLocations.7z created by NightOrion


------------------------------------------------------------------------
r14783 | a.rainman@gmail.com | 2013-07-28 19:50:09 +0400 (Вс, 28 июл 2013) | 2 lines

# Дальнейшие оптимизации и наведение порядка в Identity - не храним строки фич, а заменяем их на флажки.
# [public-build]
------------------------------------------------------------------------
r14782 | a.rainman@gmail.com | 2013-07-28 19:49:58 +0400 (Вс, 28 июл 2013) | 1 line

# Дополнение по исправлению отображения: установка IP не должна зависеть от того  пуст ник пользователя или нет! Пора отвязывать статистику от ника, и привязывать к CID!
------------------------------------------------------------------------
r14781 | a.rainman@gmail.com | 2013-07-28 18:04:29 +0400 (Вс, 28 июл 2013) | 1 line

# Потестил, и отключил USE_GET_NICK_T_IN_IDENTITY для всех версий, у нас Флай жрёт слишком много памяти, что бы делать такие оптимизации, да и результат этих оптимизаций в профайлере даже не видно, к тому же там всё равно все остальные строки конвертятся!
------------------------------------------------------------------------
r14780 | a.rainman@gmail.com | 2013-07-28 17:39:25 +0400 (Вс, 28 июл 2013) | 1 line

# log.
------------------------------------------------------------------------
r14779 | a.rainman@gmail.com | 2013-07-28 17:24:54 +0400 (Вс, 28 июл 2013) | 1 line

* В список исключаемых из шары файлов добавлено расширение "part".
------------------------------------------------------------------------
r14778 | a.rainman@gmail.com | 2013-07-28 16:57:49 +0400 (Вс, 28 июл 2013) | 4 lines

# Запустите Astyle перед сборкой на публику для увеличения номера версии!
# log
# [public-build]

------------------------------------------------------------------------
r14777 | a.rainman@gmail.com | 2013-07-28 16:44:46 +0400 (Вс, 28 июл 2013) | 2 lines

* r502-beta100.
# Увеличил номер версии.
------------------------------------------------------------------------
r14776 | a.rainman@gmail.com | 2013-07-28 16:38:52 +0400 (Вс, 28 июл 2013) | 1 line

# Исправлена опечатка в комментарии.
------------------------------------------------------------------------
r14775 | a.rainman@gmail.com | 2013-07-28 16:35:23 +0400 (Вс, 28 июл 2013) | 8 lines

* Улучшена поддержка ADC протокола.
* Исправлена ошибка r502 бета 99 - все юзеры на ADC хабах отображались пассивами.
# Теперь окончательны исправлены все ошибки допущенные в r14746.
# Дальнейшие оптимизации и зачистки в Identity.
# Поскольку пока мы не умеем работать с IPv6 - значения выкидываем, и не храним.
# Оптимизация, и исправления в области Supports - при изменении кромсаем на отдельные фичи, и далее не занимаемся эвристикой.
# Частичные исправления направленные на получение полной поддержки ADC протокола.
# [public-build]
------------------------------------------------------------------------
r14774 | a.rainman@gmail.com | 2013-07-28 16:11:36 +0400 (Вс, 28 июл 2013) | 1 line

# Расширил диагностику для UserInfoBaseHandler.
------------------------------------------------------------------------
r14773 | a.rainman@gmail.com | 2013-07-28 13:52:39 +0400 (Вс, 28 июл 2013) | 2 lines

# Убрал, ранее добавленное мной, хранение листа со списком Опчат из Client ибо код очень редко зовётся.
# [public-build]
------------------------------------------------------------------------
r14772 | a.rainman@gmail.com | 2013-07-28 13:43:37 +0400 (Вс, 28 июл 2013) | 4 lines

* Исправлена ошибка r502 бета 99 - при запуске программы не всегда применялись правила к низким(высоким) приоритетам в очереди скачивания, списку исключаемых из проверки пользоватлей для автобана, и списку исключаемых из шары файлов.
# p.s: Слав, я так и не понял, что не работает по событию onLoad, ибо всё работает.
# [public-build]

------------------------------------------------------------------------
r14771 | a.rainman@gmail.com | 2013-07-28 13:43:02 +0400 (Вс, 28 июл 2013) | 1 line

# Косметика в Identity.
------------------------------------------------------------------------
r14770 | tret2003 | 2013-07-28 10:45:57 +0400 (Вс, 28 июл 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1266, created 2013-07-28 12:45:17 +0700
   Total in database:
    - ISP - 1398
    - ISPs logo - 1407
    - Address range - 5943
   Archive CustomLocations.7z created by NightOrion


------------------------------------------------------------------------
r14769 | tret2003 | 2013-07-28 09:14:51 +0400 (Вс, 28 июл 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1265, created 2013-07-28 12:12:48 +0700
   Total in database:
    - ISP - 1399
    - ISPs logo - 1408
    - Address range - 5943
   Archive CustomLocations.7z created by NightOrion


------------------------------------------------------------------------
r14768 | a.rainman@gmail.com | 2013-07-28 06:03:12 +0400 (Вс, 28 июл 2013) | 1 line

# Убрал дубликат строки с признаком операторства в отчёте по юзеру.
------------------------------------------------------------------------
r14767 | a.rainman@gmail.com | 2013-07-28 05:55:07 +0400 (Вс, 28 июл 2013) | 4 lines

# + r14766 - исправление для UserInfoSimple и UserManager.
# Started Issue 1115 https://code.google.com/p/flylinkdc/issues/detail?id=1115 - временно отключил вызов Colors::getUserColor в окне "Очередь отдачи".
# AStyle.
# [public-build]
------------------------------------------------------------------------
r14766 | a.rainman@gmail.com | 2013-07-28 05:23:12 +0400 (Вс, 28 июл 2013) | 8 lines

* Значительно улучшена отзывчивость программы.
* Значительно снижено потребление системных ресурсов.
* Значительно увеличена скорость запуска приложения.
* Исправлена старая проблема с никами на ADC хабах, теперь программа всегда отображает ник пользователя, актуальный для текущего хаба.
* Добавлена обработка состояния "Ушёл" для пользователей на ADC хабах.
* Исправлена ошибка r502 бета 99 - при открытии фрейма лог пользователя или хаба подгружался не в соответствии с настройками, а лишь на одну строку.
# Команду прошу - пожалуйста позакрывайте ишьи, желательно с добавлением в лог, ибо их было много, но я что то не одной не нахожу :(
# [public-build]
------------------------------------------------------------------------
r14765 | a.rainman@gmail.com | 2013-07-28 03:49:47 +0400 (Вс, 28 июл 2013) | 1 line

# (Closed Issue 932) [Assert] на adc хабах стали падать FavoriteUser::update
------------------------------------------------------------------------
r14764 | a.rainman@gmail.com | 2013-07-28 01:02:14 +0400 (Вс, 28 июл 2013) | 16 lines

* Оптимизация пользовательского интерфейса: запускаем ресортировку списков и обновление статуса только у активного MDI окна, а не у всех.
* Для окна хаба добавлена отложенная ресортировка при открытии окна. Это изменение позволит ускорить запуск, и уменьшить задержки при октрытии хабов с большим количеством пользователей.
* В окне "Поиск шпион" группируем события и обрабатываем их кучей, не чаще одного раза в секунду.
* Оптимизация потребления ресурсов программой.
* Исправлены найденные недоработки в области поддержки протокольных расширений - местами забывали ставить статусные флажки для них.
* Известный баг - все пользователи на ADC хабах отображаются как пассивы!
# [issue 1110] http://code.google.com/p/flylinkdc/issues/detail?id=1110
  Сократить размер объекта Identity - при большом кол-ве юзеров жрет память
(Часть 2) - дополнения, и исправления.
# В r14746 https://code.google.com/p/flylinkdc/source/detail?r=14746 , т.е. в первой части по Issue 1110 сломали Identity::getReport, это был не критичный баг (всего лишь вывод параметров в отчёте был не полным), однако для восстановления работоспособности пришлось практически полностью переписать функцию. TODO: посмотреть вывод отчёта на свежую голову и улучшить форматирование параметров.
# Так же в r12746 где то чуть изменили логику работу, и теперь ВСЕ юзеры на ADC хабах всегда в пассиве ^_^' Несколько раз за вечер пытался найти где эта особенность, поэтому и не заливал, но так и не нашёл! :) p.s: дело не в изменениях Identity::getParams и Identity::isSupports - там всё нормально, была правда недоработка в isSupports с оптимизацией - лишняя проверка ломала логику, но её исправил. :) Заливаю с осознанием, что баг есть но где не пойму, FlyTeam, давайте вместе посмотрим на дифф r12746 и найдём подозрительные места, ибо я их не нашёл! :) . Гарантия, что именно в этой ревизии добавили баг - 100%, откатывал сборку на r12745 - работает, а на r14746 ревизии уже нет :)
# В ревизии r14724 https://code.google.com/p/flylinkdc/source/detail?r=14724 сломали Identity::getTag(), забыли параметр слоты - починено. Благодарность уходит PVS :)
# Для тестов добавил директиву PPA_INCLUDE_INFO_DIC_IN_IDENTITY дабы можно было включать и выключать словарик. В ежовой версии фичу выключил, ибо интересно потестить дельту именно на флажках, не трогая логику работы с оставшимися строками, да и у меня есть некоторые сомнения по поводу словарика - ведь получается, что он эквивалент пула строк в настройках проекта, но используется только для некоторых строк?
# Поправлены найденные ошибки в реализации протоколов - хранили много дубликатоного мусора в юзерских флажках, при создании новых юзеров зачем то сбрасывали и без того неустановленные флаги - почищено, но в тоже время забыли устанаввливать нужные - исправлено! :)
# Поправлена слишком частая отсылка команды MyInfo на NMDC хаб во время активного добавления файлов в шару.
# [public-build]
------------------------------------------------------------------------
r14763 | tret2003 | 2013-07-27 17:19:56 +0400 (Сб, 27 июл 2013) | 1 line

# Поправил кодировку в О программе
------------------------------------------------------------------------
r14762 | pavel.pimenov@gmail.com | 2013-07-27 13:58:52 +0400 (Сб, 27 июл 2013) | 1 line

#  Astyle [public-build]
------------------------------------------------------------------------
r14761 | pavel.pimenov@gmail.com | 2013-07-27 13:16:22 +0400 (Сб, 27 июл 2013) | 1 line

# Log + Отключил лог "Drop duplicated connection"
------------------------------------------------------------------------
r14760 | scalolaz_scat@mail.ru | 2013-07-27 13:05:59 +0400 (Сб, 27 июл 2013) | 2 lines

# Жёстко вшитый флаг страны в списке юзеров
(Требуется допил!!!)
------------------------------------------------------------------------
r14759 | a.rainman@gmail.com | 2013-07-27 12:59:50 +0400 (Сб, 27 июл 2013) | 1 line

# Требуется обновление локализаций.
------------------------------------------------------------------------
r14758 | pavel.pimenov@gmail.com | 2013-07-27 12:12:30 +0400 (Сб, 27 июл 2013) | 1 line

# Вернул INTERNET_OPTION_CONNECT_TIMEOUT - баг в чем-то другом
------------------------------------------------------------------------
r14757 | pavel.pimenov@gmail.com | 2013-07-27 11:34:59 +0400 (Сб, 27 июл 2013) | 1 line

# Добавил метку
------------------------------------------------------------------------
r14756 | pavel.pimenov@gmail.com | 2013-07-27 11:33:45 +0400 (Сб, 27 июл 2013) | 2 lines

# Отключил  установку INTERNET_OPTION_CONNECT_TIMEOUT
  - замечено странное увеличение коннектов - http://www.flickr.com/photos/96019675@N02/9373734289/
------------------------------------------------------------------------
r14755 | pavel.pimenov@gmail.com | 2013-07-27 11:14:37 +0400 (Сб, 27 июл 2013) | 1 line

# Вернул сортировку при старте (как отложить ее пока не придумал)
------------------------------------------------------------------------
r14754 | a.rainman@gmail.com | 2013-07-27 00:23:22 +0400 (Сб, 27 июл 2013) | 5 lines

# Почистил Util::toUInt32 - не нужен тамм ассерт, который срабатывает на половину диапазона :)
# Почистил код в Identity.
# Поправил диагностику в LogManager.
# Поправлена ошибка в UploadManager::notifyQueuedUsersL.
# [public-build]
------------------------------------------------------------------------
r14753 | tret2003 | 2013-07-26 22:06:55 +0400 (Пт, 26 июл 2013) | 1 line

# [lang] an auto commit from localization system...
------------------------------------------------------------------------
r14748 | pavel.pimenov@gmail.com | 2013-07-26 19:07:36 +0400 (Пт, 26 июл 2013) | 1 line

* r5102-beta99
------------------------------------------------------------------------
r14747 | pavel.pimenov@gmail.com | 2013-07-26 18:41:59 +0400 (Пт, 26 июл 2013) | 4 lines

# (for merge) Исправлен баг в static uint32_t toUInt32(const char* c)
  после хоть одного переполнения глобальный фгаг оставался в errno == ERANGE
  и это приводило к двойному преобразованию - сначала uint32_t ret = atoi(c);
  а потом return (uint32_t)_atoi64(c);
------------------------------------------------------------------------
r14746 | pavel.pimenov@gmail.com | 2013-07-26 18:27:19 +0400 (Пт, 26 июл 2013) | 2 lines

# [issue 1110] http://code.google.com/p/flylinkdc/issues/detail?id=1110
  Сократить размер объекта Identity - при большом кол-ве юзеров жрет память (Часть 1)
------------------------------------------------------------------------
r14745 | pavel.pimenov@gmail.com | 2013-07-26 17:52:54 +0400 (Пт, 26 июл 2013) | 1 line

# Astyle
------------------------------------------------------------------------
r14744 | a.rainman@gmail.com | 2013-07-26 15:56:59 +0400 (Пт, 26 июл 2013) | 1 line

# Обновлены теги мимикрии, добавлен оригинальный клиент.
------------------------------------------------------------------------
r14743 | tret2003 | 2013-07-26 14:42:51 +0400 (Пт, 26 июл 2013) | 2 lines

* Добавил в "О программе" версию LevelDB
# Убрал с локали :
------------------------------------------------------------------------
r14742 | a.rainman@gmail.com | 2013-07-26 13:22:42 +0400 (Пт, 26 июл 2013) | 3 lines

# Исправление для очереди отдачи и окна отдачи.
# [public-build]

------------------------------------------------------------------------
r14739 | a.rainman@gmail.com | 2013-07-26 06:25:35 +0400 (Пт, 26 июл 2013) | 10 lines

* Удалена мимикрия под простой DC++ клиент, оставлена только теговая.
* Оптимизация использования ресурсов программой во время активной раздачи - закачки.
* Исправлена проблема с закачкой когда клиент пытался одновременно качать с нескольких копий одного и того же ADC пользователя, но через разные хабы.
# Директивой IRAINMAN_ENABLE_STEALTH_MODE захоронил старую мимикрию под оригинальный клиент. Нам и своей мимикрии хватает.
# Активировал отложенную проверку пользователей директивой USING_IDLERS_IN_CONNECTION_MANAGER.
# Почистил ConnectionQueueItem и QueueItem::Source от HintedUser, он там не нужен, достаточно просто UserPtr. Из закачек и отдач хинт выкинул полностью, так что теперь клиент не пытается качать с одного и того же юзера через разные ADC хабы.
# В итоге получилось, что HintedUser нужен только файл листам, и только при условии, что файл лист будет просмотрен пользователем, и то лишь для того что бы корректно отправлялись лички (т.е. именно на тот хаб, на который задумано), и для отображения правильного меню пользовательских команд, всё.
# TODO - почистить базу от мёртвых записей хаб-хинтов, хотя, в принципе можно и не чистить, докачается, само исчезнет. Однако сохранение пустой строки вместо зинта сейчас оставил.
# Исправление для FavoriteManager::favHubGroups. TODO: почистить ужас при создании HubFrame :(
# [public-build]
------------------------------------------------------------------------
r14738 | a.rainman@gmail.com | 2013-07-26 04:32:13 +0400 (Пт, 26 июл 2013) | 1 line

# Косметика.
------------------------------------------------------------------------
r14737 | a.rainman@gmail.com | 2013-07-26 01:48:40 +0400 (Пт, 26 июл 2013) | 2 lines

# Почистил Transfer::getParams.
# Выкинул свои комментарии для выпиленного кода.
------------------------------------------------------------------------
r14725 | pavel.pimenov@gmail.com | 2013-07-25 20:00:47 +0400 (Чт, 25 июл 2013) | 4 lines

# Добавил нового разработчика reg <entry.reg@gmail.com>
   https://bitbucket.org/3F/flightsdc/wiki/Home
# Вернул файл flylinkdc-config-r5xx.xml в солюшен

------------------------------------------------------------------------
r14724 | pavel.pimenov@gmail.com | 2013-07-25 19:52:26 +0400 (Чт, 25 июл 2013) | 17 lines

# [issue 1108] http://code.google.com/p/flylinkdc/issues/detail?id=1108
  Убрал лишние преобразования из строк в числа в классе Identity и блоикировки критической секцией
  В нативный вид хранения переведены следующие параметры
	SS
	CT
	SI
	US
	SL
	HN
	HR
	HO
Если у кого-то под _DEBUG сработает assert в 

string Identity::get(const char* name) const или 
void Identity::set(const char* name, const string& val)

Сообщите мне стек - это значит я где-то забыл и параметр продолжает прокидываться в мап-у строк.  
------------------------------------------------------------------------
r14723 | pavel.pimenov@gmail.com | 2013-07-25 18:29:55 +0400 (Чт, 25 июл 2013) | 1 line

# ListLoader::startTag - прическа
------------------------------------------------------------------------
r14722 | pavel.pimenov@gmail.com | 2013-07-25 18:05:38 +0400 (Чт, 25 июл 2013) | 1 line

# [issue 1102] Логируем в UploadManager::hasUpload http://code.google.com/p/flylinkdc/issues/detail?id=1102 и для BETA
------------------------------------------------------------------------
r14721 | tret2003 | 2013-07-25 15:33:38 +0400 (Чт, 25 июл 2013) | 1 line

# Не собиралось
------------------------------------------------------------------------
r14720 | a.rainman@gmail.com | 2013-07-25 15:03:11 +0400 (Чт, 25 июл 2013) | 1 line

# Косметика.
------------------------------------------------------------------------
r14719 | a.rainman@gmail.com | 2013-07-25 15:02:14 +0400 (Чт, 25 июл 2013) | 1 line

# Мелкий фикс в Transfer.
------------------------------------------------------------------------
r14718 | a.rainman@gmail.com | 2013-07-25 15:00:10 +0400 (Чт, 25 июл 2013) | 5 lines

# Выкромсал лишний код директивой IRAINMAN_SAVE_ALL_VALID_SOURCE. Прошу задуматься вот над чем: 
nmdc хаб - CID содержит в себе адрес хаба, так что юзера найдём.
adc хаб - CID у юзера реальный, какая нам разница через какой хаб с него качать?

Сохранение хинта - это для других целей нужно, в основном для красоты, на закачки это непосредственно не влияет.
------------------------------------------------------------------------
r14717 | a.rainman@gmail.com | 2013-07-25 13:31:48 +0400 (Чт, 25 июл 2013) | 1 line

# Удалил лишнюю диагностику из MerkleTree.  
------------------------------------------------------------------------
r14716 | a.rainman@gmail.com | 2013-07-25 13:27:01 +0400 (Чт, 25 июл 2013) | 6 lines

* Увеличена стабильность программы в области отрисовки иконоко пользователей, необходимо тестирование под wine.
# Поправлены падения в Colors::getUserColor. https://crash-server.com/SearchResult.aspx?ClientID=ppa&Stack=Colors::getUserColor ,
https://crash-server.com/SearchResult.aspx?ClientID=ppa&Stack=WinUtil::getUserColor ,
https://www.box.net/shared/f7c509838c3a1125842b ,
https://crash-server.com/DumpGroup.aspx?ClientID=ppa&DumpGroupID=59082
# [public-build]
------------------------------------------------------------------------
r14715 | a.rainman@gmail.com | 2013-07-25 12:24:32 +0400 (Чт, 25 июл 2013) | 1 line

# +r14714 - залил лишнее.
------------------------------------------------------------------------
r14714 | a.rainman@gmail.com | 2013-07-25 12:20:48 +0400 (Чт, 25 июл 2013) | 1 line

# Корректировка работы автобанилки - убрал из функции проверки флажков, передаваемых из вне, т.е. если не баним, то не баним никак, и исключения проверяем заранее. Не выдаём ошибку юзеру на той стороне только если включён тихий бан.
------------------------------------------------------------------------
r14712 | a.rainman@gmail.com | 2013-07-25 02:52:05 +0400 (Чт, 25 июл 2013) | 2 lines

# AStyle.
# [public-build]
------------------------------------------------------------------------
r14711 | a.rainman@gmail.com | 2013-07-25 02:51:57 +0400 (Чт, 25 июл 2013) | 3 lines

# [issue 1102] http://code.google.com/p/flylinkdc/issues/detail?id=1102
# Почистил код, бекпортированный из r4xx в ревизии r14705. Реально добавили лишь проверку ника, всё остальное уже было. Однако проверку ника добавили под условием, которое уже было, т.е. изменение не работало. :(
# Пора скинуться Паше на отпуск у моря! :)
------------------------------------------------------------------------
r14710 | a.rainman@gmail.com | 2013-07-25 02:51:39 +0400 (Чт, 25 июл 2013) | 3 lines

# Исправил дубликатный блок отладочных директив.
# Issue 1108: Клиент в режиме _DEBUG умирает при большом кол-ве хабов (45) . Надо подумать какие диагностики нам реально нужны, и часть отключить, возможно дополнительной директивой. Ведь самые длинные задержки именно там, внутри STL.
# Немного некромантии: добавил более подробное описание действий для того, кто захочет собрать проект для Windows 2000 :)
------------------------------------------------------------------------
r14709 | a.rainman@gmail.com | 2013-07-25 02:51:31 +0400 (Чт, 25 июл 2013) | 1 line

# Улучшил сбор статистики для фичи IRAINMAN_USE_NG_LOG_MANAGER.
------------------------------------------------------------------------
r14708 | a.rainman@gmail.com | 2013-07-25 01:05:00 +0400 (Чт, 25 июл 2013) | 3 lines

# [issue 1108] не понял зачем был затеян счётчик, если уже есть флажёк m_needsUpdateStats (спецом его переименовал, что бы было видно) и всё уже было сделано :) Там достаточно просто лимитировать время (т.е. интервал), никакая ресортировка и так не будет запущена пока не будет обработано событие STATS. Дополнительно оптимизнул этот момент, теперь если очередь сообщений не пуста то STATS не добавляем. Заэкранировал код, добавленный в r14698 экранами defined(NIGHT_BUILD) || defined(DEBUG).
   https://code.google.com/p/flylinkdc/issues/detail?id=1108
# [public-build]
------------------------------------------------------------------------
r14707 | a.rainman@gmail.com | 2013-07-25 01:04:47 +0400 (Чт, 25 июл 2013) | 1 line

# Оптимизация LogManager: вынес все тяжёлые операции из под спин.лока, и добавил возможность параллельно писать в несколько файлов. На всякий случай оставил возможность отключения фичи с помощью директивы IRAINMAN_USE_NG_LOG_MANAGER.
------------------------------------------------------------------------
r14706 | a.rainman@gmail.com | 2013-07-25 01:03:10 +0400 (Чт, 25 июл 2013) | 1 line

# Ревизия File::init.
------------------------------------------------------------------------
r14705 | pavel.pimenov@gmail.com | 2013-07-24 23:19:19 +0400 (Ср, 24 июл 2013) | 4 lines

# [issue 1102] http://code.google.com/p/flylinkdc/issues/detail?id=1102
  Добавил логирование фактов сброса источников нарушающих условия дубликатности для сборок дебаг и ночников #if defined(NIGHT_BUILD) || defined(DEBUG)
  скину сборку в issue для теста

------------------------------------------------------------------------
r14704 | pavel.pimenov@gmail.com | 2013-07-24 23:13:27 +0400 (Ср, 24 июл 2013) | 1 line

# Astyle
------------------------------------------------------------------------
r14703 | a.rainman@gmail.com | 2013-07-24 22:13:51 +0400 (Ср, 24 июл 2013) | 5 lines

* Исправления в поддержке чат бота:
   - отремонтирована передача ЛС в чат. бот (команды RECV_PM_NEW (код 40) и RECV_PM (код 41);
   - возвращена потерянная при обновлении ядра передача статуса файла в очереди (поле "STATUS" команды QUERY_DOWNLOADS (код 87)).
# Проведена ревизия кода, работающего с чат-ботом.
# [public-build]
------------------------------------------------------------------------
r14702 | a.rainman@gmail.com | 2013-07-24 22:13:44 +0400 (Ср, 24 июл 2013) | 2 lines

# Исправление для SettingsManager::set(StrSetting...): перевёл функцию на switch, и исправил, найденные благодаря этому ошибки: не все списки расширений проверяли на наличие пробелов.
# На фоне изменений произведено полное захоронение фичи RIP_USE_LOG_PROTOCOL, Дима её выпилил в своё время, но не полностью.
------------------------------------------------------------------------
r14701 | a.rainman@gmail.com | 2013-07-24 22:13:29 +0400 (Ср, 24 июл 2013) | 1 line

# Поправлена диагностика для меню пред.просмотра.
------------------------------------------------------------------------
r14700 | pavel.pimenov@gmail.com | 2013-07-24 19:33:22 +0400 (Ср, 24 июл 2013) | 4 lines

# Оптимизация в SearchFrame::onCustomDraw 
 - m_location = Util::getIpCountry(Text::fromT(ip)); зовем один раз при начале отрисовки строки в CDDS_ITEMPREPAINT 
   вместо CDDS_SUBITEM | CDDS_ITEMPREPAINT: (зовется часто если дергать скроллер по горизонтале)
 - Убрал лишний вызов VideoImage::getMediaVideoIcon
------------------------------------------------------------------------
r14699 | a.rainman@gmail.com | 2013-07-24 19:21:31 +0400 (Ср, 24 июл 2013) | 7 lines

* Значительно улучшено определение своего IP адреса, который мы передаём хабу. Теперь, при наличии возможности мы всегда передаём хабу тот IP, который он передал нам сам, а не тот, который записан в настройках и(или) свойствах избранного хаба.
* Из избранных хабов убрана опция "Получить IP-адрес от хаба при входе". Данная фича теперь включена для любого NMDC хаба. Для ADC хабов она не требовалась.
* Сообщение "На хабе XXX у Вас есть права оператора" теперь также выводится и для ADC хабов.
# (Fixed Issue 923) [Рефакторинг] В HubFrame::onCustomDraw часто зовется client->isOp() https://code.google.com/p/flylinkdc/issues/detail?id=923 .
# Небольшая оптимизация в HubFrame::onSpeaker за счёт использования события UPDATE_USER. Двойное обновление пользоватлей в окне пофиксил по другому.
# Дополнительная оптимизация в обработчике ежесекундного события в HubFrame.
# [public-build]
------------------------------------------------------------------------
r14698 | pavel.pimenov@gmail.com | 2013-07-24 19:00:01 +0400 (Ср, 24 июл 2013) | 3 lines

# [issue 1108] Починил запуск клиента под отдкой.
   https://code.google.com/p/flylinkdc/issues/detail?id=1108
    (пока временно сломана автоматическая сортировка при старте)
------------------------------------------------------------------------
r14697 | tret2003 | 2013-07-24 18:59:57 +0400 (Ср, 24 июл 2013) | 1 line

# [lang] an auto commit from localization system...
------------------------------------------------------------------------
r14696 | pavel.pimenov@gmail.com | 2013-07-24 18:57:43 +0400 (Ср, 24 июл 2013) | 2 lines

# Отключил #define __PROFILER_ENABLED__
# В void Client::send падаем в дебаге dcassert(isReady())
------------------------------------------------------------------------
r14695 | pavel.pimenov@gmail.com | 2013-07-24 18:54:13 +0400 (Ср, 24 июл 2013) | 3 lines

# В void AdcHub::handle отключил странную двойную обработку "SS" 
  Заменил  Util::toInt64(i->substr(2)) на Util::toUInt32(i->c_str()+2) - не создается временный string
  TODO - Разобраться зачем нам два setBytesShared в AdcHub
------------------------------------------------------------------------
r14694 | pavel.pimenov@gmail.com | 2013-07-24 18:46:27 +0400 (Ср, 24 июл 2013) | 7 lines

# Удалил мертвый код static int textUnderCursor(POINT p, CRichEditCtrl& ctrl, tstring& x);
# При закрытии главное окна в PopupManager продолжает получать REMOVE_POPUP
# Убрал лишний AutoArray<TCHAR> buf(len); 
# Выкинул мертвые комменты Ежика if (!BOOLSETTING(FILE_LIST_FROM_ZERO_SHARE_USERS))
# Убрал лишние вызовы VideoImage::getMediaVideoIcon - оно зовется уже в drawHDIcon
# Убрал лишние static int g_count - теперь есть профайлер
# В TypedListViewCtrl убрал код LRESULT onEraseBkgnd (AirDC++) а зачем он у нас?
------------------------------------------------------------------------
r14693 | pavel.pimenov@gmail.com | 2013-07-24 18:37:30 +0400 (Ср, 24 июл 2013) | 1 line

# Обновил интерфейс с itunes
------------------------------------------------------------------------
r14692 | tret2003 | 2013-07-24 18:14:13 +0400 (Ср, 24 июл 2013) | 2 lines

* (Closed  issue 210) Поддержка "CustomCompressExt" при работе с неполными источниками
https://code.google.com/p/flylinkdc/issues/detail?id=210
------------------------------------------------------------------------
r14691 | tret2003 | 2013-07-24 14:19:58 +0400 (Ср, 24 июл 2013) | 1 line

# Косметика + Astyle
------------------------------------------------------------------------
r14690 | tret2003 | 2013-07-24 13:16:04 +0400 (Ср, 24 июл 2013) | 3 lines

* (Closed issue 1094) Окна «Очередь отдачи/скачивания» не запоминают размеры разделителя(update, добавлено сохранение разделителя в списке файлов)
https://code.google.com/p/flylinkdc/issues/detail?id=1094

------------------------------------------------------------------------
r14689 | tret2003 | 2013-07-24 09:19:31 +0400 (Ср, 24 июл 2013) | 1 line

# Массив расширений теперь без "." забыли сменить функцию для получения расширения без "."
------------------------------------------------------------------------
r14688 | tret2003 | 2013-07-24 08:50:50 +0400 (Ср, 24 июл 2013) | 3 lines

* (Closed issue 1094) Окна «Очередь отдачи/скачивания» не запоминают размеры разделителя
https://code.google.com/p/flylinkdc/issues/detail?id=1094

------------------------------------------------------------------------
r14687 | pavel.pimenov@gmail.com | 2013-07-24 00:07:44 +0400 (Ср, 24 июл 2013) | 2 lines

# m_last_ip_id иногда остается = 0. пройтись под отладкой 
  TODO Разобраться в случаях когда p_upload_download_stats.empty 
------------------------------------------------------------------------
r14685 | a.rainman@gmail.com | 2013-07-23 21:36:39 +0400 (Вт, 23 июл 2013) | 1 line

* Обновлены теги мимикрии.
------------------------------------------------------------------------
r14684 | pavel.pimenov@gmail.com | 2013-07-23 20:04:47 +0400 (Вт, 23 июл 2013) | 1 line

# Astyle
------------------------------------------------------------------------
r14683 | pavel.pimenov@gmail.com | 2013-07-23 20:03:44 +0400 (Вт, 23 июл 2013) | 2 lines

* (Closed issue 1107) http://code.google.com/p/flylinkdc/issues/detail?id=1107
  Исправлено падение приложения при закрытии если в этот момент идет прасинг файл-листа.
------------------------------------------------------------------------
r14682 | pavel.pimenov@gmail.com | 2013-07-23 20:00:38 +0400 (Вт, 23 июл 2013) | 1 line

# Не долил фикс в CFlyUserRatioInfo::flushRatio()
------------------------------------------------------------------------
r14681 | a.rainman@gmail.com | 2013-07-23 19:54:13 +0400 (Вт, 23 июл 2013) | 3 lines

# Немного почистил WaitingUsersFrame и UploadQueueItemInfo: возложил всю отвественность за обновление информации на фрейм, что позволило исключить тяжёлый метод getText(), и использовать ранее сохраненные данные, так можно, поскольку почти все данные не меняются во времемни, меняется только прогресс загрузки у юзера, и тикает время ожидания - эти данные фрейм обновляет сам, и только если приложение активно.
# Синхронизируем обновление статуса и ресортировку с событием UPDATE_ITEMS, т.е. производим эти действия не чаще раза в секунду, и только когда приложение активно.
# [public-build]
------------------------------------------------------------------------
r14680 | pavel.pimenov@gmail.com | 2013-07-23 19:53:38 +0400 (Вт, 23 июл 2013) | 1 line

# Подправлен функционал сохранения LastIP store_all_ratio_and_last_ip
------------------------------------------------------------------------
r14679 | pavel.pimenov@gmail.com | 2013-07-23 19:47:05 +0400 (Вт, 23 июл 2013) | 8 lines

# Поиск и оптимизация отрисовки HubFrame::onCustomDraw (Шаг 2)
  - Делаем материализацию в функции bool isLastIP() и возвращаем значение 
   m_isLastIP, которое рассчитываем только один раз на шаге CDDS_ITEMPREPAINT 
   через вызов UserInfo::updateIsLastIP()
   в обработке отрисовки ячейки CDDS_SUBITEM | CDDS_ITEMPREPAINT теперь вызываем более легкую функцию isLastIP	
   Сравниваем отчеты профайлера:
http://www.fly-server.ru/profiler/flylinkdc-r502-beta-profile-20130723_191726.html
http://www.fly-server.ru/profiler/flylinkdc-r502-beta-profile-20130723_193358.html
------------------------------------------------------------------------
r14678 | pavel.pimenov@gmail.com | 2013-07-23 19:27:10 +0400 (Вт, 23 июл 2013) | 9 lines

# Поиск и оптимизация отрисоки HubFrame::onCustomDraw в части избыточного вызова тяжелой функции UserInfo::isLastIP() (Шаг 1)
  - Включаем экран __PROFILER_ENABLED__ только для _DEBUG
  - Расставляем маркеры профайлера с помощью макроса PROFILE_THREAD_SCOPED_DESC
  - В конце зовем генерацию отчета Profiler::dumphtml();
  - Компилируемб  запускаем и логинимся к хабам dchub://flylinkdc.dyndns.org и adcs://adcs.flylinkdc.com:2780
  - Двигаем мышкой все скроллеры хабов чтобы набралась статистика isLastIP
    получаем следующий отчет 
http://www.fly-server.ru/profiler/flylinkdc-r502-beta-profile-20130723_191726.html
    обращаем внимание на кол-во вызовов блока /CDDS_SUBITEM | CDDS_ITEMPREPAINT
------------------------------------------------------------------------
r14677 | a.rainman@gmail.com | 2013-07-23 18:18:22 +0400 (Вт, 23 июл 2013) | 2 lines

# AStyle.
# [public-build]
------------------------------------------------------------------------
r14676 | a.rainman@gmail.com | 2013-07-23 18:16:38 +0400 (Вт, 23 июл 2013) | 10 lines

* (Closed Issue 621) Добавить в меню окна ЛС пункты для игнорирования и бана пользователя https://code.google.com/p/flylinkdc/issues/detail?id=621 .
* Окончательно локализовано меню с информацией о пользователе.
* При включённых логах история с прошлой сессии теперь подгружается и для окна хабов, а не только для окон личек.
# Почистил менюшки в окне личек, что и позволило закрыть Issue 621.
# Выделил из UploadQueueItem кусок,эквивалентный UploadQueueItemInfo. На фоне данного действия удалось сэкономить много памяти, и избежать пустых запросов, результаты которых никак не обрабатывались до открытия WaitingUsersFrame.
# Небольшая оптимизация в WaitingUser - используем list вместо set.
# Навёл порядок в интерфейсах классов, чем поправил множество ошибок с HintedUser, а точнее с потерей хинта.
# В WaitingUsersFrame::onSpeaker остался небольшой костыль, вызванный кривым преобразованием типов. Пока пусть будет так, либо сегодня вечером, либо завтра по утру поправлю.
# Мелкие правки в ресурсах.
# Требуется обновление локализаций.
------------------------------------------------------------------------
r14675 | a.rainman@gmail.com | 2013-07-23 15:08:11 +0400 (Вт, 23 июл 2013) | 1 line

# Косметика кода
------------------------------------------------------------------------
r14674 | tret2003 | 2013-07-23 13:59:20 +0400 (Вт, 23 июл 2013) | 1 line

# Добавил конфигурацию HE в VS2012
------------------------------------------------------------------------
r14672 | tret2003 | 2013-07-23 11:35:00 +0400 (Вт, 23 июл 2013) | 1 line

# Упустили сборку с поддержкой XP для VS2012 в одной из либ
------------------------------------------------------------------------
r14671 | tret2003 | 2013-07-23 11:18:01 +0400 (Вт, 23 июл 2013) | 1 line

# Дополнение к r14670, правка проекта VS2012
------------------------------------------------------------------------
r14670 | a.rainman@gmail.com | 2013-07-23 10:43:40 +0400 (Вт, 23 июл 2013) | 2 lines

# Завершена верификация модуля Wildcard: убрана копипаста, начинка переведена на шаблоны, а Wildcard.cpp удалён за ненадобностью.
# [public-build]
------------------------------------------------------------------------
r14669 | a.rainman@gmail.com | 2013-07-23 09:51:57 +0400 (Вт, 23 июл 2013) | 1 line

# +r14666: забыли ассерт для диагностики.
------------------------------------------------------------------------
r14668 | a.rainman@gmail.com | 2013-07-23 09:50:39 +0400 (Вт, 23 июл 2013) | 1 line

# +r14666: забыли ассерт для диагностики.
------------------------------------------------------------------------
r14667 | a.rainman@gmail.com | 2013-07-23 09:50:24 +0400 (Вт, 23 июл 2013) | 7 lines

* Исправление для функций пред.просмотра: в случае если расширения файлов были в неподходящем регистре не отображалось меню.
# Завершил оптимизацию в области использования Wildcard. Возможно из Client данную оптимизацию стоит снести.
# Исправлвен баг при использовании PreviewApplication - забыли Text::toLower перед сравнением. Это был очень древний баг.
# Оптимизация в области использовании StringTokenizer.
# Добавлена функция Util::splitSetting и макрос для настроек SPLIT_SETTING.
# При разрушении QueueManager убрал бессмысленное удаление файлов dclst из папки файл листов.

------------------------------------------------------------------------
r14666 | pavel.pimenov | 2013-07-23 09:29:26 +0400 (Вт, 23 июл 2013) | 6 lines

# Поправил dcassert(!aUser.hint.empty()) при открытии файл-листов в _DEBUG режиме на DirectoryListing::DirectoryListing
  Реализовано через сервисный метод HintedUser QueueItem::getHintedUserSafe()
  у коллекции downloads поле hint в getHintedUser почему-то пустое.
  В этом случае забираем его из sources - при закачке файл-листа источник всегда один и там есть корректный hintedUser
  (TODO - разобраться почему оно такое)

------------------------------------------------------------------------
r14665 | pavel.pimenov@gmail.com | 2013-07-23 07:07:25 +0400 (Вт, 23 июл 2013) | 2 lines

# Исключил лишние обращения к базе для расчета last_ip_id в CFlylinkDBManager::store_all_ratio_and_last_ip и добавил dcassert-ов

------------------------------------------------------------------------
r14664 | a.rainman@gmail.com | 2013-07-23 06:45:12 +0400 (Вт, 23 июл 2013) | 1 line

# Оптимизация вызова Wildcard::patternMatch для Client. Студия - зараза, начала ругаться только после полной пересборки :( 
------------------------------------------------------------------------
r14663 | a.rainman@gmail.com | 2013-07-23 06:30:35 +0400 (Вт, 23 июл 2013) | 1 line

# Исправление вызова Wildcard::patternMatch для Client.
------------------------------------------------------------------------
r14662 | a.rainman@gmail.com | 2013-07-23 06:15:59 +0400 (Вт, 23 июл 2013) | 7 lines

# Технологический коммит.
# UserTask -> OnlineUserTask.
# Косметика в классах: StringTask, OnlineUserTask, MessageTask.
# Оптимизация в UserInfo::getNick().
# Добавлена документация к генераторам менюшек в WinUtil.
# Исправление использования класса NonDerivable.
# Косметика в CFlyHyperLink.
------------------------------------------------------------------------
r14661 | a.rainman@gmail.com | 2013-07-23 05:37:37 +0400 (Вт, 23 июл 2013) | 2 lines

* Исправление функционала "Включение режима"ушёл" при сворачивании (и обратно при восстановлении)", данный функционал ранее мог работать не корректно если настройки были изменены в свёрнутом состоянии.
# Исправления в MainFrame::onSize - не выполняем одни и те же действия несколько раз.
------------------------------------------------------------------------
r14660 | a.rainman@gmail.com | 2013-07-23 05:37:31 +0400 (Вт, 23 июл 2013) | 1 line

# Начал разгребать менюшки в DirectoryListingFrame, пока полностью разгрёб только tabMenu, и в первом приближении зачистил работу с fileMenu.
------------------------------------------------------------------------
r14659 | a.rainman@gmail.com | 2013-07-23 02:53:42 +0400 (Вт, 23 июл 2013) | 9 lines

# +r14650 - убрал часть копипасты из Wildcard зашаблонизировав её. Заодно была провдена оптимизация за счёт вытаскивания Text::toLower, в т.ч. для одних и тех же данных из цикла.
# TODO мне: по утру внимательно просмотреть начинку Wildcard, т.е. методы: set, wildcardfit, и asterisk и поправить там копипасту, дабы не позволять допустить ошибок в столь сложных методах, да ещё и работающих с указателями, ибо подобный код может быть как причиной повреждения кучи, так и причиной других повреждений памяти.
# TODO мне: по утру просмотреть все вызовы Wildcard::patternMatch через токинайзер, и оптимизнуть, при этом настройки надо оптимизнуть через SettingsManager, дабы избежать оверхеда по памяти.
# В Wildcard::set исправлена ошибка, возникшая в результате копипасты.
# В Wildcard::asterisk исправил стрёмный код с ретурнами не понятно чего заменив его на однозначный.
# Доп. пояснение в Wildcard::wildcardfit: useSet - константа, это уточнение поможет компилятору сразу выкинуть проверку этого флажка из цикла.
# Убрал копипасту в StringTokenizer, и почистил код добавив шаблонный метод slice.
# Доп. пояснение: StringTokenizer::slice гораздо лучше будет векторизован компилятором поскольку вся обработка теперь находится внутри одного цикла.
# [public-build]
------------------------------------------------------------------------
r14658 | a.rainman@gmail.com | 2013-07-22 23:45:11 +0400 (Пн, 22 июл 2013) | 1 line

# Issue 1100 Пересмотр стиля кодирования в проекте.
------------------------------------------------------------------------
r14657 | pavel.pimenov@gmail.com | 2013-07-22 22:06:26 +0400 (Пн, 22 июл 2013) | 1 line

# Astyle
------------------------------------------------------------------------
r14656 | pavel.pimenov@gmail.com | 2013-07-22 22:04:11 +0400 (Пн, 22 июл 2013) | 4 lines

* (Closed issue) http://code.google.com/p/flylinkdc/issues/detail?id=1101
  При открытии файл-листов где имя файла пустое не кидаем исключение Directory missing name attribute
  а генерируем имя файла фиктивное l_file_name = "empty_file_name_" + Util::toString(++m_empty_file_name_counter);

------------------------------------------------------------------------
r14655 | a.rainman@gmail.com | 2013-07-22 21:36:41 +0400 (Пн, 22 июл 2013) | 1 line

# +r14653 GET -> GETM.
------------------------------------------------------------------------
r14654 | pavel.pimenov@gmail.com | 2013-07-22 21:29:17 +0400 (Пн, 22 июл 2013) | 2 lines

# fly-server настройку таймаута для коннекта INTERNET_OPTION_CONNECT_TIMEOUT вынес в конфиг 
  TODO - INTERNET_OPTION_RECEIVE_TIMEOUT и INTERNET_OPTION_SEND_TIMEOUT пока не настраивается.
------------------------------------------------------------------------
r14653 | a.rainman@gmail.com | 2013-07-22 20:55:20 +0400 (Пн, 22 июл 2013) | 1 line

# Добавлен макрос GET.
------------------------------------------------------------------------
r14652 | tret2003 | 2013-07-22 19:28:21 +0400 (Пн, 22 июл 2013) | 1 line

# Добавил упущенный файл в проект
------------------------------------------------------------------------
r14651 | pavel.pimenov@gmail.com | 2013-07-22 19:17:11 +0400 (Пн, 22 июл 2013) | 3 lines

#[issue 1097] http://code.google.com/p/flylinkdc/issues/detail?id=1097
   - Добавлен конвертор истории из SQLite в LevelDB 
   - Причесать гуй и приделать прогресс-бар (пока кол-во записей выводится в лог - протестить на Ежик-базе)
------------------------------------------------------------------------
r14650 | pavel.pimenov@gmail.com | 2013-07-22 19:15:08 +0400 (Пн, 22 июл 2013) | 1 line

# Wildcard поправил стиль.
------------------------------------------------------------------------
r14649 | pavel.pimenov@gmail.com | 2013-07-22 19:09:24 +0400 (Пн, 22 июл 2013) | 2 lines

# Упростил обработку bool CFlyServerConfig::isBlockShare не делается лишних Wildcard::patternMatch и нет приведения к нижнему того, что уже и так в нижнем.
  TODO - Славе покурить данный диф
------------------------------------------------------------------------
r14648 | pavel.pimenov@gmail.com | 2013-07-22 19:02:41 +0400 (Пн, 22 июл 2013) | 2 lines

* (Closed issue 1098) В файл-листах не подкрашиваем файлы с размером = 0 
   http://code.google.com/p/flylinkdc/issues/detail?id=1098
------------------------------------------------------------------------
r14647 | pavel.pimenov@gmail.com | 2013-07-22 19:01:22 +0400 (Пн, 22 июл 2013) | 1 line

# BOOST_USE_WINDOWS_H
------------------------------------------------------------------------
r14646 | pavel.pimenov@gmail.com | 2013-07-22 18:51:12 +0400 (Пн, 22 июл 2013) | 1 line

# [merge] DC++
------------------------------------------------------------------------
r14645 | pavel.pimenov@gmail.com | 2013-07-22 18:44:52 +0400 (Пн, 22 июл 2013) | 1 line

# Для работы предкомпиляции первым должно стоят #include "stdinc.h"
------------------------------------------------------------------------
r14644 | a.rainman@gmail.com | 2013-07-22 18:20:49 +0400 (Пн, 22 июл 2013) | 2 lines

# Частично откатил r14327, в котором была добавлена пред.компиляция заголовков
(/Yc). - проект для 2012 студии.
------------------------------------------------------------------------
r14643 | a.rainman@gmail.com | 2013-07-22 17:52:18 +0400 (Пн, 22 июл 2013) | 2 lines

# Частично откатил r14327, в котором была добавлена пред.компиляция заголовков
(/Yc). - ReleaseHE.
------------------------------------------------------------------------
r14642 | a.rainman@gmail.com | 2013-07-22 17:44:26 +0400 (Пн, 22 июл 2013) | 1 line

# Частично откатил r14327, в котором была добавлена пред.компиляция заголовков (/Yc).
------------------------------------------------------------------------
r14641 | a.rainman@gmail.com | 2013-07-22 16:50:02 +0400 (Пн, 22 июл 2013) | 5 lines

# +r14638 упс, забыл солюшен залить.
# p.s: незалитыми остались только изменения, которые я не знаю как применить корректно:
 - compiled/UpdateSource5.xml - удалён блок "emopacks" поскольку в ежовой нет смайлов.
 - два ресурса: лого для 1го апредля (res/Splash/Splash_fools_day.png
), и иконка на страничке логина для веб морды (logo.gif).
------------------------------------------------------------------------
r14640 | a.rainman@gmail.com | 2013-07-22 16:48:22 +0400 (Пн, 22 июл 2013) | 1 line

# Коррекция батника UpdateRevision.bat для ежовой и серой версий, в которых бета и релиз лежат в одной папке на сервере.
------------------------------------------------------------------------
r14639 | a.rainman@gmail.com | 2013-07-22 16:38:31 +0400 (Пн, 22 июл 2013) | 1 line

# Уточнение в version.h по поводу сборки ежовой.
------------------------------------------------------------------------
r14638 | a.rainman@gmail.com | 2013-07-22 16:33:02 +0400 (Пн, 22 июл 2013) | 3 lines

# Сделал конфигурации ReleaseHE (копия ReleaseFullOpt), но с изменениями:
 - OmitFramePointers - false - знаю, что для краш сервера нужно тру, однако, глядя на отчёты на крашсервере, там и так стек чудесно раскручивается.
 - EnableEnhancedInstructionSet для 32х битных версий StreamingSIMDExtensions2 вместо StreamingSIMDExtensions.
------------------------------------------------------------------------
r14636 | tret2003 | 2013-07-22 13:31:52 +0400 (Пн, 22 июл 2013) | 2 lines

# Убрал из настроек автообновление автообновления CustomCompressExt.ini и CustomBlockShare.ini

------------------------------------------------------------------------
r14635 | tret2003 | 2013-07-22 12:23:51 +0400 (Пн, 22 июл 2013) | 1 line

* Убрал из автообновления CustomCompressExt.ini и CustomBlockShare.ini, их содержимое перенесено в конфигурационный файл
------------------------------------------------------------------------
r14634 | tret2003 | 2013-07-22 12:21:08 +0400 (Пн, 22 июл 2013) | 1 line

# [merge] с проекта VS2010 в VS2012
------------------------------------------------------------------------
r14632 | pavel.pimenov@gmail.com | 2013-07-21 14:22:41 +0400 (Вс, 21 июл 2013) | 1 line

# Astyle
------------------------------------------------------------------------
r14631 | pavel.pimenov@gmail.com | 2013-07-21 14:22:13 +0400 (Вс, 21 июл 2013) | 2 lines

# Убрал лишние PROFILE_THREAD_SCOPED (он кстати перестал работать почему-то)
* r502-beta98
------------------------------------------------------------------------
r14630 | a.rainman@gmail.com | 2013-07-21 01:55:00 +0400 (Вс, 21 июл 2013) | 1 line

# Почистил код в области ThreadPool, и код, который его наследует.
------------------------------------------------------------------------
r14629 | a.rainman@gmail.com | 2013-07-21 00:19:11 +0400 (Вс, 21 июл 2013) | 1 line

# Добавлен метод QueueManager::shutdown для более быстрого завершения приложения в случае если фоновые потоки в менеджере уже выполнили работу, но ещё не завершились автоматически.
------------------------------------------------------------------------
r14628 | a.rainman@gmail.com | 2013-07-20 23:47:23 +0400 (Сб, 20 июл 2013) | 2 lines

# AStyle.
# [public-build]
------------------------------------------------------------------------
r14627 | a.rainman@gmail.com | 2013-07-20 23:46:18 +0400 (Сб, 20 июл 2013) | 1 line

# Оказывается на Windows для получения реального размера страницы, которой оперирует менеджер памяти нужно учитывать не только SYSTEM_INFO::dwPageSize, но ещё и  SYSTEM_INFO::dwAllocationGranularity - исправлено.
------------------------------------------------------------------------
r14626 | a.rainman@gmail.com | 2013-07-20 23:46:08 +0400 (Сб, 20 июл 2013) | 6 lines

# Унёс из MainFrame в QueueManager куски ядерного кода.
# Улучшение поиска альтернатив: проверяем на альтерантивы любой скачиваемый файл-лист, а не только те, что были найдены по запросы для опции "Автоматическое добавление в очередь".
# Исправлены потенциальные падения при использовании опции "Автоматическое добавление в очередь".
# Оптимизация в QueueManager::matchListing: не обрабатываем файл лист, если очередь скачивания пуста.
# Почистил копипасту в Thread.h путём добавления класса BaseThread.
# Поскольку код не доработан для работы с ThreadPool сделал так, что бы с ним не компилировалось.
------------------------------------------------------------------------
r14625 | a.rainman@gmail.com | 2013-07-20 23:01:51 +0400 (Сб, 20 июл 2013) | 2 lines

# +r14613 - пофиксил пути окончательно.
# [public-build]
------------------------------------------------------------------------
r14623 | a.rainman@gmail.com | 2013-07-20 02:37:08 +0400 (Сб, 20 июл 2013) | 2 lines

# +r14613 - пофиксил пути по простому.
# [public-build]
------------------------------------------------------------------------
r14622 | a.rainman@gmail.com | 2013-07-20 02:17:03 +0400 (Сб, 20 июл 2013) | 2 lines

# Поправил работу окна ЛС. Когда при коммите стирал комменты, затёр лишнее.
# [public-build]
------------------------------------------------------------------------
r14621 | pavel.pimenov@gmail.com | 2013-07-20 00:31:58 +0400 (Сб, 20 июл 2013) | 1 line

# r502-beta97 (чтобы серая изменила номер)
------------------------------------------------------------------------
r14620 | scalolaz_scat@mail.ru | 2013-07-20 00:28:29 +0400 (Сб, 20 июл 2013) | 2 lines

# В догонку - ссылка на Вики для новой страницы
[public-build]
------------------------------------------------------------------------
r14619 | scalolaz_scat@mail.ru | 2013-07-20 00:02:25 +0400 (Сб, 20 июл 2013) | 3 lines

# пнул транк

[public-build]
------------------------------------------------------------------------
r14618 | scalolaz_scat@mail.ru | 2013-07-19 23:58:26 +0400 (Пт, 19 июл 2013) | 5 lines

* (Closed Issue 1087): 	Сохранять TTH в потоке NTFS - стоит переместить в: Файл=>Настройки=>Шара (https://code.google.com/p/flylinkdc/issues/detail?id=1087)
# Новая иконка для нового пункта настроек
# Требуется шлифовка RC нового пункта (всякие утрамбовки контролов)
# Переименована страница "Шара" UploadPage в SharePage, а так-же класс и функции. Ссылка на старое имя файла осталась в конце файла.

------------------------------------------------------------------------
r14617 | a.rainman@gmail.com | 2013-07-19 23:24:45 +0400 (Пт, 19 июл 2013) | 1 line

# YНА всякий случай пока заэкранировал фичу FLYLINKDC_USE_LEVELDB в NIGHT_BUILD, что бы было включено только в серой и ежовой.
------------------------------------------------------------------------
r14616 | a.rainman@gmail.com | 2013-07-19 20:58:56 +0400 (Пт, 19 июл 2013) | 3 lines

# Вернул пробел при обращении к юзеру после ника в чате.
# Перенёс консольные команды "extraslots" и "smallfilesize" в WinUtil, тем самым сделав их универсальными.
# [public-build]
------------------------------------------------------------------------
r14615 | a.rainman@gmail.com | 2013-07-19 20:07:29 +0400 (Пт, 19 июл 2013) | 2 lines

# +r14613: вернул похеренный дефайн USE_VISTA_API.
# Косметика в CompatibilityManager.
------------------------------------------------------------------------
r14614 | pavel.pimenov@gmail.com | 2013-07-19 19:17:50 +0400 (Пт, 19 июл 2013) | 1 line

# Стер левые файлики
------------------------------------------------------------------------
r14613 | pavel.pimenov@gmail.com | 2013-07-19 19:05:54 +0400 (Пт, 19 июл 2013) | 5 lines

# [issue 1097] https://code.google.com/p/flylinkdc/issues/detail?id=1097
  - Перевел хранение истории скачки ТТХ и шаринга на базу данных levelDB
  - TODO приделать конвертер истории
  - TODO придумать красивее название к каталогу бд. 
    сейчас зовется так l_full_path_level_db = Util::getConfigPath() + "/tth-history.leveldb"; 
------------------------------------------------------------------------
r14612 | pavel.pimenov@gmail.com | 2013-07-19 18:54:31 +0400 (Пт, 19 июл 2013) | 1 line

# Для Download::FLAG_PARTIAL ошибочно звали сохранения TTH (в таблицу - я скачивал этот файл) (for merge)
------------------------------------------------------------------------
r14611 | pavel.pimenov@gmail.com | 2013-07-19 18:51:30 +0400 (Пт, 19 июл 2013) | 1 line

# DirectoryListing::File Убрал лишнее преобразование из строки в TTHValue при заполнении файл-листа (for merge)
------------------------------------------------------------------------
r14610 | pavel.pimenov@gmail.com | 2013-07-19 17:52:53 +0400 (Пт, 19 июл 2013) | 1 line

# Маски для блокировки шары привел к нижнему регистру
------------------------------------------------------------------------
r14609 | tret2003 | 2013-07-19 14:32:06 +0400 (Пт, 19 июл 2013) | 1 line

# [lang] an auto commit from localization system...
------------------------------------------------------------------------
r14608 | a.rainman@gmail.com | 2013-07-19 14:10:57 +0400 (Пт, 19 июл 2013) | 1 line

# ежовая - апдейт.
------------------------------------------------------------------------
r14607 | a.rainman@gmail.com | 2013-07-19 06:13:27 +0400 (Пт, 19 июл 2013) | 2 lines

# AStyle.
# [public-build]
------------------------------------------------------------------------
r14606 | a.rainman@gmail.com | 2013-07-19 06:06:56 +0400 (Пт, 19 июл 2013) | 7 lines

* Убрана продублированная фича "Супер пользователь". Окно "Избранные пользователи" теперь выглядит однозначно. Менюшки тоже стали чище.
* Добавлена локализация в не локализованные месте в меню.
# Поправлена загрузка и выгрузка параметров избранных пользователей.
# Почистил код новых генераторов менюшек.
# Убил останки старых обработчиков меню.
# Убил большое количество копипасты, в т.ч. свежей.
# [public-build]
------------------------------------------------------------------------
r14605 | a.rainman@gmail.com | 2013-07-19 04:19:51 +0400 (Пт, 19 июл 2013) | 1 line

# Косметика.
------------------------------------------------------------------------
r14604 | a.rainman@gmail.com | 2013-07-19 03:30:13 +0400 (Пт, 19 июл 2013) | 1 line

# В SimpleXML добавлен метод getInt64ChildAttrib.
------------------------------------------------------------------------
r14603 | pavel.pimenov@gmail.com | 2013-07-19 00:08:20 +0400 (Пт, 19 июл 2013) | 6 lines

# [issue 1097] Добавлены levelDB и snappy (Часть 1)
  https://code.google.com/p/flylinkdc/issues/detail?id=1097
  - x64 пока не проверял. x86 работает в тесте.
  - под x86 прозрачная компрессия snappy пока не работает и падает (возможно не будет использоваться)
  - файлы проектов позаимствовал у http://www.airdcpp.net/ (спасибо Анониму из блога за идею)
    http://www.flylinkdc.ru/2013/07/flylinkdc-r502-beta92-build-14457.html 
------------------------------------------------------------------------
r14602 | pavel.pimenov@gmail.com | 2013-07-18 23:58:08 +0400 (Чт, 18 июл 2013) | 6 lines

# Поправка к r14600
  - в isBlockShare передается имя в нижнем регистре (иначе не сработает блокировка если расширение будет большими буквами)
  - TODO проверить как работает если в блоке будет русское расширение
  - Запрет шаринга TLS_PRIVATE_KEY_FILE игнорируем чуток раньше.
  - в bool CFlyServerConfig::isBlockShare. добавлена проверка dcassert(Text::toLower(p_name) == p_name);
    
------------------------------------------------------------------------
r14601 | pavel.pimenov@gmail.com | 2013-07-18 23:07:26 +0400 (Чт, 18 июл 2013) | 2 lines

# Новый профайлер под x64 не работает (использует __asm конструкции)
  TODO - поправить при случае или отписать автору
------------------------------------------------------------------------
r14600 | tret2003 | 2013-07-18 22:31:48 +0400 (Чт, 18 июл 2013) | 3 lines

* to [issue 1073] Перетащил содержимое файлов CustomBlockShare.ini и CustomCompressExt.ini в файл конфигурации на fly-server.
https://code.google.com/p/flylinkdc/issues/detail?id=1073
# TODO убрать их из автоапдейта
------------------------------------------------------------------------
r14599 | a.rainman@gmail.com | 2013-07-18 20:37:46 +0400 (Чт, 18 июл 2013) | 1 line

# ежовой сборки сборки фикс :)
------------------------------------------------------------------------
r14598 | pavel.pimenov@gmail.com | 2013-07-18 18:36:16 +0400 (Чт, 18 июл 2013) | 1 line

# При активном __PROFILER_ENABLED__ генерируем в конце приложения отчет в виде HTML Profiler::dumphtml();
------------------------------------------------------------------------
r14597 | pavel.pimenov@gmail.com | 2013-07-18 18:35:26 +0400 (Чт, 18 июл 2013) | 1 line

# Astyle
------------------------------------------------------------------------
r14596 | pavel.pimenov@gmail.com | 2013-07-18 18:33:48 +0400 (Чт, 18 июл 2013) | 1 line

# MappingManager подписывается на события кривовато - блокируем дубликатные подписки/отписки
------------------------------------------------------------------------
r14595 | pavel.pimenov@gmail.com | 2013-07-18 18:31:36 +0400 (Чт, 18 июл 2013) | 2 lines

* (Closed issue 1090)
   Для PlaySound передаем параметр SND_NODEFAULT, чтобы когда звук отключен винда не лезла за системными звуками (for merge)
------------------------------------------------------------------------
r14594 | pavel.pimenov@gmail.com | 2013-07-18 18:30:03 +0400 (Чт, 18 июл 2013) | 1 line

# Исправлено получение LastIP когда колонки принято/отдано спрятаны (Спасибо Gap51 и NightOrion)
------------------------------------------------------------------------
r14593 | a.rainman@gmail.com | 2013-07-18 18:22:47 +0400 (Чт, 18 июл 2013) | 4 lines

* Добавлено автоматическое удаление запросов IP адреса.
# В Окне "Очередь скачивания": не добавляем меню пред.просмотра не только к файл листам, но и к DCLST, не полным файл листам, и запросам IP, так же не учитываем их размер при расчёте размера очереди, и не активируем вкладку для событий по таким закачкам. Не показываем TTH для запросов IP и частичных файл листов, для DCLST показываем как и раньше.
# Вот теперь точно всё.
# [public-build]
------------------------------------------------------------------------
r14592 | pavel.pimenov@gmail.com | 2013-07-18 18:21:22 +0400 (Чт, 18 июл 2013) | 1 line

# Ежик! прекращай ставить такие левые скобки :)
------------------------------------------------------------------------
r14591 | pavel.pimenov@gmail.com | 2013-07-18 18:19:46 +0400 (Чт, 18 июл 2013) | 2 lines

# Добавлен профилировщик http://floodyberry.wordpress.com/2009/10/07/high-performance-cplusplus-profiling/
  TODO - похоронить все boost::atomic_int g_count_
------------------------------------------------------------------------
r14590 | pavel.pimenov@gmail.com | 2013-07-18 18:06:25 +0400 (Чт, 18 июл 2013) | 1 line

# [natpmp] Убрал странный дефайн "errno=WSAGetLastError()" из проекта
------------------------------------------------------------------------
r14589 | pavel.pimenov@gmail.com | 2013-07-18 18:03:12 +0400 (Чт, 18 июл 2013) | 1 line

# <FunctionLevelLinking>true</FunctionLevelLinking> для ReleaseFullOpt
------------------------------------------------------------------------
r14588 | a.rainman@gmail.com | 2013-07-18 17:18:35 +0400 (Чт, 18 июл 2013) | 2 lines

* В окне "Передачи" DCLST метафайл отображаются как список файлов, а не как обычный файл.
# Убрал лишние обновления статусов для DCLST, запросов IP, и не полных файл листов в окне "Передачи".
------------------------------------------------------------------------
r14587 | a.rainman@gmail.com | 2013-07-18 17:08:04 +0400 (Чт, 18 июл 2013) | 2 lines

* В окне "Завершённые скачивания" не отображаем запросы IP адреса.
* Для окна "Завершённые скачивания" DCLST приравнен к обычному файл листу, и теперь попадает в журнал только если включена опция "Журнал полученных списков файлов" http://flylinkdc.com/dokuwiki/doku.php?id=ru:logs .
------------------------------------------------------------------------
r14586 | a.rainman@gmail.com | 2013-07-18 16:59:36 +0400 (Чт, 18 июл 2013) | 1 line

* В Вебсервере подробнее выводим информацию о типе скачиваемого файла, помимо типов "файл", "папка", и "файл лист", отображаем так же "DCLST" и "проверка IP".
------------------------------------------------------------------------
r14585 | a.rainman@gmail.com | 2013-07-18 16:55:58 +0400 (Чт, 18 июл 2013) | 4 lines

* Исправление для функции получения IP адреса - не пытаемся искать альтернативные источники.
* Качаем DCLST с наивысшим приоритетом.
# Проведена ревизия в области использования и обработки флажков в очереди скачивания. Заливаю отдельно по модулям.
# (Closed Issue 1092) [Очередь] Падаем в DEBUG конфигурации при запросе IP
------------------------------------------------------------------------
r14584 | tret2003 | 2013-07-18 09:50:53 +0400 (Чт, 18 июл 2013) | 2 lines

* (Closed issue 1088) Звук скачивания файлов не должен звучать при скачивании списка файлов и запросе IP.
https://code.google.com/p/flylinkdc/issues/detail?id=1088
------------------------------------------------------------------------
r14583 | a.rainman@gmail.com | 2013-07-18 03:50:21 +0400 (Чт, 18 июл 2013) | 4 lines

# Issue 1095:	[crash-server] Топовые падения без стека в Speaker<TimerManagerListener>::fire<TimerManagerListener::X
# Исправлена крит. ошибка. В релизе под нагрузкой грохнулось :(
# [public-build]

------------------------------------------------------------------------
r14582 | a.rainman@gmail.com | 2013-07-18 02:36:50 +0400 (Чт, 18 июл 2013) | 6 lines

# Issue 1095:	[crash-server] Топовые падения без стека в Speaker<TimerManagerListener>::fire<TimerManagerListener::X
# Добавил диагностику двойного добавления, и попытки удаления зомби в простую реализацию матюгальнику.
# Сложную реализацию матюгальника почистил от универсального кода и лишнего диагностического вывода тем самым улучшил читабельность. Теперь либо используем FastSharedCriticalSection совместно с отключением IRAINMAN_USE_SIMPLE_SPEAKER, и получаем сложный асинхронный матюгальник, либо используем только простой, а при попытке собрать сложный получаем ошибку :) 
# [public-build]


------------------------------------------------------------------------
r14581 | a.rainman@gmail.com | 2013-07-18 02:13:18 +0400 (Чт, 18 июл 2013) | 4 lines

# Issue 1095:	[crash-server] Топовые падения без стека в Speaker<TimerManagerListener>::fire<TimerManagerListener::X
# Добавлена директива IRAINMAN_USE_SIMPLE_SPEAKER - по умолчанию вкл, она переводит матюгальник в простой режим работы.
# +r14578: там не было рекурсивного входа, поскольку этот кусок кода защищён m_speaking.

------------------------------------------------------------------------
r14580 | tret2003 | 2013-07-17 23:09:32 +0400 (Ср, 17 июл 2013) | 1 line

# [lang] an auto commit from localization system...
------------------------------------------------------------------------
r14579 | tret2003 | 2013-07-17 23:08:15 +0400 (Ср, 17 июл 2013) | 1 line

# [lang] an auto commit from localization system...
------------------------------------------------------------------------
r14578 | pavel.pimenov@gmail.com | 2013-07-17 22:35:45 +0400 (Ср, 17 июл 2013) | 3 lines

# [issue 1095] https://code.google.com/p/flylinkdc/issues/detail?id=1095
  - Исправлена двойная блокировка секций void removeListeners()
  - Перед вызовом обработчика проверяем, что он не находится в состояни смерти 
------------------------------------------------------------------------
r14577 | a.rainman@gmail.com | 2013-07-17 20:26:40 +0400 (Ср, 17 июл 2013) | 1 line

# AStyle.
------------------------------------------------------------------------
r14576 | a.rainman@gmail.com | 2013-07-17 20:25:53 +0400 (Ср, 17 июл 2013) | 4 lines

# UserInfoBaseHandlerTraits переименовано в UserInfoGuiTraits.
# Убрал менюшки для юзера из WinUtil в UserInfoGuiTraits.
# Для пользовательских менюшек осталось только сгрести код в одно место, для обработчиков статических меню.
# Пошёл пилить дальше.
------------------------------------------------------------------------
r14575 | pavel.pimenov@gmail.com | 2013-07-17 19:51:08 +0400 (Ср, 17 июл 2013) | 1 line

# define IRAINMAN_FASTS_QUEUE_MANAGER // Включил во всех конфигурациях TODO http://code.google.com/p/flylinkdc/issues/detail?id=1092
------------------------------------------------------------------------
r14574 | a.rainman@gmail.com | 2013-07-17 19:22:40 +0400 (Ср, 17 июл 2013) | 1 line

# AStyle.
------------------------------------------------------------------------
r14573 | a.rainman@gmail.com | 2013-07-17 18:56:51 +0400 (Ср, 17 июл 2013) | 10 lines

* Исправлено отображение меню для пред.просмотра. Не во всех фреймах оно было полным, кое где не было классического пред.просмотра и возможности запустить уже скачанный медиафайл.
* Проведена унификация и ревизия фич пред.просмотра. Пред.просмотр работает в фреймах "Передачи" и "Очередь скачивания", помимо этого фича "Качай-смотри" открывает дополнительные возможности и работает ещё в двух фреймах, это "Поиск" и "Очередь скачивания". Функционал никак не был изменён, изменения коснулись только гуя, и технических моментов реализации.
# DirectoryListingFrame::IsDVDFile унесена в FileImage.
# В FileImage добавлены методы: isBdFolder, isDvdFolder, isDvdFile.
# Добавлены классы PreviewBaseHandler и Preview.
# Почищено и исправлено меню в окне хаба. Русский перевод вообще не соответствует английскому, и именам в менеджере ресурсов :( Нужна сверка на сервере переводов.
# Вышел по сути на финальную стадию переделки менюшек. Осталось зачистить только их использование, заодно допроверю все тонкости работы, может найду ещё что то стрёмное, или не работающее. Бетку пока всё же желательно не выпускать, тестим по серому, а то вони тьма будет, что менюшка где то двоится, или пункта где то не хватает.
# Плотно занимаюсь гуем Флая, хочу раз и навсегда похерить даже малейшую возможность наговнокодить, и скопипастить. Все механимзмы менюшек и их обработчиков потихоньку оборачиваю классами, что заставит писать в них, а не размазанно по проектку. В итоге получим универсальные, стабильные, а главные похожие друг на друга менюшки. И работать всё будет как надо, и юзер себе не будет задаваться бессмысленными вопросами почему в одном фрейме меню есть, а в другом нет.
# Мне этот рефакторинг не доставляет никакого удовольствия, ибо код местами просто ужасен, но его необходимо провести, ибо проект долгоживущий, и обрастание подобной лапшой для него смертельно. 
# [public-build]
------------------------------------------------------------------------
r14572 | pavel.pimenov@gmail.com | 2013-07-17 18:18:39 +0400 (Ср, 17 июл 2013) | 1 line

# Astyle [public-build]
------------------------------------------------------------------------
r14571 | pavel.pimenov@gmail.com | 2013-07-17 18:17:17 +0400 (Ср, 17 июл 2013) | 3 lines

* (Closed issue 1084) http://code.google.com/p/flylinkdc/issues/detail?id=1084  (Спасибо Gap51)
   Убрал паразитные попытки открыть файл .antifrag http://www.flickr.com/photos/96019675@N02/9302854303/
# При ошиюках в void QueueManager::moveFile_ логируем целевой файл
------------------------------------------------------------------------
r14570 | pavel.pimenov@gmail.com | 2013-07-17 18:14:22 +0400 (Ср, 17 июл 2013) | 4 lines

# Добавил диагностику aUser.hint.empty() - Хинт в Adc хабе пустой. поправить иначе источник из листа ложится в очередь без хаба
# Вернул void ConnectionManager::shutdown() сброс рейтинга ( возникает иногда когда завершают прога а закчки еще висят)
  http://code.google.com/p/flylinkdc/issues/detail?id=1037

------------------------------------------------------------------------
r14569 | pavel.pimenov@gmail.com | 2013-07-17 18:08:53 +0400 (Ср, 17 июл 2013) | 1 line

* Исправлен алгоритм сохранения LastIP - не всегда работало под Win8 в режиме "Запросить IP адрес" (Спасибо Gap51 за тестирование и подробные логи)
------------------------------------------------------------------------
r14568 | tret2003 | 2013-07-17 10:56:47 +0400 (Ср, 17 июл 2013) | 1 line

# Заменил переменную на ссылку
------------------------------------------------------------------------
r14567 | tret2003 | 2013-07-17 10:45:52 +0400 (Ср, 17 июл 2013) | 1 line

# Забытые скобочки
------------------------------------------------------------------------
r14566 | a.rainman@gmail.com | 2013-07-17 10:38:56 +0400 (Ср, 17 июл 2013) | 1 line

# Исправил предупреждение при сборке релиза.
------------------------------------------------------------------------
r14565 | a.rainman@gmail.com | 2013-07-17 10:16:55 +0400 (Ср, 17 июл 2013) | 5 lines

* Оптимизация в окнах "Передачи", "Очередь скачивания", и "Очереди отдачи" - группируем события и обрабатываем их кучей раз в секунду.
* Исправлено зависание в окне "Передачи".
# (Issue 1082) [DeadLock] Очередь - вешаемся (Ежик не все исправил.)
# В TaskQueue добавлен метод empty().
# [public-build]
------------------------------------------------------------------------
r14564 | tret2003 | 2013-07-17 09:27:17 +0400 (Ср, 17 июл 2013) | 1 line

# Переосмыслил r14563
------------------------------------------------------------------------
r14563 | tret2003 | 2013-07-17 08:36:17 +0400 (Ср, 17 июл 2013) | 1 line

* (Closed issue 1086) в настройках Цветовой образец вида - после слова "Образец" три символа отс.в рус.шрифте (квадратиком)
------------------------------------------------------------------------
r14562 | tret2003 | 2013-07-17 07:20:43 +0400 (Ср, 17 июл 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1264, created 2013-07-17 10:19:21 +0700
   Total in database:
    - ISP - 1399
    - ISPs logo - 1408
    - Address range - 5940
   Archive CustomLocations.7z created by NightOrion


------------------------------------------------------------------------
r14561 | a.rainman@gmail.com | 2013-07-16 23:14:39 +0400 (Вт, 16 июл 2013) | 2 lines

# AStyle.
# [public-build]
------------------------------------------------------------------------
r14560 | a.rainman@gmail.com | 2013-07-16 23:12:32 +0400 (Вт, 16 июл 2013) | 2 lines

# В FavoriteManager добавлена реальная оптимизация в виде фичи IRAINMAN_NON_COPYABLE_FAV_DIRS.
# Мелкие исправления в менюшках.
------------------------------------------------------------------------
r14559 | a.rainman@gmail.com | 2013-07-16 23:12:22 +0400 (Вт, 16 июл 2013) | 1 line

# Убрал l_isPlaySound - данную функцию нужно всегда лочить целиком, иногда вместе с обвязкой (циклами), толку от этого флажка нету.
------------------------------------------------------------------------
r14558 | a.rainman@gmail.com | 2013-07-16 21:37:13 +0400 (Вт, 16 июл 2013) | 1 line

# +r14551 - убрал лишнюю проверку if (!IsNull()) в ClearMenu() - она нужна только на случай ели меню могут умереть, а этот момент уже переписан, и они просто так не удаляются.
------------------------------------------------------------------------
r14557 | a.rainman@gmail.com | 2013-07-16 21:36:57 +0400 (Вт, 16 июл 2013) | 1 line

# Исправлена ошибка внутри QueueManager::addSourceL - забыл убрать рекурсивный вход в секцию. Секция внутри не нужна, и более того опасна, ибо может приводить к дедлокам, если её заранее не залочить в циклах.
------------------------------------------------------------------------
r14556 | a.rainman@gmail.com | 2013-07-16 21:27:39 +0400 (Вт, 16 июл 2013) | 1 line

# +r14553 не всё лочили что надо.
------------------------------------------------------------------------
r14555 | pavel.pimenov@gmail.com | 2013-07-16 21:10:39 +0400 (Вт, 16 июл 2013) | 1 line

# Звук PLAY_SOUND(SOUND_SOURCEFILE); играем без лока UniqueLock l(QueueItem::cs)
------------------------------------------------------------------------
r14554 | pavel.pimenov@gmail.com | 2013-07-16 20:12:01 +0400 (Вт, 16 июл 2013) | 1 line

# Astyle
------------------------------------------------------------------------
r14553 | pavel.pimenov@gmail.com | 2013-07-16 20:10:31 +0400 (Вт, 16 июл 2013) | 4 lines

# [issue 1082] http://code.google.com/p/flylinkdc/issues/detail?id=1082
  Сократил время блокировки в void QueueManager::on(SearchManagerListener::SR
  Вероятно исправил лок
  Если починил - написать qi->isSource() - будет красивее
------------------------------------------------------------------------
r14552 | pavel.pimenov@gmail.com | 2013-07-16 18:46:22 +0400 (Вт, 16 июл 2013) | 1 line

# Исключил копию массива структур FavoriteManager::FavDirList и заменил на простой вектор от string
------------------------------------------------------------------------
r14551 | pavel.pimenov@gmail.com | 2013-07-16 18:28:02 +0400 (Вт, 16 июл 2013) | 1 line

# Упразднил WinUtil::clearMenu - ей место в виде метода
------------------------------------------------------------------------
r14550 | pavel.pimenov | 2013-07-16 16:31:51 +0400 (Вт, 16 июл 2013) | 5 lines

# Убрал лишние создание копии getFavoriteDirs в FavoriteManager::save()
# Добавлен FavoriteManager::getInstance()->getFavoriteDirsCount() для исключения создания копии вектора структур!
# Метод DirectoryListingFrame::appendTargetMenu фикс копипасты   
  TODO - просмотреть вызовы FavoriteManager::getInstance()->getFavoriteDirs() есть избыточность копии

------------------------------------------------------------------------
r14549 | a.rainman@gmail.com | 2013-07-16 15:26:27 +0400 (Вт, 16 июл 2013) | 4 lines

# Доработка BaseImageList и наследников в области рисования.
# В первом приближении добавлен класс LastDir, пока не полная интеграция в области меню с SearchFrame. TODO: обобщить формирование меню, и добавление папок.
# Поправлены менюшки, они пока не совсем кошерные, но зато все работают.
# [public-build]
------------------------------------------------------------------------
r14548 | a.rainman@gmail.com | 2013-07-16 15:26:17 +0400 (Вт, 16 июл 2013) | 1 line

# В QueueFrame::getItemInfo убрал отладочный лог.
------------------------------------------------------------------------
r14547 | pavel.pimenov | 2013-07-16 14:20:19 +0400 (Вт, 16 июл 2013) | 4 lines

# [DB] Исправлено двойное выполнение PRAGMA page_size=4096 для центральной базы
  Открываем базу после временной смены текущего каталога через SetCurrentDirectory без указания полного пути к файлу 
 (а то у жан-клодов вандамов и его родственником могут быть проблемы)
  http://www.sql.ru/forum/1034900/executenonquery-ne-podkluchaet-dopolnitelnyy-fayly-tablic-bd-esli-v-puti-k-nim-est
------------------------------------------------------------------------
r14546 | pavel.pimenov | 2013-07-16 14:16:58 +0400 (Вт, 16 июл 2013) | 2 lines

# Исправлены баги с иконками http://code.google.com/p/flylinkdc/source/detail?r=14540
  (нельзя объявлять в хедере глобальные объекты static. их экземпляры клонируются при каждом включении в cpp )
------------------------------------------------------------------------
r14545 | a.rainman@gmail.com | 2013-07-16 12:40:03 +0400 (Вт, 16 июл 2013) | 1 line

# AStyle.
------------------------------------------------------------------------
r14544 | a.rainman@gmail.com | 2013-07-16 12:37:32 +0400 (Вт, 16 июл 2013) | 6 lines

# Добавлены структуры Colors и Fonts.
# По следам r14539 проведена ревизия вызовов GetItemCount():
 - убил устаревшую WinUtil::getFirstSelectedIndex, заменив её на аналог GetSelectedIndex().
# Убрал лишние упоминания USE_SET_LIST_COLOR_IN_SETTINGS.
# Косметика именования методов.
# Часть 2. Теперь всё.
------------------------------------------------------------------------
r14543 | a.rainman@gmail.com | 2013-07-16 12:35:17 +0400 (Вт, 16 июл 2013) | 6 lines

# Добавлены структуры Colors и Fonts.
# По следам r14539 проведена ревизия вызовов GetItemCount():
 - убил устаревшую WinUtil::getFirstSelectedIndex, заменив её на аналог GetSelectedIndex().
# Убрал лишние упоминания USE_SET_LIST_COLOR_IN_SETTINGS.
# Косметика именования методов.
# Часть 1.
------------------------------------------------------------------------
r14542 | pavel.pimenov | 2013-07-16 12:19:36 +0400 (Вт, 16 июл 2013) | 1 line

# Забыл virtual ~BaseImageList() и инициализацию счетчиков
------------------------------------------------------------------------
r14541 | scalolaz_scat@mail.ru | 2013-07-16 11:59:32 +0400 (Вт, 16 июл 2013) | 1 line

# Пнул транк, убрал центровку "Списка команд чата"
------------------------------------------------------------------------
r14540 | a.rainman@gmail.com | 2013-07-16 10:18:09 +0400 (Вт, 16 июл 2013) | 1 line

# Добавил BaseImageList, почистил остальные коллекции иконок.
------------------------------------------------------------------------
r14539 | pavel.pimenov | 2013-07-16 10:00:13 +0400 (Вт, 16 июл 2013) | 9 lines

# FileFindIter уже внутри делает FormatPath - убрал дубликатный вызов
# В FinishedFrameBase выкинул totalCount (не понятно зачем этот ошметок)
# Дпил http://code.google.com/p/flylinkdc/source/detail?r=14533 (каталоги с большим кол-вом файлов должны открываться быстрее.)
  - FileImage::getIconIndex получает на вход string 
  - Хэш-мапа хранит расширения без точки
  - SHGetFileInfo зовется без лишнего Text::toLower
  - Во всех фреймах где показываем иконку файла вставку записей перевел на I_IMAGECALLBACK (FileImage::getIconIndex не зовется в момент загрузки списка)
  - Убрал вызов API GetItemCount() для подсчета кол-ва записей в списке (храним локально с ++)
    
------------------------------------------------------------------------
r14538 | a.rainman@gmail.com | 2013-07-16 09:04:07 +0400 (Вт, 16 июл 2013) | 1 line

# +r5601 - убрал задел для отрубания временного расширения.
------------------------------------------------------------------------
r14537 | a.rainman@gmail.com | 2013-07-16 08:40:04 +0400 (Вт, 16 июл 2013) | 1 line

# +r14533 - почистил код.
------------------------------------------------------------------------
r14536 | a.rainman@gmail.com | 2013-07-16 08:38:42 +0400 (Вт, 16 июл 2013) | 1 line

# Поправил многоточие в коде - некорректно выводилось.
------------------------------------------------------------------------
r14535 | a.rainman@gmail.com | 2013-07-16 07:56:34 +0400 (Вт, 16 июл 2013) | 3 lines

# Ревизия QueueManager::putDownload, часть 2 - убрал изменения в области проверки флажков, добавленные в r14534.
# [public-build]

------------------------------------------------------------------------
r14534 | a.rainman@gmail.com | 2013-07-16 07:22:51 +0400 (Вт, 16 июл 2013) | 4 lines

* (Closed Issue 1081) [DeadLock] Очередь - вешаемся на r14527 - Ежик тут был.
# Ревизия QueueManager::putDownload - убраны длинные локи.
# [public-build]

------------------------------------------------------------------------
r14533 | a.rainman@gmail.com | 2013-07-16 07:22:41 +0400 (Вт, 16 июл 2013) | 3 lines

# Создан класс FileImage, в который из WinUtil унесено часть функционала.
# [public-build]

------------------------------------------------------------------------
r14532 | a.rainman@gmail.com | 2013-07-16 06:50:23 +0400 (Вт, 16 июл 2013) | 1 line

* (Closed Issue 1081) [DeadLock] Очередь - вешаемся на r14527 - Ежик тут был.
------------------------------------------------------------------------
r14531 | a.rainman@gmail.com | 2013-07-16 06:05:17 +0400 (Вт, 16 июл 2013) | 1 line

# AStyle.
------------------------------------------------------------------------
r14530 | a.rainman@gmail.com | 2013-07-16 06:04:23 +0400 (Вт, 16 июл 2013) | 20 lines

* Исправлена ошибка при работе под нагрузкой: иногда при активном подключении к хабу выдавалось предупреждение "Вы подключены к хабу в пассивном режиме, рекомендуем переключиться в активный режим".
* При использовании поиска в пассивном режиме, и активном подключении к хабу добавлено предупреждение "You are in active mode, but have activated passive search. Don't use passive search if you have search results without this option because you don't get search result from passive clients!!!". Требуется обновление локализаций.
* Увеличена скорость открытия окна "Список контактов" при большом числе пользователей в нём.
* В ежовой исправлено зависание при открытии списка контактов, баг был добавлен недавно.
* Исправлено урезанное меню для поиска информации в сети в окне хаба.
* В окно личных сообщений добавлены контекстные меню для следующий действий: команда whois, копирование url, а так же меню для включения и выключения автоскролла.
# Технологический коммит.
# Заюзал ClientManager::UserParams, добавленный мной в r14527.
# Продолжаю выносить код в BaseChatFrame, добавлен метод PreparePopupMenu позволивший усовершенствовать окно личек, и убрать не хилое количество копипасты.
# Восстановил работу HubFrame::addDupeUsersToSummaryMenu. Она нужна! Проблемы с менюшками вполне вероятно поправятся после того как я их дорефакторю, ибо уже вычищено значительное количество ошибок с их разрушением.
# В UsersFrame устранена ошибка в реализации - она преводила к зависанию при одновременном включении фич IRAINMAN_NON_COPYABLE_FAV_USERS и IRAINMAN_USE_SPIN_LOCK.
# Продолжаю перетаскивать функционал в UserInfoBaseHandler и WinUtil.
# Добавлен шаблон InternetSearchBaseHandler собравший в себя обработку поиска в интернете.
# Унификация appendUserItems и appendUserItemsForSingleUser.
# Зачищен код WinUtil::setupPreviewMenu.
# Удалил устаревшие функции в интерфейсах классов с меню, так же провёл переименование в базовых классах для точного определения какие именно элементы будут добавлены или почищены.
# Произведено захоронение фичи RIP_USE_CONNECTION_AUTODETECT - локализации убраны в код.
# Бетку пока не выпускать, менюшки не до конца зачищены. Там есть ошибки, к примеру в окне передач дублируются меню с инфой о юзере :) Однако я прошу проверить, что везде где надо меню появляются, и с необходимыми пунктами.
# [public-build]
# p.s: мне очень грустно, ибо у нас значительная часть гуя это копипаста, чуть чуть друг от друга отличающаяся, и с кучей ошибок :( Друзья, я вас очень прошу: перестаньте программировать копипастой.
------------------------------------------------------------------------
r14529 | a.rainman@gmail.com | 2013-07-16 05:43:32 +0400 (Вт, 16 июл 2013) | 1 line

# Из ConnectionManagerListener выпилены остатки от RIP_USE_CONNECTION_AUTODETECT.
------------------------------------------------------------------------
r14528 | a.rainman@gmail.com | 2013-07-16 00:58:21 +0400 (Вт, 16 июл 2013) | 4 lines

# Запретил копирование объектов OMenu, в классе забыли виртуализировать деструктор, однако унаследовали в CEmotionMenu.
# В CEmotionMenu добавил метод GetItemsCount, и запретил наследовать класс.
# [public-build]

------------------------------------------------------------------------
r14527 | a.rainman@gmail.com | 2013-07-15 22:34:28 +0400 (Пн, 15 июл 2013) | 1 line

# В ClientManager добавлена структура UserParams и дополнительная обвёртка для функции getUserParams. Расставлены забытые модификаторы const у методов.
------------------------------------------------------------------------
r14526 | scalolaz_scat@mail.ru | 2013-07-15 18:24:24 +0400 (Пн, 15 июл 2013) | 2 lines

# Обновлены Логи
[public-build]
------------------------------------------------------------------------
r14525 | scalolaz_scat@mail.ru | 2013-07-15 18:00:59 +0400 (Пн, 15 июл 2013) | 1 line

# к r14524: выпилил Джасека. Файл почти полностью переписан.
------------------------------------------------------------------------
r14524 | scalolaz_scat@mail.ru | 2013-07-15 17:56:21 +0400 (Пн, 15 июл 2013) | 3 lines

* [GUI AboutDlg]: Add Tab "Chat Commands"
- Remake /help string list
- Optimize to do... Нет, не так, - Оптимизируйте, кто хочет! Кажется ничего не забыл.
------------------------------------------------------------------------
r14523 | a.rainman@gmail.com | 2013-07-15 17:46:02 +0400 (Пн, 15 июл 2013) | 1 line

# Для директивы USE_SETTINGS_PATH_TO_UPDATA_DATA забыли выпилить код, связанный с PATH_ALL_USER_CONFIG.
------------------------------------------------------------------------
r14522 | pavel.pimenov | 2013-07-15 14:55:43 +0400 (Пн, 15 июл 2013) | 3 lines

# Исправлена поздняя инициализаци CFlylinkDBManager::newInstance() и LogManager::newInstance(); 
  Падало в режиме ведения логов в sqlite
* (Closed issue 1079) https://code.google.com/p/flylinkdc/issues/detail?id=1079
------------------------------------------------------------------------
r14521 | tret2003 | 2013-07-14 19:43:05 +0400 (Вс, 14 июл 2013) | 1 line

# [lang] an auto commit from localization system...
------------------------------------------------------------------------
r14520 | a.rainman@gmail.com | 2013-07-14 19:16:23 +0400 (Вс, 14 июл 2013) | 14 lines

* "Друзья/Враги" переименованы в "Список контактов". Уточнены описания пунктов меню игнорирования, теперь вместо общего термина "Игнорировать" введены термины: "Игнорировать ЛС" и "Игнорировать по имени".
* В ежовой версии исправлено зависание при сохранении списка игнорируемых по имени в настройках. Баг был добавлен недавно.
# Требуется обновление локализаций!
# Ежовая: В бета версиях в заголовок окна не выводится количество используемой памяти.
# (Processed Issue 621) Добавить в меню окна ЛС пункты для игнорирования и бана пользователя 
# (Processed Issue 777) Меню игнорировать пользователя на списке пользователей 
# Технологический коммит.
# Окончательно унёс механизм игнора по имени в ядро, и почистил код в той области. UserTraits так же унесён в ядро. HubFrame в связи с этим стал проще.
# UserInfoBaseHandler стал универсальным.
# Небольшая оптимизация по памяти в UserInfoBaseHandler: юзера и адрес хаба не храним для каждой вкладки, а используем один комплект на всех.
# В ежесекундном событии MainFrame поправлены вызовы PostMessage. TODO: надо как то по нормальному пофиксить это место, но не понятно как применить умный указатель к WinAPI.
# Почищен от копипасты обработчиков WaitingUsersFrame. Там же оптимизация - обновляем статус не чаще чем раз в секунду, и только когда окно свёрнуто. Там же UserPtr заменён на HintedUser.
# Бетку пока не выпускать, менюшки не до конца зачищены, да и перевод пока не сделан.
# [public-build]
------------------------------------------------------------------------
r14519 | a.rainman@gmail.com | 2013-07-14 19:16:01 +0400 (Вс, 14 июл 2013) | 2 lines

# Выключил отладочный лог в QueueItem::calcAndUpdateDownloadedBytes().
# Более строгая диагностика в Util::getIpCountry.
------------------------------------------------------------------------
r14518 | a.rainman@gmail.com | 2013-07-14 15:27:47 +0400 (Вс, 14 июл 2013) | 1 line

# Мелкая оптимизация в UploadManager - генерировать события без передачи ссылок на элементы менеджера можно без локов.
------------------------------------------------------------------------
r14517 | a.rainman@gmail.com | 2013-07-13 22:47:41 +0400 (Сб, 13 июл 2013) | 1 line

# AStyle.
------------------------------------------------------------------------
r14516 | a.rainman@gmail.com | 2013-07-13 22:34:41 +0400 (Сб, 13 июл 2013) | 1 line

# +r14515 - Удалён мёртвый код, оставшийся от  старого ядра struct ADCOnly и код из обвязки, на IRAINMAN_USE_UNIVERSAL_USER_MENU не обращайте внимания.
------------------------------------------------------------------------
r14515 | a.rainman@gmail.com | 2013-07-13 22:28:50 +0400 (Сб, 13 июл 2013) | 12 lines

# (Processed Issue 621) Добавить в меню окна ЛС пункты для игнорирования и бана пользователя 
# (Processed Issue 777) Меню игнорировать пользователя на списке пользователей 
# Меню выпилили во время глобального мержа со стронга на заре 500 версии, а потом так и не дописали код в той области. TODO: необходимо провести ревизию кода в области менюшек, там копипасты полно, как в самой генерации менюшек, так и в обработчиках.
# Технологический коммит.
# Обновлены директивы компиляции:
  - директивой FLYLINKDC_USE_SQL_EXPLORER выпилена недописанная фича по поддержке SQL Explorer.
  - добавлена IRAINMAN_ALLOW_ALL_CLIENT_FEATURES_ON_NMDC, в будущем позволит удобно добавлять фичи, которые поддерживаются только для adc.
# Для фичи FLYLINKDC_USE_SQL_EXPLORER дописал метод UserInfoBase::browseSqlExplorer, прокидывающий событие открытия окна через UserManager в обработчик события в MainFrame.
# Из MainFrame выпилен устаревший мембер m_OLDPriorityClass.
# AStyle.
# WaitingUsersFrame частично переведён на UserInfoBaseHandler. TODO: подробнее проанализировать WaitingUsersFrame и снести лишние обработчики.
# [public-build]
------------------------------------------------------------------------
r14514 | a.rainman@gmail.com | 2013-07-13 20:45:21 +0400 (Сб, 13 июл 2013) | 2 lines

# AStyle.
# Просьба пока AStyle более не запускать, ибо я ещё не залил реальные изменения. Коммент пишу.
------------------------------------------------------------------------
r14513 | a.rainman@gmail.com | 2013-07-13 17:53:18 +0400 (Сб, 13 июл 2013) | 3 lines

# В TypedListViewCtrl::forEachSelected добавил забытую блокировку перерисовки элементов, а она там обязательно нужна если функция удаляет элементы.
# [public-build]

------------------------------------------------------------------------
r14512 | a.rainman@gmail.com | 2013-07-13 17:32:37 +0400 (Сб, 13 июл 2013) | 1 line

# +r14502: убрал лишний virtual у деструктора MappingManager.
------------------------------------------------------------------------
r14511 | a.rainman@gmail.com | 2013-07-13 17:26:16 +0400 (Сб, 13 июл 2013) | 1 line

# +r14502: ошиблись в наследовании.
------------------------------------------------------------------------
r14509 | pavel.pimenov@gmail.com | 2013-07-13 07:45:32 +0400 (Сб, 13 июл 2013) | 1 line

# Log
------------------------------------------------------------------------
r14508 | pavel.pimenov@gmail.com | 2013-07-13 07:30:17 +0400 (Сб, 13 июл 2013) | 1 line

# Упс. не все вкоммитил
------------------------------------------------------------------------
r14507 | pavel.pimenov@gmail.com | 2013-07-13 07:18:41 +0400 (Сб, 13 июл 2013) | 2 lines

* r502-beta96
# Astyle
------------------------------------------------------------------------
r14504 | pavel.pimenov | 2013-07-12 14:16:32 +0400 (Пт, 12 июл 2013) | 1 line

# PVS-Studio
------------------------------------------------------------------------
r14503 | pavel.pimenov | 2013-07-12 13:52:54 +0400 (Пт, 12 июл 2013) | 1 line

# PVS-Studio V510 The 'debugTrace' function is not expected to receive class-type variable as xxx actual argument.
------------------------------------------------------------------------
r14502 | pavel.pimenov | 2013-07-12 11:45:28 +0400 (Пт, 12 июл 2013) | 7 lines

# Вынес Скалолаза в наследника https://code.google.com/p/flylinkdc/source/detail?r=14500
# В client забыл прописать HAVE_NATUPNP_H и убрал лишний деф HAS_PCH
  бага возникла при мерже со стронга когда
  Mapper_MiniUPnPc.cpp
  Mapper_NATPMP.cpp
  Mapper_WinUPnP.cpp
  Перенесли из windows в client а дефайн HAVE_NATUPNP_H забыли.
------------------------------------------------------------------------
r14501 | tret2003 | 2013-07-12 08:33:15 +0400 (Пт, 12 июл 2013) | 1 line

# Исправления апдейта, выявленные UpdateMaker v2.5
------------------------------------------------------------------------
r14500 | a.rainman@gmail.com | 2013-07-12 08:13:19 +0400 (Пт, 12 июл 2013) | 14 lines

# Исправлены проблемы с падениями в ListView: в forEach и forEachT забыли учесть, что произвольный доступ к элементам листа через getItemData, без предварительного поиска, никем не гарантирован, и апи может вернуть 0, если элемент с таким индексом в листе отсутствует. Так же добавил проверку в forEachSelectedT.

	DWORD_PTR GetItemData(int nItem) const
	{
		ATLASSERT(::IsWindow(m_hWnd));
		LVITEM lvi = { 0 };
		lvi.iItem = nItem;
		lvi.mask = LVIF_PARAM;
		BOOL bRet = (BOOL)::SendMessage(m_hWnd, LVM_GETITEM, 0, (LPARAM)&lvi);
		return (DWORD_PTR)(bRet ? lvi.lParam : NULL);
	}

# TODO: убрать фичу SCALOLAZ_MEDIAVIDEO_ICO в другое место :) всё таки нечего специфическому функционалу делать в универсальном листе. Рекомендую наследника создать для целей MediaInfo.
# [public-build]
------------------------------------------------------------------------
r14499 | a.rainman@gmail.com | 2013-07-12 08:13:14 +0400 (Пт, 12 июл 2013) | 1 line

# Перевёл SlotQueue в UploadManager с vector на list ибо clearUserFilesL производится удаление элемента из произвольного места, а стало быть будут реаллокации толстых объектов WaitingUser.
------------------------------------------------------------------------
r14498 | a.rainman@gmail.com | 2013-07-12 06:50:35 +0400 (Пт, 12 июл 2013) | 3 lines

* Исправлена проблема, приводившая к падениям https://www.crash-server.com/DumpGroup.aspx?ClientID=ppa&Login=Guest&DumpGroupID=71980 .
# +r14465 - по ошибке блокировали не ту секцию.
# [public-build]
------------------------------------------------------------------------
r14497 | a.rainman@gmail.com | 2013-07-12 06:30:25 +0400 (Пт, 12 июл 2013) | 4 lines

# +r14489. Проведена ревизия классов HIconWrapper, ExCImage, ResourceLoader:
 - почищен код;
 - небольшая экономия памяти за счёт выкидывания лишних мемберов из HIconWrapper;
 - убран лишний параметр из ExCImage::LoadFromResource - если необходимо получить ресурс из текущего модуля, достаточно просто передать NULL, никаких доп. флажков не требуется.
------------------------------------------------------------------------
r14496 | a.rainman@gmail.com | 2013-07-12 06:22:26 +0400 (Пт, 12 июл 2013) | 2 lines

# Дополнение к r14479: косметика. TODO: таким же образом необходимо получать коды из других библиотек?
# Оптимизация Util::getIETFLang().
------------------------------------------------------------------------
r14495 | a.rainman@gmail.com | 2013-07-12 06:21:44 +0400 (Пт, 12 июл 2013) | 1 line

# Убрал лишнюю строку из локали, оставил сообщение только в дебаге.
------------------------------------------------------------------------
r14494 | a.rainman@gmail.com | 2013-07-12 05:27:55 +0400 (Пт, 12 июл 2013) | 1 line

# Исправлена сборка Обозревателя порталов.
------------------------------------------------------------------------
r14490 | tret2003 | 2013-07-11 22:05:15 +0400 (Чт, 11 июл 2013) | 1 line

# [lang] an auto commit from localization system...
------------------------------------------------------------------------
r14489 | a.rainman@gmail.com | 2013-07-11 20:42:10 +0400 (Чт, 11 июл 2013) | 11 lines

* Устранены ошибки, снижавшие стабильность программы при использовании тем оформления.
# Дополнение к r14470 и r14483: диагностируем двойное выключение, и обязательность инициации выключения.
# ConnectionManager::shutdown() зовём один раз, и запрещаем создавать новые соединения в состоянии выключения.
# TODO: локализована явная проблема с сохранением рейтинга, и Last IP в базу: необходимо исправить невалидное сохранение из пустых коллекций в ConnectionManager::shutdown()!
# Навёл порядок в инициализации и выключении FlyFeatures: последовательность запуска - удаления, именование методов.
# Почищен код ThemeManager, в т.ч. убрано лишнее создание объекта на раннем этапе старта программы, всё равно до вызова initialize() менеджер не жив, а мёртв, а его единственный мембер - статический.
# Запретил ThemeManager перезагружать либу с темой во время работы ибо это потенциальные краши, при любой попытке сохранения настроек.
# Добавлена функция DestroySplash - подчищаем так же и строки за сплешем.
# В области сплеша наведён порядок - убраны копипастные проверки g_DisableSplash и кода.
# [public-build]

------------------------------------------------------------------------
r14488 | a.rainman@gmail.com | 2013-07-11 20:42:04 +0400 (Чт, 11 июл 2013) | 4 lines

# В BufferedSocket для m_disconnecting забыли volatile.
# Заинлайнил BufferedSocket::checkEvents() и BufferedSocket::checkSocket().
# В BufferedSocket::checkEvents() используем swap для тасков вместо копирования.
# В BufferedSocket::checkEvents() на всякий случай сбрасываем m_speaking после SHUTDOWN, это может пригодиться если кто то позовёт shutdown() дважды.
------------------------------------------------------------------------
r14487 | pavel.pimenov@gmail.com | 2013-07-11 19:38:16 +0400 (Чт, 11 июл 2013) | 1 line

# Log
------------------------------------------------------------------------
r14486 | pavel.pimenov@gmail.com | 2013-07-11 19:21:56 +0400 (Чт, 11 июл 2013) | 5 lines

# Временно отключил - addDupeUsersToSummaryMenu для теста 
  // http://www.flylinkdc.ru/2013/07/flylinkdc-r502-beta92-build-14457.html
  r502-beta94-x64 build 14474
  косяк с пкм после alt+d ни куда не делся 
  http://youtu.be/v0FqxSN9Q-0 
------------------------------------------------------------------------
r14485 | pavel.pimenov@gmail.com | 2013-07-11 19:10:04 +0400 (Чт, 11 июл 2013) | 1 line

* r502-beta95-test-1
------------------------------------------------------------------------
r14484 | pavel.pimenov@gmail.com | 2013-07-11 19:08:42 +0400 (Чт, 11 июл 2013) | 4 lines

# Исправляем мерцание хабов при старте CFlyLockWindowUpdate
  - TODO в HubFrame::openWindow убрать координаты окно и состояние
  - miniupnp [merge] добавлено получение имени роутера (часть 1)
  - Убрал опцию "Start Hubs minimized"
------------------------------------------------------------------------
r14483 | pavel.pimenov | 2013-07-11 10:06:08 +0400 (Чт, 11 июл 2013) | 2 lines

# TODO ShareManager::shutdown зовется дважды
  - По возможности используем const
------------------------------------------------------------------------
r14482 | pavel.pimenov | 2013-07-11 10:04:17 +0400 (Чт, 11 июл 2013) | 1 line

# Убрал дубликатные ;;
------------------------------------------------------------------------
r14479 | pavel.pimenov | 2013-07-11 09:39:26 +0400 (Чт, 11 июл 2013) | 2 lines

* (Closed issue 1077) http://code.google.com/p/flylinkdc/issues/detail?id=1077 
   Исправлена трансляция ошибок от wininet. теперь в журналы выводится не только код но и описание ошибки (for merge)
------------------------------------------------------------------------
r14478 | pavel.pimenov | 2013-07-11 08:40:50 +0400 (Чт, 11 июл 2013) | 1 line

# Откатил http://code.google.com/p/flylinkdc/source/detail?r=14466
------------------------------------------------------------------------
r14477 | a.rainman@gmail.com | 2013-07-11 08:37:52 +0400 (Чт, 11 июл 2013) | 6 lines

* Обновлён список несовместимого ПО http://flylinkdc.com/dokuwiki/doku.php?id=ru:incompatiblesoftware ( оригинал: http://flylinkdc.com/dokuwiki/doku.php?id=en:incompatiblesoftware ):
 - добавлен "Overwolf Overlay" - на данный момент 44 дампа;
 - добавлен "Ad Muncher" - на данный момент 9 дампов;
 - добавлено детектирование 64х битной версии проблемной "NVIDIA Application Filter", на данный момент 25 дампов от 32х битной версии и 11 от 64 х битной, итого 36.
# [public-build]

------------------------------------------------------------------------
r14476 | pavel.pimenov@gmail.com | 2013-07-11 06:58:17 +0400 (Чт, 11 июл 2013) | 4 lines

# Причину паденяи тут не локализовал:
  https://www.crash-server.com/DumpGroup.aspx?ClientID=ppa&Login=Guest&DumpGroupID=71745
  Но нашел по этой наводке структуру EXPECTED_CONNECTION_STRUCT убрал лишнее копирование в конструкторе. (странно, что PVS это не заметил)
  Изменил имя EXPECTED_CONNECTION_STRUCT - большими буквами принято называть макросы.
------------------------------------------------------------------------
r14475 | pavel.pimenov@gmail.com | 2013-07-11 06:39:44 +0400 (Чт, 11 июл 2013) | 1 line

# Log
------------------------------------------------------------------------
r14474 | pavel.pimenov@gmail.com | 2013-07-11 06:18:47 +0400 (Чт, 11 июл 2013) | 1 line

# Astyle
------------------------------------------------------------------------
r14473 | pavel.pimenov@gmail.com | 2013-07-11 06:18:10 +0400 (Чт, 11 июл 2013) | 1 line

* r502-beta94
------------------------------------------------------------------------
r14472 | a.rainman@gmail.com | 2013-07-11 04:34:40 +0400 (Чт, 11 июл 2013) | 8 lines

* Увеличена скорость закрытия окон файл-листов и поиска.
* Исправлены падения в области новой фоновой очереди к fly-server.
# Установил а CFlyServerJSON::postQuery таймоут на подключение к серверу равным 1 секунде, и обернул хендлы в CInternetHandle.
# Уменьшено время глубокого сна, а так же увеличено время для CFlyServerQueryThread, а приоритет фонового потока поднят с низкого до нормального.
# m_previous_tick сохраняем для каждой вкладки, иначе не от всех вкладок запросы попадают в очередь поскольку подписка на TimerManager строго последовательная. TODO: лимитировать именно подключения к серверу, а не обработку записей в окне.
# В GUI перенёс удаление подписок на события из деструктора в onClose! Сперва отписываемся от событий, а лишь потом начинаем разрушать объекты.
# Исправлены зависания при ожидании завершения фонового потока для очереди к fly-server.
# [public-build]
------------------------------------------------------------------------
r14471 | a.rainman@gmail.com | 2013-07-11 04:34:28 +0400 (Чт, 11 июл 2013) | 4 lines

# Ревизия BackgroundTaskExecute:
  - в отладке добавлена запись id запущенного потока.
  - в startThread() забыли сбросить состояние активности потока после неудачного запуска.
# Исправление в Thread::start(): пытаемся повторно запустить поток, а уже потом создаём исключение.
------------------------------------------------------------------------
r14470 | a.rainman@gmail.com | 2013-07-11 04:34:19 +0400 (Чт, 11 июл 2013) | 3 lines

* Увеличена скорость завершения приложения.
# Сперва отписываемся от событий, а лишь потом начинаем выключение и разрушение объектов.
# Небольшая оптимизация при завершении работы: раньше зовём ShareManager::shutdown.
------------------------------------------------------------------------
r14469 | pavel.pimenov@gmail.com | 2013-07-10 22:45:10 +0400 (Ср, 10 июл 2013) | 1 line

# Log
------------------------------------------------------------------------
r14468 | pavel.pimenov@gmail.com | 2013-07-10 22:20:17 +0400 (Ср, 10 июл 2013) | 1 line

* r502-beta93
------------------------------------------------------------------------
r14467 | pavel.pimenov@gmail.com | 2013-07-10 22:19:38 +0400 (Ср, 10 июл 2013) | 1 line

# Astyle
------------------------------------------------------------------------
r14466 | pavel.pimenov@gmail.com | 2013-07-10 22:19:07 +0400 (Ср, 10 июл 2013) | 3 lines

# Попытка найти причину http://code.google.com/p/flylinkdc/issues/detail?id=1076
  Событие PostMessage(WM_CLOSE) шлем после обхода глобального контейнера g_frames
  Есть предположение, что в момент обхода он изменяется.
------------------------------------------------------------------------
r14465 | a.rainman@gmail.com | 2013-07-10 21:26:15 +0400 (Ср, 10 июл 2013) | 16 lines

* (Closed Issue 1048) Исправлена работа автобана, ранее если сообщение о автобане в ЛС было отключено, то автобан не работал https://code.google.com/p/flylinkdc/issues/detail?id=1048 .
* Автобан: исправлена работа опции "Период сообщений (0 - отключить ЛС), мин". Ранее настройка времени игнорировалась, и клиент спамил сообщениями раз в секунду, в случае если опция была установлена в значение отличное от 0.
* Повышена отзывчивость программы.
* Работа менеджера, отвечающего за раздачу файлов, оптимизирована под многоядерные и многопроцессорные системы путём разделения механизмов.
# Продолжаем оптимизировать программу под многоядерные процессоры.
# В UploadManager, в дополнение к ранее добавленной мной FastCriticalSection csDos для защиты механизма противодействия DDoS, так же заменена единственная крит. секция менеджера на несколько раздельных:
  - CriticalSection m_csUploads - для защиты механизма отдач.
  - CriticalSection m_csQueue - для защиты механизма очереди.
  - FastSharedCriticalSection m_csReservedSlots - для защиты механизма резервирования слотов.
  - FastSharedCriticalSection m_csBans - для защиты механизма автобанилки.
# Данные изменения позволят значительно сократить длинные блокировки менеджера, что в свою очередь повышает отзывчивость программы, и значительно увеличивает производительность программы в области передачи файлов юзерам на многоядерных процессорах.
# Обновлены ключи компиляции:
  - добавлена директива IRAINMAN_USE_NG_CORE, с её помощью будут в течении этой недели будут потихоньку включены фичи из ежовой.
  - добавлена IRAINMAN_NON_COPYABLE_DATA_IN_UPLOAD_MANAGER - позволяющий избежать копирования данных в UploadManager, это стало возможно благодаря рефакторингу описанному выше.
# [public-build]

------------------------------------------------------------------------
r14464 | a.rainman@gmail.com | 2013-07-10 21:22:48 +0400 (Ср, 10 июл 2013) | 1 line

# Опечатка в диагностике TRACING_LONG_WAITS.
------------------------------------------------------------------------
r14463 | a.rainman@gmail.com | 2013-07-10 20:34:52 +0400 (Ср, 10 июл 2013) | 1 line

# [issue 1073] +r14461: ещё немного оптимизировал.
------------------------------------------------------------------------
r14462 | a.rainman@gmail.com | 2013-07-10 20:34:24 +0400 (Ср, 10 июл 2013) | 1 line

# Отключил ассерт в диагностике TRACING_LONG_WAITS. В дебаге многие вещи выполняются долго из-за огромного количества диагностик, так что если всё действительно повиснет запись можно будет найти в логе, а лишний раз отвлекаться на данный ассерт смысла нет.
------------------------------------------------------------------------
r14461 | tret2003 | 2013-07-10 19:07:11 +0400 (Ср, 10 июл 2013) | 1 line

# [issue 1073] Быстрая оптимизация по предложению ежа.
------------------------------------------------------------------------
r14460 | pavel.pimenov | 2013-07-10 12:51:34 +0400 (Ср, 10 июл 2013) | 3 lines

# removeListener для TimerManager выполняем в обратном порядке
# Добавлен конфиг-параметр отвечающий за периодичность запросов к флай-серверу minimal_interval
  если значение в конфиге нет или меньше 500. выставляется дефолтное = 2000
------------------------------------------------------------------------
r14459 | tret2003 | 2013-07-10 12:34:25 +0400 (Ср, 10 июл 2013) | 1 line

# Добавил упущенный пробел в окне поиска
------------------------------------------------------------------------
r14458 | pavel.pimenov@gmail.com | 2013-07-10 06:49:19 +0400 (Ср, 10 июл 2013) | 1 line

# Log
------------------------------------------------------------------------
r14457 | pavel.pimenov@gmail.com | 2013-07-10 06:21:40 +0400 (Ср, 10 июл 2013) | 1 line

* r502-beta92
------------------------------------------------------------------------
r14456 | a.rainman@gmail.com | 2013-07-10 04:38:08 +0400 (Ср, 10 июл 2013) | 1 line

# Astyle
------------------------------------------------------------------------
r14455 | a.rainman@gmail.com | 2013-07-10 04:03:51 +0400 (Ср, 10 июл 2013) | 12 lines

# Исправлена проблема с очередью запросов к Fly Server.
# Добавлены классы CFlyServerAdapter и CFlyServerQueryThread, реализующие механизм очереди.
# Из GUI убран лишний код.
# Убран, вместе с опасным занулением в CFlyServerJSON::clear(), защитный мембер m_merge_count_process, он не нужен поскольку весь код гарантированно выполняется в единственном потоке планировщика, и повторные входы в функции невозможны.
# Косметика кода:
  - CFlyServerAppendix переименован в более лаконичное CFlyServerInfo. 
  - чуть поправил названия методов.
# TODO: заюзать CFlyServerQueryThread::setMinimalIntervalInMilliSecond для установки интервала из конфига, всю начинку мая сделал, но конфиг трогать не стал.
# TODO: Возможно получится перенести часть кода из гуя в CFlyServerAdapter, ну или в шаблон рядышком.
# p.s: изменения тестировались мной с 1 июля, в дебаге, и ежовом апдейте - проблем обнаружено не было. Вполне вероятно, что на днях уеду, так что дальше хранить локально эти изменения смысла не вижу. Если вдруг помешают, то их всегда можно откатить.
# p.p.s: совсем забыл, что в ежовой таймаут ожидания в окне поиска равен 30 с (в обычной 10).
# [public-build]
------------------------------------------------------------------------
r14454 | a.rainman@gmail.com | 2013-07-10 04:03:44 +0400 (Ср, 10 июл 2013) | 7 lines

# Обновлены ключи компиляции.
# Добавлен IRAINMAN_USE_SPIN_LOCK - для активации FastCriticalSection.
# Добавлен IRAINMAN_USE_NG_SPEAKER - переводит матюгальник на многопоточный режим работы, зависит от IRAINMAN_USE_SHARED_SPIN_LOCK. В обычной версии не тестировался, просто так включать не советую, ибо может вызвать дополнительные спонтанные креши и дедлоки в случайных местах, в коде, которого нет в ежовой.
# Добавлен IRAINMAN_USE_NON_RECURSIVE_BEHAVIOR - зависит от IRAINMAN_USE_SPIN_LOCK и IRAINMAN_USE_SHARED_SPIN_LOCK, обозначает места, требующие доработки под концепцию нового (многопоточного) ядра.
# В Thread.h добавлена диагностика рекурсивных входов в спинлоки ( TRACING_LONG_WAITS ), и длительных ожиданий ( SPIN_LOCK_TRACE_RECURSIVE_ENTRY ). Лучше выключать, ибо дают сильную нагрузку.
# Добавлен метод SharedCriticalSection::tryLockUnique.
# В SharedCriticalSection добавлена диагностика потенциального дедлока при попытке рекурсивной уникальной блокировки после совместной блокировки.
------------------------------------------------------------------------
r14453 | a.rainman@gmail.com | 2013-07-10 01:03:56 +0400 (Ср, 10 июл 2013) | 8 lines

# Дополнение к r14448.
# Восстановил логику для экрана IRAINMAN_USE_SEPARATE_CS_IN_CLIENT_MANAGER. В обычной версии пока включать не стоит, ибо там данная фича не тестировалась, и могут возникать дедлоки, поскольку в ежовой кода меньше. Так же прошу обратить внимание, что функционал зависит от IRAINMAN_USE_RECURSIVE_SHARED_CRITICAL_SECTION, а стало быть дедлоки могут возникунть в обычной версии на ровном месте. На днях залью трейсер зависонов, после этого можно будет включить и в обычной версии.
# В ClientManager::shutdown отменяем подписку на события TimerManager.
# Поправил логику CREATE_LOCK_INSTANCE_CM для генерации чистых имён классов.
# В ChatBot убрал лишний LockInstance для вызова ClientManager::findClient, ибо она уже содержит внутри крит.секцию, и в подобной блокировке не нуждается. p.s: Если нет постфикса L значит функция не нуждается во внешней блокировке.
# +r14451: забыл код для WebServerManager. Убрал лишние проверки из ClientManager::getHubNames (коллекция и так будет пустой) и ClientManager::getNicks (будет возвращён именно cid вместо имени для оффлайн юзера, доп. код не нужен).
# [public-build]

------------------------------------------------------------------------
r14452 | pavel.pimenov@gmail.com | 2013-07-09 23:17:13 +0400 (Вт, 09 июл 2013) | 1 line

# log
------------------------------------------------------------------------
r14451 | a.rainman@gmail.com | 2013-07-09 22:55:16 +0400 (Вт, 09 июл 2013) | 15 lines

# Для лога:
* Оптимизация завершение работы программы, FlightSDC++
  https://bitbucket.org/3F/flightsdc/commits/bd42ea5216d7395f3221549aa00d4d83613
# Дополнение к r14446
# Пост-обработка фикса из дружественно ветки FlightSDC++
  https://bitbucket.org/3F/flightsdc/commits/bd42ea5216d7395f3221549aa00d4d83613
# ClientManager::getHubNames допускает возврат пустого StringList, и это уже реализовано в модуле, убрал лишний код.
# ClientManager::getNicks не имеет права вернуть пустой массив, а в случае если юзер оффлайн должен вернуть CID вместо имени - исправлено. Лишние проверки так же убраны.
# Исправлена сборка при использовании IRAINMAN_USE_SPIN_LOCK.
# Оптимизация в AdcHub::findUser - разрешено использовать getFirstNick(), поскольку данный метод используется для поиска по нику пользователей, которые онлайн.
# Косметика именования и интерфейсов:
 - AdcHub::m_adc_users -> m_users
 - NmdcHub::users -> m_users
 - SigKill заменён общепринятым в ядре shutdown.
# В ClientManager::putOnline добавил ассерт, пока выключен, ибо некоторы хабы пытаются и в онлайн юзеров выводить во время выключения. TODO: провести ревизию кода Client и наследников.
------------------------------------------------------------------------
r14450 | a.rainman@gmail.com | 2013-07-09 22:37:00 +0400 (Вт, 09 июл 2013) | 4 lines

# Дополнение к r14445.
# Добавлена гораздо более оптимальная реализация countOnlineUsersGreaterThanL.
# Почищен код в области использования.
# TODO: мб стоит использовать более хитрый код, в данный момент он оставлен закоменченным. Хотя конечно вряд ли он понадобится.
------------------------------------------------------------------------
r14449 | pavel.pimenov@gmail.com | 2013-07-09 22:22:04 +0400 (Вт, 09 июл 2013) | 1 line

# Astyle
------------------------------------------------------------------------
r14448 | pavel.pimenov@gmail.com | 2013-07-09 22:20:50 +0400 (Вт, 09 июл 2013) | 7 lines

# - В момент завершения приложения и вызова setSigKill зачищаем мапы черезе .clear
  - Сделал секции статическми 
  - Упростил макрос CREATE_LOCK_INSTANCE_CM
 p.s.
   возможны падения в моменты закрытия. места буду ловить через краш сервер.
     

------------------------------------------------------------------------
r14447 | pavel.pimenov@gmail.com | 2013-07-09 19:26:24 +0400 (Вт, 09 июл 2013) | 1 line

# Astyle
------------------------------------------------------------------------
r14446 | pavel.pimenov@gmail.com | 2013-07-09 18:41:37 +0400 (Вт, 09 июл 2013) | 17 lines

# Обработка фикса из дружественно ветки FlightSDC++
  https://bitbucket.org/3F/flightsdc/commits/bd42ea5216d7395f3221549aa00d4d83613c2345
  Ожидаем увеличение скорости закрытия файлинка при большом кол-ве юзеров и хабов.
  TODO внимательнее погонять под нагрузкой!
  основная идея - быстрое разрушение контейнеров сохраняющих юзеров в момент закрытия приложения
  в методах void NmdcHub::clearUsers() и void AdcHub::clearUsers()
  побочный эффект от этого т.к. не для каждого убитого юзера не зовется ClientManager::getInstance()->putOffline
  то контейнера onlineUsers в ClientManager остается не валидным и все обращения к нему при ключе g_isSigKill = true должны быть запрещены.
  придумать как это сделать красивее - может Ежик свежим взглядом что придумает.
  Пока заткнул условием if(g_isSigKill == false) явные падения в момент закрытия если есть активные закачки.
  В связи с чем нельзя обращзаться вот так к никам и хабам ClientManager::getInstance()->getNicks(ii->m_hinted_user)[0]
  коллекция ников может вернуться пустой!
  TODO - обощить конструкцию вида
	const auto& l_nick = ClientManager::getInstance()->getNicks(aDirList.getHintedUser());
	if(!l_nick.empty())
	  params["userNI"] = l_nick[0];

------------------------------------------------------------------------
r14445 | pavel.pimenov@gmail.com | 2013-07-09 18:31:35 +0400 (Вт, 09 июл 2013) | 4 lines

# Метод QueueItem::countOnlineUsersL всегда подсчитывал кол-во всех онлайн юзеров
  это нужно не всегда в некоторых случаях достаточно чтобы выполнилось условие когда их кол-во больше X
  Добавляем дефолтный параметр со стоп-кеем.
  TODO возможно это криво и не дает экономии...
------------------------------------------------------------------------
r14444 | pavel.pimenov@gmail.com | 2013-07-09 18:23:39 +0400 (Вт, 09 июл 2013) | 1 line

# Перевел sizeof -> _countof для общности обработки sn*printf
------------------------------------------------------------------------
r14443 | tret2003 | 2013-07-09 16:03:46 +0400 (Вт, 09 июл 2013) | 1 line

# [lang] an auto commit from localization system...
------------------------------------------------------------------------
r14440 | tret2003 | 2013-07-09 06:57:07 +0400 (Вт, 09 июл 2013) | 1 line

# Копипаста зло.
------------------------------------------------------------------------
r14439 | tret2003 | 2013-07-09 06:56:03 +0400 (Вт, 09 июл 2013) | 1 line

# Дополнение r14434
------------------------------------------------------------------------
r14437 | a.rainman@gmail.com | 2013-07-08 23:59:45 +0400 (Пн, 08 июл 2013) | 3 lines

# log:
 - убрал лишнее жирное выделение записей для версий в конце лога.
 - в полном логе убрал дубликаты записей для 502-beta-88, которые уже есть в 502-beta-87.
------------------------------------------------------------------------
r14436 | a.rainman@gmail.com | 2013-07-08 22:30:00 +0400 (Пн, 08 июл 2013) | 1 line

# Ревизия FileFindIter.
------------------------------------------------------------------------
r14435 | tret2003 | 2013-07-08 22:27:46 +0400 (Пн, 08 июл 2013) | 1 line

# Добавил забытое временное расширение
------------------------------------------------------------------------
r14434 | tret2003 | 2013-07-08 22:09:14 +0400 (Пн, 08 июл 2013) | 1 line

# Заменил ссылку на объект и добавил потерянную * в маску.
------------------------------------------------------------------------
r14433 | tret2003 | 2013-07-08 21:36:49 +0400 (Пн, 08 июл 2013) | 1 line

# [Log]
------------------------------------------------------------------------
r14432 | tret2003 | 2013-07-08 21:02:08 +0400 (Пн, 08 июл 2013) | 1 line

# Astyle
------------------------------------------------------------------------
r14431 | tret2003 | 2013-07-08 20:59:49 +0400 (Пн, 08 июл 2013) | 1 line

* Добавлен CustomBlockShare.ini для обновления списка исключаемых из шары файлов
------------------------------------------------------------------------
r14429 | a.rainman@gmail.com | 2013-07-08 20:07:16 +0400 (Пн, 08 июл 2013) | 4 lines

# Технологический коммит.
# Проведена ревизия классов, самостоятельно запускающих, и управляющих потоками - исправлены найденные ошибки в элементах синхронизации.
# Дописана USING_IDLERS_IN_CONNECTION_MANAGER_PLEASE_CHECK_ME. TODO: возможно стоит использовать отложенную проверку, дабы более быстро создавать соединения.
# [public-build]
------------------------------------------------------------------------
r14428 | a.rainman@gmail.com | 2013-07-08 20:06:08 +0400 (Пн, 08 июл 2013) | 3 lines

* Улучшение CDM отладчика: теперь в отладчике отображается реальное время наступления события, а не время, в которое событие было выведено на экран.
# Проведена ревизия и унификация кода.
# В ядро была добавлена структура DebugTask, в которую была унесена логика форматирования, и благодаря которой проведена унификация сообщений.
------------------------------------------------------------------------
r14427 | a.rainman@gmail.com | 2013-07-08 14:22:25 +0400 (Пн, 08 июл 2013) | 4 lines

# Технологический коммит.
# В UPNPCheckDlg большинство мемберов константы.
# В проекте перенёс файлы UPNPCheckDlg в подпапку Wizard.
# Более полное выпиливание фичи SSA_WIZARD_FEATURE.
------------------------------------------------------------------------
r14426 | pavel.pimenov@gmail.com | 2013-07-07 22:57:34 +0400 (Вс, 07 июл 2013) | 1 line

* r502-beta91
------------------------------------------------------------------------
r14424 | a.rainman@gmail.com | 2013-07-07 20:53:57 +0400 (Вс, 07 июл 2013) | 4 lines

* Исправлена ошибка, приводившая к блокировке системной очереди сообщений при открытии битторент ссылке во Флае:
 <Gap51> кликнул по магнетссылке на сайте, не обратил внимание что система предлагает её открыть флаем - согласился. флай и ссылку не открыл и систему намертво повесил.
# [public-build]

------------------------------------------------------------------------
r14423 | a.rainman@gmail.com | 2013-07-07 20:06:36 +0400 (Вс, 07 июл 2013) | 2 lines

* (Closed Issue 678) Не работают индивидуальные ограничения скорости по пользователям https://code.google.com/p/flylinkdc/issues/detail?id=678 .
# [public-build]
------------------------------------------------------------------------
r14422 | a.rainman@gmail.com | 2013-07-07 20:06:31 +0400 (Вс, 07 июл 2013) | 1 line

# Косметика в StatsFrame.
------------------------------------------------------------------------
r14421 | a.rainman@gmail.com | 2013-07-07 16:27:47 +0400 (Вс, 07 июл 2013) | 6 lines

* Исправлена утечка памяти при длительной работе программы.
# В FinishedManager исправлена утечка памяти.
# В ежесекундном событии ConnectionManager исправлен потенциальный дедлок, актуально только при включении директивы IRAINMAN_USE_RECURSIVE_SHARED_CRITICAL_SECTION. В общем фикс для ежовой, в обычной этого бага не было.
# Обновлены ключи компиляции:
 - Добавлены директивы IRAINMAN_USE_SEPARATE_CS_IN_FAVORITE_MANAGER, IRAINMAN_USE_SEPARATE_CS_IN_FINISHED_MANAGER, IRAINMAN_USE_SEPARATE_CS_IN_CLIENT_MANAGER - позволяющие отключать соответствующий функционал.
# [public-build]
------------------------------------------------------------------------
r14420 | a.rainman@gmail.com | 2013-07-07 16:27:37 +0400 (Вс, 07 июл 2013) | 4 lines

# Исправлена ошибка в CFlylinkDBManager::addSource: забывали устанавливать тип юзера перед апдейтом ника, подробнее r14334.
# В CFlylinkDBManager::addSource так же проверяем адрес хаба.
# Добавлена Util::isNmdcHub.
# Отключил лишние для IRAINMAN_SAVE_ALL_VALID_SOURCE диагностики.
------------------------------------------------------------------------
r14419 | a.rainman@gmail.com | 2013-07-07 16:27:25 +0400 (Вс, 07 июл 2013) | 1 line

# Почистил код UserManager в области списка игнорируемых.
------------------------------------------------------------------------
r14418 | a.rainman@gmail.com | 2013-07-07 07:42:09 +0400 (Вс, 07 июл 2013) | 2 lines

# Оптимизация в области IRAINMAN_USE_SEPARATE_CS_IN_QUEUE_MANAGER: исключаем лишние рекурсивные входы, слишком частые входы, и т.п. проблемы. Убрал лишнюю секцию QueueManager::UserQueue::csUQ.
# [public-build]
------------------------------------------------------------------------
r14417 | a.rainman@gmail.com | 2013-07-07 04:56:42 +0400 (Вс, 07 июл 2013) | 1 line

# Исправлена в SharedCriticalSection::lockShared.
------------------------------------------------------------------------
r14416 | a.rainman@gmail.com | 2013-07-07 04:56:25 +0400 (Вс, 07 июл 2013) | 2 lines

# IRAINMAN_NON_COPYABLE_SOURCE_LIST_IN_QUEUE_FRAME переименована в IRAINMAN_NON_COPYABLE_SOURCE_LIST_IN_QUEUE_MANAGER, и немного расширена область её действия, функции QueueManager: getSources и getBadSources теперь запрещено использовать. TODO: вероятно стоит вообще добавить LockInstance в это место.
# Ежовая: выключил IRAINMAN_USE_SEPARATE_CS_IN_QUEUE_MANAGER. Вероятно скоро совсем снесу, ибо придумал как переписать более няшно.
------------------------------------------------------------------------
r14411 | pavel.pimenov | 2013-07-06 09:42:12 +0400 (Сб, 06 июл 2013) | 1 line

# Добавлена опция отключения сбора потерянных локаций 
------------------------------------------------------------------------
r14408 | pavel.pimenov@gmail.com | 2013-07-05 21:43:29 +0400 (Пт, 05 июл 2013) | 1 line

# log
------------------------------------------------------------------------
r14400 | pavel.pimenov@gmail.com | 2013-07-05 19:38:48 +0400 (Пт, 05 июл 2013) | 1 line

* r502-beta90
------------------------------------------------------------------------
r14394 | pavel.pimenov@gmail.com | 2013-07-05 19:00:00 +0400 (Пт, 05 июл 2013) | 1 line

# [public-build] Astyle
------------------------------------------------------------------------
r14393 | pavel.pimenov@gmail.com | 2013-07-05 18:59:24 +0400 (Пт, 05 июл 2013) | 1 line

# [fly-server] Исправлена снихронизация медиа-информации с флай-сервером в случаях когда TTH+Size серверу "не известен"
------------------------------------------------------------------------
r14387 | tret2003 | 2013-07-05 00:58:17 +0400 (Пт, 05 июл 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1263, created 2013-07-05 03:39:08 +0700
   Total in database:
    - ISP - 1399
    - ISPs logo - 1408
    - Address range - 5937
   Archive CustomLocations.7z created by NightOrion


------------------------------------------------------------------------
r14383 | pavel.pimenov@gmail.com | 2013-07-04 22:45:52 +0400 (Чт, 04 июл 2013) | 1 line

# Точка падения в onRemove https://crash-server.com/Problem.aspx?ClientID=ppa&ProblemID=28506
------------------------------------------------------------------------
r14375 | pavel.pimenov@gmail.com | 2013-07-04 18:38:26 +0400 (Чт, 04 июл 2013) | 2 lines

# В парсере HD иконок по разрешению убрал лишние преобразования в tstring 
# В void QueueManager::add убрал создание лишнего временно объекта SearchManager::getInstance()->search(TTHValue(root).toBase32()
------------------------------------------------------------------------
r14374 | a.rainman@gmail.com | 2013-07-04 15:29:10 +0400 (Чт, 04 июл 2013) | 1 line

# +r14367 исправлена компиляция при выключении директивы _NO_DEADLOCK_TRACE
------------------------------------------------------------------------
r14373 | pavel.pimenov | 2013-07-04 13:28:25 +0400 (Чт, 04 июл 2013) | 1 line

# Убрал лишние FLYLINKDC_USE_MEDIAINFO_SERVER
------------------------------------------------------------------------
r14372 | tret2003 | 2013-07-04 11:14:47 +0400 (Чт, 04 июл 2013) | 1 line

# Откатил r14366
------------------------------------------------------------------------
r14371 | tret2003 | 2013-07-04 10:42:32 +0400 (Чт, 04 июл 2013) | 2 lines

# [merge] http://bazaar.launchpad.net/~dcplusplus-team/dcplusplus/trunk/revision/3319
[ADC] Send the LC (locale) parameter in INF
------------------------------------------------------------------------
r14370 | tret2003 | 2013-07-04 09:04:19 +0400 (Чт, 04 июл 2013) | 1 line

# Убрал из бекапа CustomCompressExt.ini, он контролируется апдейтом.
------------------------------------------------------------------------
r14369 | pavel.pimenov@gmail.com | 2013-07-04 06:26:40 +0400 (Чт, 04 июл 2013) | 2 lines

# Не компилировалось с выключеным IRAINMAN_SAVE_ALL_VALID_SOURCE

------------------------------------------------------------------------
r14368 | pavel.pimenov@gmail.com | 2013-07-04 06:06:34 +0400 (Чт, 04 июл 2013) | 1 line

* r502-beta89
------------------------------------------------------------------------
r14367 | a.rainman@gmail.com | 2013-07-04 01:42:12 +0400 (Чт, 04 июл 2013) | 9 lines

# Поправлены подозрительные моменты с блокировками в QueueManager.
# Ежовая: включил обратно IRAINMAN_USE_SEPARATE_CS_IN_QUEUE_MANAGER. Дополнительно включил в ежовой SCALOLAZ_PROPPAGE_COLOR - дабы лучше цеплялись темы.
# Проведена ревизия фичи IRAINMAN_USE_SEPARATE_CS_IN_QUEUE_MANAGER - подчищен код.
# Обновлены ключи компиляции.
# Исправлена работа опции FLYLINKDC_USE_BOOST_LOCK - не корректно ассоциировали локи с секциями, что вызвало ошибки компиляции в некоторых случаях.
# IRAINMAN_USE_READ_WRITE_LOCK переименована в IRAINMAN_USE_READ_WRITE_SPIN_LOCK.
# RECURSIVE_READ_WRITE_CRITICAL_SECTION_ENABLED переименована в IRAINMAN_USE_RECURSIVE_READ_WRITE_CRITICAL_SECTION и перенесена из Thread.h в compiler_flylinkdc.h.
# Теперь при отключении IRAINMAN_USE_READ_WRITE_SPIN_LOCK FastSharedCriticalSection переводятся на FastCriticalSection, что является более корректной заменой.
# За ~сутки тестирования багов не выявлено.
------------------------------------------------------------------------
r14366 | a.rainman@gmail.com | 2013-07-04 01:39:45 +0400 (Чт, 04 июл 2013) | 1 line

# ошибка компиляции.
------------------------------------------------------------------------
r14363 | a.rainman@gmail.com | 2013-07-03 21:30:29 +0400 (Ср, 03 июл 2013) | 2 lines

# Обновлены ключи компиляции.
# Добавлен ключ IRAINMAN_SAVE_ALL_VALID_SOURCE , сохраняющий частичные источники, и DHT источники. В ежовой вкл.
------------------------------------------------------------------------
r14357 | tret2003 | 2013-07-03 14:27:33 +0400 (Ср, 03 июл 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1261, created 2013-07-03 17:15:57 +0700
   Total in database:
    - ISP - 1399
    - ISPs logo - 1408
    - Address range - 5935
   Archive CustomLocations.7z created by NightOrion


------------------------------------------------------------------------
r14348 | pavel.pimenov@gmail.com | 2013-07-02 23:39:29 +0400 (Вт, 02 июл 2013) | 1 line

# [public-build] Astyle
------------------------------------------------------------------------
r14347 | pavel.pimenov@gmail.com | 2013-07-02 21:23:42 +0400 (Вт, 02 июл 2013) | 3 lines

# Источники FLAG_PARTIAL и с DHT не сбрасываются в базу данных для последующего восстановления
  Так реализовано в стронге и eiskaltdcpp. зачем Алексей вернул FLAG_PARTIAL не понятно. а фильтрацию с DHT мы забыли смержить
  Подробнее тут: http://code.google.com/p/flylinkdc/source/detail?r=14334
------------------------------------------------------------------------
r14346 | pavel.pimenov@gmail.com | 2013-07-02 20:48:31 +0400 (Вт, 02 июл 2013) | 2 lines

# Подгружаем рейтинг на всех операциях
# Вынес загрузку ников и хабов очереди в отдельные переменные для отладки
------------------------------------------------------------------------
r14345 | pavel.pimenov@gmail.com | 2013-07-02 18:25:12 +0400 (Вт, 02 июл 2013) | 2 lines

# TODO - Точка падения https://crash-server.com/Problem.aspx?ClientID=ppa&ProblemID=28097

------------------------------------------------------------------------
r14344 | pavel.pimenov | 2013-07-02 16:12:50 +0400 (Вт, 02 июл 2013) | 1 line

# Исправлена загрузка рейтинга для юзера, если закачка была в очереди, но прервалась на половинке по выходу
------------------------------------------------------------------------
r14343 | pavel.pimenov | 2013-07-02 15:33:30 +0400 (Вт, 02 июл 2013) | 1 line

# В UploadManager убрал не используемые методы
------------------------------------------------------------------------
r14342 | pavel.pimenov | 2013-07-02 15:20:58 +0400 (Вт, 02 июл 2013) | 2 lines

# Дополнение к http://code.google.com/p/flylinkdc/source/detail?r=14341
  user -> m_hinted_user
------------------------------------------------------------------------
r14341 | pavel.pimenov | 2013-07-02 13:00:07 +0400 (Вт, 02 июл 2013) | 1 line

# В DirectoryListingFrame не прокидывался хинт с урлом хаба. (ошибка мержа GUI части со StrongDC++)
------------------------------------------------------------------------
r14340 | pavel.pimenov | 2013-07-02 11:49:49 +0400 (Вт, 02 июл 2013) | 5 lines

# Дополнение к https://code.google.com/p/flylinkdc/source/detail?r=14334
  Добавил dcassert-ы и сохранение HubHint если источник всего 1
  TODO - проверить под нагрузкой
  

------------------------------------------------------------------------
r14339 | pavel.pimenov | 2013-07-02 11:33:32 +0400 (Вт, 02 июл 2013) | 6 lines

# К таблице очереди добавлено сохранение хаба https://code.google.com/p/flylinkdc/source/detail?r=14334
  не домержили в свое время со сторонга. :(
  TODO - посмотреть внимательнее и сделать сериализацию очереди как в оригинальном DC++ там не сохраняется лишний Nick в xml файл
  и тут его не нужно по идее в базу писать.
  

------------------------------------------------------------------------
r14338 | a.rainman@gmail.com | 2013-07-02 11:00:51 +0400 (Вт, 02 июл 2013) | 1 line

# Почистил свои ассерты в конструкторе простого MerkleTree.
------------------------------------------------------------------------
r14337 | a.rainman@gmail.com | 2013-07-02 10:54:04 +0400 (Вт, 02 июл 2013) | 3 lines

# Issue 804 Выпуск официальной ежовой версии (с ограниченным функционалом и оптимизацией в сторону высоких нагрузок):
- Отключил IRAINMAN_USE_SEPARATE_CS_IN_QUEUE_MANAGER.
- По умолчанию включена опция "Использовать ',' при обращении к Нику в чате, вместо ':'"
------------------------------------------------------------------------
r14336 | a.rainman@gmail.com | 2013-07-02 10:45:48 +0400 (Вт, 02 июл 2013) | 1 line

# Issue 1071: Ошибка в реализации алгоритма сохранения источников в БД: Сделал фичу с сохранением плохих источников выпиливаемой и выпилил.
------------------------------------------------------------------------
r14335 | a.rainman@gmail.com | 2013-07-02 07:38:26 +0400 (Вт, 02 июл 2013) | 2 lines

# В BackgroundTaskExecuter добавлен механизм ожидания завершения фонового потока - исправление ошибок.
# Почищен код исполнителей для BackgroundTaskExecuter.
------------------------------------------------------------------------
r14334 | a.rainman@gmail.com | 2013-07-02 07:22:47 +0400 (Вт, 02 июл 2013) | 4 lines

# (Closed Issue 1071) Ошибка в реализации алгоритма сохранения источников в БД:
- изменён алгоритм сохранения источников: теперь всё зависит от CID, а не от ника, нику разрешено быть пустым. ( подробнее см. Issue 849 Пропадают источники для файлов при перезагрузке программы. https://code.google.com/p/flylinkdc/issues/detail?id=849 )
- исправлен сброс источников в базу.
- коррекция в QueueItem: вместо количества сохранённых в базе суб.источников сохраняем только факт их наличия.
------------------------------------------------------------------------
r14332 | pavel.pimenov@gmail.com | 2013-07-01 23:20:23 +0400 (Пн, 01 июл 2013) | 2 lines

# Контроль в дебаге записи в базу данных очереди пустых ников и контроль чтения
  http://code.google.com/p/flylinkdc/source/detail?r=14284
------------------------------------------------------------------------
r14331 | pavel.pimenov@gmail.com | 2013-07-01 21:06:25 +0400 (Пн, 01 июл 2013) | 1 line

# log
------------------------------------------------------------------------
r14330 | pavel.pimenov@gmail.com | 2013-07-01 20:50:19 +0400 (Пн, 01 июл 2013) | 1 line

# log
------------------------------------------------------------------------
r14329 | pavel.pimenov@gmail.com | 2013-07-01 20:14:41 +0400 (Пн, 01 июл 2013) | 1 line

* r502-beta88
------------------------------------------------------------------------
r14328 | pavel.pimenov@gmail.com | 2013-07-01 20:02:47 +0400 (Пн, 01 июл 2013) | 4 lines

#(Closed issue) 1067 Косметика в bool getTTH(const string& p_target, TTHValue& p_tth)
# В ConnectionManager::shutdown() добавил сброс рейтинга и lastIP в базу даже если коллекции downloads и uploads не пустые
  Возможно исправится http://youtu.be/j1aKV9qOAxM  (ждем подтверждение Gap51 - часть 2)
# [public-build]
------------------------------------------------------------------------
r14327 | pavel.pimenov@gmail.com | 2013-07-01 19:56:25 +0400 (Пн, 01 июл 2013) | 4 lines

# Включил предкомпиляцию заголовков для FlyFeatures
  TODO - разобраться с 
         cl : Command line warning D9030: '/Yc' is incompatible with multiprocessing; ignoring /MP switch

------------------------------------------------------------------------
r14324 | pavel.pimenov@gmail.com | 2013-07-01 19:18:30 +0400 (Пн, 01 июл 2013) | 2 lines

# Экран FLYLINKDC_USE_MEDIAINFO_SERVER не все отрезал
 
------------------------------------------------------------------------
r14323 | a.rainman@gmail.com | 2013-07-01 11:13:20 +0400 (Пн, 01 июл 2013) | 12 lines

# Технологический коммит.
# Локализовал фичу FLYLINKDC_USE_MEDIAINFO_SERVER, и сделал её выпиливаемой.
# Небольшие исправления в HashManager::getMediaInfo - отложено зовём Text::fromT, преобразования в числа заменены на функции из Util (обеспечена корректная работа с локалями для вещественных чисел).
# Лёгкая оптимизация в CFlyMediaInfo::translateDuration.
# Исправлена ошибка в ShareManager::rebuildMediainfo - возвращали имя файла в нижнем регистре вместо полноценного варианта.
# Добавлен метод SimpleXML::getChildAttribSplit, позволяющий парсить параметр, содержащий множественные значения.
# Почистил код CFlyServerConfig, CServerItem, DHTServer.
# Убрал лишние проверки на m_merge_count_process, и скорректировал вызов wait_stop_merge() в GUI. TODO: обобщить код.
# Из SearchFrame::closeAll() убрал лишнее ожидание wait_stop_merge() поскольку оно уже есть в SearchFrame::onClose(...).
# В SearchFrame::onTimer исправил ошибку с вызовом updateStatus(), при отключении настройки ENABLE_FLY_SERVER забывали обновлять статус.
# Исправлены недоработки в методах onShowFlyServerProperty в GUI. TODO: данный код тоже следует обобщить.
# Мелкие фиксы копипасты в рамках использования интерфейсов классов.
------------------------------------------------------------------------
r14322 | pavel.pimenov@gmail.com | 2013-07-01 06:53:11 +0400 (Пн, 01 июл 2013) | 5 lines

# [public-build] Возможо исправлено сохранение LastIP (ждем подтверждения от Gap51)
   При запросе IP иногда появляется исключение от юзера вида
   http://www.flickr.com/photos/96019675@N02/9178731763/
   и если не дождаться пока полоска загрузки не пропадет - рейтинг может не сбросится в базу 
   TODO - поправить и сделать сброс рейтинга при закрытии приложения принудительно.
------------------------------------------------------------------------
r14321 | pavel.pimenov@gmail.com | 2013-06-30 22:05:30 +0400 (Вс, 30 июн 2013) | 1 line

# Опечатка
------------------------------------------------------------------------
r14320 | pavel.pimenov@gmail.com | 2013-06-30 21:01:23 +0400 (Вс, 30 июн 2013) | 1 line

# Галку отключения флайсервера сделал только одну - часть 2
------------------------------------------------------------------------
r14319 | pavel.pimenov@gmail.com | 2013-06-30 20:46:16 +0400 (Вс, 30 июн 2013) | 1 line

# Галку отключения флайсервера сделал только одну
------------------------------------------------------------------------
r14318 | pavel.pimenov@gmail.com | 2013-06-30 20:32:24 +0400 (Вс, 30 июн 2013) | 3 lines

# Поправил экран в UserInfoColumns.h
  Выкинул из него лишний #include "compiler.h"
  TODO узнать у Алексея зачем он простой enum вынес в отдельный файл
------------------------------------------------------------------------
r14315 | a.rainman@gmail.com | 2013-06-30 14:57:28 +0400 (Вс, 30 июн 2013) | 2 lines

# [public-build]
# AStyle.
------------------------------------------------------------------------
r14314 | a.rainman@gmail.com | 2013-06-30 14:57:23 +0400 (Вс, 30 июн 2013) | 2 lines

# Issue 1032: Уведомлять пользователя о том, что он использует не поддерживаемую версию ОС: добавил упоминание в информацию о системе.

------------------------------------------------------------------------
r14310 | pavel.pimenov@gmail.com | 2013-06-29 09:46:50 +0400 (Сб, 29 июн 2013) | 1 line

# [merge] Исправлен копи-паст в CBarShader
------------------------------------------------------------------------
r14306 | a.rainman@gmail.com | 2013-06-28 18:24:00 +0400 (Пт, 28 июн 2013) | 1 line

# Issue 1032: Уведомлять пользователя о том, что он использует не поддерживаемую версию ОС: в связи с добавлением авто-отключения сообщения в r14305 убрал избыточную возможность отключения из гуя, и лишнюю строку из локали.
------------------------------------------------------------------------
r14305 | tret2003 | 2013-06-28 17:35:15 +0400 (Пт, 28 июн 2013) | 1 line

* to [issue 1032] Вывод сообщения о старой ОС только один раз.
------------------------------------------------------------------------
r14304 | pavel.pimenov | 2013-06-27 23:09:28 +0400 (Чт, 27 июн 2013) | 3 lines

# Убрал флаг INTERNET_FLAG_TRANSFER_ASCII - он только для ftp
# Вырезал перегруженную функцию Util::getDataFromInet для чтения в файл - не используется
  TODO - влить в 4xx и strg
------------------------------------------------------------------------
r14301 | a.rainman@gmail.com | 2013-06-24 21:13:54 +0400 (Пн, 24 июн 2013) | 2 lines

# [public-build]
# Отложил фичу IRAINMAN_USE_UNICODE_IN_NMDC до лучших времён, ибо писать костыль в виде преобразователя, который по кусочкам конвертирует строку при передаче на хаб нет никакого желания.
------------------------------------------------------------------------
r14300 | a.rainman@gmail.com | 2013-06-24 18:26:11 +0400 (Пн, 24 июн 2013) | 1 line

# Удалил ассерт из HubFrame::onClose - это нормальная ситуация, поскольку хаб был удалён пользователем из списка недавних хабов в тот момент, когда он был открыт.
------------------------------------------------------------------------
r14299 | a.rainman@gmail.com | 2013-06-24 18:09:51 +0400 (Пн, 24 июн 2013) | 2 lines

# [public-build]
# IRAINMAN_USE_UNICODE_IN_NMDC - оптимизация: при разбиении команд анализируем их построчно.
------------------------------------------------------------------------
r14298 | a.rainman@gmail.com | 2013-06-24 18:06:06 +0400 (Пн, 24 июн 2013) | 1 line

# CFlylinkDBManager::errorDB - косметика.
------------------------------------------------------------------------
r14297 | a.rainman@gmail.com | 2013-06-24 16:32:13 +0400 (Пн, 24 июн 2013) | 1 line

# Убрал ассерт из HashManager: это нормальное поведение при закрытии программы во время хеширования, и принудительном прерывании процесса.
------------------------------------------------------------------------
r14296 | a.rainman@gmail.com | 2013-06-24 15:58:35 +0400 (Пн, 24 июн 2013) | 3 lines

# [public-build]
# log
# Экспериментальное включение поддержки юникода на nmdc хабах. Директива IRAINMAN_USE_UNICODE_IN_NMDC включена только в серой ветке, и в ежовой версии.
------------------------------------------------------------------------
r14295 | a.rainman@gmail.com | 2013-06-24 15:51:10 +0400 (Пн, 24 июн 2013) | 1 line

# Поправлена диагностика в Util::getIpCountry.
------------------------------------------------------------------------
r14294 | a.rainman@gmail.com | 2013-06-24 10:16:07 +0400 (Пн, 24 июн 2013) | 1 line

# IRAINMAN_USE_UNICODE_IN_NMDC 
------------------------------------------------------------------------
r14293 | scalolaz_scat@mail.ru | 2013-06-24 08:59:39 +0400 (Пн, 24 июн 2013) | 3 lines

# PublicHubsFrm: косметика вида
- Смещаем от левого борта окаймление поля фильтра
- По-другому считаем сегменты для статуса - не умещалось общее число Пользователей в хабах
------------------------------------------------------------------------
r14292 | a.rainman@gmail.com | 2013-06-24 04:38:37 +0400 (Пн, 24 июн 2013) | 2 lines

# только для лога!
* (Closed Issue 512): Проблемы со статистикой скачанного/отданного https://code.google.com/p/flylinkdc/issues/detail?id=512 .
------------------------------------------------------------------------
r14291 | a.rainman@gmail.com | 2013-06-24 04:29:02 +0400 (Пн, 24 июн 2013) | 4 lines

# [public-build]
* Исправлено отображение географического местоположения в окне передач.
# log
# Запрет подачи на вход Util::getIpCountry строки с пустым IP адресом.
------------------------------------------------------------------------
r14290 | a.rainman@gmail.com | 2013-06-24 03:19:39 +0400 (Пн, 24 июн 2013) | 2 lines

# [public-build]
# log
------------------------------------------------------------------------
r14289 | a.rainman@gmail.com | 2013-06-24 03:09:36 +0400 (Пн, 24 июн 2013) | 1 line

# Astyle
------------------------------------------------------------------------
r14288 | a.rainman@gmail.com | 2013-06-24 03:04:46 +0400 (Пн, 24 июн 2013) | 12 lines

# [public-build]
# Технологический коммит.
# Ревизия ClientManager.
# Косметика в интерфейсе класса ClientManager: для функций, нуждающихся в блокировке при вызове добавлен признак L.
# Убрал лишнюю проверку из ClientManager::getNicks.
# Оптимизация в ClientManager::getConnection - не запрашиваем из Identity одни и те же данные дважды.
# Оптимизация в ClientManager::checkCheating - не зовём дважды метод Identity::set_bit.
# Оптимизация в ClientManager::findHub: переставил местами условия - сначала проверяем порт, а уже потом делаем более тяжёлое сравнение строк с IP.
# Оптимизация в ClientManager::getMyNick: возвращаем ник быстрее за счёт замены getMyIdentity().getNick() на getMyOnlineUser()->getUser()->getFirstNick().
# Оптимизация в ChatBot::onMessageV1: используем getMyOnlineUser()->getUser()->getFirstNickT() вместо Text::toT(getMyIdentity().getNick()).
# Значительно оптимизирован конструктор UploadQueueItem - исключаем двойной поиск по мапе onlineUsers, сокращаем длину блокировок, и исключаем двойные запросы одних и тех же данных

------------------------------------------------------------------------
r14287 | a.rainman@gmail.com | 2013-06-24 03:00:34 +0400 (Пн, 24 июн 2013) | 1 line

# Поправил диагностику в MerkleTree, забыл учесть MIN_BLOCK_SIZE.
------------------------------------------------------------------------
r14286 | a.rainman@gmail.com | 2013-06-24 03:00:11 +0400 (Пн, 24 июн 2013) | 1 line

# +r14281: почистил код загрузки.
------------------------------------------------------------------------
r14285 | a.rainman@gmail.com | 2013-06-24 02:42:44 +0400 (Пн, 24 июн 2013) | 1 line

# Отключил IRAINMAN_USE_BOOST_HASHER_FOR_CID.
------------------------------------------------------------------------
r14284 | a.rainman@gmail.com | 2013-06-23 22:30:09 +0400 (Вс, 23 июн 2013) | 2 lines

* (Closed Issue 849) Пропадают источники для файлов при перезагрузке программы. Ошибка была допущена ещё между версиями r377-beta5 и r377-beta6. https://code.google.com/p/flylinkdc/issues/detail?id=849
# Ошибка была допущена ещё в r1286,
------------------------------------------------------------------------
r14283 | a.rainman@gmail.com | 2013-06-23 22:27:15 +0400 (Вс, 23 июн 2013) | 6 lines

# [public-build]
# Только для лога, реально Issue 969 была закрыта в r14282.
* (Closed Issue 969) Неверное отображение ника на ADC хабах https://code.google.com/p/flylinkdc/issues/detail?id=969 .
# Исправлена ошибка, допущенная в r14282 - был полностью сломан файловый обмен. Исправление выполнено заменой хешера из STL/TR1 на хешер из Boost. 
# Обновлены ключи компиляции.
# Добавлен ключ IRAINMAN_USE_BOOST_HASHER_FOR_CID, заменяющий самопальный хешер на хешер, учитывающий все данные. В данный момент включён, и работает нормально.
------------------------------------------------------------------------
r14282 | a.rainman@gmail.com | 2013-06-23 16:21:20 +0400 (Вс, 23 июн 2013) | 11 lines

# [public-build]
# Технологический коммит.
# Хешер для класса CID переведён на адекватную реализацию из STL. Данное изменение является критическим, поскольку предыдущий хешер был в значительной степени подвержен коллизиям.
# User::cid - константный мембер!
# Откатил функциональные изменения, добавленные в r14262, ибо они мешают диагностике проблем.
# Функционал обновления ника вынесен в функцию, требующую внешней блокировки ClientManager::updateNick_internal.
# В ClientManager::m_nicks теперь пишутся только ники для nmdc юзеров. Ники adc юзеров в данную коллекцию писать бессмысленно, ибо для одного cid может быть несколько ников. Возможно этим исправлено Issue 969 - Неверное отображение ника на ADC хабах.
# Исправлена ошибка в ClientManager::getUser для nmdc хабов - не добавляли ник в m_nicks.
# Добавлена функция ClientManager::isMe, принимающая на вход ссылку на OnlineUsersPtr. На использование вновь добавленной функции переведены все необходимые места: UserManager::checkUser и HubFrame::onSpeaker.
# Обновлены ключи компиляции.
# Добавлена директива IRAINMAN_NON_COPYABLE_USER_DATA_IN_CLIENT_MANAGER, пока в целях диагностики проблемы https://crash-server.com/Problem.aspx?ClientID=ppa&ProblemID=12550 , однако в будущем можно использовать её для экономии ресурсов. На данный момент директива выключена.
------------------------------------------------------------------------
r14281 | scalolaz_scat@mail.ru | 2013-06-23 14:33:39 +0400 (Вс, 23 июн 2013) | 4 lines

# Временно (или насовсем):
- RSS, боремся с pubDate без для недели
- Другой вариант логирования при запуске компонентов для отображения на сплеше
[public-build]
------------------------------------------------------------------------
r14280 | a.rainman@gmail.com | 2013-06-22 23:28:50 +0400 (Сб, 22 июн 2013) | 1 line

# FavoriteManager::getUserCommands - косметика кода.
------------------------------------------------------------------------
r14279 | a.rainman@gmail.com | 2013-06-22 23:28:43 +0400 (Сб, 22 июн 2013) | 1 line

# В DirectoryListing::getUserFromFilename не обновляли имя юзера в ClientManager,
------------------------------------------------------------------------
r14278 | a.rainman@gmail.com | 2013-06-22 23:28:36 +0400 (Сб, 22 июн 2013) | 1 line

# Забыли вырезать кусочек автобана IRAINMAN_ENABLE_AUTO_BAN.
------------------------------------------------------------------------
r14277 | a.rainman@gmail.com | 2013-06-22 22:41:22 +0400 (Сб, 22 июн 2013) | 1 line

# В UserManager::checkUser не пытаемся проверять сами себя.
------------------------------------------------------------------------
r14276 | a.rainman@gmail.com | 2013-06-22 21:50:06 +0400 (Сб, 22 июн 2013) | 1 line

# Откатил проверку, добавленную в r13277: незачем просто так гасить добавленные для диагностики проверки, и при этом ещё изменять логику.
------------------------------------------------------------------------
r14270 | pavel.pimenov@gmail.com | 2013-06-21 19:35:45 +0400 (Пт, 21 июн 2013) | 1 line

# log
------------------------------------------------------------------------
r14269 | pavel.pimenov@gmail.com | 2013-06-21 19:12:57 +0400 (Пт, 21 июн 2013) | 1 line

* r502-beta87
------------------------------------------------------------------------
r14268 | pavel.pimenov@gmail.com | 2013-06-21 19:11:15 +0400 (Пт, 21 июн 2013) | 1 line

# Заметка к http://code.google.com/p/flylinkdc/issues/detail?id=1064
------------------------------------------------------------------------
r14267 | a.rainman@gmail.com | 2013-06-21 11:08:34 +0400 (Пт, 21 июн 2013) | 1 line

# Почистил код FinishedItem.
------------------------------------------------------------------------
r14266 | a.rainman@gmail.com | 2013-06-21 11:08:28 +0400 (Пт, 21 июн 2013) | 1 line

# Добавлен макрос GETC, аналогичный по функционалу GETSET, но, в отличии от него, генерирующий мембер константу и джеттер.
------------------------------------------------------------------------
r14264 | tret2003 | 2013-06-20 18:55:18 +0400 (Чт, 20 июн 2013) | 1 line

# [lang] an auto commit from localization system...
------------------------------------------------------------------------
r14263 | pavel.pimenov@gmail.com | 2013-06-20 18:41:41 +0400 (Чт, 20 июн 2013) | 1 line

# Astyle [public-build]
------------------------------------------------------------------------
r14262 | pavel.pimenov@gmail.com | 2013-06-20 18:35:22 +0400 (Чт, 20 июн 2013) | 1 line

# Косметика в ClientManager::updateNick
------------------------------------------------------------------------
r14261 | pavel.pimenov@gmail.com | 2013-06-20 18:32:10 +0400 (Чт, 20 июн 2013) | 2 lines

* Исправлена проблема блокировки базы https://crash-server.com/Bug.aspx?ClientID=ppa&ProblemID=17520
  флай ждет 5 сек и выдает предупреждение без падения. пока отрытую транзацию в бд не закроют во внешнем приложении.
------------------------------------------------------------------------
r14260 | a.rainman@gmail.com | 2013-06-20 11:41:26 +0400 (Чт, 20 июн 2013) | 3 lines

* Восстановлен функционад открытия файл листов и выдачи слота из окон заврешённых отдач/скачиваний.
# +r13573.
# TODO: подумать почему образовалась проблема, описанная в Issue 981, найти ошибку с установкой имени и починить по нормальному, т.е. без необходимости копирования ника. Хреново, что юзеры не пишут багрепорты вовремя.
------------------------------------------------------------------------
r14259 | a.rainman@gmail.com | 2013-06-20 09:26:57 +0400 (Чт, 20 июн 2013) | 4 lines

# Issue 804: Выпуск официальной ежовой версии (с ограниченным функционалом и оптимизацией в сторону высоких нагрузок).
# Обновлены ключи компиляции.
# Добавлены директивы IRAINMAN_AUTOUPDATE_CORE_DIFFERENCE и IRAINMAN_AUTOUPDATE_ARCH_DIFFERENCE - пока выключены
# Реальных изменений кода данный коммит не несёт.
------------------------------------------------------------------------
r14258 | a.rainman@gmail.com | 2013-06-20 09:12:48 +0400 (Чт, 20 июн 2013) | 1 line

# Модификатор const для списков хабов для поиска.
------------------------------------------------------------------------
r14257 | a.rainman@gmail.com | 2013-06-20 08:44:45 +0400 (Чт, 20 июн 2013) | 1 line

# +r14251: добавлена обвёртка для ежовой версии, и подсчёт количества вызовов.
------------------------------------------------------------------------
r14256 | a.rainman@gmail.com | 2013-06-20 08:41:00 +0400 (Чт, 20 июн 2013) | 1 line

# +r14251: забыли заменить копирование на ссылки.
------------------------------------------------------------------------
r14255 | a.rainman@gmail.com | 2013-06-20 07:58:41 +0400 (Чт, 20 июн 2013) | 1 line

# +r14247: из ClientManager::makeCid убрал преобразование ника к нижнему регистру.
------------------------------------------------------------------------
r14254 | a.rainman@gmail.com | 2013-06-20 07:57:07 +0400 (Чт, 20 июн 2013) | 1 line

* (Closed Issue 914): Зависание ежовой (HE) версии при добавлении пользователя в друзья при открытой вкладке "Друзья - Враги" https://code.google.com/p/flylinkdc/issues/detail?id=914 . Исправлено принудительным закрытием открытой вкладки.
------------------------------------------------------------------------
r14253 | a.rainman@gmail.com | 2013-06-20 07:56:53 +0400 (Чт, 20 июн 2013) | 1 line

* Для списка избранных пользователей сохраняем и загружаем CID только для adc хабов, для nmdc генерируем его при старте.
------------------------------------------------------------------------
r14252 | pavel.pimenov@gmail.com | 2013-06-20 06:55:03 +0400 (Чт, 20 июн 2013) | 1 line

# [coding-style]
------------------------------------------------------------------------
r14251 | pavel.pimenov@gmail.com | 2013-06-20 06:53:53 +0400 (Чт, 20 июн 2013) | 1 line

# Text::toT(user->getFirstNick()) заменил на user->getFirstNickT()
------------------------------------------------------------------------
r14250 | a.rainman@gmail.com | 2013-06-20 06:34:19 +0400 (Чт, 20 июн 2013) | 1 line

# +r14247: добавил комментарий с описанием изменения.
------------------------------------------------------------------------
r14249 | a.rainman@gmail.com | 2013-06-20 05:47:09 +0400 (Чт, 20 июн 2013) | 3 lines

# Технологический коммит.
# Обновлены ключи компиляции.
# Добавлена директива IRAINMAN_NON_COPYABLE_CLIENTS_IN_CLIENT_MANAGER, зависит от IRAINMAN_USE_READ_WRITE_LOCK. Включение директивы позволяет избежать копирования данных хабов, а так же избежать лишнего цикла обработки для этих данных.
------------------------------------------------------------------------
r14248 | a.rainman@gmail.com | 2013-06-20 05:46:59 +0400 (Чт, 20 июн 2013) | 3 lines

# Технологический коммит.
# Удалил из WebServerManager лишний StringList.
# Убрал из WebServerManager::search избыточное копирование адресов хабов, ибо обход этого списка делается внутри поискового движка в ClientManager::search.
------------------------------------------------------------------------
r14247 | a.rainman@gmail.com | 2013-06-20 05:28:40 +0400 (Чт, 20 июн 2013) | 2 lines

# Технологический коммит.
# ClientManager::findLegacyUser - заменил stricmp на строковый оператор сравнения. Теоретически это так же должно сократить число падений https://crash-server.com/Problem.aspx?ClientID=ppa&ProblemID=12550 . Изменение избавляет от явно бессмысленного подсчёта длинны строки, что в свою очередь прилично сократит время выполнения данный функции, ибо для функции данные сравнения основная нагрузка.
------------------------------------------------------------------------
r14245 | a.rainman@gmail.com | 2013-06-20 05:16:04 +0400 (Чт, 20 июн 2013) | 2 lines

# Технологический коммит.
# Убрал гашение исключений в FileUpdateSearch::DeleteAll() - их там быть не должно.
------------------------------------------------------------------------
r14244 | tret2003 | 2013-06-19 21:51:01 +0400 (Ср, 19 июн 2013) | 1 line

* Пересчитываем глобальное ратио перед тем как его показать.
------------------------------------------------------------------------
r14243 | tret2003 | 2013-06-19 19:31:09 +0400 (Ср, 19 июн 2013) | 1 line

# Дополнение r14217
------------------------------------------------------------------------
r14242 | tret2003 | 2013-06-19 19:26:18 +0400 (Ср, 19 июн 2013) | 1 line

# Дополнение r14241
------------------------------------------------------------------------
r14241 | pavel.pimenov@gmail.com | 2013-06-19 18:42:55 +0400 (Ср, 19 июн 2013) | 1 line

# Зачем-то const засунули в зад.
------------------------------------------------------------------------
r14240 | pavel.pimenov@gmail.com | 2013-06-19 18:34:24 +0400 (Ср, 19 июн 2013) | 1 line

# [coding-style]
------------------------------------------------------------------------
r14239 | pavel.pimenov@gmail.com | 2013-06-19 18:29:07 +0400 (Ср, 19 июн 2013) | 1 line

# Спрятал коллекцию m_clients и const Client::List& getClients() const внутрь менеджера ClientManager. 
------------------------------------------------------------------------
r14238 | pavel.pimenov@gmail.com | 2013-06-19 06:59:11 +0400 (Ср, 19 июн 2013) | 1 line

# Astyle [public-build]
------------------------------------------------------------------------
r14237 | pavel.pimenov@gmail.com | 2013-06-19 06:57:44 +0400 (Ср, 19 июн 2013) | 1 line

# TOOD узнать замчем в веб сервере используется сырой сокет а не С++ обертка? и где ::shutdown(sock, SD_BOTH);?
------------------------------------------------------------------------
r14236 | pavel.pimenov@gmail.com | 2013-06-19 06:55:35 +0400 (Ср, 19 июн 2013) | 1 line

# Убрал лишние inline
------------------------------------------------------------------------
r14235 | pavel.pimenov@gmail.com | 2013-06-19 06:45:48 +0400 (Ср, 19 июн 2013) | 1 line

# TODO Убрать торчащую наружу коллекцию. const Client::List& getClients() const
------------------------------------------------------------------------
r14234 | pavel.pimenov@gmail.com | 2013-06-19 00:17:16 +0400 (Ср, 19 июн 2013) | 1 line

# Log
------------------------------------------------------------------------
r14233 | pavel.pimenov@gmail.com | 2013-06-18 23:57:29 +0400 (Вт, 18 июн 2013) | 1 line

* r502-beta86
------------------------------------------------------------------------
r14232 | pavel.pimenov@gmail.com | 2013-06-18 23:37:45 +0400 (Вт, 18 июн 2013) | 3 lines

# TODO - sqlite3_busy_handler
# TODO - merge r4xx и strongdc-sqlite

------------------------------------------------------------------------
r14231 | pavel.pimenov@gmail.com | 2013-06-18 23:23:12 +0400 (Вт, 18 июн 2013) | 5 lines

# Возможно исправил https://crash-server.com/Problem.aspx?ClientID=ppa&ProblemID=17660
  Анализ полных дампов показал падения с ошибкой Database is locked 
  Версия: БД открыают во внешнем приложении и выполняют запросы к ней
    TODO - если не полегчает перехватить sqlite3_busy_handler и выводить сообщение до тех пор, пока база на освободится
   
------------------------------------------------------------------------
r14230 | a.rainman@gmail.com | 2013-06-18 23:00:36 +0400 (Вт, 18 июн 2013) | 3 lines

# +r14225:
  favHubGroups защищать не надо, ибо работа с ним всегда ведётся в основном потоке (потоке гуя).
  csHubs это FastSharedCriticalSection!
------------------------------------------------------------------------
r14229 | pavel.pimenov@gmail.com | 2013-06-18 22:40:09 +0400 (Вт, 18 июн 2013) | 1 line

# в FavoriteManager::isPrivate иногда подают пустой URL
------------------------------------------------------------------------
r14228 | pavel.pimenov@gmail.com | 2013-06-18 22:39:29 +0400 (Вт, 18 июн 2013) | 4 lines

# Убрал избыточные временные sqlite3_connection для создания файлов 
 - FlylinkDC_dht.sqlite
 - FlylinkDC_log.sqlite
 - FlylinkDC_mediainfo.sqlite
------------------------------------------------------------------------
r14227 | pavel.pimenov@gmail.com | 2013-06-18 22:00:41 +0400 (Вт, 18 июн 2013) | 1 line

# [public-build]
------------------------------------------------------------------------
r14226 | pavel.pimenov@gmail.com | 2013-06-18 22:00:05 +0400 (Вт, 18 июн 2013) | 2 lines

* (Closed issue 1057) Зависание в настройках лент новостей
   https://code.google.com/p/flylinkdc/issues/detail?id=1057
------------------------------------------------------------------------
r14225 | pavel.pimenov@gmail.com | 2013-06-18 19:28:36 +0400 (Вт, 18 июн 2013) | 4 lines

# Защитил секцией обращение к favoriteHubs
  https://crash-server.com/Problem.aspx?ClientID=ppa&ProblemID=23193
  TODO - остались еще дырки где работаем без секции.
         как красивее сделать пока не придумал.
------------------------------------------------------------------------
r14224 | pavel.pimenov@gmail.com | 2013-06-18 18:19:05 +0400 (Вт, 18 июн 2013) | 1 line

# Astyle [public-build]
------------------------------------------------------------------------
r14221 | pavel.pimenov | 2013-06-18 09:37:11 +0400 (Вт, 18 июн 2013) | 4 lines

# (issue 1061) 
  - Добавлена функция RSSFeed::convertPubDate - в случае проблем с конвертацией даты кидает ошибки в лог
  - Отключил функцию RSSNewsFrame::onRemoveAll - она не дописана и приводила к ликам
  - Убрал утечку ресурса new RSSItem(*j); в RSSManager::updateAllFeeds() если canAdd возвращает false
------------------------------------------------------------------------
r14220 | pavel.pimenov@gmail.com | 2013-06-18 07:02:56 +0400 (Вт, 18 июн 2013) | 5 lines

# [crash] 41 падений в области RSS 
          // https://crash-server.com/Problem.aspx?ClientID=ppa&ProblemID=23689  
          // http://i.imgur.com/Si4oqEI.png
  TODO - стека не видно, разобрать по коду что может падать.

------------------------------------------------------------------------
r14219 | pavel.pimenov@gmail.com | 2013-06-17 21:06:11 +0400 (Пн, 17 июн 2013) | 1 line

# log
------------------------------------------------------------------------
r14218 | pavel.pimenov@gmail.com | 2013-06-17 20:39:15 +0400 (Пн, 17 июн 2013) | 1 line

* r502-beta85
------------------------------------------------------------------------
r14217 | pavel.pimenov@gmail.com | 2013-06-17 20:37:32 +0400 (Пн, 17 июн 2013) | 5 lines

* В окне поиска добавлена галка для отключения запросов к fly-server
  TODO 
    - Реализовать аналогичное для файл-листов
    - Ожидать завершение выполнения потока запроса к серверу при закрытии приложения.
  
------------------------------------------------------------------------
r14216 | pavel.pimenov@gmail.com | 2013-06-17 20:16:47 +0400 (Пн, 17 июн 2013) | 1 line

# Исправлена загрузка LastIP из базы данных
------------------------------------------------------------------------
r14215 | pavel.pimenov | 2013-06-17 08:49:35 +0400 (Пн, 17 июн 2013) | 2 lines

# Убрал лишний return 0 в CFlylinkDBManager::get_path_id 
  Подправил логирование в CFlyServerJSON::connectFlyServer
------------------------------------------------------------------------
r14214 | tret2003 | 2013-06-16 22:46:17 +0400 (Вс, 16 июн 2013) | 1 line

# [Log]
------------------------------------------------------------------------
r14213 | tret2003 | 2013-06-16 22:37:37 +0400 (Вс, 16 июн 2013) | 1 line

# убрал лишние return
------------------------------------------------------------------------
r14212 | tret2003 | 2013-06-16 22:27:07 +0400 (Вс, 16 июн 2013) | 1 line

* Добавлен вывод информации, в окно статусов скачивания, о блокировке через IPTrust
------------------------------------------------------------------------
r14210 | pavel.pimenov@gmail.com | 2013-06-15 18:51:21 +0400 (Сб, 15 июн 2013) | 1 line

# test - линкуем статически 
------------------------------------------------------------------------
r14209 | pavel.pimenov@gmail.com | 2013-06-15 09:07:48 +0400 (Сб, 15 июн 2013) | 4 lines

# [fly-server][public-build] 
  - Убрал лишнюю критическую секцию из CFlyServerJSON. при закрытии окна ждем пока поток завершится через atomic
  - Обращение к серверу в окне поиска сделал чаще (2 сек вместо 3)

------------------------------------------------------------------------
r14205 | pavel.pimenov@gmail.com | 2013-06-14 23:12:03 +0400 (Пт, 14 июн 2013) | 1 line

# [public-build]
------------------------------------------------------------------------
r14204 | pavel.pimenov@gmail.com | 2013-06-14 22:53:53 +0400 (Пт, 14 июн 2013) | 1 line

# log
------------------------------------------------------------------------
r14203 | pavel.pimenov@gmail.com | 2013-06-14 22:39:05 +0400 (Пт, 14 июн 2013) | 3 lines

# В обновленной версии r502-beta84 build 14197 (которая еще называется 84.1) при попытке скачивания видео файлов, имеющих название и расширение, например, Фильм.2013.D.HDRip.avi файл качается, но обрезается до Фильм.2013.D.HDR
В итоге файл ошибочно распознается как RAW формат (изображение).
http://www.flylinkdc.ru/2013/05/flylinkdc-r502-beta82-build-14110.html
------------------------------------------------------------------------
r14202 | pavel.pimenov@gmail.com | 2013-06-14 19:00:42 +0400 (Пт, 14 июн 2013) | 2 lines

# Временно убрал BackgroundTaskExecuter - падало при закрытии фрейма поиска (вызов чисто виртуальный функции)
  TODO - где-то проблема с синхронизацией.
------------------------------------------------------------------------
r14201 | tret2003 | 2013-06-14 07:09:37 +0400 (Пт, 14 июн 2013) | 1 line

# [Log]
------------------------------------------------------------------------
r14200 | pavel.pimenov@gmail.com | 2013-06-14 07:00:18 +0400 (Пт, 14 июн 2013) | 3 lines

# Запросы к sqlite делаем только в момент отрисовки SearchFrame::onCustomDraw
# Log
# [public-build]
------------------------------------------------------------------------
r14195 | pavel.pimenov@gmail.com | 2013-06-13 21:16:58 +0400 (Чт, 13 июн 2013) | 1 line

# Astyle
------------------------------------------------------------------------
r14194 | pavel.pimenov@gmail.com | 2013-06-13 21:16:32 +0400 (Чт, 13 июн 2013) | 3 lines

* После обновления на r502-beta84 build 14192 (x86) перестало работать Скачать в... - Обзор... (диалог сохранения файла не появляется вообще)
# В WinUtil::browseFile убрал лишний массив AutoArray <TCHAR> buf(FULL_MAX_PATH);
# [fly-server] Запрос к серверу для окна поиска перевел в отдельный поток (синхронный POST подтормаживает интерфейс)
------------------------------------------------------------------------
r14193 | pavel.pimenov@gmail.com | 2013-06-13 19:57:10 +0400 (Чт, 13 июн 2013) | 1 line

# log
------------------------------------------------------------------------
r14192 | pavel.pimenov@gmail.com | 2013-06-13 19:38:14 +0400 (Чт, 13 июн 2013) | 1 line

* r502-beta84
------------------------------------------------------------------------
r14189 | pavel.pimenov | 2013-06-13 14:18:57 +0400 (Чт, 13 июн 2013) | 1 line

# [public-build]
------------------------------------------------------------------------
r14188 | pavel.pimenov | 2013-06-13 14:11:35 +0400 (Чт, 13 июн 2013) | 4 lines

# [fly-server] Для уменьшения нагрузки на сервер в окне поиска добавлен локальный кэш .
   Принятые медиа-данные сохраняются в таблице fly_server_cache ( БД: FlylinkDC_mediainfo.sqlite ) 
   и при повторном поиске с сервера возвращается только счетчик популярности.
   TODO - Добавить зачистку таблицы fly_server_cache (условие пока не придумал)
------------------------------------------------------------------------
r14187 | pavel.pimenov@gmail.com | 2013-06-12 22:48:05 +0400 (Ср, 12 июн 2013) | 1 line

# log
------------------------------------------------------------------------
r14186 | pavel.pimenov@gmail.com | 2013-06-12 21:43:46 +0400 (Ср, 12 июн 2013) | 1 line

# [merge] https://github.com/eiskaltdcpp/eiskaltdcpp/commit/c8dcf444d17fffacb6797d14a57b102d653896d0
------------------------------------------------------------------------
r14185 | scalolaz_scat@mail.ru | 2013-06-12 21:23:00 +0400 (Ср, 12 июн 2013) | 1 line

# к r14184: Пардон, двойной вызов функции.
------------------------------------------------------------------------
r14184 | scalolaz_scat@mail.ru | 2013-06-12 20:44:39 +0400 (Ср, 12 июн 2013) | 2 lines

# RSSnewsFrame: окончательно убираем мусор из описаний лент
Функция конвертера из RSSnewsFrame перенесена в Util.h
------------------------------------------------------------------------
r14183 | scalolaz_scat@mail.ru | 2013-06-12 19:21:12 +0400 (Ср, 12 июн 2013) | 1 line

# к r14179: RSSnewsFrame: загасили эксепшены в дебаге.
------------------------------------------------------------------------
r14182 | tret2003 | 2013-06-12 14:16:16 +0400 (Ср, 12 июн 2013) | 1 line

# [Log]
------------------------------------------------------------------------
r14179 | scalolaz_scat@mail.ru | 2013-06-12 03:51:25 +0400 (Ср, 12 июн 2013) | 1 line

# RSSnewsFrame: Add Context Menu for news (Open, Copy URL, Copy TITLE + URL)
------------------------------------------------------------------------
r14178 | tret2003 | 2013-06-11 23:03:02 +0400 (Вт, 11 июн 2013) | 1 line

# log
------------------------------------------------------------------------
r14173 | scalolaz_scat@mail.ru | 2013-06-11 19:09:26 +0400 (Вт, 11 июн 2013) | 1 line

# RSSnewsFrame: небольшая правка. Заменяем тэги на 1 пробел.
------------------------------------------------------------------------
r14172 | pavel.pimenov@gmail.com | 2013-06-11 19:02:42 +0400 (Вт, 11 июн 2013) | 1 line

# log
------------------------------------------------------------------------
r14171 | pavel.pimenov@gmail.com | 2013-06-11 18:08:55 +0400 (Вт, 11 июн 2013) | 1 line

* (Closed issue 1060) Убрал лишнюю нагрузку на базу данных в окне поиска
------------------------------------------------------------------------
r14170 | tret2003 | 2013-06-11 14:59:01 +0400 (Вт, 11 июн 2013) | 1 line

# [lang] an auto commit from localization system...
------------------------------------------------------------------------
r14169 | tret2003 | 2013-06-11 14:55:32 +0400 (Вт, 11 июн 2013) | 1 line

# Добавил страницу wiki для выгрузки с Transifex
------------------------------------------------------------------------
r14168 | pavel.pimenov | 2013-06-11 11:34:43 +0400 (Вт, 11 июн 2013) | 1 line

# [merge] https://github.com/eiskaltdcpp/eiskaltdcpp/commit/b031715
------------------------------------------------------------------------
r14167 | pavel.pimenov@gmail.com | 2013-06-10 23:24:13 +0400 (Пн, 10 июн 2013) | 1 line

* r502-beta83
------------------------------------------------------------------------
r14166 | pavel.pimenov@gmail.com | 2013-06-10 22:50:14 +0400 (Пн, 10 июн 2013) | 8 lines

# Исправление алгоритма сохранения рейтинга 
  - Корректный разброс отдачи/приема при смене у клиента IP
  - Суммарный счетчик расчитываем как double (не будет переполнения)
  - TODO 
     - Требует тест при смене IP клиента
     - Добавлен перегруженный метод string Util::formatBytes(double aBytes) - попытаться избавиться от него через шаблон и спецификацию  int64_t/double
     - Потестить на adc хабах

------------------------------------------------------------------------
r14164 | tret2003 | 2013-06-10 21:08:30 +0400 (Пн, 10 июн 2013) | 13 lines

# Добавил логирование загрузки в системный журнал с фиксированием времени загрузки компонентов отдельно каждого и с момента загрузки. На сплеш выводим время начала загрузки с момента старта. При начале загрузки компонента выводится время прошедшее с момента окончания загрузки предыдущего компонента. По завершении загрузки время загрузки компонента и время окончания загрузки с момента старта программы.
Пример лога:
[2013-06-11 00:05:49] [Start] [StartUp]
[2013-06-11 00:05:49] [Step ] [StartUp] Begin load Ratio [127 ms]
[2013-06-11 00:05:49] [Step ] [StartUp] End load Ratio [3 ms and 130 ms after start]
[2013-06-11 00:05:49] [Step ] [StartUp] Begin load Geo IP [1 ms]
[2013-06-11 00:05:49] [Step ] [StartUp] End load Geo IP [3 ms and 134 ms after start]
[2013-06-11 00:05:49] [Step ] [StartUp] Begin load Custom Locations [2 ms]
[2013-06-11 00:05:49] [Step ] [StartUp] End load Custom Locations [2 ms and 138 ms after start]
[2013-06-11 00:05:51] [Step ] [StartUp] Begin load Настройки [1377 ms]
[2013-06-11 00:05:51] [Step ] [StartUp] End load Настройки [82 ms and 1597 ms after start]
[2013-06-11 00:05:51] [Step ] [StartUp] Begin load Избранные хабы [24 ms]
[2013-06-11 00:05:51] [Step ] [StartUp] End load Избранные хабы [52 ms and 1673 ms after start]
------------------------------------------------------------------------
r14162 | a.rainman@gmail.com | 2013-06-10 16:43:38 +0400 (Пн, 10 июн 2013) | 1 line

# Зарегеэкспил Util::eraseHtmlTags - теперь реализация на глухо вырезает все теги.
------------------------------------------------------------------------
r14161 | a.rainman@gmail.com | 2013-06-10 16:08:20 +0400 (Пн, 10 июн 2013) | 1 line

# Astyle.
------------------------------------------------------------------------
r14160 | a.rainman@gmail.com | 2013-06-10 16:06:49 +0400 (Пн, 10 июн 2013) | 6 lines

# В связи с вопросами к r14148 применил к BackgroundTaskExecuter move semantics, можно использовать в качестве примера: обратите внимание на код метода QueueManagerWaiter::move:
				void move(const string& p_source, const string& p_target, QueueItem::Priority p_Priority)
				{
					addTask(WaiterFile(p_source, p_target, p_Priority));
				}
 тут создаётся объект WaiterFile и именно он передаётся через весь механизм без единого копирования в метод execute, выполняемый в фоновом потоке.
------------------------------------------------------------------------
r14157 | pavel.pimenov@gmail.com | 2013-06-09 23:25:56 +0400 (Вс, 09 июн 2013) | 2 lines

# При ошибке с бд в заголовке сообщения выводим версию флая (удалил локализацию DATA_BASE_ERROR, // "FlylinkDC.sqlite database error!")
# Все ошибки с бд - критичные. 
------------------------------------------------------------------------
r14156 | pavel.pimenov@gmail.com | 2013-06-09 21:58:48 +0400 (Вс, 09 июн 2013) | 1 line

# Astyle [public-build]
------------------------------------------------------------------------
r14155 | pavel.pimenov@gmail.com | 2013-06-09 21:56:16 +0400 (Вс, 09 июн 2013) | 3 lines

# Закрыл падение вида https://www.crash-server.com/DumpGroup.aspx?ClientID=ppa&DumpGroupID=60497
  TODO - пересмотреть алгоритм расчета рейтинга при смене IP для объекта User необходимо сбрасывать накопленную статистику в базу 
  и перегружать локальные счетчики из другой стоки таблицы fly_ratio
------------------------------------------------------------------------
r14152 | a.rainman@gmail.com | 2013-06-08 20:54:55 +0400 (Сб, 08 июн 2013) | 1 line

# BackgroundTaskExecuter::addTask - cleanup.
------------------------------------------------------------------------
r14151 | a.rainman@gmail.com | 2013-06-08 20:33:23 +0400 (Сб, 08 июн 2013) | 1 line

# Issue 1057 Зависание в настройках лент новостей: почистил код.
------------------------------------------------------------------------
r14150 | tret2003 | 2013-06-08 19:39:15 +0400 (Сб, 08 июн 2013) | 1 line

# Поправил типы переменных для min
------------------------------------------------------------------------
r14149 | a.rainman@gmail.com | 2013-06-08 19:21:14 +0400 (Сб, 08 июн 2013) | 1 line

# RSSItemInfo class interface cleanup.
------------------------------------------------------------------------
r14148 | a.rainman@gmail.com | 2013-06-08 19:21:08 +0400 (Сб, 08 июн 2013) | 1 line

# Util::eraseHtmlTags optimization.
------------------------------------------------------------------------
r14145 | tret2003 | 2013-06-07 18:58:32 +0400 (Пт, 07 июн 2013) | 1 line

# Дополнение к r14140
------------------------------------------------------------------------
r14144 | tret2003 | 2013-06-07 17:59:02 +0400 (Пт, 07 июн 2013) | 1 line

# Дополнительные экраны по DHT и немного Astyle
------------------------------------------------------------------------
r14141 | a.rainman@gmail.com | 2013-06-05 17:58:19 +0400 (Ср, 05 июн 2013) | 1 line

# +r14140 eraseHtmlTags не все применения учёл.
------------------------------------------------------------------------
r14140 | a.rainman@gmail.com | 2013-06-05 17:42:02 +0400 (Ср, 05 июн 2013) | 6 lines

# Технологический коммит.
# +r14135, r14136, r14137.
# Почистил код.
# Убрал копирование строк.
# Убрал создание временных строк для поиска.
# Косметика кода.
------------------------------------------------------------------------
r14139 | tret2003 | 2013-06-05 12:41:33 +0400 (Ср, 05 июн 2013) | 1 line

# Потушил warning при сборке
------------------------------------------------------------------------
r14138 | tret2003 | 2013-06-05 09:53:19 +0400 (Ср, 05 июн 2013) | 1 line

# Загружаем рейтинг закачек/раздач при старте программы
------------------------------------------------------------------------
r14137 | tret2003 | 2013-06-05 08:23:19 +0400 (Ср, 05 июн 2013) | 1 line

# Дополнение r14136
------------------------------------------------------------------------
r14136 | tret2003 | 2013-06-04 21:06:22 +0400 (Вт, 04 июн 2013) | 1 line

# Утащил HTMLtagsErase в client
------------------------------------------------------------------------
r14135 | scalolaz_scat@mail.ru | 2013-06-03 23:14:07 +0400 (Пн, 03 июн 2013) | 3 lines

# [RSS news Frame]:
1. Заменён запуск по двойному клику с openFile на openLink, т.к. не стартовал браузер "по умолчанию"
2. Убираем часть тэгов HTML из "Описания" новостей
------------------------------------------------------------------------
r14134 | tret2003 | 2013-06-03 16:00:47 +0400 (Пн, 03 июн 2013) | 1 line

# Изменил адреса хаба Комсомольска-на-амуре
------------------------------------------------------------------------
r14133 | tret2003 | 2013-06-03 11:28:34 +0400 (Пн, 03 июн 2013) | 1 line

# [Log]
------------------------------------------------------------------------
r14132 | tret2003 | 2013-06-03 07:35:21 +0400 (Пн, 03 июн 2013) | 1 line

# [lang] an auto commit from localization system...
------------------------------------------------------------------------
r14131 | tret2003 | 2013-06-03 06:39:21 +0400 (Пн, 03 июн 2013) | 1 line

* (Closed issue 1058) Не загружаются настройки IPTrust.ini с URL адреса
------------------------------------------------------------------------
r14119 | a.rainman@gmail.com | 2013-05-30 21:06:07 +0400 (Чт, 30 май 2013) | 5 lines

* Исправлена некорректная работа опции "Использовать CTRL для строк истории" - опция игнорировалась при нажатии кнопок Home и End.
# Слияние методов onChar из HubFrame и PrivateFrame в общий метод для BaseChatFrame:
  - навёл порядок в структуре кода.
  - локализовал обработчики.
  - убрал копипаст.
------------------------------------------------------------------------
r14118 | a.rainman@gmail.com | 2013-05-30 19:00:25 +0400 (Чт, 30 май 2013) | 4 lines

* Добавлен поиск по тексту в окне личных сообщений, аналогичный поиску по тексту окне хаба.
# Слияние методов onChar из HubFrame и PrivateFrame в общий метод для BaseChatFrame:
  - перенёс реализацию в BaseChatFrame.
  - почистил код.
------------------------------------------------------------------------
r14117 | a.rainman@gmail.com | 2013-05-30 17:05:12 +0400 (Чт, 30 май 2013) | 6 lines

# +r14116  isAnyCtrlorAlt -> isCtrlOrAlt.
# Подготовка к слиянию методов onChar из HubFrame и PrivateFrame в общий метод для BaseChatFrame:
  - исправлена работа опции USE_CTRL_FOR_LINE_HISTORY в PrivateFrame.
  - унификация кода, и поведения в обработке нажатых клавиш.
  - из PrivateFrame убрана двойная проверка uMsg == WM_KEYDOWN.
  - расставлены технические комментарии.
------------------------------------------------------------------------
r14116 | tret2003 | 2013-05-30 14:54:35 +0400 (Чт, 30 май 2013) | 1 line

# Заменил вызов  isCtrl() || isAlt() на isAnyCtrlorAlt()
------------------------------------------------------------------------
r14115 | tret2003 | 2013-05-30 12:55:21 +0400 (Чт, 30 май 2013) | 2 lines

* (Closed issue 1051) Перепутаны имена файлов звуков на соответствующие события в настройках
 https://code.google.com/p/flylinkdc/issues/detail?id=1051
------------------------------------------------------------------------
r14114 | tret2003 | 2013-05-30 10:25:24 +0400 (Чт, 30 май 2013) | 1 line

# Заменил вызовы GetKeyState() на соответствующие isCtrl() isAlt isShift() (повышаем удобочитаемость)
------------------------------------------------------------------------
r14113 | tret2003 | 2013-05-30 09:49:47 +0400 (Чт, 30 май 2013) | 1 line

# Добавил потерянные скобки при мерже (Найдено PSV V648 http://viva64.com/en/v648)
------------------------------------------------------------------------
r14112 | tret2003 | 2013-05-30 00:31:54 +0400 (Чт, 30 май 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1260, created 2013-05-30 02:50:36 +0700
   Total in database:
    - ISP - 1399
    - ISPs logo - 1408
    - Address range - 5935
   Archive CustomLocations.7z created by NightOrion


------------------------------------------------------------------------
r14111 | pavel.pimenov@gmail.com | 2013-05-29 19:26:55 +0400 (Ср, 29 май 2013) | 1 line

# log
------------------------------------------------------------------------
r14110 | pavel.pimenov@gmail.com | 2013-05-29 19:10:11 +0400 (Ср, 29 май 2013) | 1 line

* r502-beta82
------------------------------------------------------------------------
r14109 | pavel.pimenov@gmail.com | 2013-05-29 19:07:17 +0400 (Ср, 29 май 2013) | 1 line

# Astyle
------------------------------------------------------------------------
r14108 | pavel.pimenov | 2013-05-28 17:30:09 +0400 (Вт, 28 май 2013) | 1 line

# Убрал лишний protected: для m_HubID (дополнение к r14107)
------------------------------------------------------------------------
r14107 | a.rainman@gmail.com | 2013-05-28 16:33:04 +0400 (Вт, 28 май 2013) | 1 line

# some define compilation fix.
------------------------------------------------------------------------
r14106 | tret2003 | 2013-05-28 13:49:13 +0400 (Вт, 28 май 2013) | 1 line

# Сортируем списки IP при добавлении а не при поиске, ищем всё таки чаще и одним условием меньше
------------------------------------------------------------------------
r14105 | pavel.pimenov@gmail.com | 2013-05-28 07:00:55 +0400 (Вт, 28 май 2013) | 1 line

# Исправлен проброс HubID в AdcHub::getUser (не считалась статистика на adcs хабах)
------------------------------------------------------------------------
r14104 | pavel.pimenov@gmail.com | 2013-05-27 22:08:07 +0400 (Пн, 27 май 2013) | 2 lines

# Сброс статистики деаем после окончания операций upload/DownloadManager
  - TOOD Разобраться, почему в CFlyUserRatioInfo::flushRatio() может быть m_nick_id == 0 и !m_nick.empty() 
------------------------------------------------------------------------
r14103 | pavel.pimenov@gmail.com | 2013-05-27 21:56:25 +0400 (Пн, 27 май 2013) | 2 lines

# Убрал задвоение рейтинга по Download
  - TODO починить проблему "не все данные по статистики сбрасываются в базу"
------------------------------------------------------------------------
r14102 | pavel.pimenov@gmail.com | 2013-05-27 21:47:53 +0400 (Пн, 27 май 2013) | 2 lines

# Поправлен расчет отданного. в UserConnection::on(BytesSent 
  из-за копипасты поставил AddRatioDownload вместо AddRatioUpload
------------------------------------------------------------------------
r14101 | pavel.pimenov@gmail.com | 2013-05-27 18:58:50 +0400 (Пн, 27 май 2013) | 1 line

# Заменил _stprintf на snwprintf (нет риска переполнения буфера)
------------------------------------------------------------------------
r14100 | tret2003 | 2013-05-27 18:52:55 +0400 (Пн, 27 май 2013) | 1 line

# [IPGuard] Cделал блокируемыми запросы к flyserver через IPGuard
------------------------------------------------------------------------
r14099 | tret2003 | 2013-05-27 11:18:55 +0400 (Пн, 27 май 2013) | 1 line

# [IPList] Переименовал функцию
------------------------------------------------------------------------
r14098 | tret2003 | 2013-05-27 11:04:44 +0400 (Пн, 27 май 2013) | 1 line

# [IPList] Убрал Дельту, она не нужна т.к. была бага при портировании кода с C# на C++
------------------------------------------------------------------------
r14097 | pavel.pimenov | 2013-05-27 10:49:59 +0400 (Пн, 27 май 2013) | 6 lines

# [IPGuard]
  - Убрал копипаст при работе с m_usedList
  TODO 
    - Посмотреть зачем там vector и std::sort
    - Слава обещал поправить функцию void addUserListAndSort(uint32_t p_ip, uint32_t p_level, uint16_t p_delta) и убрать дельту
  
------------------------------------------------------------------------
r14096 | pavel.pimenov | 2013-05-27 10:16:20 +0400 (Пн, 27 май 2013) | 3 lines

# [IPGuard]
  - Убрал лишние new аллокации и unique_ptr<>
  - FastCriticalSection m_cs перенес из IpGuard в IPList
------------------------------------------------------------------------
r14095 | tret2003 | 2013-05-27 06:55:02 +0400 (Пн, 27 май 2013) | 1 line

# Вернул пробел
------------------------------------------------------------------------
r14094 | tret2003 | 2013-05-26 21:10:11 +0400 (Вс, 26 май 2013) | 1 line

# Удалил неиспользуемые определения локализации
------------------------------------------------------------------------
r14093 | tret2003 | 2013-05-26 21:04:52 +0400 (Вс, 26 май 2013) | 1 line

# Поправил файлы проекта VS2012
------------------------------------------------------------------------
r14092 | a.rainman@gmail.com | 2013-05-26 17:32:53 +0400 (Вс, 26 май 2013) | 2 lines

# Issue 1032 - добавил возможность отключения уведомления пользователя о том, что он использует устаревшую версию ОС.
# [lang]
------------------------------------------------------------------------
r14090 | tret2003 | 2013-05-26 13:00:07 +0400 (Вс, 26 май 2013) | 1 line

# [lang] an auto commit from localization system...
------------------------------------------------------------------------
r14089 | tret2003 | 2013-05-25 17:24:55 +0400 (Сб, 25 май 2013) | 1 line

# Убрал пробелы в конце строк, перенёс их в код.
------------------------------------------------------------------------
r14088 | tret2003 | 2013-05-25 16:55:45 +0400 (Сб, 25 май 2013) | 1 line

# Заменил перевод загрузки файл листа на обработку
------------------------------------------------------------------------
r14087 | tret2003 | 2013-05-25 16:06:25 +0400 (Сб, 25 май 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1259, created 2013-05-25 18:35:24 +0700
   Total in database:
    - ISP - 1398
    - ISPs logo - 1407
    - Address range - 5927
   Archive CustomLocations.7z created by NightOrion


------------------------------------------------------------------------
r14086 | a.rainman@gmail.com | 2013-05-25 13:48:48 +0400 (Сб, 25 май 2013) | 5 lines

# Слегка почистил код веб-сервера:
  - очистил реализацию Start() и Stop().
  - добавлена функция toChecked.
  - очищена функция вывода логов.
  - перенёс проверку корректности BANDWIDTH_LIMIT_START и BANDWIDTH_LIMIT_END в SettingsManager.
------------------------------------------------------------------------
r14085 | a.rainman@gmail.com | 2013-05-25 13:48:43 +0400 (Сб, 25 май 2013) | 3 lines

# Оптимизация Text::safe_strftime_translate:
  - убрал копирование строк,
  - убрал лишнюю проверку перед циклом.
------------------------------------------------------------------------
r14084 | a.rainman@gmail.com | 2013-05-25 13:48:37 +0400 (Сб, 25 май 2013) | 1 line

# В ChatCtrl::AppendText почистил код сброса bUseEmo.
------------------------------------------------------------------------
r14083 | pavel.pimenov@gmail.com | 2013-05-25 12:54:35 +0400 (Сб, 25 май 2013) | 1 line

# Сокращение размера rtf-лога (Часть 2)
------------------------------------------------------------------------
r14082 | pavel.pimenov@gmail.com | 2013-05-25 12:51:34 +0400 (Сб, 25 май 2013) | 1 line

# Сокращение размера rtf-лога
------------------------------------------------------------------------
r14081 | pavel.pimenov@gmail.com | 2013-05-25 12:49:23 +0400 (Сб, 25 май 2013) | 1 line

# r502-beta81.1 log
------------------------------------------------------------------------
r14080 | tret2003 | 2013-05-25 12:17:51 +0400 (Сб, 25 май 2013) | 1 line

# [lang] an auto commit from localization system...
------------------------------------------------------------------------
r14079 | pavel.pimenov@gmail.com | 2013-05-25 12:06:40 +0400 (Сб, 25 май 2013) | 1 line

# [fly-server] Запрос к серверу в окне поиска делаем реже (раз в 3 сек)
------------------------------------------------------------------------
r14078 | a.rainman@gmail.com | 2013-05-25 00:27:39 +0400 (Сб, 25 май 2013) | 1 line

# Исправлена ошибка со списком файлов для веб-сервера.
------------------------------------------------------------------------
r14076 | a.rainman@gmail.com | 2013-05-24 23:58:15 +0400 (Пт, 24 май 2013) | 1 line

# Доп-е к r14062 - не обновляем статус бар если окно свёрнуто.
------------------------------------------------------------------------
r14075 | a.rainman@gmail.com | 2013-05-24 23:27:38 +0400 (Пт, 24 май 2013) | 5 lines

# Дополнение к зачистке MerkleTree.
# Дополнение по(Closed Issue 1045) - убрал лишнее умножение.
# Если не смогли создать объект MerkleTree - ругаемся в лог.
# Started Issue 1047.
# Поправил диагностику в MerkleTree - нулевой размер файла - допустим. Однако необходимо что бы размер файла был больше или равен размеру блока, а так же размер блока не может быть меньше или равен 0.
------------------------------------------------------------------------
r14074 | tret2003 | 2013-05-24 20:40:59 +0400 (Пт, 24 май 2013) | 1 line

# log
------------------------------------------------------------------------
r14073 | tret2003 | 2013-05-24 20:32:03 +0400 (Пт, 24 май 2013) | 1 line

# log
------------------------------------------------------------------------
r14072 | pavel.pimenov@gmail.com | 2013-05-24 20:26:07 +0400 (Пт, 24 май 2013) | 1 line

# log - без c
------------------------------------------------------------------------
r14071 | tret2003 | 2013-05-24 20:09:43 +0400 (Пт, 24 май 2013) | 1 line

# log
------------------------------------------------------------------------
r14070 | pavel.pimenov@gmail.com | 2013-05-24 19:09:45 +0400 (Пт, 24 май 2013) | 1 line

# Опечатка в урле. Славе спасибо!
------------------------------------------------------------------------
r14069 | pavel.pimenov@gmail.com | 2013-05-24 19:07:03 +0400 (Пт, 24 май 2013) | 3 lines

# В связи с возможным закрытием в будущем гугл-кода для хранения "бинарей" в svn 
  автообновление флая перевел на http://www.fly-server.ru/update/ (зеркалироваться будет по cron-у)
  мастером остается гугл-код
------------------------------------------------------------------------
r14067 | pavel.pimenov@gmail.com | 2013-05-24 18:47:37 +0400 (Пт, 24 май 2013) | 1 line

# r502-beta81
------------------------------------------------------------------------
r14066 | tret2003 | 2013-05-24 18:28:37 +0400 (Пт, 24 май 2013) | 1 line

# В базе хранится значение как int а не int64, извлекаем соответственно
------------------------------------------------------------------------
r14064 | tret2003 | 2013-05-24 18:15:58 +0400 (Пт, 24 май 2013) | 1 line

# Дополнение r900 в репке апдейта
------------------------------------------------------------------------
r14063 | tret2003 | 2013-05-24 18:11:20 +0400 (Пт, 24 май 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1258, created 2013-05-24 19:59:36 +0700
   Total in database:
    - ISP - 1397
    - ISPs logo - 1406
    - Address range - 5922
   Archive CustomLocations.7z created by NightOrion


------------------------------------------------------------------------
r14062 | pavel.pimenov@gmail.com | 2013-05-24 17:32:50 +0400 (Пт, 24 май 2013) | 8 lines

# [fly-server] 
  Веротяно исправлен баг вида https://crash-server.com/Problem.aspx?ClientID=ppa&ProblemID=23004
  (Отказ от TimerManagerListener - используется локальный оконный WM_TIMER)
# Coding style
# В ShareManager::Directory::toXml исправлены падения по assert-ам в отладке
# В ConnectionManager::shutdown() вернул лок для if (userConnections.empty())
  и поправил dcassert(downloads.empty()) - они должны быть внизу

------------------------------------------------------------------------
r14061 | tret2003 | 2013-05-24 16:41:48 +0400 (Пт, 24 май 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1257, created 2013-05-24 18:31:20 +0700
   Total in database:
    - ISP - 1397
    - ISPs logo - 1406
    - Address range - 5889
   Archive CustomLocations.7z created by NightOrion


------------------------------------------------------------------------
r14060 | a.rainman@gmail.com | 2013-05-24 13:57:55 +0400 (Пт, 24 май 2013) | 1 line

# Issue 939 - уменьшил размер переменной с флагами до 16 бит, на настоящий момент максимум используются: в ежовой - 9, в обычной добавляется ещё 2 на статистику, итого 11, колонок. Добавил статический ассерт на случай превышения размера переменной и инструкцию, что делать.
------------------------------------------------------------------------
r14057 | a.rainman@gmail.com | 2013-05-24 13:26:02 +0400 (Пт, 24 май 2013) | 1 line

# log.
------------------------------------------------------------------------
r14056 | a.rainman@gmail.com | 2013-05-24 13:19:08 +0400 (Пт, 24 май 2013) | 6 lines

# issue 1035 - дополнение к r14038:
  - исправлена сборка при выключении PPA_INCLUDE_LASTIP_AND_USER_RATIO.
  - из ClientManager::getUser удалён лишний вызов setFirstNick.
  - исправлена ошибка с генерацией неверного ID для хаба во время загрузки списка избранных хабов, функцию get_dic_hub_id звали раньше Util::formatDchubUrl.
  - TODO: местами остались 64х битные переменные для hubID - проверить и почистить.
# Убран лишний Text::toLower при загрузке списка избранных юзеров ибо строка обрабатывалась formatDchubUrl, в которой вызывается decodeUrl, в которой адрес как раз и приводятся к нижнему регистру.
------------------------------------------------------------------------
r14055 | a.rainman@gmail.com | 2013-05-24 13:18:54 +0400 (Пт, 24 май 2013) | 1 line

# issue 954 - дополнение к r14034 из User::hasAutoBan забыли удалить обвязку от кода.
------------------------------------------------------------------------
r14054 | tret2003 | 2013-05-24 07:50:39 +0400 (Пт, 24 май 2013) | 1 line

# [Transifex.net] Update client v0.9
------------------------------------------------------------------------
r14053 | tret2003 | 2013-05-24 07:50:03 +0400 (Пт, 24 май 2013) | 1 line

# [lang] an auto commit from localization system...
------------------------------------------------------------------------
r14049 | pavel.pimenov@gmail.com | 2013-05-23 21:01:51 +0400 (Чт, 23 май 2013) | 1 line

# log
------------------------------------------------------------------------
r14048 | a.rainman@gmail.com | 2013-05-23 20:50:52 +0400 (Чт, 23 май 2013) | 1 line

* (Closed Issue 1045) [crash-server] Падение при загрузке из базы дерева TTH.
------------------------------------------------------------------------
r14047 | tret2003 | 2013-05-23 20:47:22 +0400 (Чт, 23 май 2013) | 1 line

# Astyle
------------------------------------------------------------------------
r14046 | pavel.pimenov@gmail.com | 2013-05-23 20:39:13 +0400 (Чт, 23 май 2013) | 1 line

# r502-beta80 Log
------------------------------------------------------------------------
r14045 | pavel.pimenov@gmail.com | 2013-05-23 20:18:20 +0400 (Чт, 23 май 2013) | 2 lines

# Исправлена подкраска файлов в окне поиска
# Если окно поиска закрывается - то обрабатывать SearchFrame::on(SearchManagerListener::SR уже не нужно. (иногда падаем под отладкой)
------------------------------------------------------------------------
r14044 | pavel.pimenov@gmail.com | 2013-05-23 19:06:52 +0400 (Чт, 23 май 2013) | 3 lines

# [fly-server] 
  Обработка тэга возвращаемого с сервера "count_media"
  если на сервере еще нет медиаинфы а у нас в базе она есть - скинуть ее на сервер.
------------------------------------------------------------------------
r14041 | pavel.pimenov@gmail.com | 2013-05-23 06:54:07 +0400 (Чт, 23 май 2013) | 2 lines

# Исправил сборку релизной конфигурации
  windows\MainFrm.cpp(2289): error C2039: 'g_user_counts' : is not a member of 'User'
------------------------------------------------------------------------
r14040 | pavel.pimenov@gmail.com | 2013-05-23 06:47:25 +0400 (Чт, 23 май 2013) | 1 line

# r502-beta80 (пока не выпускаем)
------------------------------------------------------------------------
r14039 | pavel.pimenov@gmail.com | 2013-05-23 06:46:26 +0400 (Чт, 23 май 2013) | 1 line

# Astyle
------------------------------------------------------------------------
r14038 | pavel.pimenov@gmail.com | 2013-05-23 06:44:10 +0400 (Чт, 23 май 2013) | 3 lines

* (closed issue 1035) https://flylinkdc.googlecode.com/svn/branches-dev/ppa/issue-1035
 - Переписан алгоритм сохранения рейтинга и last_IP в базу данных.

------------------------------------------------------------------------
r14037 | pavel.pimenov@gmail.com | 2013-05-23 06:19:50 +0400 (Чт, 23 май 2013) | 1 line

# Astyle
------------------------------------------------------------------------
r14036 | pavel.pimenov@gmail.com | 2013-05-23 06:19:19 +0400 (Чт, 23 май 2013) | 1 line

# class FilteredOutputStream добавил диагностику на попытку записать 0 байт
------------------------------------------------------------------------
r14034 | pavel.pimenov@gmail.com | 2013-05-22 20:19:15 +0400 (Ср, 22 май 2013) | 2 lines

* (Closed issue 954) http://code.google.com/p/flylinkdc/issues/detail?id=954
  - Похоронил туманную функцию Ежика CFlylinkDBManager::getInstance()->getHubUrlWithHubId
------------------------------------------------------------------------
r14033 | tret2003 | 2013-05-22 20:01:20 +0400 (Ср, 22 май 2013) | 1 line

# Сменил формат флагов с gif на bmp
------------------------------------------------------------------------
r14032 | pavel.pimenov@gmail.com | 2013-05-22 19:55:54 +0400 (Ср, 22 май 2013) | 12 lines

# [issue 1043] http://code.google.com/p/flylinkdc/issues/detail?id=1043
  - HashManager::Hasher::fastHash звался при открытом файле.
    т.е. в нормальном режиме выполнялось двойное открытие файла.
  - GetDiskFreeSpace зовется на каждый файл для определения размера кластера
    TODO - размер кластера определять один раз.
    TODO - узнать зачем его вообще определять? :)
  - Вызов File::getSize заменен на File::isExist(m_fname, l_size, l_outFiletime)
    для определение сразу и размера и даты модификации
  - Если не сработал fastHash то только в этом случае открываем файл через класс File l_slow_file_reader(m_fname, File::READ, File::OPEN);
  - File::isExist добавил assert на получения пустого имени файла.
  - TODO при хешировании файла 0 размера так-же пока assert-имся
  
------------------------------------------------------------------------
r14030 | a.rainman@gmail.com | 2013-05-22 18:07:08 +0400 (Ср, 22 май 2013) | 1 line

# Issue 1037 [BUG] иногда теряем объект User? Выключил отладочный лог создания-удаления юзеров экраном ENABLE_DEBUG_LOG_IN_USER_CLASS ибо сильно грузит систему под нагрузкой.
------------------------------------------------------------------------
r14029 | a.rainman@gmail.com | 2013-05-22 18:07:02 +0400 (Ср, 22 май 2013) | 2 lines

# Технологический коммит.
# +r14008 - CFlylinkDBManager::load_dht_nodes migrate from list to vector.
------------------------------------------------------------------------
r14028 | a.rainman@gmail.com | 2013-05-22 17:42:36 +0400 (Ср, 22 май 2013) | 2 lines

# Технологический коммит.
# +r14007 - MerkleTree::getLeafData - cleanup.
------------------------------------------------------------------------
r14027 | a.rainman@gmail.com | 2013-05-22 09:11:26 +0400 (Ср, 22 май 2013) | 2 lines

# Issue 1038 [Расследование] Определить причину длительного нахождения завершенных закачек в состоянии ожидания
# Нашёл кусочек мёртвого кода, посмотрю позже, пока не до Флая.
------------------------------------------------------------------------
r14026 | a.rainman@gmail.com | 2013-05-22 07:59:55 +0400 (Ср, 22 май 2013) | 1 line

# small cleanup.
------------------------------------------------------------------------
r14025 | a.rainman@gmail.com | 2013-05-22 07:33:39 +0400 (Ср, 22 май 2013) | 3 lines

* Встроенный веб интерфейс теперь поддерживает темы.
# Добавил файлы от новой веб-морды в апдейт.
# Удалил лишние файлы разделители пути с конца строк ибо они автоматически добавляются внутри Флая - экономим трафик.
------------------------------------------------------------------------
r14024 | a.rainman@gmail.com | 2013-05-22 07:17:57 +0400 (Ср, 22 май 2013) | 3 lines

# Технологический коммит.
# Issue 1040 [SQLite] Оптимизация запросов определния наличия в шаре файла и факта скачки.
# Дополнение к r14015 - добавил авто документирование, убрал магические константы, слегка почистил код.
------------------------------------------------------------------------
r14023 | a.rainman@gmail.com | 2013-05-22 07:12:56 +0400 (Ср, 22 май 2013) | 5 lines

# Closed Issue 1013 [www-server] Удалить старую реализацию без шаблонов.
  - Убрал старую реализацию веб-морды.
  - Немного почистил код самого веб-сервера.
  - Поправил ошибки в работе с путями.
# Убрал из веб-сервера ограничения на выдачу логов завершённых отдач (закачек) поскольку данная опция теперь есть в настройках.
------------------------------------------------------------------------
r14019 | a.rainman@gmail.com | 2013-05-22 06:29:27 +0400 (Ср, 22 май 2013) | 1 line

# Добавлена функция ReplaceAllUriSeparatorToPathSeparator.
------------------------------------------------------------------------
r14018 | pavel.pimenov@gmail.com | 2013-05-22 06:22:41 +0400 (Ср, 22 май 2013) | 3 lines

# Забытые префиксы l_
# Создание ссылки вида const auto &l_sav_dht_nodes_get = m_save_dht_nodes.get(); // [!] PVS V807 Decreased performance 
  по ошибке засунули во внутрь цикла.
------------------------------------------------------------------------
r14015 | pavel.pimenov@gmail.com | 2013-05-22 05:38:47 +0400 (Ср, 22 май 2013) | 7 lines

* (Closed issue 1040) http://code.google.com/p/flylinkdc/issues/detail?id=1040
  - Время загрузки тестового файл-листа из 155 тыс файлов уменьшилась с 3 сек до 2
  - Добавлена возможность визуализации одновременно двух флажков "Скачивал файл + Был в шаре" http://i.imgur.com/ocfCHSb.png 
     TODO - провести локализацию и убрать склейку  TSTRING(I_DOWNLOADED_THIS_FILE) + TSTRING(THIS_FILE_WAS_IN_MY_SHARE)
     TODO - обощить и убрать копипась в области += _T(" + ");
  - Добавлено логирование времени открытия файл-листов
 TODO потестить и влить в остальные ветки.
------------------------------------------------------------------------
r14014 | pavel.pimenov@gmail.com | 2013-05-22 05:25:01 +0400 (Ср, 22 май 2013) | 1 line

# [fly-server] в _DEBUG тоже грузим конфиг flylinkdc-config-r5xx.xml из сети 
------------------------------------------------------------------------
r14012 | a.rainman@gmail.com | 2013-05-22 00:32:17 +0400 (Ср, 22 май 2013) | 2 lines

# Технологический коммит.
# Для чисто технической (кеширующей) переменной QueueItem::m_averageSpeed используем модификатор mutable.
------------------------------------------------------------------------
r14011 | a.rainman@gmail.com | 2013-05-21 23:39:12 +0400 (Вт, 21 май 2013) | 1 line

# log.
------------------------------------------------------------------------
r14010 | a.rainman@gmail.com | 2013-05-21 23:32:32 +0400 (Вт, 21 май 2013) | 1 line

* (Closed Issue 992) Неактуальные данные в фрейме "Окно передач", при этом в окне "Очередь скачивания" данные обновляются своевременно https://code.google.com/p/flylinkdc/issues/detail?id=992 .
------------------------------------------------------------------------
r14009 | a.rainman@gmail.com | 2013-05-21 23:32:23 +0400 (Вт, 21 май 2013) | 2 lines

# Технологический коммит.
# Issue 1037 [BUG] иногда теряем объект User? - добавил доп. диагностику по подсчёту количества юзеров в рантайме. На момент завершения глобальной функции shutdown, расположенной в модуле DCPlusPlus.cpp, мы не имеем права иметь более 2х юзеров. К этому моменту могут оставаться живым только статические ClientManager::g_uflylinkdc и ClientManager::g_me, которые разрушаются при окончательном завершении программы. Для наблюдения добавил вывод статистики так же и в три места MainFrame::OnClose - при попытке закрытия программы (closing = false), при вторичном входе в функции (closing = true), и после завершения stopperThread. Так же добавлен вывод статистики в конструктор и деструктор User.
------------------------------------------------------------------------
r14008 | a.rainman@gmail.com | 2013-05-21 23:32:01 +0400 (Вт, 21 май 2013) | 5 lines

# Технологический коммит.
# Увеличил максимальное количество сохраняемых нод с 200 до 500, а так же подправил комментарий.
# Оптимизация в dht::RoutingTable::saveNodes() - используем vector вместо dqueue, и сразу заказываем необходимое количество памяти.
# Оптимизация CFlylinkDBManager::save_dht_nodes - используем vector вместо dqueue.
# Оптимизация CFlylinkDBManager::load_dht_nodes - используем list вместо dqueue, возвращаем не количество нод, а факт их наличия.
------------------------------------------------------------------------
r14007 | a.rainman@gmail.com | 2013-05-21 23:30:33 +0400 (Вт, 21 май 2013) | 5 lines

# Технологический коммит.
# Добавил диагностики в MerkleTree.
# Почистил код в области использования MerkleTree::BASE_BLOCK_SIZE.
# Почистил код конструктора MerkleTree.
# Оптимизация в MerkleTree::finalize() и MerkleTree::reduceBlocks() - убираем лишние вызовы pop_back для контейнера. После завершения тестов код из TEST_NEW_FINALIZE_MERKLE_THREE и TEST_NEW_REDUCE_BLOCKS_MERKLE_THREE - удалить.
------------------------------------------------------------------------
r14006 | tret2003 | 2013-05-21 22:48:32 +0400 (Вт, 21 май 2013) | 2 lines

# Поправка к r13954
https://code.google.com/p/flylinkdc/source/detail?r=13954
------------------------------------------------------------------------
r14005 | tret2003 | 2013-05-21 22:03:50 +0400 (Вт, 21 май 2013) | 1 line

# default значения bool всегда false
------------------------------------------------------------------------
r14004 | tret2003 | 2013-05-21 21:56:11 +0400 (Вт, 21 май 2013) | 3 lines

# [PVS-Studio]
 V560. A part of conditional expression is always true/false  http://www.viva64.com/en/V560

------------------------------------------------------------------------
r14003 | tret2003 | 2013-05-21 21:37:21 +0400 (Вт, 21 май 2013) | 1 line

# Дополнение r13443, не делаем новый enum, юзаем тот что есть.
------------------------------------------------------------------------
r14002 | a.rainman@gmail.com | 2013-05-21 19:53:07 +0400 (Вт, 21 май 2013) | 4 lines

# Технологический коммит.
# Почистил CFlylinkDBManager от одноразовых циклов.
# Немного оптимизировал CFlylinkDBManager::get_location.
# Добавил диагностики.
------------------------------------------------------------------------
r13999 | tret2003 | 2013-05-21 18:43:23 +0400 (Вт, 21 май 2013) | 2 lines

# Поправка к r13954
https://code.google.com/p/flylinkdc/source/detail?r=13954
------------------------------------------------------------------------
r13998 | pavel.pimenov | 2013-05-21 11:43:51 +0400 (Вт, 21 май 2013) | 2 lines

# [jsoncpp] Исправил ошибочные инициализации вложенных объектов значением NULL
  у них есть свои дефолтные конструкторы и так инитить их нельзя.
------------------------------------------------------------------------
r13996 | pavel.pimenov | 2013-05-21 08:23:07 +0400 (Вт, 21 май 2013) | 1 line

# [test] svn:ignore
------------------------------------------------------------------------
r13992 | tret2003 | 2013-05-20 22:57:06 +0400 (Пн, 20 май 2013) | 1 line

# [jconcpp] Забыл добавить путь для сборки в проекте VS2012
------------------------------------------------------------------------
r13986 | tret2003 | 2013-05-20 19:30:39 +0400 (Пн, 20 май 2013) | 2 lines

* [json]
 Вернул утраченные при слиянии коммиты r11561, r12732, r13947
------------------------------------------------------------------------
r13982 | pavel.pimenov | 2013-05-20 14:07:01 +0400 (Пн, 20 май 2013) | 3 lines

# [issue 1037] http://code.google.com/p/flylinkdc/issues/detail?id=1037
 - Добавлена диагностика утекающего ресурса getCQI (TODO баг пока не починен)

------------------------------------------------------------------------
r13981 | pavel.pimenov | 2013-05-20 09:52:20 +0400 (Пн, 20 май 2013) | 30 lines

# [issue 1037] http://code.google.com/p/flylinkdc/issues/detail?id=1037
 - Добавлено отладочное логирование создания и разрушения User и замечен странный баг и вероятная утечка 
1. запускаем приложение с коннектом к тестовому хабу где сидит один юзер

 [!!!!!!]   [!!!!!!]  User::User(const CID& aCID) this = 04CDE3E0
 [!!!!!!]   [!!!!!!]  User::User(const CID& aCID) this = 04CDE558
 [!!!!!!]   [!!!!!!]  User::User(const CID& aCID) this = 04E3D840
 [!!!!!!]   [!!!!!!]  User::User(const CID& aCID) this = 04D21800
 [!!!!!!]   [!!!!!!]  User::User(const CID& aCID) this = 04D24CC0

 [!!!!!!]   [!!!!!!]  User::~User() this = 04D24CC0
 [!!!!!!]   [!!!!!!]  User::~User() this = 04D21800
 [!!!!!!]   [!!!!!!]  User::~User() this = 04E3D840
 [!!!!!!]   [!!!!!!]  User::~User() this = 04CDE3E0
 [!!!!!!]   [!!!!!!]  User::~User() this = 04CDE558
  
5 объектов сконструировалось 5 и разрушилось. все нормально так и должно быть.
  
2. запускаем второй раз но на этот раз выполняем скачивание файл-листа с этого одного пользователя
 лог уже меняется. 5 объекто создано а вот разрушилось только 4
 [!!!!!!]   [!!!!!!]  User::User(const CID& aCID) this = 04ADE3E0
 [!!!!!!]   [!!!!!!]  User::User(const CID& aCID) this = 04ADE558
 [!!!!!!]   [!!!!!!]  User::User(const CID& aCID) this = 04C3D8B8
 [!!!!!!]   [!!!!!!]  User::User(const CID& aCID) this = 04B22D10
 [!!!!!!]   [!!!!!!]  User::User(const CID& aCID) this = 04C38E70

 [!!!!!!]   [!!!!!!]  User::~User() this = 04C38E70
 [!!!!!!]   [!!!!!!]  User::~User() this = 04B22D10
 [!!!!!!]   [!!!!!!]  User::~User() this = 04ADE3E0
 [!!!!!!]   [!!!!!!]  User::~User() this = 04ADE558
------------------------------------------------------------------------
r13980 | pavel.pimenov | 2013-05-20 08:19:57 +0400 (Пн, 20 май 2013) | 5 lines

# Убрал сокращение времени жизни лока внутри функции. Еж зачем ты это делаешь?
  также я посомтрел диф и не понял что ты починил в r13979
  убрал else так оно ничего не меняет! в чем была ошибка то и как проявлялась?
  

------------------------------------------------------------------------
r13979 | a.rainman@gmail.com | 2013-05-19 21:58:16 +0400 (Вс, 19 май 2013) | 2 lines

* Исправлены локализованные проблемы с закачкой.
# Исправлена ошибка с расчётом размера блока, ошибка была вызвана не корректной реализацией функции CFlylinkDBManager::getBlockSize.
------------------------------------------------------------------------
r13978 | a.rainman@gmail.com | 2013-05-19 21:58:06 +0400 (Вс, 19 май 2013) | 12 lines

# Технологический коммит.
# Исправлен подсчёт статистики в функции Socket::writeAll - считали второй раз, хотя уже считается в Socket::write.
# Добавил немного диагностики.
# PVS:
  - исправлено в 2х местах V107 Implicit type conversion second argument 'connStr.size()' of function 'writeAll' to 32-bit type.
  - помечено ложными срабатываниями по причине того, что inet_addr ( http://msdn.microsoft.com/en-us/library/windows/desktop/ms738563(v=vs.85).aspx ) может обрабатывать только адрес IPv4, а стало быть размер 4 байта здесь корректен:
    - V112 Dangerous magic number 4 used: ...dr, paddr + 4);. 
    - V112 Dangerous magic number 4 used: ...*>(&addr), 4, AF_INET);... 
  - помечено ложными срабатываниями V111 Call of function 'debugTrace' with variable number of arguments. Second argument has memsize type.
# Откатил r9835. Прошу перечитать http://msdn.microsoft.com/en-us/library/windows/desktop/ms740532(v=vs.85).aspx и объяснить на каком основании в ревизии r9835 была добавлена магическая проверка l_val <= 0, при этом в лог ошибка отправляется уже с другим условием l_val == 0.
Так же прошу объяснить на каком основании мы не доверяем системе, и почему система может вернуть нам мусор в этих местах, но при этом апи не содержит функции проверки диапазона допустимых значений.
В который раз прошу, пожалуйста - если что то где то упало, то надо искать реальные ошибки в нашем коде а не маскировать их не понятно на чём основанными проверками.
------------------------------------------------------------------------
r13977 | a.rainman@gmail.com | 2013-05-19 13:52:14 +0400 (Вс, 19 май 2013) | 1 line

# Добавил пропущенные упоминания PVS в комментариях к найденным по диагностикам недочётах.
------------------------------------------------------------------------
r13974 | a.rainman@gmail.com | 2013-05-19 13:40:13 +0400 (Вс, 19 май 2013) | 1 line

# Добавил пропущенные упоминания PVS в комментариях к найденным по диагностикам недочётах.
------------------------------------------------------------------------
r13973 | tret2003 | 2013-05-19 13:32:00 +0400 (Вс, 19 май 2013) | 1 line

# Расставил везде где забыл коммент [!] PVS
------------------------------------------------------------------------
r13970 | tret2003 | 2013-05-19 11:53:30 +0400 (Вс, 19 май 2013) | 3 lines

# [PVS]
 V303. The function is deprecated in the Win64 system. It is safer to use the
'foo' function http://viva64.com/en/v303
------------------------------------------------------------------------
r13969 | tret2003 | 2013-05-19 11:17:18 +0400 (Вс, 19 май 2013) | 2 lines

# [PVS-Studio]
 V801. Decreased performance. It is better to redefine the N function argument as a reference. Consider replacing 'const T' with 'const .. &T' / 'const .. *T' http://www.viva64.com/en/V801
------------------------------------------------------------------------
r13968 | tret2003 | 2013-05-19 11:03:52 +0400 (Вс, 19 май 2013) | 3 lines

# [PVS-Studio]
 V669. The argument is a non-constant reference. The analyzer is unable to determine the position at which this argument is being modified. It is possible that the function contains an error http://viva64.com/en/v669
 V630. The 'malloc' function is used to allocate memory for an array of objects which are classes containing constructors/destructors http://viva64.com/en/v630
------------------------------------------------------------------------
r13966 | tret2003 | 2013-05-19 09:58:34 +0400 (Вс, 19 май 2013) | 1 line

# [lang] an auto commit from localization system...
------------------------------------------------------------------------
r13962 | tret2003 | 2013-05-18 22:48:16 +0400 (Сб, 18 май 2013) | 29 lines

* [jsoncpp][merge]
 * - New CMake based build system. Based in part on contribution from
   Igor Okulist and Damien Buhl (Patch #14). Added support for running
   tests and building with DLL on Windows.
   - added missing JSON_API
   - Visual Studio DLL: suppressed warning "C4251: <data member>: <type> 
   needs to have dll-interface to be used by..." via pragma push/pop
   in json-cpp headers.
   - New header json/version.h now contains version number macros
   (JSONCPP_VERSION_MAJOR, JSONCPP_VERSION_MINOR, JSONCPP_VERSION_PATCH
   and JSONCPP_VERSION_HEXA). While this header is generated by CMake,
   it is committed to ease build with alternate build system 
   (CMake only update the file when it changes avoid issues with VCS).

 * Fixed CMake / Unix build instructions.

 * Added basic Travis CI integration contributed by Igor Okulist.

 * Added clang compiler for continuous integration.

 * Added continuous integration failure e-mail notification.

 * Added continuous integration matrix for shared/static library (specified through environment variables).

 * Added continuous integration matrix for debug/release build. Made static debug build verbose.

 * Fixed continuous integration matrix for debug/release build. Made static debug build verbose.

 * Added missing source file to CMakeLists.txt.
------------------------------------------------------------------------
r13959 | a.rainman@gmail.com | 2013-05-18 17:28:37 +0400 (Сб, 18 май 2013) | 1 line

# compilation fix.
------------------------------------------------------------------------
r13958 | pavel.pimenov@gmail.com | 2013-05-18 16:28:42 +0400 (Сб, 18 май 2013) | 1 line

# Astyle, тамайут ожидания ответа от флайсервера поднял до 5 сек
------------------------------------------------------------------------
r13957 | tret2003 | 2013-05-18 16:28:39 +0400 (Сб, 18 май 2013) | 3 lines

# [PVS-Studio] V303. The function is deprecated in the Win64 system. It is safer to use the 'foo' function http://viva64.com/en/v303


------------------------------------------------------------------------
r13956 | tret2003 | 2013-05-18 16:10:27 +0400 (Сб, 18 май 2013) | 1 line

# Откатил r13955
------------------------------------------------------------------------
r13955 | tret2003 | 2013-05-18 15:58:46 +0400 (Сб, 18 май 2013) | 2 lines

# [PVS-Studio] V510. The 'Foo' function is not expected to receive class-type variable as 'N' actual argument http://viva64.com/ru/v510

------------------------------------------------------------------------
r13954 | tret2003 | 2013-05-18 14:54:33 +0400 (Сб, 18 май 2013) | 2 lines

# [PVS-Studio] V807. Decreased performance. Consider creating a pointer/reference to avoid using the same expression repeatedly http://viva64.com/ru/v807

------------------------------------------------------------------------
r13947 | pavel.pimenov@gmail.com | 2013-05-17 06:24:43 +0400 (Пт, 17 май 2013) | 3 lines

# [jsoncpp][cppcheck]
  - Забытые инициализации мемберов
  - Замена .size() на .empty()
------------------------------------------------------------------------
r13946 | pavel.pimenov@gmail.com | 2013-05-16 18:50:05 +0400 (Чт, 16 май 2013) | 1 line

# r502-beta79 Log [public-build]
------------------------------------------------------------------------
r13945 | pavel.pimenov@gmail.com | 2013-05-16 18:28:04 +0400 (Чт, 16 май 2013) | 4 lines

# r502-beta79 Log

  
  
------------------------------------------------------------------------
r13944 | tret2003 | 2013-05-16 18:09:03 +0400 (Чт, 16 май 2013) | 3 lines

# [PVS-Studio] V813. Decreased performance. The argument should probably be rendered as a constant pointer/reference
http://viva64.com/ru/v813

------------------------------------------------------------------------
r13943 | pavel.pimenov@gmail.com | 2013-05-16 18:05:47 +0400 (Чт, 16 май 2013) | 4 lines

# r502-beta79
  Astyle
  
  
------------------------------------------------------------------------
r13940 | tret2003 | 2013-05-16 15:07:53 +0400 (Чт, 16 май 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1256, created 2013-05-16 17:31:26 +0700
   Total in database:
    - ISP - 1397
    - ISPs logo - 1406
    - Address range - 5889
   Archive CustomLocations.7z created by NightOrion


------------------------------------------------------------------------
r13939 | pavel.pimenov | 2013-05-16 14:35:47 +0400 (Чт, 16 май 2013) | 6 lines

# [fly-server] Оптимизация трафика (заработает после обновления серверной части в течении суток)
  - Добавлет тип запроса - "только счетчики" для случая когда медиаинформация уже есть локально или пришла через файл-лист
  - Расширенная информация запрашивается только точечно для одного файла через меню - "Медиаинформация" или "Копировать"->"Медиаинформация"
  - Убрал возможные дедлоки в DirectoryListingFrame::onClose и в SearchFrame::onClose во время ожидания обработки информации с флай-сервера 
    критическую секцию в цикле ждем не более одной секунды. (пусть пока лучше упадет и скинет дамп на краш сервер для анализа)
  - Убрал копипаст парсинга тэга "media-ext" из JSON-ответа сервера.
------------------------------------------------------------------------
r13935 | scalolaz_scat@mail.ru | 2013-05-16 12:16:57 +0400 (Чт, 16 май 2013) | 2 lines

* (Closed Issue 1034): Баг с пустыми окнами личных сообщений
https://code.google.com/p/flylinkdc/issues/detail?id=1034
------------------------------------------------------------------------
r13931 | tret2003 | 2013-05-15 22:22:50 +0400 (Ср, 15 май 2013) | 2 lines

# PVS.
V303. The function is deprecated in the Win64 system. It is safer to use the 'foo' function
------------------------------------------------------------------------
r13930 | a.rainman@gmail.com | 2013-05-15 21:32:31 +0400 (Ср, 15 май 2013) | 2 lines

# Небольшая оптимизация в TimerManager: исключаем лишний вызов boost::posix_time::microsec_clock::universal_time() в ежесекундном цикле.
# Косметика кода.
------------------------------------------------------------------------
r13929 | a.rainman@gmail.com | 2013-05-15 21:32:15 +0400 (Ср, 15 май 2013) | 5 lines

# PVS.
# V809 Verifying that a pointer value is not NULL is not required. The 'if (instance)' check can be removed. singleton.h 50
# V669 The 'condition' argument is a non-constant reference. The analyzer is unable to determine the position at which this argument is being modified. It is possible that the function contains an error. thread.h 165
# V803 Decreased performance. In case 'm_counter' is iterator it's more effective to use prefix form of increment. Replace iterator++ with ++iterator. w.h 54

------------------------------------------------------------------------
r13928 | a.rainman@gmail.com | 2013-05-15 21:32:02 +0400 (Ср, 15 май 2013) | 4 lines

# Исправлена утечка памяти в FavoriteManager::removePreviewApp.
# Исправлены ошибки в архитектуре при работе со списком приложений для превью (FavoriteManager::previewApplications).
# PVS V813 Decreased performance. The 'name', 'application', 'arguments', 'extension' arguments should probably be rendered as constant references. favoritemanager.h 366

------------------------------------------------------------------------
r13927 | a.rainman@gmail.com | 2013-05-15 21:31:25 +0400 (Ср, 15 май 2013) | 1 line

# PVS V807.
------------------------------------------------------------------------
r13926 | tret2003 | 2013-05-15 20:54:51 +0400 (Ср, 15 май 2013) | 1 line

# Добавил страничку в выгрузку
------------------------------------------------------------------------
r13925 | tret2003 | 2013-05-15 19:09:08 +0400 (Ср, 15 май 2013) | 1 line

# [lang] an auto commit from localization system...
------------------------------------------------------------------------
r13922 | pavel.pimenov | 2013-05-15 17:29:35 +0400 (Ср, 15 май 2013) | 4 lines

# [fly-server] Оптимизация исходящего трафика на set-запросах
  - Исключена дублированная посылка медиаинформации с разных клиентов по одному ТТХ
  - Удалена локальная таблица fly_send_to_server для запоминания посылаемых TTH на fly-server
  - TODO уточнить логику работы g_fly_server_config.isFullMediainfo() и убрать копипаст.
------------------------------------------------------------------------
r13921 | a.rainman@gmail.com | 2013-05-15 13:49:40 +0400 (Ср, 15 май 2013) | 1 line

# Дополнение к r13918: добавил диагностику, убрал умножение на 1000 если period = 0.
------------------------------------------------------------------------
r13920 | tret2003 | 2013-05-15 01:37:13 +0400 (Ср, 15 май 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1255, created 2013-05-15 04:26:38 +0700
   Total in database:
    - ISP - 1397
    - ISPs logo - 1406
    - Address range - 5888
   Archive CustomLocations.7z created by NightOrion


------------------------------------------------------------------------
r13919 | a.rainman@gmail.com | 2013-05-14 23:23:24 +0400 (Вт, 14 май 2013) | 3 lines

* (Started Issue 1032) Уведомлять пользователя о том, что он использует не поддерживаемую версию ОС https://code.google.com/p/flylinkdc/issues/detail?id=1032 . Подробнее о совместимых версиях ОС можно почитать тут http://flylinkdc.com/dokuwiki/doku.php?id=ru:outdatedoperatingsystem .
# Для лучшей читабельности навёл марафет в области определения версий ОС в CompatibilityManager.
# log.
------------------------------------------------------------------------
r13918 | pavel.pimenov@gmail.com | 2013-05-14 21:38:59 +0400 (Вт, 14 май 2013) | 1 line

# [merge] Исправлено деление на ноль https://crash-server.com/Problem.aspx?ProblemID=22552
------------------------------------------------------------------------
r13913 | pavel.pimenov@gmail.com | 2013-05-14 20:38:10 +0400 (Вт, 14 май 2013) | 1 line

# MaskType сделал 32 битным.
------------------------------------------------------------------------
r13912 | tret2003 | 2013-05-14 20:03:53 +0400 (Вт, 14 май 2013) | 1 line

# Изменил способ проверки на пустоту калбек функции
------------------------------------------------------------------------
r13911 | tret2003 | 2013-05-14 19:40:54 +0400 (Вт, 14 май 2013) | 2 lines

# Вырезал IRAINMAN_ASYNC_LOAD_CUSTOMLOCATION

------------------------------------------------------------------------
r13910 | tret2003 | 2013-05-14 19:18:51 +0400 (Вт, 14 май 2013) | 1 line

# Добавил дополнительную информацию при загрузке в сплеш.
------------------------------------------------------------------------
r13900 | tret2003 | 2013-05-14 14:36:44 +0400 (Вт, 14 май 2013) | 1 line

# Убрал из ресурсов дубликатную строку
------------------------------------------------------------------------
r13899 | tret2003 | 2013-05-14 07:18:12 +0400 (Вт, 14 май 2013) | 1 line

# Заменил isSet на isAnySet
------------------------------------------------------------------------
r13898 | a.rainman@gmail.com | 2013-05-13 20:15:57 +0400 (Пн, 13 май 2013) | 11 lines

# Технологический коммит.
* (Closed Issue 1030) При перемещении файлов в очереди скачивания иногда файлы не перемещаются.
# Issue 82 Сделал более понятным и простым код в QueueFrame::moveSelected().
# Исправлен дедлок в ежовой под нагрузкой при завершении скачивании файла.
# Мелкая оптимизация в ежовой: единожды блокируем csUQ в QueueManager::UserQueue::add, а в QueueManager::UserQueue::add входим в неё рекурсивно ибо так быстрее.
# Заменил избыточный мембер QueueManager::queueFile функцией.
# Сделал QueueManager::csM полностью независимым и перевёл на FastCriticalSection - так оптимальнее, ибо код защищаемый данным элементом синхронизации очень короткий и быстрый, а рекурсивные входы в секцию отсутствуют.
# Добавил явную ошибку с описанием при включении IRAINMAN_USE_SEPARATE_CS_IN_QUEUE_MANAGER без IRAINMAN_USE_READ_WRITE_LOCK.
# Поправил диагностику в QueueItem::calcAndUpdateDownloadedBytes().
# [public-build] log.

------------------------------------------------------------------------
r13897 | a.rainman@gmail.com | 2013-05-13 15:49:32 +0400 (Пн, 13 май 2013) | 4 lines

* Исправлено зависание при активной закачке.
# Исправлен глюк с сохранением запроса IP в базу - его зачем то сохраняли в базу.
# Добавлено логгирование времени выполнения функции QueueManager::saveQueue.
# [public-build] log.
------------------------------------------------------------------------
r13896 | tret2003 | 2013-05-13 14:21:27 +0400 (Пн, 13 май 2013) | 1 line

# [lang] an auto commit from localization system...
------------------------------------------------------------------------
r13893 | a.rainman@gmail.com | 2013-05-12 21:28:10 +0400 (Вс, 12 май 2013) | 2 lines

# Исправлен dead lock при активной закачке в ежовой версии. Дедлок имел место быть при включённом ключе компиляции IRAINMAN_USE_SEPARATE_CS_IN_QUEUE_MANAGER, и потому в обычной версии отсутствовал.
# TODO необходим рефакторинг с защитой менеджера базы, ибо там хорошо так виснет https://code.google.com/p/flylinkdc/issues/detail?id=1028 .
------------------------------------------------------------------------
r13892 | a.rainman@gmail.com | 2013-05-12 19:24:57 +0400 (Вс, 12 май 2013) | 1 line

# log.
------------------------------------------------------------------------
r13891 | a.rainman@gmail.com | 2013-05-12 19:24:35 +0400 (Вс, 12 май 2013) | 3 lines

# Технологический коммит.
# Сделал статическими функции обвёртки для QueueItem в QueueManager.
# Мелкая оптимизация в QueueFrame - не копируем список источников для закачки при выводе данных (работает если активен ключ компиляции IRAINMAN_NON_COPYABLE_SOURCE_LIST_IN_QUEUE_FRAME, зависит от IRAINMAN_USE_READ_WRITE_LOCK).
------------------------------------------------------------------------
r13890 | a.rainman@gmail.com | 2013-05-12 19:09:49 +0400 (Вс, 12 май 2013) | 1 line

# Дополнил диагностику в CFlylinkDBManager::getBlockSize. 
------------------------------------------------------------------------
r13889 | tret2003 | 2013-05-12 18:04:55 +0400 (Вс, 12 май 2013) | 1 line

# Обновлена версия ZenLib
------------------------------------------------------------------------
r13888 | a.rainman@gmail.com | 2013-05-12 17:53:44 +0400 (Вс, 12 май 2013) | 1 line

# log
------------------------------------------------------------------------
r13884 | tret2003 | 2013-05-12 17:07:15 +0400 (Вс, 12 май 2013) | 1 line

# Обновлена версия MediaInfo
------------------------------------------------------------------------
r13876 | tret2003 | 2013-05-11 22:57:04 +0400 (Сб, 11 май 2013) | 2 lines

* (Closed issue 1019) 	[BUG] Не полностью поддерживаются пути с глубиной более 260 (MAX_PATH)
 https://code.google.com/p/flylinkdc/issues/detail?id=1019
------------------------------------------------------------------------
r13872 | tret2003 | 2013-05-11 18:46:49 +0400 (Сб, 11 май 2013) | 2 lines

* (Closed issue 1026) Не удаляется поток TTH из NTFS
 https://code.google.com/p/flylinkdc/issues/detail?id=1026
------------------------------------------------------------------------
r13871 | tret2003 | 2013-05-11 18:44:59 +0400 (Сб, 11 май 2013) | 2 lines

# [issue 1019]
 Передаём в MediaInfo путь на файл с припиской в начале \\?\ если путь длиннее 260 символов. Ждем от автора MediaInfo правок ZenLib для адекватного реагирования на такой путь, патч уже выслан.
------------------------------------------------------------------------
r13863 | pavel.pimenov@gmail.com | 2013-05-10 20:45:09 +0400 (Пт, 10 май 2013) | 1 line

# [r502-beta79] Log
------------------------------------------------------------------------
r13860 | tret2003 | 2013-05-10 12:27:23 +0400 (Пт, 10 май 2013) | 3 lines

# [issue 1019]
 File::getTimeStamp не получал дату создания файла если путь длиннее 256 символов
 TODO: разобраться с File::setTimeStamp, возможно там необходимо аналогичная правка
------------------------------------------------------------------------
r13856 | tret2003 | 2013-05-09 18:50:49 +0400 (Чт, 09 май 2013) | 1 line

# Изменения из-за обновления UpdateMaker до версии 2.3 
------------------------------------------------------------------------
r13849 | pavel.pimenov@gmail.com | 2013-05-09 16:27:21 +0400 (Чт, 09 май 2013) | 1 line

# [r502] Astyle
------------------------------------------------------------------------
r13837 | pavel.pimenov@gmail.com | 2013-05-08 22:42:45 +0400 (Ср, 08 май 2013) | 1 line

# Убрал отладочный лог в Util::playSound
------------------------------------------------------------------------
r13836 | tret2003 | 2013-05-08 22:24:02 +0400 (Ср, 08 май 2013) | 2 lines

* (Closed issue 1024) Неправильная работа IPTrust
 https://code.google.com/p/flylinkdc/issues/detail?id=1024
------------------------------------------------------------------------
r13828 | pavel.pimenov | 2013-05-08 12:32:55 +0400 (Ср, 08 май 2013) | 1 line

# Забыл поменять 1 минуту на 30
------------------------------------------------------------------------
r13827 | pavel.pimenov | 2013-05-08 12:31:55 +0400 (Ср, 08 май 2013) | 4 lines

# [fly-server] 
  - Если не смогли прочитать конфиг http://www.fly-server.ru/etc/flylinkdc-config-r5xx.xml
    пытаемся это сделать след раз только через 30 минут
  - Если конфиг прочитался успешно - перечитываем его через 12 часов (или после перезапуска)
------------------------------------------------------------------------
r13826 | tret2003 | 2013-05-08 08:02:56 +0400 (Ср, 08 май 2013) | 1 line

# Сохраняем неизвестные IP только если CustomLocation обновляется.
------------------------------------------------------------------------
r13825 | pavel.pimenov@gmail.com | 2013-05-08 06:42:59 +0400 (Ср, 08 май 2013) | 1 line

# [coding style]
------------------------------------------------------------------------
r13824 | pavel.pimenov@gmail.com | 2013-05-07 23:06:26 +0400 (Вт, 07 май 2013) | 5 lines

# [issue 1019][Рефакторинг] http://code.google.com/p/flylinkdc/issues/detail?id=1019
   Поправлен метод формирования пути через \\\\?\\
    - Убрал лишний вызов фукнции strnicmp 
    - Если длина пути не превышает MAX_PATH эти доп-операции лишние

------------------------------------------------------------------------
r13823 | tret2003 | 2013-05-07 09:41:06 +0400 (Вт, 07 май 2013) | 1 line

# Добавил проверку на обновлённость
------------------------------------------------------------------------
r13815 | tret2003 | 2013-05-04 18:27:02 +0400 (Сб, 04 май 2013) | 1 line

# [lang] an auto commit from localization system...
------------------------------------------------------------------------
r13811 | tret2003 | 2013-05-04 17:24:22 +0400 (Сб, 04 май 2013) | 1 line

# Давлен запрос на сбор и отправку анонимной статистики использования
------------------------------------------------------------------------
r13795 | pavel.pimenov@gmail.com | 2013-05-02 22:27:01 +0400 (Чт, 02 май 2013) | 1 line

# [public-build] Log
------------------------------------------------------------------------
r13794 | pavel.pimenov@gmail.com | 2013-05-02 21:07:39 +0400 (Чт, 02 май 2013) | 1 line

# Поправка src_exclude.txt. два раза было *.obj
------------------------------------------------------------------------
r13793 | pavel.pimenov@gmail.com | 2013-05-02 20:50:09 +0400 (Чт, 02 май 2013) | 1 line

# log
------------------------------------------------------------------------
r13792 | pavel.pimenov@gmail.com | 2013-05-02 20:46:14 +0400 (Чт, 02 май 2013) | 14 lines

* r502-beta77
* (Closed issue 1015) Падение strftime при наличии в сообщении логирования символа '%' 
  http://code.google.com/p/flylinkdc/issues/detail?id=1015
* (Closed issue 982) В окне автообновления показывать сжатый и общий размер файлов
  https://code.google.com/p/flylinkdc/issues/detail?id=982
* (Closed issue 1010) Пополнение CustomLocation от пользователей
   http://code.google.com/p/flylinkdc/issues/detail?id=1010
   - Перехватываем случаи остуствия IP в CustomLocation.ini и сохраняем их в базе данных в таблице fly_location_ip_lost
   - При следующем сеансе связи с fly-server выбираем из таблицы первые 100 "потрянных" адресов и передаем на сервер для анализа.
   - Переданные записи в локальной базе помечаем флажком чтобы больше не слать.
   - На стороне сервере полученный массив сохраняем в аналогичной табличке. ждем когда наберется коллекция 
     и пересылаем разработчику CustomLocation для анализа.
   - TODO - сделать функцию сбора отключемую через конфигурацию (для случая большой нагрузки на fly-server)

------------------------------------------------------------------------
r13791 | pavel.pimenov@gmail.com | 2013-05-02 20:40:48 +0400 (Чт, 02 май 2013) | 5 lines

* (Closed issue 1015) Падение strftime при наличии в сообщении логирования символа '%' http://code.google.com/p/flylinkdc/issues/detail?id=1015
  - Если в сообщение нет % то завать formatTime не нужно. (оптимизация генерации имени файла system.log и подобных)

  

------------------------------------------------------------------------
r13790 | pavel.pimenov@gmail.com | 2013-05-02 20:24:12 +0400 (Чт, 02 май 2013) | 5 lines

* (Closed issue 1015) Падение strftime при наличии в сообщении логирования символа '%' http://code.google.com/p/flylinkdc/issues/detail?id=1015
  - Убрал boost::replace_all. Слава придумал более оптимальную замену.

  

------------------------------------------------------------------------
r13785 | tret2003 | 2013-05-02 17:00:01 +0400 (Чт, 02 май 2013) | 1 line

# Добавил файлы в проект
------------------------------------------------------------------------
r13784 | tret2003 | 2013-05-02 16:56:56 +0400 (Чт, 02 май 2013) | 2 lines

* (Closed issue 982) https://code.google.com/p/flylinkdc/issues/detail?id=982
   - В окне автообновления показывать сжатый и общий размер файлов
------------------------------------------------------------------------
r13783 | pavel.pimenov@gmail.com | 2013-05-02 15:08:27 +0400 (Чт, 02 май 2013) | 3 lines

* (Closed issue 1015) Падение strftime при наличии в сообщении логирования символа '%' http://code.google.com/p/flylinkdc/issues/detail?id=1015
   TODO - for merge r4xx и StrongDC++ sqlite

------------------------------------------------------------------------
r13782 | pavel.pimenov@gmail.com | 2013-05-02 14:23:34 +0400 (Чт, 02 май 2013) | 1 line

# [public-build] Astyle
------------------------------------------------------------------------
r13781 | tret2003 | 2013-05-02 13:54:25 +0400 (Чт, 02 май 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1254, created 2013-05-02 16:51:00 +0700
   Total in database:
    - ISP - 1397
    - ISPs logo - 1406
    - Address range - 5888
   Archive CustomLocations.7z created by NightOrion


------------------------------------------------------------------------
r13780 | pavel.pimenov | 2013-05-02 11:04:46 +0400 (Чт, 02 май 2013) | 4 lines

* (Closed issue 1010) Дополнение к r13779 
   Передачу и сбор "потерянных" IP начинаем если в таблице fly_location_ip более 5000 записей. (сейчас в нашей базе их 5729)
   http://code.google.com/p/flylinkdc/issues/detail?id=1010

------------------------------------------------------------------------
r13779 | pavel.pimenov | 2013-05-02 10:23:50 +0400 (Чт, 02 май 2013) | 8 lines

* (Closed issue 1010) Пополнение CustomLocation от пользователей
   http://code.google.com/p/flylinkdc/issues/detail?id=1010
   - Перехватываем случаи остуствия IP в CustomLocation.ini и сохраняем их в базе данных в таблице fly_location_ip_lost
   - При следующем сеансе связи с fly-server выбираем из таблицы первые 100 "потрянных" адресов и передаем на сервер для анализа.
   - Переданные записи в локальной базе помечаем флажком чтобы больше не слать.
   - На стороне сервере полученный массив сохраняем в аналогичной табличке. ждем когда наберется коллекция 
     и пересылаем разработчику CustomLocation для анализа.
   - TODO - сделать функцию сбора отключемую через конфигурацию (для случая большой нагрузки на fly-server)
------------------------------------------------------------------------
r13778 | pavel.pimenov | 2013-05-02 08:33:45 +0400 (Чт, 02 май 2013) | 1 line

# [fly-server] Поправка к r13777 коммиту - забыл ++
------------------------------------------------------------------------
r13777 | pavel.pimenov | 2013-05-02 08:23:53 +0400 (Чт, 02 май 2013) | 5 lines

# [fly-server] Если в списке результатов поиска оказывалось много значений а сам процесс поиска был закончен, 
               то последующий скроллинг полученных данных не приводил к отображению расширенной информации с fly-server.
               Периодичность обращения к серверу выставил = 2 сек.
                
  
------------------------------------------------------------------------
r13775 | tret2003 | 2013-05-01 18:51:38 +0400 (Ср, 01 май 2013) | 1 line

# [lang] an auto commit from localization system...
------------------------------------------------------------------------
r13773 | pavel.pimenov@gmail.com | 2013-05-01 17:22:01 +0400 (Ср, 01 май 2013) | 1 line

# Log и поменял путь к Araxis
------------------------------------------------------------------------
r13772 | pavel.pimenov@gmail.com | 2013-05-01 17:12:53 +0400 (Ср, 01 май 2013) | 1 line

# r502-beta76 Log
------------------------------------------------------------------------
r13771 | pavel.pimenov@gmail.com | 2013-05-01 16:54:34 +0400 (Ср, 01 май 2013) | 1 line

# [public-build] Astyle
------------------------------------------------------------------------
r13770 | pavel.pimenov@gmail.com | 2013-05-01 16:50:45 +0400 (Ср, 01 май 2013) | 1 line

* r502-beta76
------------------------------------------------------------------------
r13769 | pavel.pimenov@gmail.com | 2013-05-01 16:49:41 +0400 (Ср, 01 май 2013) | 5 lines

* (Closed issue 944) Все скрытые боты хаба вылезли наружу.
 Включил IRAINMAN_USE_HIDDEN_USERS (TODO убрать этот дефайн чтобы не засорять код)
 - http://code.google.com/p/flylinkdc/issues/detail?id=944
 - http://code.google.com/p/flylinkdc/issues/detail?id=916

------------------------------------------------------------------------
r13768 | pavel.pimenov@gmail.com | 2013-05-01 16:43:54 +0400 (Ср, 01 май 2013) | 3 lines

# [issue 1003] http://code.google.com/p/flylinkdc/issues/detail?id=1003
  - Забыли сбросить счетчик узлов RoutingTable::resetNodesCount() в момент закрытия (спасибо Славе что нашел)
  - Поправил стиль кодирования
------------------------------------------------------------------------
r13767 | a.rainman@gmail.com | 2013-05-01 15:55:07 +0400 (Ср, 01 май 2013) | 2 lines

* Исправлена сортировка в окне хабов.
# Поправлено повсеместным включением IRAINMAN_USE_NG_FAST_USER_INFO.
------------------------------------------------------------------------
r13766 | tret2003 | 2013-05-01 12:45:40 +0400 (Ср, 01 май 2013) | 2 lines

* (Closed issue 1009) https://code.google.com/p/flylinkdc/issues/detail?id=1009
   - Если файла IPGrant.ini нет - экстрактировать его из ресурса как пример по аналогии CustomCompressExt.ini
------------------------------------------------------------------------
r13760 | a.rainman@gmail.com | 2013-04-30 13:49:43 +0400 (Вт, 30 апр 2013) | 1 line

# [public-build] log
------------------------------------------------------------------------
r13759 | a.rainman@gmail.com | 2013-04-30 13:21:03 +0400 (Вт, 30 апр 2013) | 1 line

# Ежовая: в DHT::info(...) отсылаем на ту сторону признак ежовости ПО.
------------------------------------------------------------------------
r13758 | a.rainman@gmail.com | 2013-04-30 13:20:58 +0400 (Вт, 30 апр 2013) | 3 lines

# Issue 1003 [DeadLock] Зависание в LRESULT MainFrame::onCheckDHTStats.
# Убрал ClientManager::getInstance()->infoUpdated();

------------------------------------------------------------------------
r13754 | tret2003 | 2013-04-29 17:13:47 +0400 (Пн, 29 апр 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1252, created 2013-04-29 20:12:19 +0700
   Total in database:
    - ISP - 1397
    - ISPs logo - 1406
    - Address range - 5887
   Archive CustomLocations.7z created by NightOrion


------------------------------------------------------------------------
r13753 | a.rainman@gmail.com | 2013-04-29 13:39:35 +0400 (Пн, 29 апр 2013) | 6 lines

# Issue 1003 [DeadLock] Зависание в LRESULT MainFrame::onCheckDHTStats.
# Дополнение к r13750 и r13733.
# Вернул ClientManager::getInstance()->infoUpdated(); для всех версий.
# Если выключен SSA_VIDEO_PREVIEW_FEATURE то используем ConnectivityManager::getInstance()->setup(true); если же фича включена - используем только запуск и остановку DHT.
# По хорошему надо допилить ишью, что бы не вешалось.

------------------------------------------------------------------------
r13752 | a.rainman@gmail.com | 2013-04-28 19:11:38 +0400 (Вс, 28 апр 2013) | 3 lines

* (Closed Issue 1011) Если включена опция "Уменьшать приоритет процесса при сворачивании программы в трей" то после авто-обновления из свёрнутого состояния программа запускается с приоритетом ниже нормального.
# Унёс функционал изменения приоритета процесса в CompatibilityManager.
# В ежовой по умолчанию включена опция "Уменьшать приоритет процесса при сворачивании программы в трей".
------------------------------------------------------------------------
r13751 | tret2003 | 2013-04-28 17:39:29 +0400 (Вс, 28 апр 2013) | 1 line

# [lang] an auto commit from localization system...
------------------------------------------------------------------------
r13750 | a.rainman@gmail.com | 2013-04-28 16:21:32 +0400 (Вс, 28 апр 2013) | 2 lines

# В MainFrame::onCheckDHTStats - убрал лишние установки значения параметра USE_DHT.
# В ежовой вернул потерянный в r13733 проброс портов для DHT, и обновление инфы на хабах.
------------------------------------------------------------------------
r13749 | a.rainman@gmail.com | 2013-04-28 15:41:02 +0400 (Вс, 28 апр 2013) | 1 line

# Косметика.
------------------------------------------------------------------------
r13748 | tret2003 | 2013-04-27 21:59:06 +0400 (Сб, 27 апр 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1251, created 2013-04-28 00:58:17 +0700
   Total in database:
    - ISP - 1397
    - ISPs logo - 1406
    - Address range - 5886
   Archive CustomLocations.7z created by NightOrion


------------------------------------------------------------------------
r13747 | tret2003 | 2013-04-27 21:50:03 +0400 (Сб, 27 апр 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1250, created 2013-04-27 23:37:31 +0700
   Total in database:
    - ISP - 1397
    - ISPs logo - 1406
    - Address range - 5885
   Archive CustomLocations.7z created by NightOrion


------------------------------------------------------------------------
r13746 | tret2003 | 2013-04-27 18:08:01 +0400 (Сб, 27 апр 2013) | 1 line

# [lang] an auto commit from localization system...
------------------------------------------------------------------------
r13745 | tret2003 | 2013-04-26 12:49:26 +0400 (Пт, 26 апр 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1249, created 2013-04-26 14:33:58 +0700
   Total in database:
    - ISP - 1397
    - ISPs logo - 1406
    - Address range - 5884
   Archive CustomLocations.7z created by NightOrion


------------------------------------------------------------------------
r13744 | tret2003 | 2013-04-25 21:49:38 +0400 (Чт, 25 апр 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1247, created 2013-04-26 00:48:11 +0700
   Total in database:
    - ISP - 1397
    - ISPs logo - 1406
    - Address range - 5882
   Archive CustomLocations.7z created by NightOrion


------------------------------------------------------------------------
r13743 | tret2003 | 2013-04-25 21:38:09 +0400 (Чт, 25 апр 2013) | 1 line

# [lang] an auto commit from localization system...
------------------------------------------------------------------------
r13742 | tret2003 | 2013-04-25 20:23:55 +0400 (Чт, 25 апр 2013) | 1 line

# Astyle
------------------------------------------------------------------------
r13741 | tret2003 | 2013-04-25 20:00:19 +0400 (Чт, 25 апр 2013) | 1 line

# Добавил логирование ошибок загрузки IPList выдачи дополнительных слотов по IP
------------------------------------------------------------------------
r13740 | pavel.pimenov | 2013-04-24 23:28:15 +0400 (Ср, 24 апр 2013) | 2 lines

* (Fixed issue 1007) http://code.google.com/p/flylinkdc/issues/detail?id=1007
  Длительное обновление строки статуса в файл-листах с большим кол-вом файлов (10-50 тыс)
------------------------------------------------------------------------
r13735 | pavel.pimenov | 2013-04-24 15:33:14 +0400 (Ср, 24 апр 2013) | 1 line

# [public-build] Astyle
------------------------------------------------------------------------
r13734 | tret2003 | 2013-04-24 14:54:37 +0400 (Ср, 24 апр 2013) | 2 lines

* (Closed  issue 1005) https://code.google.com/p/flylinkdc/issues/detail?id=1005
   - Неверное описание + переработка механизма выдачи дополнительных слотов по IP адресам
------------------------------------------------------------------------
r13733 | pavel.pimenov | 2013-04-24 14:53:40 +0400 (Ср, 24 апр 2013) | 4 lines

* (Fixed issue 1003) http://code.google.com/p/flylinkdc/issues/detail?id=1003
  - При отвключении/включении DHT звался тяжелый метод ConnectivityManager::getInstance()->setup(true);
    Заменил вызов на dht::DHT::getInstance()->stop() / dht::DHT::getInstance()->start()
  - Убрал лишний вызов ClientManager::getInstance()->infoUpdated();
------------------------------------------------------------------------
r13732 | tret2003 | 2013-04-24 13:13:44 +0400 (Ср, 24 апр 2013) | 1 line

# Уточнил описание функционала "IP Grant" TODO - завести issue и доработать
------------------------------------------------------------------------
r13731 | pavel.pimenov | 2013-04-24 11:30:30 +0400 (Ср, 24 апр 2013) | 1 line

# [coding style] m_threadId -> g_threadId зачем статический мембер выведен на уровень класса. он используется только в Thread::start()
------------------------------------------------------------------------
r13730 | pavel.pimenov | 2013-04-24 11:16:19 +0400 (Ср, 24 апр 2013) | 3 lines

# [issue 1003]  http://code.google.com/p/flylinkdc/issues/detail?id=1003
  - Убрал гашение всех исключений при вызове ConnectivityManager::setup
  - TODO Для отключения DHT сейчас гасится все. протестировать и поправить чтобы отключался/включался именно DHT 
------------------------------------------------------------------------
r13728 | tret2003 | 2013-04-23 20:36:28 +0400 (Вт, 23 апр 2013) | 1 line

# Добавил переводчика в окно О программе
------------------------------------------------------------------------
r13727 | tret2003 | 2013-04-23 19:30:22 +0400 (Вт, 23 апр 2013) | 1 line

# Поправил опечатку
------------------------------------------------------------------------
r13726 | tret2003 | 2013-04-23 19:26:49 +0400 (Вт, 23 апр 2013) | 2 lines

# Изменил описание ошибки доступа к Базе данных SQLite
 TODO, обновить все локали разом.
------------------------------------------------------------------------
r13725 | a.rainman@gmail.com | 2013-04-23 16:08:23 +0400 (Вт, 23 апр 2013) | 1 line

# Util::isMediaFile -> Util::isStreamingVideoFile.
------------------------------------------------------------------------
r13724 | scalolaz_scat@mail.ru | 2013-04-22 22:50:27 +0400 (Пн, 22 апр 2013) | 1 line

# Исправление к r13723: убираем ненужную проверку (проверка не по теме) на принадлежность к ВИДЕО файлам.
------------------------------------------------------------------------
r13723 | scalolaz_scat@mail.ru | 2013-04-22 21:43:46 +0400 (Пн, 22 апр 2013) | 2 lines

* (Closed Issue 987): Убрать вывод диалога медиаинформации при двойном клике
https://code.google.com/p/flylinkdc/issues/detail?id=987
------------------------------------------------------------------------
r13718 | tret2003 | 2013-04-21 20:21:00 +0400 (Вс, 21 апр 2013) | 1 line

# Поправил кодировку
------------------------------------------------------------------------
r13717 | tret2003 | 2013-04-21 18:51:04 +0400 (Вс, 21 апр 2013) | 1 line

# Исправил опечатку
------------------------------------------------------------------------
r13716 | tret2003 | 2013-04-21 18:30:37 +0400 (Вс, 21 апр 2013) | 1 line

* Добавлен Португальский Бразильский
------------------------------------------------------------------------
r13715 | scalolaz_scat@mail.ru | 2013-04-18 20:39:43 +0400 (Чт, 18 апр 2013) | 1 line

# префиксов фикс. уязвимость устранена.
------------------------------------------------------------------------
r13714 | scalolaz_scat@mail.ru | 2013-04-18 20:17:53 +0400 (Чт, 18 апр 2013) | 1 line

# Не заметил лишний const :)
------------------------------------------------------------------------
r13713 | scalolaz_scat@mail.ru | 2013-04-18 19:05:28 +0400 (Чт, 18 апр 2013) | 4 lines

# Дополнение к r13661 
(https://code.google.com/p/flylinkdc/source/detail?r=13661)
Затеняем "Расположение", если известен только ИП из предыдущей сессии.
(фенька под экраном: не понравилось - выключи, вымой руки с мылом)
------------------------------------------------------------------------
r13710 | tret2003 | 2013-04-17 19:10:56 +0400 (Ср, 17 апр 2013) | 1 line

# Заменил переменную на указатель
------------------------------------------------------------------------
r13709 | a.rainman@gmail.com | 2013-04-17 17:01:53 +0400 (Ср, 17 апр 2013) | 1 line

# Шаблонизировал Util::isTTH.
------------------------------------------------------------------------
r13708 | a.rainman@gmail.com | 2013-04-17 15:26:23 +0400 (Ср, 17 апр 2013) | 1 line

# +r13707 - забыл удалить остатки устаревшего кода.
------------------------------------------------------------------------
r13707 | a.rainman@gmail.com | 2013-04-17 15:17:54 +0400 (Ср, 17 апр 2013) | 4 lines

# Технологический коммит.
# Применение WinUtil::GetWindowText - убираем копипасту и потенциальные проблемы, к примеру, что текст не влезет в буфер, и будет обрезан.
# В WinUtil добавлены fromAtlString и toAtlString для чуть более быстрого преобразования строк, заодно исключаем копипасту.
# Сделал SSA_SAVE_LAST_NICK_MACROS не отключемым, так же упростил код в той области- исключив лишние конвертирования строк.
------------------------------------------------------------------------
r13706 | a.rainman@gmail.com | 2013-04-17 14:41:52 +0400 (Ср, 17 апр 2013) | 1 line

# +r13705 Добавил диагностику в Util::isTTH. Так же используем типы для работы с памятью в качестве индекса.
------------------------------------------------------------------------
r13705 | tret2003 | 2013-04-17 14:17:55 +0400 (Ср, 17 апр 2013) | 2 lines

* (Closed  issue 999) https://code.google.com/p/flylinkdc/issues/detail?id=999
   - Поиск не реагирует на вставку магнет-ссылки в поисковой запрос.(Рефакторинг)
------------------------------------------------------------------------
r13704 | pavel.pimenov | 2013-04-17 12:45:04 +0400 (Ср, 17 апр 2013) | 2 lines

# [PVS-Studio] new не может вернуть nullptr, она кидает исключение.
 
------------------------------------------------------------------------
r13703 | pavel.pimenov | 2013-04-17 12:36:21 +0400 (Ср, 17 апр 2013) | 4 lines

* Разрешил сохранение в таблице fly_location_ip нескольких значений с одинаковыми start-IP + stop-IP
  Иначе возникает ложное сообщение об ошибке в базе http://i.imgur.com/Ka03mLN.png
  TODO - Славе удалить описание про ошибку.
  Предлагаю в этом случае просто предлагать прислать снимок экрана на ppa74@ya.ru
------------------------------------------------------------------------
r13702 | tret2003 | 2013-04-17 10:36:19 +0400 (Ср, 17 апр 2013) | 1 line

# Изменил домен на vk.com
------------------------------------------------------------------------
r13701 | tret2003 | 2013-04-17 09:40:02 +0400 (Ср, 17 апр 2013) | 1 line

# Косметика
------------------------------------------------------------------------
r13700 | tret2003 | 2013-04-16 23:05:53 +0400 (Вт, 16 апр 2013) | 2 lines

* (Closed issue 999) https://code.google.com/p/flylinkdc/issues/detail?id=999
   - Поиск не реагирует на вставку магнет-ссылки в поисковой запрос
------------------------------------------------------------------------
r13699 | tret2003 | 2013-04-16 16:51:08 +0400 (Вт, 16 апр 2013) | 1 line

# Убрал проверку по IPGuard уже работающих соединений, при изменении настроек надо проверить разово все существующие соединения и корректно закрыть подпадающие под новые правила запрета.
------------------------------------------------------------------------
r13698 | tret2003 | 2013-04-16 16:28:26 +0400 (Вт, 16 апр 2013) | 1 line

# [lang] an auto commit from localization system...
------------------------------------------------------------------------
r13697 | a.rainman@gmail.com | 2013-04-16 12:13:26 +0400 (Вт, 16 апр 2013) | 1 line

# +r13690 вернул цифирь в CFlySafeGuard.
------------------------------------------------------------------------
r13696 | a.rainman@gmail.com | 2013-04-15 23:21:50 +0400 (Пн, 15 апр 2013) | 13 lines

# +r13691 Технологический коммит.
# Исправлено применение правил IPGuard в BufferedSocket::checkEvents() - вызываем Socket::disconect в IpGuard::check, и при этом его не обрабатываем. Славу - отшлёпать! p.s: я вообще не уверен, что эти применения правил в режиме реального времени так уж нужны, ибо проверки в начинке фич тяжеленные.
# Удалил копипастный IpGuard::IPNumToStr, заменил на Socket::convertIP4.
# Удалил из PGLoader и IpGuard мембер, содержащий путь до конфига - нечего хранить строку, которая используется два раза в программе, ну или три, при условии если юзер в настройки залезет.
# IpGrant::load - забыли ссылку.
# Улучшил читабельность в PGLoader::check и PGLoader::addLine.
# Поправил индексы для локализаций, забыли приписку _ALL.
# Косметика в интерфейсах классов.
# Исправлены косяки с подсчётом вызовов.
# IPList теперь вырезается директивой PPA_INCLUDE_IPFILTER.
# Из Util::BackupSettings() убираем резервное копирование файлов, если фичи отключены.
# Много копипасты в коде, и тормознющий поиск как были, так и остались. Кое где используется линейный поиск, а в одном месте вложенный линейный (сложность n^2). Явные косяки в интеграции фич поправил, однако настоятельно прошу самостоятельно переписать начинку фич как следует, ибо проверки там уж очень тяжёлые, а зовутся теперь буквально на каждый чих. К примеру фича выдачи IP адреса для диапазона наверняка используется в провайдерских сборках для ускорения файло обмена в пиринге, а значит правил там много.
# p.s: в ежовой все равны, ежовая только для инета, поэтому ниодной из этих фич там нет, и не будет.
------------------------------------------------------------------------
r13695 | tret2003 | 2013-04-15 23:02:31 +0400 (Пн, 15 апр 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1246, created 2013-04-16 02:01:11 +0700
   Total in database:
    - ISP - 1397
    - ISPs logo - 1406
    - Address range - 5881
   Archive CustomLocations.7z created by NightOrion


------------------------------------------------------------------------
r13692 | tret2003 | 2013-04-15 22:26:01 +0400 (Пн, 15 апр 2013) | 1 line

# Исправил префикс для глобальной переменной
------------------------------------------------------------------------
r13691 | tret2003 | 2013-04-15 21:10:09 +0400 (Пн, 15 апр 2013) | 2 lines

* (Closed issue 906) https://code.google.com/p/flylinkdc/issues/detail?id=906
   - Дописать парсер для распознавания IP вида 10.152.0.0/16
------------------------------------------------------------------------
r13690 | a.rainman@gmail.com | 2013-04-15 19:33:40 +0400 (Пн, 15 апр 2013) | 26 lines

# Технологический коммит.
# Issue 988 [Рефакторинг] Узнать зачем во многих местах у нас появился volatile.
BufferedSocket:
volatile bool m_speaking; - устанавливается в потоке BufferedSocket, проверяется в BufferedSocket::shutdown (во внешний мир из BufferedSocket::putSocket) из любого другого потока. Потому и volatile.
volatile ThreadID m_threadId; - тут было лишнее, забыл убрать в процессе исправления дедлока.
volatile State m_state; - тоже volatile не нужен.

BackgroundTaskExecuter:
volatile bool active; - не нужен volatile. Можно было бы вообще изменить на atomic_flag, но в данном случае это избыточно, ибо установка переменной уже защищена спинлоком, и дополнительная блокировки шины процессора не требуется.

SharedFileStream::SharedFileHandle:
volatile unsigned int ref_cnt; - такая же ситуация, как и с BackgroundTaskExecuter.

CGDIImage
volatile bool m_allowCreateTimer; - заменил на boost::atomic_bool.

CFlySafeGuard
volatile LONG& m_counter; заменил на boost::atomic_bool.

Про места, где используются volatile LONG для передачи в InterlockedIncrement и в подобные функции из WinApi писать не стал.

# Подчистил код в BufferedSocket::threadConnect.
# TODO: после завершения перехода на VS 2012 заменить все boost::atomic на std::atomic.
# Перенёс директиву BOOST_ALL_NO_LIB из client/stdinc.h в client/compiler_flylinkdc.h для избежания проблем с использованием boost вне ядра.
# Мелкое улучшение диагностики в SharedFileStream.
# Косметика.
------------------------------------------------------------------------
r13688 | a.rainman@gmail.com | 2013-04-15 19:25:27 +0400 (Пн, 15 апр 2013) | 2 lines

# Мелкая оптимизация в CFlyProfiler::add - уменьшил длину блокировки, ибо она и без того большая.
# Так же, по хорошему, для CFlyProfiler::g_entry_counter; надо использовать unordered_map, а для участков кода CFlyProfiler в целом надо включить оптимизацию, ибо код там достаточно тяжёлый, и точно будет вызывать дополнительную тормозню в дебаге.
------------------------------------------------------------------------
r13684 | a.rainman@gmail.com | 2013-04-15 16:44:56 +0400 (Пн, 15 апр 2013) | 2 lines

# Исправлены ошибки в реализации TypedListViewCtrl::SetItemFilled. Ошибки могли приводить к отображению некорректного цвета, если стандартный цвет текста не чёрный.
# TODO: заменить вызов GetSysColor на цвета из WinUtil для поддержки тем оформления FlylinkDC++?
------------------------------------------------------------------------
r13683 | a.rainman@gmail.com | 2013-04-15 15:54:48 +0400 (Пн, 15 апр 2013) | 23 lines

# +r13676 PSAPI_VERSION = 1 - необходимо для OS младше Windows 7, т.е. в данный момент для Windows XP, Windows Vista, и их серверных версий. Да и не обязательно его вообще вручную ставить.
# Так же прошу обратить внимание, что изменяется для PSAPI v2 изменяется расположение импортируемых функций, а библиотека Psapi - полностью упраздняется.
Kernel32.lib on Windows 7 and Windows Server 2008 R2;
Psapi.lib if PSAPI_VERSION=1 on Windows 7 and Windows Server 2008 R2;
Psapi.lib on Windows Server 2008, Windows Vista, Windows Server 2003, and Windows XP
DLL
Kernel32.dll on Windows 7 and Windows Server 2008 R2;
Psapi.dll if PSAPI_VERSION=1 on Windows 7 and Windows Server 2008 R2;
Psapi.dll on Windows Server 2008, Windows Vista, Windows Server 2003, and Windows XP

# Ну и выдержка из самого psapi:
//
// Give teams a choice of using a downlevel version of psapi.h for an OS versions.
// Teams can set C_DEFINES=$(C_DEFINES) -DPSAPI_VERSION=1 for downlevel psapi
// on windows 7 and higher.  We found that test code needs this capability.
//
#ifndef PSAPI_VERSION
#if (NTDDI_VERSION >= NTDDI_WIN7)
#define PSAPI_VERSION 2
#else
#define PSAPI_VERSION 1
#endif
#endif
------------------------------------------------------------------------
r13682 | a.rainman@gmail.com | 2013-04-15 15:19:27 +0400 (Пн, 15 апр 2013) | 1 line

# (Closed Issue 996) Забыт вызов FreeLibrary для psapi ?
------------------------------------------------------------------------
r13681 | a.rainman@gmail.com | 2013-04-15 15:19:11 +0400 (Пн, 15 апр 2013) | 2 lines

# PVS.
# Из заметного - экономим память в CFlyGeoIP - PVS V802 On 64-bit platform, structure size can be reduced from 24 to 16 bytes by rearranging the fields according to their sizes in decreasing order. cflylinkdbmanager.h 32
------------------------------------------------------------------------
r13679 | pavel.pimenov | 2013-04-14 22:48:36 +0400 (Вс, 14 апр 2013) | 1 line

# log
------------------------------------------------------------------------
r13678 | scalolaz_scat@mail.ru | 2013-04-14 22:42:22 +0400 (Вс, 14 апр 2013) | 5 lines

* (Partial Fixed Issue 994): Добавить в ПКМ на тексте в чате пункты "Искать в Google", для быстрого поиска информации о выделенном тексте.

Добавлена обработка выделенного текста для чатов Хабов.
К Приватным чатам шифр не подобран :(
Добавлена ссылка Яххо, но пока не задействована в ресурсах
------------------------------------------------------------------------
r13677 | pavel.pimenov | 2013-04-14 21:29:53 +0400 (Вс, 14 апр 2013) | 2 lines

* r5012-beta75
# Astyle
------------------------------------------------------------------------
r13676 | pavel.pimenov | 2013-04-14 21:27:40 +0400 (Вс, 14 апр 2013) | 2 lines

# [merge] PSAPI_VERSION = 1 (Для запуска под win XP)  http://msdn.microsoft.com/en-us/library/windows/desktop/ms683219%28v=vs.85%29.aspx
# Косметика
------------------------------------------------------------------------
r13667 | pavel.pimenov | 2013-04-14 14:45:51 +0400 (Вс, 14 апр 2013) | 7 lines

* jsoncpp
  - Patch #3539678: Copy constructor does not initialize allocated_ for stringValue
    (contributed by rmongia).
  - Patch #3600941: Missing field copy in Json::Value::iterator causing infinite 
    loop when using experimental internal map (#define JSON_VALUE_USE_INTERNAL_MAP)
	(contributed by Ming-Lin Kao).

------------------------------------------------------------------------
r13661 | tret2003 | 2013-04-14 10:46:27 +0400 (Вс, 14 апр 2013) | 1 line

# LastIP делаем меньше интенсивность цвета, а не тупо серым (конфликтовало с серой темой)
------------------------------------------------------------------------
r13660 | tret2003 | 2013-04-14 10:36:53 +0400 (Вс, 14 апр 2013) | 1 line

# Исправил r13655
------------------------------------------------------------------------
r13655 | tret2003 | 2013-04-13 21:03:18 +0400 (Сб, 13 апр 2013) | 1 line

# Потушил Warning
------------------------------------------------------------------------
r13646 | a.rainman@gmail.com | 2013-04-13 15:23:29 +0400 (Сб, 13 апр 2013) | 1 line

# Выпилил пропущенные куски в RIP_USE_CORAL.
------------------------------------------------------------------------
r13631 | a.rainman@gmail.com | 2013-04-10 21:48:43 +0400 (Ср, 10 апр 2013) | 5 lines

* В команду контекстного меню "Отчёт" добавлен вывод месторасположения.
# Issue 937 https://code.google.com/p/flylinkdc/issues/detail?id=937 , Issue 958 https://code.google.com/p/flylinkdc/issues/detail?id=958
# При получении полной инфы о юзере через контекстное меню - получаем месторасположение юзера при необходимости.
# Добавил в g_unknownLocationIndex описание расположение "Неизвестно" - необходимо для пунктов получения полной информации о юзере через контекстное меню.
# [public-build] log.
------------------------------------------------------------------------
r13630 | a.rainman@gmail.com | 2013-04-10 21:04:40 +0400 (Ср, 10 апр 2013) | 1 line

# [public-build] log.
------------------------------------------------------------------------
r13629 | a.rainman@gmail.com | 2013-04-10 20:57:55 +0400 (Ср, 10 апр 2013) | 8 lines

* Оптимизация в функционале определения географического местоположения юзера ( Issue 937 https://code.google.com/p/flylinkdc/issues/detail?id=937 , Issue 958 https://code.google.com/p/flylinkdc/issues/detail?id=958 )
# Убил рудиментарную WinUtil::getFlagImage.
# В UserInfo используем Util::CustomNetworkIndex.
# Из Util::getIpCountry выкинул лишний объект string.
# В Util::CustomNetworkIndex храним tstring и возвращаем на него ссылку тем самым избегаем постоянного конвертирования строк.
# Util::getIpCountry возвращает индекс неизвестного расположения, если расположение не найдено в базе.
# В Util::CustomNetworkIndex добавлен метод isSet - если данные по месторасположению не были в ней найдены метод предотвращает тяжёлые и при том многократные, при каждой отрисовке данных, повторные обращения к базе.
# +r13627 не во всех конфигурациях собиралось.
------------------------------------------------------------------------
r13627 | tret2003 | 2013-04-10 19:43:13 +0400 (Ср, 10 апр 2013) | 1 line

# Убрал ворнинг
------------------------------------------------------------------------
r13626 | a.rainman@gmail.com | 2013-04-10 19:37:13 +0400 (Ср, 10 апр 2013) | 1 line

# Добавил забытые const.
------------------------------------------------------------------------
r13625 | tret2003 | 2013-04-10 14:13:38 +0400 (Ср, 10 апр 2013) | 2 lines

* (Closed  issue 991) https://code.google.com/p/flylinkdc/issues/detail?id=991
   - Не работает сортировка по "Разрешение" в Поиске.
------------------------------------------------------------------------
r13615 | pavel.pimenov | 2013-04-09 20:05:20 +0400 (Вт, 09 апр 2013) | 2 lines

* (Closed issue 983) https://code.google.com/p/flylinkdc/issues/detail?id=983
   - Бесконечные подключения для скачки файл-листа
------------------------------------------------------------------------
r13614 | a.rainman@gmail.com | 2013-04-09 19:55:30 +0400 (Вт, 09 апр 2013) | 1 line

# [public-build] log.
------------------------------------------------------------------------
r13613 | a.rainman@gmail.com | 2013-04-09 19:39:52 +0400 (Вт, 09 апр 2013) | 3 lines

# Технологический коммит.
# В Util подкорректировал методы работы с путями, именами, и расширениями файлов: по возможности убрал копипаст за счёт шаблонов, и поставил перегруженные функции друг за другом.
# Поправил комментарий: ошибки https://www.box.net/shared/qgziqx3ryy91dzu9cb8c и  https://www.box.net/shared/r76og6wrc75gjyc5gf1r были исправлены рефакторингом очереди.
------------------------------------------------------------------------
r13612 | a.rainman@gmail.com | 2013-04-09 19:39:45 +0400 (Вт, 09 апр 2013) | 1 line

# +r13605 Забыли EmptyPage::cancel().
------------------------------------------------------------------------
r13611 | scalolaz_scat@mail.ru | 2013-04-09 19:29:43 +0400 (Вт, 09 апр 2013) | 1 line

# к r13609 : Оптимизация, навеянная Ежами :)
------------------------------------------------------------------------
r13610 | scalolaz_scat@mail.ru | 2013-04-09 18:51:43 +0400 (Вт, 09 апр 2013) | 3 lines

# Убраны ненужные buf
# Добавлены проверки на необходимость вообще обращения к отрисовке иконок HD
# Текст к "Разрешение" чуток смещен вправо
------------------------------------------------------------------------
r13609 | scalolaz_scat@mail.ru | 2013-04-09 18:43:30 +0400 (Вт, 09 апр 2013) | 1 line

# Убраны лишние проверки
------------------------------------------------------------------------
r13608 | a.rainman@gmail.com | 2013-04-09 18:10:50 +0400 (Вт, 09 апр 2013) | 1 line

# +r13604 - уменьшил время жизни объекта.
------------------------------------------------------------------------
r13607 | scalolaz_scat@mail.ru | 2013-04-09 16:06:21 +0400 (Вт, 09 апр 2013) | 1 line

# к r13588 : Путь "Экспорта" в папку с темами
------------------------------------------------------------------------
r13606 | scalolaz_scat@mail.ru | 2013-04-09 15:26:04 +0400 (Вт, 09 апр 2013) | 1 line

# к r13588 : Убрано расширение Тем из списка выбора Тем.
------------------------------------------------------------------------
r13605 | scalolaz_scat@mail.ru | 2013-04-09 14:44:01 +0400 (Вт, 09 апр 2013) | 10 lines

* (Closed Issue 495): Баг при выборе цветовой темы
https://code.google.com/p/flylinkdc/issues/detail?id=495
* (Closed Issue 474): Поведение кнопки "Импорт темы"
https://code.google.com/p/flylinkdc/issues/detail?id=474
# WinUtil: Исправление к резерву иконок "Разрешения" (префикс)

Добавлен функционал "Отмены" изменений окна Настроек. Откатываются ВСЕ изменения, на всех страницах в пределах текущего открытия окна. Думается, так работают все приложения.
Окно, как и положено, закрывается.

# РАЗРАБОТЧИКАМ: видите косяк? Правьте, не спрашивая.
------------------------------------------------------------------------
r13604 | a.rainman@gmail.com | 2013-04-09 14:28:57 +0400 (Вт, 09 апр 2013) | 1 line

# +r13603 Убрал delete в самый низ.
------------------------------------------------------------------------
r13603 | tret2003 | 2013-04-09 14:23:47 +0400 (Вт, 09 апр 2013) | 1 line

# r13602 опечатка
------------------------------------------------------------------------
r13602 | tret2003 | 2013-04-09 14:20:00 +0400 (Вт, 09 апр 2013) | 2 lines

# Переписал r13597 https://code.google.com/p/flylinkdc/source/detail?r=13597
# Заменил, где необходимо, двойной вызов isSet на isAnySet
------------------------------------------------------------------------
r13601 | a.rainman@gmail.com | 2013-04-09 00:08:42 +0400 (Вт, 09 апр 2013) | 1 line

# Откатил r13600 - спать надо, а не код пилить.
------------------------------------------------------------------------
r13600 | a.rainman@gmail.com | 2013-04-08 23:05:52 +0400 (Пн, 08 апр 2013) | 1 line

# Оптимизация в QueueFrame::addQueueItem: используем итераторы в вызове find + insert. Очень жду проверок в PVS от Андрея :)
------------------------------------------------------------------------
r13599 | a.rainman@gmail.com | 2013-04-08 20:46:32 +0400 (Пн, 08 апр 2013) | 1 line

# +r13598: студия зараза. Стала ругаться только после полной пересборки.
------------------------------------------------------------------------
r13598 | a.rainman@gmail.com | 2013-04-08 20:18:43 +0400 (Пн, 08 апр 2013) | 2 lines

# Заменил CLockRedraw::m_is_invalidate параметром шаблона CLockRedraw.
# К сожалению C++ не позволяет прозрачно использовать какие либо значения по умолчанию в шаблоне. По этой причине при использовании CLockRedraw приходится явно указывать, что это шаблон: CLockRedraw<>. В D этой проблемы нет, вот его (язык, а точнее стандартную либу) и надо пилить сейчас когда делать нечего :)
------------------------------------------------------------------------
r13597 | a.rainman@gmail.com | 2013-04-08 19:22:36 +0400 (Пн, 08 апр 2013) | 2 lines

* Не подсвечиваем вкладку "Очередь скачивания" жирным при добавлении в очередь файл-листа или теста для получения IP адреса. Изменение сделано по причине того, что при удалении из очереди скачивания такого типа передач вкладка не подсвечивается жирным. Так же не подсвечиваем данную вкладку жирным при добавлении в очередь или удалении из неё dclst файла.
# Убрал ненужный параметр из QueueManager::addCheckUserIP.
------------------------------------------------------------------------
r13596 | a.rainman@gmail.com | 2013-04-08 18:55:50 +0400 (Пн, 08 апр 2013) | 1 line

# Лёгкая оптимизация в PPA_INCLUDE_DOS_GUARD (Сделал то, что давно хотел): убрал лишние данные из ключа идентификатора. CID + имя файла наиболее точно выполняет роль ключа, и не требует каких либо дополнительных данных. При этом так же гарантируется отсутствие случайной блокировки пользователя, сидящего на нескольких ADC хабах, поскольку количество соединений от одного юзера гораздо раньше лимитируется в ConnectionManager.
------------------------------------------------------------------------
r13592 | tret2003 | 2013-04-08 09:59:44 +0400 (Пн, 08 апр 2013) | 1 line

# Дополнение к r13589, сменил префикс
------------------------------------------------------------------------
r13591 | tret2003 | 2013-04-08 08:07:07 +0400 (Пн, 08 апр 2013) | 1 line

# Не суммируем в статистике окна очереди закачек размер запросов IP, т.к. он имеет размер -1
------------------------------------------------------------------------
r13590 | tret2003 | 2013-04-08 07:25:29 +0400 (Пн, 08 апр 2013) | 1 line

# Откатил r13585, там бага занятнее.
------------------------------------------------------------------------
r13589 | scalolaz_scat@mail.ru | 2013-04-08 06:47:49 +0400 (Пн, 08 апр 2013) | 7 lines

# Небольшое дополнение к r13588, оно-же - попытка пофиксить https://code.google.com/p/flylinkdc/issues/detail?id=495

Событие Cancel не наступает, где-то глубже искать нужно, в PropPage или PropertiesDlg
Так-же, нужно удалять временный файл.

Возможно фикс неуместный, - откатывайте. И заодно предыдущий коммит. Т.к. тема применяется в любом случае сразу при выборе.

------------------------------------------------------------------------
r13588 | scalolaz_scat@mail.ru | 2013-04-08 05:42:22 +0400 (Пн, 08 апр 2013) | 3 lines

* (Closed Issue 455): 	r500 в настройках переименовать кнопку "Экспорт темы" и сделать из "Импорт темы" селектор, подобный выбору темы и языка.

(Тексты были исправлены ранее)
------------------------------------------------------------------------
r13587 | scalolaz_scat@mail.ru | 2013-04-08 02:28:14 +0400 (Пн, 08 апр 2013) | 1 line

# к r13586: то-же для Приватных чатов
------------------------------------------------------------------------
r13586 | scalolaz_scat@mail.ru | 2013-04-08 02:01:32 +0400 (Пн, 08 апр 2013) | 2 lines

* (Closed Issue 453): При клике ПКМ по магнету в чате выводить пункт меню "Копировать Магнет" а не "Копировать URL".
https://code.google.com/p/flylinkdc/issues/detail?id=453
------------------------------------------------------------------------
r13585 | tret2003 | 2013-04-07 22:12:26 +0400 (Вс, 07 апр 2013) | 1 line

# Убрал лишнюю проверку при удалении из очереди в Окне очереди закачек
------------------------------------------------------------------------
r13584 | tret2003 | 2013-04-07 22:01:31 +0400 (Вс, 07 апр 2013) | 1 line

# Убрал * у IP в списке юзеров хаба, означающий что IP получен с прошлой сессии, теперь такой IP будет серым.
------------------------------------------------------------------------
r13583 | scalolaz_scat@mail.ru | 2013-04-07 20:49:35 +0400 (Вс, 07 апр 2013) | 3 lines

# Убрана копипаста заливки итема (из 4 фреймов) перед отрисовкой флагов, иконок, текста
# HubFrame: засерятор ИП со звездой в списке пользователей хаба.

------------------------------------------------------------------------
r13582 | scalolaz_scat@mail.ru | 2013-04-06 17:35:54 +0400 (Сб, 06 апр 2013) | 1 line

# Пнул транк: заэкранировали ожирятор "Разрешения" для HD и Full HD
------------------------------------------------------------------------
r13580 | tret2003 | 2013-04-06 12:56:23 +0400 (Сб, 06 апр 2013) | 1 line

# Поправил проект VS2012
------------------------------------------------------------------------
r13576 | tret2003 | 2013-04-06 10:26:25 +0400 (Сб, 06 апр 2013) | 1 line

* (Closed  Issue 977): Неправильная работа IPGuard [for merge]
------------------------------------------------------------------------
r13575 | JhaoDa | 2013-04-05 20:35:41 +0400 (Пт, 05 апр 2013) | 1 line

# Дополнение к r13574: поправлен идентификатор.
------------------------------------------------------------------------
r13574 | JhaoDa | 2013-04-05 19:04:48 +0400 (Пт, 05 апр 2013) | 1 line

* (Closed  Issue 977): Сделать выравнивание в колонке "Скачано" (шара) по правому краю
------------------------------------------------------------------------
r13573 | pavel.pimenov | 2013-04-05 18:40:48 +0400 (Пт, 05 апр 2013) | 4 lines

* (Closed issue 981) http://code.google.com/p/flylinkdc/issues/detail?id=981
  В списке завершенных отдач некоторые ники превращались в CID 
  одновременно убрал хранение HintedUser

------------------------------------------------------------------------
r13569 | pavel.pimenov | 2013-04-04 18:17:43 +0400 (Чт, 04 апр 2013) | 1 line

# [merge] Закрыл вызов ReleaseDC при убитом m_hWnd + dcassert
------------------------------------------------------------------------
r13568 | pavel.pimenov | 2013-04-04 18:16:32 +0400 (Чт, 04 апр 2013) | 1 line

# [5xx] Astyle
------------------------------------------------------------------------
r13564 | a.rainman@gmail.com | 2013-04-04 15:05:50 +0400 (Чт, 04 апр 2013) | 1 line

# Косметика.
------------------------------------------------------------------------
r13563 | a.rainman@gmail.com | 2013-04-04 14:58:53 +0400 (Чт, 04 апр 2013) | 1 line

# Косметика.
------------------------------------------------------------------------
r13555 | pavel.pimenov | 2013-04-04 12:07:52 +0400 (Чт, 04 апр 2013) | 1 line

# Исправлено падение при загрузке смайлов (выходили за пределы массива)
------------------------------------------------------------------------
r13554 | pavel.pimenov | 2013-04-04 06:58:54 +0400 (Чт, 04 апр 2013) | 1 line

# Ежик! не пиши больше так
------------------------------------------------------------------------
r13553 | a.rainman@gmail.com | 2013-04-04 06:21:14 +0400 (Чт, 04 апр 2013) | 1 line

# Окончательно Fixed Issue 925: Полностью отключил фичу IRAINMAN_USE_SEARCH_FLOOD_FILTER. TODO мне: оптимизировать поиск несколько другим способом: не отвечать на одинаковые запросы от одного искателя в течении определённого промежутка времени, модификацию сделать внутри SearchManager - только это даст реальный эффект при большом числе открытых хабов.
------------------------------------------------------------------------
r13552 | a.rainman@gmail.com | 2013-04-04 06:01:49 +0400 (Чт, 04 апр 2013) | 6 lines

# Доброго утра.
# Исправлены локализованные проблемы с закачкой.
# Исправлено несколько дедлоков.
# Произведена оптимизация за счёт устранения лишних рекурсивных входов в критические секции.
# Убрал кусок копипасты, введший меня в заблуждение и приводивший к одному из исправленных дедлоков.
# Убрал лишнюю проверку из CFlylinkDBManager::remove_queue_item. Функция зовётся в двух местах в проекте, там где может быть id = 0 вернул проверку, а равен нулю он будет у файл листов. Однако второе место где зовётся функция это загрузка базы, в данном случае ошибку в данных игнорировать нельзя.
------------------------------------------------------------------------
r13551 | pavel.pimenov | 2013-04-03 23:20:24 +0400 (Ср, 03 апр 2013) | 2 lines

# Рефаторинг - убрал не используемую настройку BOOLSETTING(GET_USER_COUNTRY)
  страну юзера получаем всегда 
------------------------------------------------------------------------
r13550 | pavel.pimenov | 2013-04-03 23:18:11 +0400 (Ср, 03 апр 2013) | 4 lines

# [issue 905] Рефаторинг http://code.google.com/p/flylinkdc/issues/detail?id=905
  Убрал избыточные вызовы ::SelectObject(cd->nmcd.hdc, WinUtil::systemFont);
  логика временного включения жирного шрифта зашита в drawHDIcon
# Испрален возможный лок в merge_fly_server_info при нажатии кнопки "пауза" при поиске 
------------------------------------------------------------------------
r13548 | a.rainman@gmail.com | 2013-04-03 22:22:03 +0400 (Ср, 03 апр 2013) | 3 lines

# (Closed Issue 975) [DeadLock] Очередь - вешаемся на r13540.
# Добавлена директива IRAINMAN_USE_SEPARATE_CS_IN_QUEUE_MANAGER, зависит от IRAINMAN_USE_READ_WRITE_LOCK. Без неё не включать, ибо будут дедлоки. За счёт введения данной директивы в обычной версии (в не ежовой) крит. секции в QueueManager работают в более оптимальном режиме - исключаются лишние рекурсивные входы.
# TODO мне: подумать и слегка упростить механизмы блокировок в QueueManager (сделаю примерно после 8-10 апреля). Ибо сейчас в обычной версии используется 1 обычная секция, а в ежовой 4 RW секции :). Вероятно полностью уберу секцию из QueueManager::UserQueue поскольку она судя по всему избыточна, и лишь добавляет рекурсивных входов.
------------------------------------------------------------------------
r13547 | tret2003 | 2013-04-03 20:31:27 +0400 (Ср, 03 апр 2013) | 1 line

# Уменьшил по дефолту количество кнопочек на тулбаре
------------------------------------------------------------------------
r13543 | tret2003 | 2013-04-03 13:34:07 +0400 (Ср, 03 апр 2013) | 1 line

# [lang] an auto commit from localization system...
------------------------------------------------------------------------
r13542 | tret2003 | 2013-04-03 08:11:04 +0400 (Ср, 03 апр 2013) | 1 line

# Добавил забытый файл в проект
------------------------------------------------------------------------
r13541 | tret2003 | 2013-04-03 08:05:53 +0400 (Ср, 03 апр 2013) | 2 lines

* [DC++][merge] Add a command to disconnect a hub
http://bazaar.launchpad.net/~dcplusplus-team/dcplusplus/trunk/revision/3249
------------------------------------------------------------------------
r13540 | a.rainman@gmail.com | 2013-04-02 17:22:55 +0400 (Вт, 02 апр 2013) | 2 lines

# Исправлено падение https://www.crash-server.com/Problem.aspx?ClientID=ppa&ProblemID=18543
# Переписал диагностику.
------------------------------------------------------------------------
r13539 | a.rainman@gmail.com | 2013-04-02 16:33:52 +0400 (Вт, 02 апр 2013) | 2 lines

# Выключил SSA_SHELL_INTEGRATION.
# TODO допилить библиотеку расщирения проводника Windows. По шагам: 1 - https://code.google.com/p/flylinkdc/issues/detail?id=971 , 2 - https://code.google.com/p/flylinkdc/issues/detail?id=972 , 3 - https://code.google.com/p/flylinkdc/issues/detail?id=973 , 4 - https://code.google.com/p/flylinkdc/issues/detail?id=966 .
------------------------------------------------------------------------
r13538 | scalolaz_scat@mail.ru | 2013-04-02 16:16:44 +0400 (Вт, 02 апр 2013) | 1 line

# Ожирятор. Второй вариант, оптимизированный.
------------------------------------------------------------------------
r13537 | scalolaz_scat@mail.ru | 2013-04-02 15:04:19 +0400 (Вт, 02 апр 2013) | 1 line

# Ожирятор "Разрешения" HD в Поиске и Списках Файлов.
------------------------------------------------------------------------
r13536 | a.rainman@gmail.com | 2013-04-02 14:38:28 +0400 (Вт, 02 апр 2013) | 1 line

# +r13529 - исправил ошибку в условии ассерта. Копипаст - зло.
------------------------------------------------------------------------
r13535 | a.rainman@gmail.com | 2013-04-01 21:21:12 +0400 (Пн, 01 апр 2013) | 1 line

# Util::parseIP мелкофикс.
------------------------------------------------------------------------
r13534 | a.rainman@gmail.com | 2013-04-01 20:55:49 +0400 (Пн, 01 апр 2013) | 12 lines

* Исправлены локализованные проблемы с закачкой.
# Issue 909.
# Issue 804: В ежовой версии исправлен дедлок при завершении скачивания файла, наблюдалось явление только при активной закачке (в обычной версии данного бага не было).
# Issue 933: В ежесекундном событии QueueManager увеличил минимальный интервал вызова saveQueue() с 10 до 30 секунд, TODO: подумать, и по расписанию сохранять раз в минуту?
# Небольшая оптимизация: в QueueManager::processList прерываем работу функции если список файлов, скачанный с юзера оказался пустым.
# В QueueManager::handlePartialResult исправлена ошибка,  которая могла приводить к падению ежовой версии, на обычной версии этого бага не было.
# QueueManager::UserQueue::addDownloadL переведена на использование внешней блокировки. 
# В QueueItem полностью завершён тест с необходимыми вызовами getDownloadedBytes(true), в связи с чем метод переименован в calcAndUpdateDownloadedBytes().
# Мелкая оптимизация обработка событий UserConnected и UserDisconnected в QueueManager:
 - в QueueManagerListener добавлено событие StatusUpdatedList, позволяющее передавать в speaker одно событие на коллекцию вместо нескольких на каждый элемент.
 - добавлен ключ IRAINMAN_NON_COPYABLE_USER_QUEUE_ON_USER_CONNECTED_OR_DISCONECTED, дающий дополнительную лёгкую оптимизацию за счёт избежания копирования элементов коллекции. Зависит от IRAINMAN_USE_READ_WRITE_LOCK, поскольку без RW секций его включать нельзя, ибо будет дед лок, в общем актуально только для ежовой.
# Косметика комментариев.
------------------------------------------------------------------------
r13533 | a.rainman@gmail.com | 2013-04-01 20:51:43 +0400 (Пн, 01 апр 2013) | 2 lines

# Технологический коммит.
# Speaker::TrySpeakerLock не используем если включено IRAINMAN_USE_READ_WRITE_LOCK.
------------------------------------------------------------------------
r13532 | tret2003 | 2013-04-01 20:14:30 +0400 (Пн, 01 апр 2013) | 1 line

# Забыл вернуть 0
------------------------------------------------------------------------
r13531 | tret2003 | 2013-04-01 20:10:55 +0400 (Пн, 01 апр 2013) | 1 line

# Косметика
------------------------------------------------------------------------
r13530 | tret2003 | 2013-04-01 19:57:20 +0400 (Пн, 01 апр 2013) | 1 line

# Реставрировал сломавшуюся сортировку по IP
------------------------------------------------------------------------
r13529 | a.rainman@gmail.com | 2013-04-01 18:14:57 +0400 (Пн, 01 апр 2013) | 2 lines

# Добавил температуры в реакторе, тем самым ускорив разложение биоразложимого кода. На всякий случай необходимо тестирование.
# TODO: надо слегка оптимизнуть SearchFrm::compareItems по колонке COLUMN_MEDIA_XY.
------------------------------------------------------------------------
r13527 | tret2003 | 2013-04-01 14:36:38 +0400 (Пн, 01 апр 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1245, created 2013-04-01 17:04:37 +0700
   Total in database:
    - ISP - 1399
    - ISPs logo - 1408
    - Address range - 5881
   Archive CustomLocations.7z created by NightOrion


------------------------------------------------------------------------
r13526 | tret2003 | 2013-04-01 07:06:16 +0400 (Пн, 01 апр 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1244, created 2013-04-01 09:30:36 +0700
   Total in database:
    - ISP - 1399
    - ISPs logo - 1408
    - Address range - 5878
   Archive CustomLocations.7z created by NightOrion


------------------------------------------------------------------------
r13525 | scalolaz_scat@mail.ru | 2013-04-01 02:26:17 +0400 (Пн, 01 апр 2013) | 1 line

# более Корректный сплеш 1 апреля [public-build]
------------------------------------------------------------------------
r13524 | a.rainman@gmail.com | 2013-04-01 01:38:32 +0400 (Пн, 01 апр 2013) | 1 line

# Упростил работу с датами для сплеша.
------------------------------------------------------------------------
r13523 | a.rainman@gmail.com | 2013-04-01 01:05:36 +0400 (Пн, 01 апр 2013) | 1 line

# [public-build] Fixed critical mistakes! :) Областные файло-обменные помойки! (:
------------------------------------------------------------------------
r13522 | a.rainman@gmail.com | 2013-04-01 00:32:33 +0400 (Пн, 01 апр 2013) | 2 lines

# [public-build] TODO мне по IRAINMAN_USE_UNICODE_IN_NMDC.

------------------------------------------------------------------------
r13521 | a.rainman@gmail.com | 2013-04-01 00:29:59 +0400 (Пн, 01 апр 2013) | 1 line

# Косметика.
------------------------------------------------------------------------
r13520 | a.rainman@gmail.com | 2013-04-01 00:29:49 +0400 (Пн, 01 апр 2013) | 8 lines

* Исправлены ошибки при работе с кодировками для избранных adc хабов.
# Для adc хабов не сохраняем кодировку в свойствах избранных хабов.
# Ошибка была не просто в отображении, реально глюк с кодировкой был :(
# Вместо ишьи - лог:
[23:43:45] <MikeKMV> кодировка хаба не доступна почему-то но написано 1251
[23:44:27] <MikeKMV> на адц нельзя поменять кодировку
[23:44:38] <MikeKMV> но блин пишет 1251
[23:45:09] <IRainman7HE> Агу, и она utf8, пойду посмотрю почему так отображается,  скорее всего просто пишет, но реально значение utf8
------------------------------------------------------------------------
r13519 | a.rainman@gmail.com | 2013-03-31 23:26:49 +0400 (Вс, 31 мар 2013) | 1 line

# (Closed Issue 967) FlylinkDC HE не загружается список пользователей на ADC-хабах.
------------------------------------------------------------------------
r13518 | tret2003 | 2013-03-31 22:06:07 +0400 (Вс, 31 мар 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1241, created 2013-04-01 00:13:01 +0700
   Total in database:
    - ISP - 1399
    - ISPs logo - 1407
    - Address range - 5879
   Archive CustomLocations.7z created by NightOrion


------------------------------------------------------------------------
r13515 | a.rainman@gmail.com | 2013-03-31 18:04:56 +0400 (Вс, 31 мар 2013) | 1 line

# Косметика.
------------------------------------------------------------------------
r13513 | a.rainman@gmail.com | 2013-03-31 17:38:50 +0400 (Вс, 31 мар 2013) | 3 lines

# log.
* Добавлено расширение оболочки проводника, позволяющая добавлять и удалять папки из шары непосредственно из проводника. Интеграция включается на странице настроек "Дополнительно->Интеграция" ( http://flylinkdc.com/dokuwiki/doku.php?id=ru:intergation ).
# TODO: необходимо обновить справку в вике, там странички вообще нет :(
------------------------------------------------------------------------
r13511 | a.rainman@gmail.com | 2013-03-31 16:21:18 +0400 (Вс, 31 мар 2013) | 6 lines

# Дописал SSA_SHELL_INTEGRATION, и включил его.
# [lang] Требуется обновление локализаций.
# Добавил файлы расширения в список файлов авто-апдейта.
# TODO: для полной интеграции на Win x64 необходимо регистрировать так же 32х битную библиотеку (Issue 966).
# TODO: всем релизерам собрать у себя либы, и положить в папку сс скомпилированным Флаем,  в общем делаем тоже самое, что с обозревателем порталов, и апдейтером.
# TODO: необходимо обновить UpdateMaker, залью чуть позже.
------------------------------------------------------------------------
r13510 | a.rainman@gmail.com | 2013-03-31 15:21:09 +0400 (Вс, 31 мар 2013) | 1 line

# +r13508 забыл проект и новый файл влить. Теперь точно всё.
------------------------------------------------------------------------
r13509 | a.rainman@gmail.com | 2013-03-31 15:07:47 +0400 (Вс, 31 мар 2013) | 1 line

# +r13508 Упрощение HubFrame::updateUserList - забыл хидер влить.
------------------------------------------------------------------------
r13508 | a.rainman@gmail.com | 2013-03-31 14:49:32 +0400 (Вс, 31 мар 2013) | 6 lines

# Упрощение HubFrame::updateUserList - выкинут лишний флажёк и лишний вызов.
# +r13460: вкатил изменения назад, но только для ежовой.
# Обновлены ключи компиляции.
# Добавлена тестовая директива IRAINMAN_USE_OLD_CODE_IN_USER_INFO_ONLY_FOR_TEST.
# Обновлены ключи компиляции: DONT_SHOW_HIDDEN_USERS_IN_HUB_FRAME переименован в IRAINMAN_USE_HIDDEN_USERS
# Для фичи IRAINMAN_USE_HIDDEN_USERS - скрываем скрытых пользователей так же и на ADC хабах.
------------------------------------------------------------------------
r13507 | tret2003 | 2013-03-31 14:36:07 +0400 (Вс, 31 мар 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1240, created 2013-03-31 17:34:54 +0700
   Total in database:
    - ISP - 1399
    - ISPs logo - 1407
    - Address range - 5879
   Archive CustomLocations.7z created by NightOrion


------------------------------------------------------------------------
r13506 | tret2003 | 2013-03-31 14:18:04 +0400 (Вс, 31 мар 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1239, created 2013-03-31 17:16:09 +0700
   Total in database:
    - ISP - 1398
    - ISPs logo - 1407
    - Address range - 5878
   Archive CustomLocations.7z created by NightOrion


------------------------------------------------------------------------
r13505 | tret2003 | 2013-03-31 12:35:39 +0400 (Вс, 31 мар 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1238, created 2013-03-31 15:27:15 +0700
   Total in database:
    - ISP - 1398
    - ISPs logo - 1407
    - Address range - 5869
   Archive CustomLocations.7z created by NightOrion


------------------------------------------------------------------------
r13503 | tret2003 | 2013-03-31 09:59:24 +0400 (Вс, 31 мар 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1237, created 2013-03-31 12:32:45 +0700
   Total in database:
    - ISP - 1397
    - ISPs logo - 1406
    - Address range - 5868
   Archive CustomLocations.7z created by NightOrion


------------------------------------------------------------------------
r13502 | tret2003 | 2013-03-30 23:29:03 +0400 (Сб, 30 мар 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1235, created 2013-03-31 02:28:02 +0700
   Total in database:
    - ISP - 1396
    - ISPs logo - 1404
    - Address range - 5861
   Archive CustomLocations.7z created by NightOrion


------------------------------------------------------------------------
r13497 | tret2003 | 2013-03-30 15:12:20 +0400 (Сб, 30 мар 2013) | 1 line

* (Closed Issue 964) В сообщении об ошибке скачивания при обновлении неправильная ссылка.
------------------------------------------------------------------------
r13483 | tret2003 | 2013-03-30 11:26:05 +0400 (Сб, 30 мар 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1234, created 2013-03-30 14:00:49 +0700
   Total in database:
    - ISP - 1396
    - ISPs logo - 1404
    - Address range - 5861
   Archive CustomLocations.7z created by NightOrion


------------------------------------------------------------------------
r13481 | tret2003 | 2013-03-30 11:19:37 +0400 (Сб, 30 мар 2013) | 1 line

# Откатил частично r13479
------------------------------------------------------------------------
r13479 | tret2003 | 2013-03-30 11:02:09 +0400 (Сб, 30 мар 2013) | 1 line

# [UpdateMaker] Обновление проектов, фикс сборки
------------------------------------------------------------------------
r13470 | pavel.pimenov | 2013-03-30 08:15:21 +0400 (Сб, 30 мар 2013) | 1 line

* <OmitFramePointers>false</OmitFramePointers> (https://crash-server.com/Integration.aspx)
------------------------------------------------------------------------
r13462 | tret2003 | 2013-03-29 22:25:04 +0400 (Пт, 29 мар 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1233, created 2013-03-30 01:23:40 +0700
   Total in database:
    - ISP - 1395
    - ISPs logo - 1403
    - Address range - 5859
   Archive CustomLocations.7z created by NightOrion


------------------------------------------------------------------------
r13461 | pavel.pimenov | 2013-03-29 22:14:31 +0400 (Пт, 29 мар 2013) | 1 line

# log [public-build]
------------------------------------------------------------------------
r13460 | pavel.pimenov | 2013-03-29 21:52:52 +0400 (Пт, 29 мар 2013) | 9 lines

! Откатил ревизии для срочного перевыпуска бетки - что-то сломалось,
Reverse merged revision(s) 13459-13458 from trunk:
# [Issue 939] Удалил экран NIGHT_BUILD для IRAINMAN_USE_NG_FAST_USER_INFO.
........
# Обновлены ключи компиляции: DONT_SHOW_HIDDEN_USERS_IN_HUB_FRAME переименован в IRAINMAN_USE_HIDDEN_USERS
# Для фичи IRAINMAN_USE_HIDDEN_USERS - скрываем скрытых пользователей так же и на ADC хабах.
........


------------------------------------------------------------------------
r13459 | a.rainman@gmail.com | 2013-03-29 21:35:55 +0400 (Пт, 29 мар 2013) | 2 lines

# Обновлены ключи компиляции: DONT_SHOW_HIDDEN_USERS_IN_HUB_FRAME переименован в IRAINMAN_USE_HIDDEN_USERS
# Для фичи IRAINMAN_USE_HIDDEN_USERS - скрываем скрытых пользователей так же и на ADC хабах.
------------------------------------------------------------------------
r13458 | a.rainman@gmail.com | 2013-03-29 21:17:28 +0400 (Пт, 29 мар 2013) | 1 line

# [Issue 939] Удалил экран NIGHT_BUILD для IRAINMAN_USE_NG_FAST_USER_INFO.
------------------------------------------------------------------------
r13457 | pavel.pimenov | 2013-03-29 21:16:42 +0400 (Пт, 29 мар 2013) | 2 lines

* r502-beta74.1
  File::getSafeTimeStamp - Исправлено падение при отсуствии файла Custom* (Чистая инсталляция)
------------------------------------------------------------------------
r13456 | a.rainman@gmail.com | 2013-03-29 20:57:52 +0400 (Пт, 29 мар 2013) | 3 lines

# [Issue 939]
# +r13447 - включил IRAINMAN_USE_NG_FAST_USER_INFO тем самым частично восстановлена авторесортировка по колонкам в окне хаба.
# Вынес enum из UserInfo.h в UserInfoColumns.h ибо не собиралось.
------------------------------------------------------------------------
r13455 | pavel.pimenov | 2013-03-29 20:45:06 +0400 (Пт, 29 мар 2013) | 1 line

# log [public-build]
------------------------------------------------------------------------
r13453 | pavel.pimenov | 2013-03-29 20:13:10 +0400 (Пт, 29 мар 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1232, created 2013-03-29 10:33:23 +0700
   Total in database:
    - ISP - 1395
    - ISPs logo - 1403
    - Address range - 5859
   Archive CustomLocations.7z created by NightOrion


------------------------------------------------------------------------
r13452 | pavel.pimenov | 2013-03-29 20:01:46 +0400 (Пт, 29 мар 2013) | 1 line

* r502-beta74
------------------------------------------------------------------------
r13451 | a.rainman@gmail.com | 2013-03-29 19:59:24 +0400 (Пт, 29 мар 2013) | 1 line

# Удалил остатки ALLOW_RELOAD_INTERNALBD_IN_RUNTIME. Из механизма авто обновления код удалять не стал, ибо там много.
------------------------------------------------------------------------
r13450 | pavel.pimenov | 2013-03-29 19:54:42 +0400 (Пт, 29 мар 2013) | 1 line

# Astyle + Добавил в игнор *.opensdf
------------------------------------------------------------------------
r13449 | a.rainman@gmail.com | 2013-03-29 19:52:30 +0400 (Пт, 29 мар 2013) | 1 line

# +r13448 и r13447 - compilation  fix. Для коментариев больших кусков кода лучше юзать "//" Специальная кнопочка для этого есть в панели у студии (Ctrl+K, Ctrl+C)
------------------------------------------------------------------------
r13448 | a.rainman@gmail.com | 2013-03-29 19:48:05 +0400 (Пт, 29 мар 2013) | 4 lines

# +r13446.
# Исправлена ошибка определния типа подключения (актив/пассив) для своего юзера на хабе в WinUtil::getUserColor.
# Дополнительная оптимизация WinUtil::getUserColor.
# Из UserInfo для COLUMN_MODE убрал зависимость от isUdpActive().
------------------------------------------------------------------------
r13447 | pavel.pimenov | 2013-03-29 19:41:23 +0400 (Пт, 29 мар 2013) | 5 lines

# https://code.google.com/p/flylinkdc/issues/detail?id=953
  - Удалил у UserInfo базовый массив tstring-ов public ColumnBase< COLUMN_LAST > (экономия памяти на моих хабах по сравнению с beta73 - 40Mb)
  - Закэшировал локацию и индекс флага в UserInfo (TODO - отрефакторить и заменить на вложенный класс CustomNetworkIndex)
  - Вернул работу сортировки и поиска по колонке "расположение"
  - Возможно что-то сломал еще
------------------------------------------------------------------------
r13446 | pavel.pimenov | 2013-03-29 19:05:58 +0400 (Пт, 29 мар 2013) | 3 lines

* (Fixed issue 961 )  https://code.google.com/p/flylinkdc/issues/detail?id=961
  - Облегчена функция WinUtil::getUserColor в ней теперь не ищется OnlineUser по CID
  - Исправлено зависание при получени цвета юзера.
------------------------------------------------------------------------
r13445 | a.rainman@gmail.com | 2013-03-29 18:48:29 +0400 (Пт, 29 мар 2013) | 1 line

# В SharedFileStream добавил комментарии, разъясняющие почему именно на некоторых методах класса не нужна блокировка. Блокировка здесь не нужна, поскольку функция вызывается сразу после конструктора, и по сути является частью конструктора.
------------------------------------------------------------------------
r13444 | pavel.pimenov | 2013-03-29 18:35:10 +0400 (Пт, 29 мар 2013) | 1 line

# Изменил алгоритм бенчмарка рекурсивоного обхода дерева.
------------------------------------------------------------------------
r13443 | scalolaz_scat@mail.ru | 2013-03-29 17:00:09 +0400 (Пт, 29 мар 2013) | 1 line

# Дополнение к r13437: SearchFrm: добавлен функционал "Копировать / Имя Папки"
------------------------------------------------------------------------
r13442 | a.rainman@gmail.com | 2013-03-29 16:19:03 +0400 (Пт, 29 мар 2013) | 2 lines

# Обновлены ключи компиляции: IRAINMAN_TTH_GET_TODO_CHECK проверен и переименован IRAINMAN_ENABLE_TTH_GET_FLAG. Произведено захоронение фичи.
# В ConnectionManager::on(UserConnectionListener::Supports, ...) добавлена диагностика критического момента: не установки supports для юзера. Проверку в релизе полностью исключил - если упадёт, хотя бы увидим, а гейзенбаги с закачкой можем и не заметить.
------------------------------------------------------------------------
r13441 | a.rainman@gmail.com | 2013-03-29 16:18:56 +0400 (Пт, 29 мар 2013) | 1 line

# [Issue 632] Подчищен класс обвёртка над CInternetHandle.
------------------------------------------------------------------------
r13440 | scalolaz_scat@mail.ru | 2013-03-29 14:57:18 +0400 (Пт, 29 мар 2013) | 2 lines

# Дополнение к r13437: префикс переменным
Мозг выкипает. И вообще был уговор: "префиксы не трогай, я сам исправлю (с) PPA"
------------------------------------------------------------------------
r13439 | scalolaz_scat@mail.ru | 2013-03-29 14:53:04 +0400 (Пт, 29 мар 2013) | 1 line

# Дополнение к r13437: префикс переменным
------------------------------------------------------------------------
r13438 | scalolaz_scat@mail.ru | 2013-03-29 14:43:03 +0400 (Пт, 29 мар 2013) | 1 line

# Дополнение к r13437: префикс переменным, исправлен цикл GetItemCount()
------------------------------------------------------------------------
r13437 | scalolaz_scat@mail.ru | 2013-03-29 13:26:20 +0400 (Пт, 29 мар 2013) | 2 lines

* (Fixed Issue 887) Меню по правой кнопке на папке - копировать - имя ПАПКИ
https://code.google.com/p/flylinkdc/issues/detail?id=887
------------------------------------------------------------------------
r13434 | pavel.pimenov | 2013-03-29 06:59:09 +0400 (Пт, 29 мар 2013) | 7 lines

* [issue 958] http://code.google.com/p/flylinkdc/issues/detail?id=958
  Перенос CustomLocations.ini в базу данных. (Часть 1)
  TODO 
    - Исключить лишие обращения к БД если уже один раз достали значение. (кешировать в columns + хранить индекс)
    - Починить сортировку и поиск по колонке расположения.
  
  
------------------------------------------------------------------------
r13433 | pavel.pimenov | 2013-03-28 22:16:03 +0400 (Чт, 28 мар 2013) | 1 line

# SharedFileStream не понял зачем Еж инитит pos в -1 только для _DEBUG.
------------------------------------------------------------------------
r13430 | JhaoDa | 2013-03-28 19:29:01 +0400 (Чт, 28 мар 2013) | 1 line

* (Closed  Issue 959): Добавлен формат WebM (http://en.wikipedia.org/wiki/WebM)
------------------------------------------------------------------------
r13429 | pavel.pimenov | 2013-03-28 19:14:01 +0400 (Чт, 28 мар 2013) | 2 lines

# [cppcheck] - C-стиль привдения заменил на С++ reinterpret_cast
  
------------------------------------------------------------------------
r13428 | pavel.pimenov | 2013-03-28 19:07:51 +0400 (Чт, 28 мар 2013) | 2 lines

# [issue 905] http://code.google.com/p/flylinkdc/issues/detail?id=905
  Убрал дублирование кода в отрисовке иконки HD
------------------------------------------------------------------------
r13427 | pavel.pimenov | 2013-03-28 18:41:01 +0400 (Чт, 28 мар 2013) | 2 lines

* [Issue 937] http://code.google.com/p/flylinkdc/issues/detail?id=937
  Баг в определении страны. если ip > 2гиг то ломались get_country 
------------------------------------------------------------------------
r13426 | JhaoDa | 2013-03-28 16:19:40 +0400 (Чт, 28 мар 2013) | 1 line

# Дополнение к r13413: поправлены иконки.
------------------------------------------------------------------------
r13424 | tret2003 | 2013-03-28 11:39:38 +0400 (Чт, 28 мар 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1231, created 2013-03-28 14:38:31 +0700
   Total in database:
    - ISP - 1395
    - ISPs logo - 1403
    - Address range - 5846
   Archive CustomLocations.7z created by NightOrion


------------------------------------------------------------------------
r13421 | pavel.pimenov | 2013-03-28 06:29:01 +0400 (Чт, 28 мар 2013) | 8 lines

# [Рефакторинг] Поправки к http://code.google.com/p/flylinkdc/source/detail?r=13418#
  - Объекты в функции эффективнее передавать по константным ссылкам а не по значения. GetMediaVideoIcon(const tstring& p_col) (не делается лишняя копия)
  - Забыли проверку после find('x') (в колонке не всегда есть даные)
  - Заменил порядок проверки 
     if (ctrlResults.findColumn(cd->iSubItem) == COLUMN_MEDIA_XY && !si->columns[COLUMN_MEDIA_XY].empty())
    на
     if (!si->columns[COLUMN_MEDIA_XY].empty() && ctrlResults.findColumn(cd->iSubItem) == COLUMN_MEDIA_XY)
   Более легкую проверку лучше ставить в начале. т.к. если первое условеи будет false, то второе выполняться вообще не будет (а там линейный поиск колонки)
------------------------------------------------------------------------
r13420 | scalolaz_scat@mail.ru | 2013-03-28 02:01:56 +0400 (Чт, 28 мар 2013) | 1 line

# MediaVideoIco: Красотульки и ровности по высоте строки.
------------------------------------------------------------------------
r13419 | tret2003 | 2013-03-28 01:03:42 +0400 (Чт, 28 мар 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1230, created 2013-03-28 02:51:05 +0700
   Total in database:
    - ISP - 1395
    - ISPs logo - 1403
    - Address range - 5845
   Archive CustomLocations.7z created by NightOrion


------------------------------------------------------------------------
r13418 | scalolaz_scat@mail.ru | 2013-03-27 22:44:38 +0400 (Ср, 27 мар 2013) | 3 lines

# Дополнение к r13413:
Поиск разрешений перенесён в WinUtil
[public-build] - команда "фас" дадена!
------------------------------------------------------------------------
r13415 | scalolaz_scat@mail.ru | 2013-03-27 22:01:07 +0400 (Ср, 27 мар 2013) | 3 lines

# Дополнение к r13413:
Вынесли глобальную переменную в WinUtil
Исправление SearchFrm - получение данных.
------------------------------------------------------------------------
r13413 | scalolaz_scat@mail.ru | 2013-03-27 20:53:55 +0400 (Ср, 27 мар 2013) | 2 lines

* Close Issue #905: Выводить в колонку Видео HD для определённых разрешений
В запасе (закомментированы) иконки SD и Mobile Video (>640*480)
------------------------------------------------------------------------
r13412 | pavel.pimenov | 2013-03-27 20:44:27 +0400 (Ср, 27 мар 2013) | 2 lines

# [test] [Issue 956] http://code.google.com/p/flylinkdc/issues/detail?id=956
   Тест производительности рекурсивного чтения файлов разными способами.
------------------------------------------------------------------------
r13410 | pavel.pimenov | 2013-03-27 19:56:35 +0400 (Ср, 27 мар 2013) | 2 lines

# Исправлен запрос определения наличия в базе данных таблицы с именем x (for merge)
  select count(*) from sqlite_master where type = 'table' and lower(tbl_name) = 'x'
------------------------------------------------------------------------
r13402 | tret2003 | 2013-03-26 13:03:22 +0400 (Вт, 26 мар 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1229, created 2013-03-26 14:43:27 +0700
   Total in database:
    - ISP - 1393
    - ISPs logo - 1401
    - Address range - 5840
   Archive CustomLocations.rar created by NightOrion


------------------------------------------------------------------------
r13401 | tret2003 | 2013-03-26 11:33:38 +0400 (Вт, 26 мар 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1228, created 2013-03-26 14:18:55 +0700
   Total in database:
    - ISP - 1393
    - ISPs logo - 1401
    - Address range - 5840
   Archive CustomLocations.rar created by NightOrion


------------------------------------------------------------------------
r13400 | tret2003 | 2013-03-26 10:26:22 +0400 (Вт, 26 мар 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1227, created 2013-03-26 13:09:23 +0700
   Total in database:
    - ISP - 1393
    - ISPs logo - 1402
    - Address range - 5842
   Archive CustomLocations.rar created by NightOrion


------------------------------------------------------------------------
r13399 | tret2003 | 2013-03-26 09:58:34 +0400 (Вт, 26 мар 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1226, created 2013-03-26 12:53:15 +0700
   Total in database:
    - ISP - 1394
    - ISPs logo - 1403
    - Address range - 5842
   Archive CustomLocations.rar created by NightOrion


------------------------------------------------------------------------
r13398 | tret2003 | 2013-03-26 09:44:26 +0400 (Вт, 26 мар 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1225, created 2013-03-26 12:42:51 +0700
   Total in database:
    - ISP - 1395
    - ISPs logo - 1404
    - Address range - 5842
   Archive CustomLocations.rar created by NightOrion


------------------------------------------------------------------------
r13397 | tret2003 | 2013-03-26 08:50:44 +0400 (Вт, 26 мар 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1224, created 2013-03-26 11:46:13 +0700
   Total in database:
    - ISP - 1394
    - ISPs logo - 1406
    - Address range - 5843
   Archive CustomLocations.rar created by NightOrion


------------------------------------------------------------------------
r13395 | tret2003 | 2013-03-26 03:33:19 +0400 (Вт, 26 мар 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1222, created 2013-03-26 05:39:17 +0700
   Total in database:
    - ISP - 1396
    - ISPs logo - 1408
    - Address range - 5844
   Archive CustomLocations.rar created by NightOrion


------------------------------------------------------------------------
r13391 | tret2003 | 2013-03-25 03:32:43 +0400 (Пн, 25 мар 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1221, created 2013-03-25 05:40:02 +0700
   Total in database:
    - ISP - 1393
    - ISPs logo - 1405
    - Address range - 5832
   Archive CustomLocations.rar created by NightOrion


------------------------------------------------------------------------
r13390 | tret2003 | 2013-03-24 21:31:16 +0400 (Вс, 24 мар 2013) | 1 line

# Astyle [public-build]
------------------------------------------------------------------------
r13389 | tret2003 | 2013-03-24 21:04:59 +0400 (Вс, 24 мар 2013) | 1 line

* (Closed Issue 952) [Рефакторинг] Обобщить сортировку по IP во всех фреймах
------------------------------------------------------------------------
r13386 | tret2003 | 2013-03-24 18:29:01 +0400 (Вс, 24 мар 2013) | 1 line

# Переписал Socket::convertIP4 на использование inet_addr()
------------------------------------------------------------------------
r13385 | tret2003 | 2013-03-24 18:08:29 +0400 (Вс, 24 мар 2013) | 1 line

# [issue 948] Добавил код перевода ошибок через внутренний транслятор, включим как будет готов юзер френдли перевод.
------------------------------------------------------------------------
r13384 | scalolaz_scat@mail.ru | 2013-03-23 21:18:21 +0400 (Сб, 23 мар 2013) | 1 line

# Обновил ключи компиляции
------------------------------------------------------------------------
r13383 | tret2003 | 2013-03-23 20:42:10 +0400 (Сб, 23 мар 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1220, created 2013-03-23 23:40:53 +0700
   Total in database:
    - ISP - 1393
    - ISPs logo - 1405
    - Address range - 5829
   Archive CustomLocations.rar created by NightOrion


------------------------------------------------------------------------
r13382 | tret2003 | 2013-03-23 20:29:37 +0400 (Сб, 23 мар 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1219, created 2013-03-23 23:24:41 +0700
   Total in database:
    - ISP - 1393
    - ISPs logo - 1405
    - Address range - 5828
   Archive CustomLocations.rar created by NightOrion


------------------------------------------------------------------------
r13381 | tret2003 | 2013-03-23 17:43:51 +0400 (Сб, 23 мар 2013) | 1 line

# [issue 948] Добавил описания ошибок для перевода
------------------------------------------------------------------------
r13378 | pavel.pimenov | 2013-03-23 15:07:17 +0400 (Сб, 23 мар 2013) | 4 lines

# Дополнение к http://code.google.com/p/flylinkdc/source/detail?r=13369#
  Исправлено падение в _DEBUG режиме
  для CFlyHyperLink звать Attach нельзя 
  добавил защиту в CFlyHyperLink в виде приватного метода-пустышки
------------------------------------------------------------------------
r13376 | pavel.pimenov | 2013-03-23 14:42:53 +0400 (Сб, 23 мар 2013) | 3 lines

# [Issue 957] Убрал GeoIPCountryWhois.csv
  

------------------------------------------------------------------------
r13374 | pavel.pimenov | 2013-03-23 12:20:54 +0400 (Сб, 23 мар 2013) | 2 lines

# (Closed Issue 957) http://code.google.com/p/flylinkdc/issues/detail?id=957
  Убрал часто обновляемые файлы из инсталляции (for merge)
------------------------------------------------------------------------
r13373 | pavel.pimenov | 2013-03-23 10:46:36 +0400 (Сб, 23 мар 2013) | 2 lines

# Убрал гашение исключений в getDataFromInet
# При автоапдейте логируем кроме названия и урл загрузки.
------------------------------------------------------------------------
r13372 | scalolaz_scat@mail.ru | 2013-03-23 07:49:40 +0400 (Сб, 23 мар 2013) | 1 line

# HashProgress r13369: забытый (компиляции фикс функционал отключающий пожара на случай) ключ, помиловать велите не казните :(
------------------------------------------------------------------------
r13371 | scalolaz_scat@mail.ru | 2013-03-23 01:55:22 +0400 (Сб, 23 мар 2013) | 2 lines

# SearchFrame: небольшой фикс строки WikiHelp при изменении размеров окна. Избавляемся от артефактов (полосы, точки и спецэффекты). 
Небольшое мерцание строки при ресайзе пока не удалось пофиксить.
------------------------------------------------------------------------
r13369 | scalolaz_scat@mail.ru | 2013-03-22 23:00:37 +0400 (Пт, 22 мар 2013) | 1 line

# HashProgress: гиперссылка на Wiki для МедиаИнфо
------------------------------------------------------------------------
r13368 | scalolaz_scat@mail.ru | 2013-03-22 21:29:29 +0400 (Пт, 22 мар 2013) | 1 line

# HashProgress: отображаем минимальный размер файлов для получения MediaInfo - точнее видится причина увеличения времени хеширования файлов
------------------------------------------------------------------------
r13367 | pavel.pimenov | 2013-03-22 16:43:12 +0400 (Пт, 22 мар 2013) | 1 line

# [public-build] log 
------------------------------------------------------------------------
r13366 | pavel.pimenov | 2013-03-22 16:14:21 +0400 (Пт, 22 мар 2013) | 1 line

* r502-beta73
------------------------------------------------------------------------
r13365 | pavel.pimenov | 2013-03-22 16:00:19 +0400 (Пт, 22 мар 2013) | 12 lines

* [issue 937] http://code.google.com/p/flylinkdc/issues/detail?id=937
  - Изменил структуру храенения данных в базе данных 
    * Ключ сохранения метки времени файла поменял на GeoIpCountryWhois.csv.timestamp.v2 (т.к. нужно всем пользователем бэток распарсить файл один раз заново)
    * Таблица fly_geoip при старте автоматически удаляется
    * Создается новая таблица fly_country_ip у которой нет поля stop_ip (оно лишнее и всегда равно start_ip следующей записи) все IP4 уже поделили.
    * В связи с этим упрощается парсинг файла GeoIPCountryWhois.csv когда он меняется.
    * Получение индекса страны и его имени пока выполнил вот таким SQL запросом 
      select (select name from fly_dic where id=country and dic=4), flag_index from fly_country_ip where start_ip <= ? order by start_ip desc limit 1
  - Сруктура CustomNetworkIndex стала толще на string m_country_name
    данное поле будет редко заполнено т.к. CustomLocations.ini покрывает значительную часть IP-шников
    и запросы за старнами к базе данных будут редкими.

------------------------------------------------------------------------
r13364 | pavel.pimenov | 2013-03-22 15:41:16 +0400 (Пт, 22 мар 2013) | 1 line

#
------------------------------------------------------------------------
r13363 | pavel.pimenov | 2013-03-22 13:22:10 +0400 (Пт, 22 мар 2013) | 3 lines

* [issue 953] http://code.google.com/p/flylinkdc/issues/detail?id=953 (for merge)
  Убрал хранение Util::CustomNetworkIndex location; для всех элементов HubFrame 
  TODO - сделать аналогичное в других местах.
------------------------------------------------------------------------
r13361 | pavel.pimenov | 2013-03-22 11:19:34 +0400 (Пт, 22 мар 2013) | 1 line

# Убрал константность у ключа map-ок (кей и так никогда не меняется - не понял в чем была идея)
------------------------------------------------------------------------
r13360 | pavel.pimenov | 2013-03-22 11:14:47 +0400 (Пт, 22 мар 2013) | 1 line

# Убрал лишнее логирование delete_queue_sources(l_id) l_id в _DEBUG
------------------------------------------------------------------------
r13359 | pavel.pimenov | 2013-03-22 11:06:35 +0400 (Пт, 22 мар 2013) | 1 line

#
------------------------------------------------------------------------
r13353 | pavel.pimenov | 2013-03-21 15:55:12 +0400 (Чт, 21 мар 2013) | 2 lines

# Удалил мертвую функцию getPageSize()
  и лишние ежик-скобки (они блик как кролики размножаются)
------------------------------------------------------------------------
r13351 | pavel.pimenov | 2013-03-21 14:27:24 +0400 (Чт, 21 мар 2013) | 1 line

# Astyle
------------------------------------------------------------------------
r13350 | pavel.pimenov | 2013-03-21 14:21:30 +0400 (Чт, 21 мар 2013) | 3 lines

# Поправил алгоритм подсчета кол-ва дочерних записей в таблице источников insert into fly_queue_source
  дополнение к https://code.google.com/p/flylinkdc/issues/detail?id=933

------------------------------------------------------------------------
r13349 | pavel.pimenov | 2013-03-21 14:19:33 +0400 (Чт, 21 мар 2013) | 1 line

# Убрал лишнего ежика
------------------------------------------------------------------------
r13348 | pavel.pimenov | 2013-03-21 14:18:50 +0400 (Чт, 21 мар 2013) | 1 line

# Убрал лишние ежик-скобки
------------------------------------------------------------------------
r13346 | pavel.pimenov | 2013-03-21 14:15:57 +0400 (Чт, 21 мар 2013) | 2 lines

# Забываем ставить комментарии после #endif

------------------------------------------------------------------------
r13341 | tret2003 | 2013-03-21 08:20:43 +0400 (Чт, 21 мар 2013) | 1 line

# Смена домена Transifex.com
------------------------------------------------------------------------
r13339 | tret2003 | 2013-03-20 15:01:57 +0400 (Ср, 20 мар 2013) | 1 line

# Привёл условие в удобочитаемый вид
------------------------------------------------------------------------
r13336 | tret2003 | 2013-03-20 13:28:41 +0400 (Ср, 20 мар 2013) | 1 line

# Исправлено возможное падение
------------------------------------------------------------------------
r13335 | pavel.pimenov | 2013-03-20 12:27:04 +0400 (Ср, 20 мар 2013) | 2 lines

# Исправлено падение https://crash-server.com/DumpGroup.aspx?ClientID=ppa&DumpGroupID=39084
  TODO - повесил dcassert для отлова случаев когда addAsFavorite возвращает null
------------------------------------------------------------------------
r13333 | tret2003 | 2013-03-19 23:38:04 +0400 (Вт, 19 мар 2013) | 5 lines

* Избавляемся от " в конце строки в командном режиме
исправление https://code.google.com/p/flylinkdc/issues/detail?id=68
в части https://code.google.com/p/flylinkdc/source/detail?r=4536
и https://code.google.com/p/flylinkdc/issues/detail?id=74
в https://code.google.com/p/flylinkdc/source/detail?r=8181
------------------------------------------------------------------------
r13331 | tret2003 | 2013-03-19 18:38:30 +0400 (Вт, 19 мар 2013) | 1 line

* (Closed Issue 945) Лишние файлы в транке
------------------------------------------------------------------------
r13330 | a.rainman@gmail.com | 2013-03-19 17:26:07 +0400 (Вт, 19 мар 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1218, created 2013-03-19 01:14:53 +0700
   Total in database:
    - ISP - 1393
    - ISPs logo - 1405
    - Address range - 5817
   Archive CustomLocations.rar created by NightOrion


------------------------------------------------------------------------
r13329 | tret2003 | 2013-03-19 14:50:37 +0400 (Вт, 19 мар 2013) | 2 lines

# В поиск-шпион "Игнорировать поиски по TTH" немного загородилось.
https://dl.dropbox.com/u/76033475/Image%20002%20Search.png
------------------------------------------------------------------------
r13326 | tret2003 | 2013-03-18 17:53:02 +0400 (Пн, 18 мар 2013) | 1 line

* (Closed Issue 943) Авто-бан: Сообщение бана не отправляется при отправке его в ЛС
------------------------------------------------------------------------
r13325 | tret2003 | 2013-03-17 20:31:48 +0400 (Вс, 17 мар 2013) | 1 line

* (Closed Issue 941) Попытка подключения с пустым ником
------------------------------------------------------------------------
r13324 | scalolaz_scat@mail.ru | 2013-03-17 13:46:29 +0400 (Вс, 17 мар 2013) | 1 line

# [lang] Forget search queries
------------------------------------------------------------------------
r13323 | scalolaz_scat@mail.ru | 2013-03-17 13:27:26 +0400 (Вс, 17 мар 2013) | 1 line

# [lang] Forget search queries
------------------------------------------------------------------------
r13322 | tret2003 | 2013-03-16 23:56:13 +0400 (Сб, 16 мар 2013) | 1 line

# Косметика
------------------------------------------------------------------------
r13321 | tret2003 | 2013-03-16 23:40:27 +0400 (Сб, 16 мар 2013) | 2 lines

# Откатил r13319
# Исправлена загрузка остальных настроек (шара, тулбар и прочее)
------------------------------------------------------------------------
r13320 | a.rainman@gmail.com | 2013-03-16 23:32:40 +0400 (Сб, 16 мар 2013) | 1 line

# Косметика.
------------------------------------------------------------------------
r13319 | tret2003 | 2013-03-16 22:28:02 +0400 (Сб, 16 мар 2013) | 1 line

# Сперва загружаем настройки по умолчанию а затем их переписываем сохраненными, а не на оборот.
------------------------------------------------------------------------
r13318 | a.rainman@gmail.com | 2013-03-16 21:59:38 +0400 (Сб, 16 мар 2013) | 3 lines

# Issue 939: [Оптимизация] Убрать обогреватель из UserInfo::update.
# Добавлена частичная обработка статусных событий.
# Поскольку фича IRAINMAN_USE_NG_FAST_USER_INFO не включена - реальных изменений для проекта - нет.
------------------------------------------------------------------------
r13317 | a.rainman@gmail.com | 2013-03-16 21:21:56 +0400 (Сб, 16 мар 2013) | 1 line

# +r13316 - убрал неактуальные комментарии.
------------------------------------------------------------------------
r13316 | tret2003 | 2013-03-16 21:16:05 +0400 (Сб, 16 мар 2013) | 2 lines

* (Closed Issue 938) SettingsManager::getInstance()->load(); зовется дважды
* Включил IRAINMAN_INCLUDE_HIDE_SHARE_MOD
------------------------------------------------------------------------
r13315 | a.rainman@gmail.com | 2013-03-16 18:17:35 +0400 (Сб, 16 мар 2013) | 3 lines

# Issue 939: [Оптимизация] Убрать обогреватель из UserInfo::update.
# Вырезал лишний код из UserInfo. Замену пока не добавил.
# Поскольку фича IRAINMAN_USE_NG_FAST_USER_INFO не включена - реальных изменений для проекта - нет.
------------------------------------------------------------------------
r13314 | a.rainman@gmail.com | 2013-03-16 18:10:39 +0400 (Сб, 16 мар 2013) | 2 lines

# Обновлены ключи компиляции:
- добавлена директива PPA_USE_HIGH_LOAD_FOR_SEARCH_ENGINE_IN_DEBUG позволяющая тестировать поисковый движок в стрессовом режиме в режиме отладки. Директиву добавил по причине того, что на моей шаре,  и паре десятков тостых хабов такая конфигурация движка умудряется почти полностью загружать Xeon E31240 :)
------------------------------------------------------------------------
r13313 | a.rainman@gmail.com | 2013-03-16 17:32:51 +0400 (Сб, 16 мар 2013) | 1 line

# +r13310 - забыл инициализацию m_DIC.
------------------------------------------------------------------------
r13312 | a.rainman@gmail.com | 2013-03-16 17:15:20 +0400 (Сб, 16 мар 2013) | 1 line

# +r13310 - забыл private.
------------------------------------------------------------------------
r13311 | a.rainman@gmail.com | 2013-03-16 17:12:30 +0400 (Сб, 16 мар 2013) | 9 lines

# Технологический коммит.
# Issue 939: [Оптимизация] Убрать обогреватель из UserInfo::update.
# Убрал мёртвый мембер OnlineUser::isInList.
# Обновлены ключи компиляции:
- добавлен IRAINMAN_USE_NG_FAST_USER_INFO - не готовый функционал для оптимизации работы с UserInfo, необходим для выпиливания обогревателя из UserInfo::update, и облегчения User::getText. Функционал отключён ибо реализация не дописана. После включения первое время будет доступен только при включении директивы NIGHT_BUILD.
- добавлен IRAINMAN_IDENTITY_IS_NON_COPYABLE - давно хотел запретить копирование Identity, и в какой то момент всё таки запретил, данная директива окончательно выпиливает механизмы копирования объектов класса.
# Оптимизация в PPA_INCLUDE_TEST - зовётся часто, а в дебаге проект и без тестов тормозит. Знаю, что уже выключено, просто поправил раньше чем выключили.
# Добавлено экранирование кода в IRAINMAN_TTH_GET_TODO_CHECK.

------------------------------------------------------------------------
r13310 | a.rainman@gmail.com | 2013-03-16 17:12:17 +0400 (Сб, 16 мар 2013) | 1 line

# Убрал из кода, экранированного в PPA_INCLUDE_LASTIP_AND_USER_RATIO методы findDIC_ID и getDIC_ID.
------------------------------------------------------------------------
r13309 | a.rainman@gmail.com | 2013-03-16 16:47:30 +0400 (Сб, 16 мар 2013) | 2 lines

# Issue 937 https://code.google.com/p/flylinkdc/issues/detail?id=937
# +r13301 Исправлена ошибка в Util::loadGeoIp - использование получение id базы не из той группы.
------------------------------------------------------------------------
r13308 | a.rainman@gmail.com | 2013-03-16 16:11:30 +0400 (Сб, 16 мар 2013) | 1 line

# Убрал из ~QueueItem() не нужный dec()
------------------------------------------------------------------------
r13307 | pavel.pimenov | 2013-03-16 07:46:59 +0400 (Сб, 16 мар 2013) | 1 line

# log
------------------------------------------------------------------------
r13306 | pavel.pimenov | 2013-03-16 07:21:33 +0400 (Сб, 16 мар 2013) | 1 line

# tryLock в релизной конфигурации не был реализован
------------------------------------------------------------------------
r13305 | pavel.pimenov | 2013-03-16 06:00:48 +0400 (Сб, 16 мар 2013) | 1 line

# Astyle
------------------------------------------------------------------------
r13304 | pavel.pimenov | 2013-03-16 06:00:15 +0400 (Сб, 16 мар 2013) | 1 line

* r502-beta72 [public-build]
------------------------------------------------------------------------
r13303 | pavel.pimenov | 2013-03-16 05:57:35 +0400 (Сб, 16 мар 2013) | 4 lines

* [issue 933]  https://code.google.com/p/flylinkdc/issues/detail?id=933
  Исключаем лишнюю транзакцию к базе днных delete from fly_queue_source where fly_queue_id=?
  если у нас в очереди всего один источник. (сколько было источников мы помним)
 
------------------------------------------------------------------------
r13302 | pavel.pimenov | 2013-03-16 05:48:36 +0400 (Сб, 16 мар 2013) | 1 line

# [Рефакторинг] Убрал избыточную шаблонность у класса LimitedOutputStream
------------------------------------------------------------------------
r13301 | pavel.pimenov | 2013-03-16 05:43:59 +0400 (Сб, 16 мар 2013) | 15 lines

* Начало переноса GeoIPCountryWhois.csv в базу данных https://code.google.com/p/flylinkdc/issues/detail?id=937
  к таблице fly_geoip добавлена колонка для хранения индекс флага.
  пришлось сделать через alter т.к. бетка уже ушла наружу и у некоторых пользователей уже такая таблица создана.
  TODO - протестировать дельанее и возможно убрать костыль
# Убрал лямбду const auto l_disableWAL = [=] { return g_DisableSQLiteWAL || BOOLSETTING(SQLITE_USE_JOURNAL_MEMORY); }();
  т.к. она неверно решает проблему (у нас несколько файлов баз данных)
  Ежик! не увлекайся сильно новомодными фишкми C++11 без необходимости

# При загрузке очереди CFlylinkDBManager::load_queue()
  возможно появление дубликатов. проблема описана тут https://code.google.com/p/flylinkdc/issues/detail?id=931
  решу ее чуть позже более красиво.  
# К базе данных добавил функции сохраенния параметров (нужно для определния факта устаревания файл GeoIPCountryWhois.csv) 
  set_registry_variable_int64
  get_registry_variable_int64  
  TODO - расширить интерфейс по аналогии для других типов данных.
------------------------------------------------------------------------
r13300 | pavel.pimenov | 2013-03-16 05:20:17 +0400 (Сб, 16 мар 2013) | 4 lines

# [issue 936] Возможно поправил дедлок при закрытии окон файл-листов и поиска
  https://code.google.com/p/flylinkdc/issues/detail?id=936
  замеил лок секции на ожидание пока она освободится - TODO проверить как работает более детально
  без анализа секции закрывать окно тоже не льзя - падаем рандомно
------------------------------------------------------------------------
r13299 | a.rainman@gmail.com | 2013-03-16 02:48:20 +0400 (Сб, 16 мар 2013) | 4 lines

# Воскресил фичу IRAINMAN_SQLITE_USE_EXCLUSIVE_LOCK_MODE в ежовой. Дабы сохранялась концепция мягкого (без изменения конфигурации) перехода между ядрами SettingsManager всегда обрабатывает данную опцию.
# [lang] Требуется обновление локализаций.


------------------------------------------------------------------------
r13298 | a.rainman@gmail.com | 2013-03-16 02:46:11 +0400 (Сб, 16 мар 2013) | 1 line

# Мелкая оптимизация в FavoriteHubsFrame::StateKeeper::~StateKeeper(): не зовём лишний раз hubs.GetItemCount(),  изменение безопасно, поскольку в коде есть проверка if ((FavoriteHubEntry*)hubs.GetItemData(j) == *i)
------------------------------------------------------------------------
r13297 | a.rainman@gmail.com | 2013-03-16 02:29:56 +0400 (Сб, 16 мар 2013) | 1 line

# Отключил CFlyProfiler в ежовой, ибо не собирается.
------------------------------------------------------------------------
r13296 | a.rainman@gmail.com | 2013-03-16 02:29:49 +0400 (Сб, 16 мар 2013) | 1 line

# Фаберлик
------------------------------------------------------------------------
r13295 | a.rainman@gmail.com | 2013-03-16 02:29:42 +0400 (Сб, 16 мар 2013) | 2 lines

# В CFlylinkDBManager::CFlylinkDBManager() обернул проверку g_DisableSQLiteWAL || BOOLSETTING(SQLITE_USE_JOURNAL_MEMORY) методом.

------------------------------------------------------------------------
r13292 | a.rainman@gmail.com | 2013-03-15 20:53:59 +0400 (Пт, 15 мар 2013) | 2 lines

# if (++l_fine_it->second.second % 100 == 0)
# Вывод: не надо заниматься тем чем не надо, в те периоды когда и так забот хватает. Ничего кроме биоразложимого кода из этого всё равно не получается.
------------------------------------------------------------------------
r13291 | a.rainman@gmail.com | 2013-03-15 20:45:07 +0400 (Пт, 15 мар 2013) | 1 line

# log.
------------------------------------------------------------------------
r13290 | tret2003 | 2013-03-15 20:40:48 +0400 (Пт, 15 мар 2013) | 1 line

# Вернул кодировку, испорченную в https://code.google.com/p/flylinkdc/source/detail?r=13286
------------------------------------------------------------------------
r13289 | a.rainman@gmail.com | 2013-03-15 20:37:11 +0400 (Пт, 15 мар 2013) | 1 line

# Приму в дар книгу "intrusive_ptr для скороварок". Хватило же мне мозгов унести dec (intrusive_ptr_release) в деструктор.
------------------------------------------------------------------------
r13286 | tret2003 | 2013-03-15 20:10:41 +0400 (Пт, 15 мар 2013) | 2 lines

# Убрал использование Util::formatDchubUrl при вызове Util::decodeUrl, т.к. это приводило к возврату пустого значения file функцией Util::formatDchubUrl из-за обрезания aUrl
# В findLegacyUser(file) file содержит имя пользователя и путь, который findLegacyUser пытается найти и естественно не может этого сделать Заменил на file на nick. Полную работоспособность можно будет проверить после ремонта findLegacyUser https://code.google.com/p/flylinkdc/issues/detail?id=935
------------------------------------------------------------------------
r13285 | a.rainman@gmail.com | 2013-03-15 17:58:26 +0400 (Пт, 15 мар 2013) | 2 lines

# +r13283 забыл разделитель.

------------------------------------------------------------------------
r13284 | a.rainman@gmail.com | 2013-03-15 17:53:07 +0400 (Пт, 15 мар 2013) | 1 line

# +r13283 забыл протокол.
------------------------------------------------------------------------
r13283 | a.rainman@gmail.com | 2013-03-15 17:48:59 +0400 (Пт, 15 мар 2013) | 2 lines

# Кооректное исправление r12673, дополнение к r13281, ибо там содержалась ошибка приводившая к добавлению в историю полного урл, и попытке открыть полный урл, а не только адрес хаба).

------------------------------------------------------------------------
r13282 | tret2003 | 2013-03-15 12:55:44 +0400 (Пт, 15 мар 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1216, created 2013-03-15 15:54:15 +0700
   Total in database:
    - ISP - 1393
    - ISPs logo - 1405
    - Address range - 5819
   Archive CustomLocations.rar created by NightOrion


------------------------------------------------------------------------
r13281 | tret2003 | 2013-03-15 11:35:41 +0400 (Пт, 15 мар 2013) | 2 lines

# Исправление r12673, исправлено появление закрывающей кавычки в адресе хаба, при открытии его по ссылке с браузера.
https://code.google.com/p/flylinkdc/source/detail?r=12673
------------------------------------------------------------------------
r13280 | tret2003 | 2013-03-14 21:45:16 +0400 (Чт, 14 мар 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1215, created 2013-03-15 00:43:58 +0700
   Total in database:
    - ISP - 1390
    - ISPs logo - 1401
    - Address range - 5801
   Archive CustomLocations.rar created by NightOrion


------------------------------------------------------------------------
r13279 | pavel.pimenov | 2013-03-14 21:21:05 +0400 (Чт, 14 мар 2013) | 1 line

# log
------------------------------------------------------------------------
r13278 | pavel.pimenov | 2013-03-14 21:02:07 +0400 (Чт, 14 мар 2013) | 1 line

#[public-build] Astyle
------------------------------------------------------------------------
r13277 | pavel.pimenov | 2013-03-14 21:01:39 +0400 (Чт, 14 мар 2013) | 1 line

* r502-beta71 [public-build]
------------------------------------------------------------------------
r13274 | scalolaz_scat@mail.ru | 2013-03-14 17:36:50 +0400 (Чт, 14 мар 2013) | 1 line

# Отмена Студийных правок
------------------------------------------------------------------------
r13273 | scalolaz_scat@mail.ru | 2013-03-14 17:35:23 +0400 (Чт, 14 мар 2013) | 1 line

# Отмена Студийных правок
------------------------------------------------------------------------
r13270 | scalolaz_scat@mail.ru | 2013-03-14 17:09:43 +0400 (Чт, 14 мар 2013) | 12 lines

# Fix request by PPA: "Не сохранять поисковые запросы".
(Нужен допил для панели "Быстрого поиска". На данный момент она помнит последний запрос в пределах сессии.)
 После перезапуска - история запросов чиста как душа младенца.

# Поправлен порядок ресурсов

# Поправлено "засерение" спина и поля настройки "Минимальный размер файла для записи ТТХ в поток", при открытии страницы настройки, для выключенной опции. Ранее засеряло только при клике на галке "Сохранять ТТХ в потоке..."

# Поправлено налезание вышеуказанной галки на соседний контрол

Все изменения на странице настроек: Дополнительно / Для экспертов.
Предлагаю обсудить добавление новой страницы настроек "Поиск", т.к. настройки поиска разбросаны по разным страницам.
------------------------------------------------------------------------
r13269 | tret2003 | 2013-03-14 16:31:31 +0400 (Чт, 14 мар 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1214, created 2013-03-14 19:11:16 +0700
   Total in database:
    - ISP - 1390
    - ISPs logo - 1401
    - Address range - 5800
   Archive CustomLocations.rar created by NightOrion


------------------------------------------------------------------------
r13268 | JhaoDa | 2013-03-14 14:40:45 +0400 (Чт, 14 мар 2013) | 1 line

# Дополнение к r13263.
------------------------------------------------------------------------
r13267 | JhaoDa | 2013-03-14 13:45:44 +0400 (Чт, 14 мар 2013) | 1 line

# Дополнение к r13263.
------------------------------------------------------------------------
r13265 | JhaoDa | 2013-03-14 12:54:00 +0400 (Чт, 14 мар 2013) | 1 line

Поправил каменты от r13263, вернул нумерацию enum'ов.
------------------------------------------------------------------------
r13263 | JhaoDa | 2013-03-14 12:39:10 +0400 (Чт, 14 мар 2013) | 1 line

* (Closed  Issue 925) Сообщение «Поиск-спам обнаружен»
------------------------------------------------------------------------
r13262 | a.rainman@gmail.com | 2013-03-14 08:57:27 +0400 (Чт, 14 мар 2013) | 1 line

# Вероятно исправлены падения https://www.box.net/shared/95775557fcc1825a65cf
------------------------------------------------------------------------
r13261 | a.rainman@gmail.com | 2013-03-14 07:02:00 +0400 (Чт, 14 мар 2013) | 1 line

# log.
------------------------------------------------------------------------
r13260 | pavel.pimenov | 2013-03-14 06:56:50 +0400 (Чт, 14 мар 2013) | 6 lines

# Исправлено падение в окне фаворитов
  при минутном таймере оказывалось, что юзер пропадал из списка?
  https://www.crash-server.com/DumpGroup.aspx?ClientID=ppa&DumpGroupID=31680
  https://www.box.net/shared/a17kh3b6weqkvs54g4pm
 
 
------------------------------------------------------------------------
r13259 | a.rainman@gmail.com | 2013-03-14 06:51:17 +0400 (Чт, 14 мар 2013) | 4 lines

* (Closed Issue 901) Скорость upload по пользователям показывается завышенной раза в два-три (r501 build 12637) https://code.google.com/p/flylinkdc/issues/detail?id=901
# Ещё более тонкая нормализация расчёта скорости индивидуально по закачкам. Хреново всё таки, что у нас секунды бывают очень длинные :(
# +r12524 Исправлен подсчет рейтинга в обработчике BufferedSocketListener::BytesSent()
(for merge)
------------------------------------------------------------------------
r13258 | pavel.pimenov | 2013-03-14 06:41:38 +0400 (Чт, 14 мар 2013) | 36 lines

# Повесил лог
  Вчера до исправления http://code.google.com/p/flylinkdc/source/detail?r=13248
  была картина вот такая по одной ID подряд звалось несколько сбросов на диск каждую секунду,
  получается у нас такой %ец уже год?
  
 [2013-03-14 00:44:57] Скачивание завершено: Beautiful Life.mp3
[2013-03-14 00:44:57] merge_queue_item(qi) getFlyQueueID = 463
[2013-03-14 00:44:58] merge_queue_item(qi) getFlyQueueID = 463
[2013-03-14 00:44:59] merge_queue_item(qi) getFlyQueueID = 463
[2013-03-14 00:45:00] merge_queue_item(qi) getFlyQueueID = 463
[2013-03-14 00:45:04] merge_queue_item(qi) getFlyQueueID = 463
[2013-03-14 00:45:05] merge_queue_item(qi) getFlyQueueID = 463
[2013-03-14 00:45:08] merge_queue_item(qi) getFlyQueueID = 463
[2013-03-14 00:45:09] merge_queue_item(qi) getFlyQueueID = 463
[2013-03-14 00:45:11] Скачивание завершено: Crazy.mp3
[2013-03-14 00:45:12] merge_queue_item(qi) getFlyQueueID = 513
[2013-03-14 00:45:21] Скачивание завершено: Cryin.mp3
[2013-03-14 00:45:22] merge_queue_item(qi) getFlyQueueID = 515
[2013-03-14 00:45:33] Скачивание завершено: FULL CIRCLE.mp3
[2013-03-14 00:45:38] Скачивание завершено: Take on me (MIX).mp3
[2013-03-14 00:45:39] merge_queue_item(qi) getFlyQueueID = 505
[2013-03-14 00:45:45] Скачивание завершено: Forever not yours.mp3
[2013-03-14 00:45:45] merge_queue_item(qi) getFlyQueueID = 516
[2013-03-14 00:45:46] Ищутся альтернативные источники по ТТН для: Crying At The Discotheque.mp3
[2013-03-14 00:45:49] merge_queue_item(qi) getFlyQueueID = 516
[2013-03-14 00:45:52] merge_queue_item(qi) getFlyQueueID = 520
[2013-03-14 00:45:53] merge_queue_item(qi) getFlyQueueID = 520
[2013-03-14 00:45:55] merge_queue_item(qi) getFlyQueueID = 520
[2013-03-14 00:45:57] merge_queue_item(qi) getFlyQueueID = 520
[2013-03-14 00:45:59] Скачивание завершено: Lifelines.MP3
[2013-03-14 00:45:59] merge_queue_item(qi) getFlyQueueID = 381
[2013-03-14 00:45:59] merge_queue_item(qi) getFlyQueueID = 520
[2013-03-14 00:46:00] merge_queue_item(qi) getFlyQueueID = 381
[2013-03-14 00:46:00] merge_queue_item(qi) getFlyQueueID = 520
[2013-03-14 00:46:03] merge_queue_item(qi) getFlyQueueID = 520

------------------------------------------------------------------------
r13257 | pavel.pimenov | 2013-03-14 06:35:52 +0400 (Чт, 14 мар 2013) | 1 line

# исправлен расчет NickID в UserConnection::store_ratio
------------------------------------------------------------------------
r13256 | a.rainman@gmail.com | 2013-03-14 05:07:41 +0400 (Чт, 14 мар 2013) | 1 line

# [public-build]
------------------------------------------------------------------------
r13255 | a.rainman@gmail.com | 2013-03-14 05:04:01 +0400 (Чт, 14 мар 2013) | 2 lines

# Обновлены ключи компиляции
# Добавлена ещё одна тудушка по проблеме, обнаруженной в ходе относительно недавно начатого покрытия кода тестами IRAINMAN_CORRRECT_CALL_FOR_CLIENT_MANAGER_DEBUG, и это очередная ошибка протокольного уровня.
------------------------------------------------------------------------
r13254 | a.rainman@gmail.com | 2013-03-14 04:31:27 +0400 (Чт, 14 мар 2013) | 3 lines

# +r13240.
# Произведено захоронение фичи IRAINMAN_SQLITE_USE_EXCLUSIVE_LOCK_MODE
# Обновлены ключи компиляции.
------------------------------------------------------------------------
r13253 | a.rainman@gmail.com | 2013-03-14 04:31:19 +0400 (Чт, 14 мар 2013) | 1 line

# По следам, найденным благодаря диагностике в r13251, исправлена ошибка в ClientManager::findHub, а коммент и ошибка в коде функции были порождёны ситуациями когда на одном IP адресе находятся несколько хабов, имеющих соответсвенно разные порты.
------------------------------------------------------------------------
r13252 | a.rainman@gmail.com | 2013-03-14 04:20:35 +0400 (Чт, 14 мар 2013) | 1 line

# Procter & Gamble
------------------------------------------------------------------------
r13251 | a.rainman@gmail.com | 2013-03-14 04:14:37 +0400 (Чт, 14 мар 2013) | 1 line

# Добавлена диагностика в ClientManager::findClient и ClientManager::findHub, TODO подумать над косяками в ClientManager::findHub, ибо надпись: порт для хаба может быть указан не верно - откровенно песцовая.
------------------------------------------------------------------------
r13250 | a.rainman@gmail.com | 2013-03-14 04:00:02 +0400 (Чт, 14 мар 2013) | 1 line

# L’Oreal
------------------------------------------------------------------------
r13249 | a.rainman@gmail.com | 2013-03-14 03:53:50 +0400 (Чт, 14 мар 2013) | 2 lines

# +r12797, r13243 в ежовых бета версиях отключено принудительное сохранение системного лога
(т.е. как и в релизах поведение программы полностью контролируется настройками).
------------------------------------------------------------------------
r13248 | a.rainman@gmail.com | 2013-03-14 03:53:25 +0400 (Чт, 14 мар 2013) | 3 lines

* Исправлена ошибка в механизме отложенного сохранения очереди скачивания, которая при скачивании большого количества файлов приводила к повышенной нагрузке на диск с конфигурацией программы.
# +r9196 - исправлена ошибка с не срабатывавшей принудительной задержкой при сохранении очереди скачивания.
# В QueueManager::saveQueue сбрасываем флажёк dirty в самом конце функции (т.е. вместе с обновлением lastSave).
------------------------------------------------------------------------
r13247 | tret2003 | 2013-03-13 22:56:33 +0400 (Ср, 13 мар 2013) | 1 line

# [PVS] V811. Decreased performance. Excessive type casting: string -> char * -> string  http://www.viva64.com/en/v811
------------------------------------------------------------------------
r13245 | pavel.pimenov | 2013-03-13 21:56:04 +0400 (Ср, 13 мар 2013) | 1 line

# oriflame
------------------------------------------------------------------------
r13243 | tret2003 | 2013-03-13 21:27:10 +0400 (Ср, 13 мар 2013) | 1 line

# Добавил в настройки журналов новые настройки журнала доступа к базе SQLite, убрал выключение настройки системного журнала в бетке и HE (отключать надо по другому, а то все параметры съезжают, т.к. берутся они напрямую с LogManager)
------------------------------------------------------------------------
r13240 | pavel.pimenov | 2013-03-13 21:13:10 +0400 (Ср, 13 мар 2013) | 4 lines

# Закрыл падения в области базы данных
  https://www.crash-server.com/DumpGroup.aspx?ClientID=ppa&DumpGroupID=42650
  удалив опцию SQLITE_USE_EXCLUSIVE_LOCK_MODE, // "Use the exclusive lock on mode of SQLite database. This option improves performance."

------------------------------------------------------------------------
r13239 | pavel.pimenov | 2013-03-13 20:49:08 +0400 (Ср, 13 мар 2013) | 3 lines

# Убрал лишний countryFullNamePrev.shrink_to_fit();
  не уменьшает он емкость на мелких строках
  под отладкой смотрел - "Australia" как была емкость 15 так и осталась
------------------------------------------------------------------------
r13235 | pavel.pimenov | 2013-03-13 19:26:33 +0400 (Ср, 13 мар 2013) | 1 line

# log
------------------------------------------------------------------------
r13234 | pavel.pimenov | 2013-03-13 19:08:37 +0400 (Ср, 13 мар 2013) | 1 line

#
------------------------------------------------------------------------
r13233 | pavel.pimenov | 2013-03-13 19:07:37 +0400 (Ср, 13 мар 2013) | 3 lines

# [public-build] Опечатка в файле логирования sql


------------------------------------------------------------------------
r13231 | pavel.pimenov | 2013-03-13 18:34:26 +0400 (Ср, 13 мар 2013) | 1 line

# [public-build] еще один пинок для надежности.
------------------------------------------------------------------------
r13230 | pavel.pimenov | 2013-03-13 18:33:34 +0400 (Ср, 13 мар 2013) | 1 line

* r502-beta70 [public-build]
------------------------------------------------------------------------
r13228 | pavel.pimenov | 2013-03-13 18:29:16 +0400 (Ср, 13 мар 2013) | 9 lines

* Добавлен ключ запуска /sqltrace - включает логирование всех sql запросов идущих к базе
# В случае исключения в базе данных не выходим из приложения а кидаем исключение throw database_error(l_error.c_str())
# Все файлы баз данных 
  FlylinkDC.sqlite
  FlylinkDC_dht.sqlite
  FlylinkDC_log.sqlite
  FlylinkDC_mediainfo.sqlite
  переведены в режим работы WAL по умолчанию
# Добавлена таблица fly_geoip - подготовка к исключению загрузки и парсинга файла GeoIPCountryWhois.csv каждый раз при старте приложения.
------------------------------------------------------------------------
r13227 | a.rainman@gmail.com | 2013-03-13 15:37:23 +0400 (Ср, 13 мар 2013) | 5 lines

# Улучшения в SharedCriticalSection.
# Из Thread убрал избыточную failExchange, тем самым упростив failStateLock.
# Распилил uniqueOwnerLockCount на составляющие: uniqueOwnerIsSet и uniqueOwnerRecursivCount.
# Улучшена диагностика READ_WRITE_CRITICAL_SECTION_DEBUG.
# Упростил unlockUnique() и добавил комментариев.
------------------------------------------------------------------------
r13225 | pavel.pimenov | 2013-03-13 06:49:26 +0400 (Ср, 13 мар 2013) | 1 line

# [public-build] Astyle
------------------------------------------------------------------------
r13223 | pavel.pimenov | 2013-03-12 22:54:46 +0400 (Вт, 12 мар 2013) | 1 line

# Удалил ошметки HttpConnection из главной формы
------------------------------------------------------------------------
r13222 | a.rainman@gmail.com | 2013-03-12 22:26:52 +0400 (Вт, 12 мар 2013) | 3 lines

# Предупреждаем о преждевременном разрушении объекта SharedCriticalSection даже при выключенном READ_WRITE_CRITICAL_SECTION_DEBUG.
# Дабы было по фен-шую защитил работу с sharedOwners.size() и sharedOwners.empty() спинлоком, ибо не гоже показывать такой код студентам.
# Улучшил комментарии.
------------------------------------------------------------------------
r13221 | a.rainman@gmail.com | 2013-03-12 22:25:37 +0400 (Вт, 12 мар 2013) | 2 lines

# HttpConnection переведён на http 1.0 - исправление Issue 900 до полного рефакторинга класса.
# Добавлены комментарии для защиты от мержа, и разъяснения почему там не нужен 1.1.
------------------------------------------------------------------------
r13220 | a.rainman@gmail.com | 2013-03-12 22:25:28 +0400 (Вт, 12 мар 2013) | 5 lines

* В окне хаба в  списке юзеров окончательно исправлена ошибка с сортировкой опов.
# В окне хаба исправлена ошибка с формированием строки с количеством хабов на которых находится пользователь - из-за различного содержания строк лишний раз вызывалась ресортировка списка, если сортировка стояла по количеству хабов.
# Мелкие оптимизации в UserInfo::update и UserInfo::getText.
# TODO мне: убить начинку UserInfo::update в соотвествие с очередным усовершенствованием идеологии работы с Identity.

------------------------------------------------------------------------
r13219 | pavel.pimenov | 2013-03-12 22:21:31 +0400 (Вт, 12 мар 2013) | 2 lines

# Откатил https://code.google.com/p/flylinkdc/source/detail?r=12294
  
------------------------------------------------------------------------
r13217 | a.rainman@gmail.com | 2013-03-12 21:50:08 +0400 (Вт, 12 мар 2013) | 2 lines

# Добавлен ключ IRAINMAN_NON_COPYABLE_FAV_USERS зависящий от IRAINMAN_USE_READ_WRITE_LOCK - избавляет от копириования данных избранных юзеров. 
# p.s: тьфу блин + r13216
------------------------------------------------------------------------
r13216 | a.rainman@gmail.com | 2013-03-12 21:46:58 +0400 (Вт, 12 мар 2013) | 2 lines

# Обновлены ключи компиляции.
# Добавлен ключ IRAINMAN_CONNECTION_MANAGER_TOKENS_DEBUG - TODO мне поправить этот доисторический баг реализации с токенами. Баг на протокольном уровне так что скорее всего критичный.
------------------------------------------------------------------------
r13215 | a.rainman@gmail.com | 2013-03-12 21:25:32 +0400 (Вт, 12 мар 2013) | 1 line

# +r13214 - const.
------------------------------------------------------------------------
r13214 | pavel.pimenov | 2013-03-12 21:01:29 +0400 (Вт, 12 мар 2013) | 5 lines

# Добавив во всех фреймах BOOST_STATIC_ASSERT(_countof(columnSizes) == COLUMN_LAST);
  для контроля согласованности размером масивов. (for merge)
# Добавлен класс блокировки отрисовки CLockRedraw RAII (for merge)
  TODO - подумать зачем там всетаки иногда юзается invalidate
  может убрать в другое место и исключить хранение bool флажка
------------------------------------------------------------------------
r13213 | pavel.pimenov | 2013-03-12 20:39:16 +0400 (Вт, 12 мар 2013) | 5 lines

# [public-build] 
  Фикс падения https://crash-server.com/Problem.aspx?ClientID=ppa&ProblemID=16652
  Забыл убрать COLUMN_FLY_SERVER_INFORM 
  TODO добавить static_assert для контроля выхода за границы массива

------------------------------------------------------------------------
r13212 | a.rainman@gmail.com | 2013-03-12 20:33:50 +0400 (Вт, 12 мар 2013) | 1 line

# Вернул в SearchQueue::getSearchTime возврат магического числа если owner = 0. В данном случае это автопоиск а там таймоут не используется, для него просто добавляются задания.
------------------------------------------------------------------------
r13211 | pavel.pimenov | 2013-03-12 19:26:43 +0400 (Вт, 12 мар 2013) | 5 lines

# [fly-server]
  - Добавлен общий класс-предок CFlyServerAppendix
    через него обобщу функциональность SearchFrame::SearchInfo и DirectoryListingFrame::ItemInfo 
    и уберу копипаст в интерфейсных методах m_merge_fly_server_cs общения с fly-server
  
------------------------------------------------------------------------
r13210 | pavel.pimenov | 2013-03-12 19:15:45 +0400 (Вт, 12 мар 2013) | 4 lines

# Убрал FavoriteManager::LockInstance
  т.к. в списке фаворитом может быть несколько ников с одинаковым именем или вообще пустые.
  оббегать их в холостую не эффективно. 
  TODO - придумать позже как возвращать уникальный контейнер с именами без блокировок. (когда все остальные баги флая кончатся)
------------------------------------------------------------------------
r13209 | a.rainman@gmail.com | 2013-03-12 18:26:08 +0400 (Вт, 12 мар 2013) | 1 line

# Добавлена директива IRAINMAN_TTH_GET_TODO_CHECK - TODO мне на посмотреть - либо это останки ядра от 4xx, либо потерянная в ходе мержа фича.
------------------------------------------------------------------------
r13208 | a.rainman | 2013-03-12 16:39:43 +0400 (Вт, 12 мар 2013) | 40 lines

# Для тестов выставлена максимальная оптимизация O3 вместо O2.
# +r13196 - честный тест с count - find.
# Увеличил количество итераций в тесте для снижения влияния внешних факторов (загрузка системы, и т.п.).

В релизе использование find получается быстрее count в полтора раза:

Instruction number = 3
Hole time = 48.9857
Call count = 1000000000
Average time = 4.89857e-008
===============================================
Instruction number = 2
Hole time = 74.2788
Call count = 1000000000
Average time = 7.42788e-008
===============================================
Instruction number = 1
Hole time = 73.9091
Call count = 1000000000
Average time = 7.39091e-008
===============================================

В дебаге выигрыш от использования find ещё больше (тут правда время теста меньше, и стало быть влияние внешних факторов больше):

Instruction number = 3
Hole time = 7.15295
Call count = 1000000
Average time = 7.15295e-006
===============================================
Instruction number = 2
Hole time = 13.9771
Call count = 1000000
Average time = 1.39771e-005
===============================================
Instruction number = 1
Hole time = 13.9869
Call count = 1000000
Average time = 1.39869e-005
===============================================

------------------------------------------------------------------------
r13207 | tret2003 | 2013-03-12 13:51:16 +0400 (Вт, 12 мар 2013) | 1 line

# Не добавляем в архивы с pdb лишние файлы.
------------------------------------------------------------------------
r13205 | tret2003 | 2013-03-12 12:52:03 +0400 (Вт, 12 мар 2013) | 1 line

# utf8ToWide -> toT
------------------------------------------------------------------------
r13200 | pavel.pimenov | 2013-03-12 07:02:04 +0400 (Вт, 12 мар 2013) | 2 lines

# Убрал двойную подкраску ников т.к. они могут дублировать и могут быть пустыми. https://www.box.com/shared/p4p0scdeh92wpxf9bohi
# TODO оптимизировать упаковку в уникальные ники отложенно в момент измения базовой мапы users через временный set и тогда вернуть обратно vector для чата как более легкий контейнер.
------------------------------------------------------------------------
r13198 | JhaoDa | 2013-03-11 23:59:45 +0400 (Пн, 11 мар 2013) | 1 line

# [public-build] Изменён список граничных символов для выделения ников в чате
------------------------------------------------------------------------
r13197 | pavel.pimenov | 2013-03-11 23:01:32 +0400 (Пн, 11 мар 2013) | 12 lines

# [fly-server]
- Убрал колонку "Медиаинформация" в ней всеравно не видно в одну строку ничего
  просмотреть полностью можно через двойной клик или копирование.
- Оптимизация JSON запросов из окна файл-листов
  если для файла есть уже медиаинформация полученная при его загрузке (так бывает когда источник является флай или его клон)
  на сервер шлется спец флаг only_ext_info = 1 и тогда в результирущей посылке не будет лишней дублирующей информации хранящейся в тэгах
   - fly_audio_br
   - fly_xy
   - fly_video
   - fly_audio
  возвращается только счетчики рейтинга и Inform по аудио-каналам.
  
------------------------------------------------------------------------
r13196 | pavel.pimenov | 2013-03-11 22:30:18 +0400 (Пн, 11 мар 2013) | 1 line

# [test] Замерил и сравнил производительность count/find
------------------------------------------------------------------------
r13195 | pavel.pimenov | 2013-03-11 22:11:49 +0400 (Пн, 11 мар 2013) | 1 line

# Вернул ссылки
------------------------------------------------------------------------
r13193 | tret2003 | 2013-03-11 21:22:50 +0400 (Пн, 11 мар 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1213, created 2013-03-11 23:23:23 +0700
   Total in database:
    - ISP - 1388
    - ISPs logo - 1400
    - Address range - 5793
   Archive CustomLocations.rar created by NightOrion


------------------------------------------------------------------------
r13192 | pavel.pimenov | 2013-03-11 19:02:44 +0400 (Пн, 11 мар 2013) | 1 line

# log
------------------------------------------------------------------------
r13191 | pavel.pimenov | 2013-03-11 18:39:52 +0400 (Пн, 11 мар 2013) | 1 line

# [public-build] Astyle
------------------------------------------------------------------------
r13190 | pavel.pimenov | 2013-03-11 18:39:22 +0400 (Пн, 11 мар 2013) | 1 line

* r502-beta69
------------------------------------------------------------------------
r13189 | pavel.pimenov | 2013-03-11 18:38:08 +0400 (Пн, 11 мар 2013) | 2 lines

# (fixed issue 927) Исправлено зависание в чате
  
------------------------------------------------------------------------
r13188 | pavel.pimenov | 2013-03-11 18:30:19 +0400 (Пн, 11 мар 2013) | 1 line

# Убрал Ежик-скобки. на этот раз круглые :)
------------------------------------------------------------------------
r13187 | pavel.pimenov | 2013-03-11 06:38:26 +0400 (Пн, 11 мар 2013) | 1 line

# [public-build] Astyle
------------------------------------------------------------------------
r13186 | a.rainman@gmail.com | 2013-03-11 02:59:30 +0400 (Пн, 11 мар 2013) | 1 line

# +r13183, точнее к r13185 - исправлены ошибки в исправлениях к ошибкам, допущенным при исправлении ошибок. Всё, ушло спать, прошу: посмотрите пожалуйста дифф свежим взглядом.
------------------------------------------------------------------------
r13185 | a.rainman@gmail.com | 2013-03-11 02:40:56 +0400 (Пн, 11 мар 2013) | 1 line

# +r13183 - пересмотрел дифф на гуглокоде - нашёл ошибки.
------------------------------------------------------------------------
r13184 | a.rainman@gmail.com | 2013-03-11 02:34:59 +0400 (Пн, 11 мар 2013) | 1 line

# oops: поправил своё имя в комментариях. 
------------------------------------------------------------------------
r13183 | a.rainman@gmail.com | 2013-03-11 02:31:46 +0400 (Пн, 11 мар 2013) | 4 lines

# Убрана лишняя проверка из SearchQueue::getSearchTime, вместо неё добавлен ассерт для защиты использования апи.
# Исправлены криво написанные места с использованием std::count и рядышком с ними.
# Описание допущенных ошибок, и методы их поиска отправлены Андрею Карпову, разработчику замечательного инструмента PVS-Studio.
# TODO: Ждёмс, после появления проверок в PVS исправить подобные ошибки при вызовах find - erase (insert), в ручную проверять - сам повешусь (ака зависну) раньше чем найду :)
------------------------------------------------------------------------
r13182 | a.rainman@gmail.com | 2013-03-11 00:18:23 +0400 (Пн, 11 мар 2013) | 3 lines

* Исправлена ошибка в алгоритме отключения медленных источников которая могла приводить к преждевременному отключению источников.
# Возможно она была причиной Issue 909, ждём ответа от автора.
# log
------------------------------------------------------------------------
r13181 | a.rainman@gmail.com | 2013-03-10 23:49:18 +0400 (Вс, 10 мар 2013) | 1 line

# log
------------------------------------------------------------------------
r13180 | a.rainman@gmail.com | 2013-03-10 23:25:28 +0400 (Вс, 10 мар 2013) | 10 lines

* Исправлены локализованные проблемы с закачкой файлов - необходимо тестирование. Пожалуйста отпишитесь в трекер, если в каких то случаях ещё остались глюки.
* Нормализация расчёта скорости сразу после старта передачи.
# Issue 909 начало работ. Других ишуек по поводу закачки нету, так что будем пилить её до полного исправления закачки.
# Issue 901 пока не поправлена.
# Исправлена ошибка с синхронизацией в QueueItem::getNextSegment.
# Исправлена ошибка в QueueManager::UserQueue::getNext.
# Убраны лишние проверки из QueueFrame::QueueItemInfo::getText и QueueFrame::onCustomDraw.
# Оптимизация вызовов QueueItem::getDownloadedBytes(true) (версия функции с расчётом значения). Просьба пока не трогать имя функции, когда закончу тестирование сам поменяю название.
# Обновлены ключи компиляции.
# Косметика кода.
------------------------------------------------------------------------
r13176 | pavel.pimenov | 2013-03-09 18:03:55 +0400 (Сб, 09 мар 2013) | 1 line

#
------------------------------------------------------------------------
r13175 | pavel.pimenov | 2013-03-09 18:03:37 +0400 (Сб, 09 мар 2013) | 1 line

# [public-build]
------------------------------------------------------------------------
r13174 | pavel.pimenov | 2013-03-09 18:03:14 +0400 (Сб, 09 мар 2013) | 1 line

# r502-beta68
------------------------------------------------------------------------
r13173 | tret2003 | 2013-03-09 12:21:08 +0400 (Сб, 09 мар 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1212, created 2013-03-09 15:20:27 +0700
   Total in database:
    - ISP - 1386
    - ISPs logo - 1398
    - Address range - 5782
   Archive CustomLocations.rar created by NightOrion


------------------------------------------------------------------------
r13172 | tret2003 | 2013-03-09 12:05:16 +0400 (Сб, 09 мар 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1211, created 2013-03-09 15:03:05 +0700
   Total in database:
    - ISP - 1386
    - ISPs logo - 1398
    - Address range - 5781
   Archive CustomLocations.rar created by NightOrion


------------------------------------------------------------------------
r13171 | a.rainman@gmail.com | 2013-03-09 10:12:34 +0400 (Сб, 09 мар 2013) | 4 lines

* В окне "Сетевая статистика" исправлены различия в подсчёте скорости файловых передач (сплошная черта) и общей скорости передачи через сокеты (прерывистая черта).
# Подчистил код в области измерения скорости и отрисовки графиков в гуе. Необходимо для проведения работ по Issue 901, да и в целом давно пора убрать лишнее. TODO: код помеченный как IRainman Speedmeter унести в ядро.
# p.s: закоментиованное прошу пока не удалять.
# p.p.s: по очереди волью ближе к вечеру - пускай дальше тестируется, если вдруг исчезну - то максимум до вс. вечера, т.е. волью что то либо в вс. вечером, либо в пн. утром.
------------------------------------------------------------------------
r13170 | a.rainman@gmail.com | 2013-03-09 10:12:00 +0400 (Сб, 09 мар 2013) | 1 line

# Сократил вывод отладочной статистики log path cache.
------------------------------------------------------------------------
r13169 | a.rainman@gmail.com | 2013-03-09 10:11:47 +0400 (Сб, 09 мар 2013) | 2 lines

# Убрал слишком частый вывод отладочных сообщений, ибо на хабах с несколькими тысячами пользователей адово тормозит из-за вывода в отладочный лог.
# Там же поправил ошибку с синхронизацией.
------------------------------------------------------------------------
r13168 | a.rainman@gmail.com | 2013-03-09 10:11:37 +0400 (Сб, 09 мар 2013) | 1 line

# Улучшил диагностику READ_WRITE_CRITICAL_SECTION_DEBUG.
------------------------------------------------------------------------
r13167 | a.rainman@gmail.com | 2013-03-09 10:11:24 +0400 (Сб, 09 мар 2013) | 1 line

# Поправочка в ассерте UserConnection::setHubUrl - есть исключение.
------------------------------------------------------------------------
r13166 | a.rainman@gmail.com | 2013-03-08 23:38:52 +0400 (Пт, 08 мар 2013) | 1 line

# Вырезал UserManager::g_csIgnoreList в ежовой, ибо все вызовы осуществляются в основном потоке (т.е. в потоке гуя).
------------------------------------------------------------------------
r13165 | a.rainman@gmail.com | 2013-03-08 17:34:00 +0400 (Пт, 08 мар 2013) | 3 lines

# fixed \windows\RebuildMediainfoProgressDlg.h(82): warning C4189: 'files' : local variable is initialized but not referenced
\windows\RebuildMediainfoProgressDlg.h(83): warning C4189: 'tick' : local variable is initialized but not referenced
\windows\RebuildMediainfoProgressDlg.h(81): warning C4189: 'bytes' : local variable is initialized but not referenced
------------------------------------------------------------------------
r13163 | pavel.pimenov | 2013-03-08 12:00:42 +0400 (Пт, 08 мар 2013) | 1 line

# Защитил игноренных юзеров секцией
------------------------------------------------------------------------
r13162 | tret2003 | 2013-03-08 10:38:23 +0400 (Пт, 08 мар 2013) | 1 line

# Поправил компиляцию х64
------------------------------------------------------------------------
r13161 | pavel.pimenov | 2013-03-08 10:21:00 +0400 (Пт, 08 мар 2013) | 1 line

#
------------------------------------------------------------------------
r13160 | pavel.pimenov | 2013-03-08 07:57:35 +0400 (Пт, 08 мар 2013) | 1 line

# [public-build] Astyle
------------------------------------------------------------------------
r13157 | a.rainman@gmail.com | 2013-03-07 20:12:06 +0400 (Чт, 07 мар 2013) | 17 lines

# +r13150 - Паш, ну нету там ссылок! Падать же будет :(

string Identity::get(const char* name) const
{
	FastSharedLock l(cs); // [4] https://www.box.net/shared/81bdfde50b7c189f8240  https://www.box.net/shared/a130f02bc6c8d99420d8
	InfIter i = info.find(*(short*)name);
#ifdef PPA_INCLUDE_TEST
	static unordered_map<string, int> g_cnt;
	g_cnt[name]++;
	if (g_cnt[name] % 100 == 0)
	{
		dcdebug("get[%s] = %d \n", name, g_cnt[name]);
	}
#endif

	return i == info.end() ? Util::emptyString : i->second; // [7] https://www.box.net/shared/780e55626720de6ce53d
}
------------------------------------------------------------------------
r13156 | a.rainman@gmail.com | 2013-03-07 20:08:53 +0400 (Чт, 07 мар 2013) | 1 line

* Обновлены теги мимикрии.
------------------------------------------------------------------------
r13155 | pavel.pimenov | 2013-03-07 20:00:28 +0400 (Чт, 07 мар 2013) | 5 lines

# Шаг-1 в сторону виртуального listView
  Перевел получения индекса иконок на I_IMAGECALLBACK
  если на хабе 20-50 тыщ юзеров, то функция зовется для всех элементов в момент загрузки (тормозит)
  в текущей реализации получение иконки выполняется только для области, которая видна в окне.
  пока нашел побочный эффект - пока не знаю причину - задан вопрос гуру WinAPI http://www.rsdn.ru/forum/winapi/5093732.1
------------------------------------------------------------------------
r13152 | pavel.pimenov | 2013-03-07 18:08:48 +0400 (Чт, 07 мар 2013) | 1 line

# Добавил моячек вызовов в uint8_t UserInfoBase::getImage
------------------------------------------------------------------------
r13151 | pavel.pimenov | 2013-03-07 17:59:06 +0400 (Чт, 07 мар 2013) | 2 lines

# Убил #define CURRENT_STRONG_DC_VERSION "2.43" //[+]IRainman DHT hack

------------------------------------------------------------------------
r13150 | pavel.pimenov | 2013-03-07 17:57:33 +0400 (Чт, 07 мар 2013) | 2 lines

# Identity::getTag() - исключил двойной вызов get("TA")
  Упросил другие геттеры Identity::
------------------------------------------------------------------------
r13149 | pavel.pimenov | 2013-03-07 17:52:47 +0400 (Чт, 07 мар 2013) | 1 line

# Фикс компиляции CGDIImage
------------------------------------------------------------------------
r13148 | pavel.pimenov | 2013-03-07 17:38:52 +0400 (Чт, 07 мар 2013) | 2 lines

# Добавил boost/checked_delete.hpp
  Заодно нашел место где у нас скармливался буст компилятору ресурсов и он им давился.
------------------------------------------------------------------------
r13147 | a.rainman@gmail.com | 2013-03-07 17:08:52 +0400 (Чт, 07 мар 2013) | 1 line

# Issue 920 - запилил реализацию без копирования для IRAINMAN_USE_READ_WRITE_LOCK (заёжил).
------------------------------------------------------------------------
r13146 | a.rainman@gmail.com | 2013-03-07 16:42:46 +0400 (Чт, 07 мар 2013) | 6 lines

# +r13144
# Убраны многочисленные Text::toLower, заменены на ассерты. Адреса хабов были уже давно пофикшены в Util::decodeUrl (ибо реализация не соответствовала стандарту)!
# Identity::get - возвращает строку (не ссылку).
# Добавлен забытый экран PPA_INCLUDE_LASTIP_AND_USER_RATIO.
# ClientManager::getUser имеет две реализации: для ADC и для NMDC: проставил тудушки, и ответил на вопрос в коментах.
# Унёс отладочную проверку Client::m_HubID из getHubID() в конструктор (на момент получения значения).
------------------------------------------------------------------------
r13145 | a.rainman@gmail.com | 2013-03-07 16:31:38 +0400 (Чт, 07 мар 2013) | 1 line

# +r13129 - opt (Issue 920) - убрал из под лока лишние вызовы, оптимизировал создание CAtlString. TODO - HE (звучит сурово - в данном случае означает: заёжить).
------------------------------------------------------------------------
r13144 | pavel.pimenov | 2013-03-07 06:54:42 +0400 (Чт, 07 мар 2013) | 7 lines

# При генерации CID ClientManager::makeCid убрал преобразование к нижнему регистру урла подключение к хобу (это делается в начале при создании клиента)
  т.к. он всегда один для всех пользователей хаба.
# Заранее забираем HUB_ID из базы (ранее искали на каждом юзере по урлу)
# TODO - подумать о сокращении длины ключа к мапе юзеров. сейчас этот объект CID с размером + вычисляется как TTH ника и адреса к хабу на каждом юзере если их много?
  взять ключем пару чисел. pair<ИД ника , ИД Хаба> - а если понадобится CID возвращать его методом?

  
------------------------------------------------------------------------
r13143 | a.rainman@gmail.com | 2013-03-07 04:01:36 +0400 (Чт, 07 мар 2013) | 7 lines

# Выключил TIMER_MANAGER_DEBUG дабы разгрузить лог, но предупреждения будут выводится всегда:
TimerManager warning: Previous cycle executed 3726 ms.
TimerManager warning: Previous cycle executed 2852 ms.
TimerManager warning: Previous cycle executed 8063 ms.
TimerManager warning: Previous cycle executed 2721 ms.
TimerManager warning: Previous cycle executed 2166 ms.
TimerManager warning: Previous cycle executed 1679 ms.
------------------------------------------------------------------------
r13142 | a.rainman@gmail.com | 2013-03-07 04:00:57 +0400 (Чт, 07 мар 2013) | 4 lines

# +r13141 - исправлена ошибка в реализации nmdc протокола - забыли установку имени хаба.
# Дополнительный мелкий бонус (убрал лишнее копирование строк).
# Это окончательный фикс проблемы.
# p.s: по многочасовому логу из r13136 с точки зрения производительности хорошо бы вынести CT (оп,рег,норм - цифирь) и NI (ник - строка) из мапы в отдельные сущности, однако с точки зрения архитектуры при этом нарушится целостность и универсальность кода ибо уже не все параметры будут содержатся в мапе. В общем вердикт: дальнейших действий не требуется.
------------------------------------------------------------------------
r13141 | a.rainman@gmail.com | 2013-03-07 02:22:43 +0400 (Чт, 07 мар 2013) | 3 lines

# Исправлена ошибка в Client::getMyNick() приводившая к снижению производительности.
# Убрана функция дублёр getCurrentNick().
# TODO так же оптимизировать getHubName().
------------------------------------------------------------------------
r13140 | a.rainman@gmail.com | 2013-03-07 02:01:38 +0400 (Чт, 07 мар 2013) | 1 line

# Issue 923 часть 2
------------------------------------------------------------------------
r13139 | pavel.pimenov | 2013-03-06 23:05:59 +0400 (Ср, 06 мар 2013) | 2 lines

* (fixed Issue 923) [Рефакторинг] В HubFrame::onCustomDraw часто зовется client->isOp()
   http://code.google.com/p/flylinkdc/issues/detail?id=923
------------------------------------------------------------------------
r13138 | pavel.pimenov | 2013-03-06 22:31:39 +0400 (Ср, 06 мар 2013) | 3 lines

* [Issue 922] Проверить производительность загрузки больших файл-листов
  возможно на каждом файле обращаться к мап-е не очень эффективно.
  и если кол-во файлов-паразитов будет не много. захардкордить их проверки.
------------------------------------------------------------------------
r13136 | pavel.pimenov | 2013-03-06 06:36:13 +0400 (Ср, 06 мар 2013) | 2 lines

# Для Ежа поставил маячек подсчета статистики вызовов Identity::get и Identity::set (видно только под отладкой)
  - Одна из причин появление getMyIdentity()
------------------------------------------------------------------------
r13135 | a.rainman@gmail.com | 2013-03-06 01:52:32 +0400 (Ср, 06 мар 2013) | 1 line

# Косметика.
------------------------------------------------------------------------
r13134 | a.rainman@gmail.com | 2013-03-05 23:29:40 +0400 (Вт, 05 мар 2013) | 1 line

# Косметика.
------------------------------------------------------------------------
r13133 | pavel.pimenov | 2013-03-05 20:04:11 +0400 (Вт, 05 мар 2013) | 1 line

# dcassert и nullptr
------------------------------------------------------------------------
r13132 | pavel.pimenov | 2013-03-05 20:02:22 +0400 (Вт, 05 мар 2013) | 1 line

# Удалил лишние Ежик-скобки.
------------------------------------------------------------------------
r13131 | pavel.pimenov | 2013-03-05 20:00:19 +0400 (Вт, 05 мар 2013) | 2 lines

# [merge]
  Исправлено падение при битом файле конфига https://crash-server.com/Problem.aspx?ProblemID=15638
------------------------------------------------------------------------
r13129 | pavel.pimenov | 2013-03-05 19:44:29 +0400 (Вт, 05 мар 2013) | 1 line

# [Issue 920] Поправил алгоритм подкраски ников включенных в друзья. (for merge)
------------------------------------------------------------------------
r13127 | pavel.pimenov | 2013-03-05 18:53:12 +0400 (Вт, 05 мар 2013) | 1 line

# [merge] Отсутствует операторская проверка повторяющихся цифр в размере шары. Пример сообщения: [xx:xx:xx] *** Пользователь XXXX - 74 755 555 527 Б - the share size had too many same numbers in it.
------------------------------------------------------------------------
r13126 | tret2003 | 2013-03-05 12:44:15 +0400 (Вт, 05 мар 2013) | 1 line

# Дополнение r13125, убрал лишние c_str()
------------------------------------------------------------------------
r13125 | tret2003 | 2013-03-05 12:37:01 +0400 (Вт, 05 мар 2013) | 1 line

# (Fixed issue 917) Поправил сортировку по колонке разрешения в поиске
------------------------------------------------------------------------
r13121 | pavel.pimenov | 2013-03-04 18:41:13 +0400 (Пн, 04 мар 2013) | 1 line

# Исправлено падение на парсинге Util::getExternalIP
------------------------------------------------------------------------
r13119 | pavel.pimenov | 2013-03-04 18:36:29 +0400 (Пн, 04 мар 2013) | 1 line

# Подмена урлов с flylinkdc.ru/ на flylinkdc.com/
------------------------------------------------------------------------
r13115 | tret2003 | 2013-03-02 16:20:46 +0400 (Сб, 02 мар 2013) | 1 line

# Поправил сортировку по колонке разрешения в списке файлов
------------------------------------------------------------------------
r13111 | pavel.pimenov | 2013-03-02 07:32:23 +0400 (Сб, 02 мар 2013) | 1 line

# Добавил dcassert чтобы замечать проблемы с загрузкой конфига в отладке
------------------------------------------------------------------------
r13106 | pavel.pimenov | 2013-03-01 20:46:42 +0400 (Пт, 01 мар 2013) | 2 lines

# [r5xx] [public-build] Astyle

------------------------------------------------------------------------
r13103 | pavel.pimenov | 2013-03-01 18:34:53 +0400 (Пт, 01 мар 2013) | 4 lines

* (Fixed issue 917) Неправильная сортировка по рейтингу в окне поиска 
  Поправил сортировку по рейтингу и битрейту. длительность пока оставил 
  TODO - В колонке строковое значение... в формате Xh Ym Zs написать парсер привести к числу и сравить

------------------------------------------------------------------------
r13098 | tret2003 | 2013-03-01 17:34:00 +0400 (Пт, 01 мар 2013) | 1 line

# При установке не проверяем версии файлов у которых нет версий
------------------------------------------------------------------------
r13096 | scalolaz_scat@mail.ru | 2013-03-01 12:24:20 +0400 (Пт, 01 мар 2013) | 2 lines

# Дополнение к r13087: убрал лишние пробелы.
# Если возможно, - укоротить слово Memory: до M: или хотя бы Mem:, т.к. на большинстве хабов не влезает порт хаба в адресе.
------------------------------------------------------------------------
r13094 | a.rainman@gmail.com | 2013-03-01 00:14:12 +0400 (Пт, 01 мар 2013) | 1 line

# r13088 - копипасты фикс.
------------------------------------------------------------------------
r13093 | pavel.pimenov | 2013-03-01 00:02:49 +0400 (Пт, 01 мар 2013) | 1 line

# log
------------------------------------------------------------------------
r13092 | a.rainman@gmail.com | 2013-02-28 23:52:51 +0400 (Чт, 28 фев 2013) | 1 line

# +r13088.
------------------------------------------------------------------------
r13091 | a.rainman@gmail.com | 2013-02-28 23:42:31 +0400 (Чт, 28 фев 2013) | 1 line

# Упростил код в DONT_SHOW_HIDDEN_USERS_IN_HUB_FRAME.
------------------------------------------------------------------------
r13089 | pavel.pimenov | 2013-02-28 23:30:29 +0400 (Чт, 28 фев 2013) | 2 lines

# [r5xx] [public-build] Astyle

------------------------------------------------------------------------
r13088 | pavel.pimenov | 2013-02-28 23:29:39 +0400 (Чт, 28 фев 2013) | 1 line

# r502-beta67
------------------------------------------------------------------------
r13087 | pavel.pimenov | 2013-02-28 23:24:35 +0400 (Чт, 28 фев 2013) | 6 lines

# [fly-server] поддержка запроса fly-login пока не используется.
# Контроль отрытия битых файл-листов с предложением отправить их разработчику.
# Для беток в заголовке выводим расход памяти [Memory: %dM / %dM] 
# Для одиночных файлов на двойном клике в окне файл-листа и посика показываем развертку информации поулченной с сервера.
  https://www.box.com/shared/pi4h46b32spcymv0qrpy 
  TODO - колонку mediInform спрятать в нее ничего не входит.
------------------------------------------------------------------------
r13086 | pavel.pimenov | 2013-02-28 23:16:19 +0400 (Чт, 28 фев 2013) | 1 line

# Убрал копи-паст в UserConnection::on(BytesSent и UserConnection::on(Data
------------------------------------------------------------------------
r13085 | a.rainman@gmail.com | 2013-02-28 22:40:32 +0400 (Чт, 28 фев 2013) | 1 line

# +r13084 - ради дебажных тестов надо писать проверки так, что бы было явно видно что они для теста.
------------------------------------------------------------------------
r13084 | pavel.pimenov | 2013-02-28 22:29:34 +0400 (Чт, 28 фев 2013) | 1 line

# Откатил r13076
------------------------------------------------------------------------
r13081 | a.rainman@gmail.com | 2013-02-28 21:22:34 +0400 (Чт, 28 фев 2013) | 1 line

# +r13071 - заэкранировал ядерные зависимости по коду для скрытых юзеров в DONT_SHOW_HIDDEN_USERS_IN_HUB_FRAME.
------------------------------------------------------------------------
r13078 | tret2003 | 2013-02-28 21:01:54 +0400 (Чт, 28 фев 2013) | 1 line

# Дополнение к r13062
------------------------------------------------------------------------
r13076 | a.rainman@gmail.com | 2013-02-28 20:33:10 +0400 (Чт, 28 фев 2013) | 3 lines

# Дополнение к r13049 и r13050: файл не залил.
# Убрал из ~Socket() проверку if(sock != INVALID_SOCKET) ибо она уже
присутствует в disconnect().
------------------------------------------------------------------------
r13074 | pavel.pimenov | 2013-02-28 20:21:05 +0400 (Чт, 28 фев 2013) | 1 line

# Убрал лишние скобки
------------------------------------------------------------------------
r13071 | a.rainman@gmail.com | 2013-02-28 19:36:27 +0400 (Чт, 28 фев 2013) | 2 lines

* Включил показ скрытых ботов в списке хабов.
# В ежовой скрываются, но при поиске вылазиют - посмотреть почему, и исправить (TODO).
------------------------------------------------------------------------
r13070 | pavel.pimenov | 2013-02-28 19:08:26 +0400 (Чт, 28 фев 2013) | 8 lines

# Убрал падения вида
  https://crash-server.com/Problem.aspx?ClientID=ppa&ProblemID=12550  (> 200 падений)
  Если падаем значит в мапах хранились невалидные указатели.
  это очень опасно и могло приводить к багам поиска.
  Если есть сомнения - смотрим в код оригинального DC++.
  TODO 
   - часть баги лежат в оригинальном StrongDC++
   там и в r4xx тоже пофиксить это. память в этом месте экономить можно другим способом.
------------------------------------------------------------------------
r13069 | scalolaz_scat@mail.ru | 2013-02-28 19:08:01 +0400 (Чт, 28 фев 2013) | 2 lines

# вернул подпись к "магическому числу" ~ 6mbit
В дальнейшем, сделать ограничения верхнего и нижнего порога, как в настройке "Ограничения скорости"
------------------------------------------------------------------------
r13068 | pavel.pimenov | 2013-02-28 18:52:22 +0400 (Чт, 28 фев 2013) | 3 lines

# - Добавлен флаг старта без файла конфигурации (первый старт портабельной версии)
  пока нигде не юзается.

------------------------------------------------------------------------
r13067 | scalolaz_scat@mail.ru | 2013-02-28 18:40:38 +0400 (Чт, 28 фев 2013) | 1 line

# Регуляторы ограничения скорости: копипасты фикс (благодарности NightOrion)
------------------------------------------------------------------------
r13062 | tret2003 | 2013-02-27 22:25:00 +0400 (Ср, 27 фев 2013) | 1 line

# [lang] an auto commit from localization system...
------------------------------------------------------------------------
r13057 | pavel.pimenov | 2013-02-27 21:42:55 +0400 (Ср, 27 фев 2013) | 1 line

# Убрал левые скобки
------------------------------------------------------------------------
r13055 | pavel.pimenov | 2013-02-27 20:55:37 +0400 (Ср, 27 фев 2013) | 10 lines

* Merged revision(s) 13054 from branches-release/flylinkdc-r501-sp12:
* [r501-sp12.4] Wizards/WzNetActive.h
 - Исправлена двойная проверка upnp
 - При чистой установке никогда не включалось UPNP
 - Даже если проверка прошла с ошибкой - ставим режим upnp и не выводим пугающий диалог про пассивный режим.
   TODO 
    - проверить при прямом коннекте
    - влить в trunk
  

------------------------------------------------------------------------
r13052 | tret2003 | 2013-02-27 12:17:49 +0400 (Ср, 27 фев 2013) | 1 line

# [lang] an auto commit from localization system...
------------------------------------------------------------------------
r13050 | a.rainman@gmail.com | 2013-02-27 00:34:59 +0400 (Ср, 27 фев 2013) | 4 lines

# Дополнение к r13049
# Убрал из ~Socket() проверку if(sock != INVALID_SOCKET) ибо она уже присутствует в disconnect().
# Да в ~SSLSocket() была ошибка с двойным вызовом disconnect - поправил комментарий на утвердительный.
# dcassert(sock != INVALID_SOCKET) в Socket::shutdown() и Socket::close() Ответ на вопрос поймаем ли под отладкой двойное закрытие? - нет не поймаем, ибо INVALID_SOCKET это тоже нормальное состояние сокета, который мог стать не валидным в процессе работы в результате какой либо сетевой ошибки.
------------------------------------------------------------------------
r13049 | pavel.pimenov | 2013-02-26 22:00:11 +0400 (Вт, 26 фев 2013) | 3 lines

# dcassert
# Не зовем disconnect в virtual ~Socket() если сокет не создан
# Убрал двойной вызов disconnect в ~SSLSocket()
------------------------------------------------------------------------
r13048 | pavel.pimenov | 2013-02-26 21:57:29 +0400 (Вт, 26 фев 2013) | 1 line

# [r5xx] [public-build] Astyle
------------------------------------------------------------------------
r13047 | pavel.pimenov | 2013-02-26 21:53:57 +0400 (Вт, 26 фев 2013) | 4 lines

# Исправлены возможные падения при onClose
  https://crash-server.com/Problem.aspx?ClientID=ppa&ProblemID=12626
  https://crash-server.com/Problem.aspx?ClientID=ppa&ProblemID=12580
  https://crash-server.com/Problem.aspx?ClientID=ppa&ProblemID=14931
------------------------------------------------------------------------
r13046 | pavel.pimenov | 2013-02-26 20:55:12 +0400 (Вт, 26 фев 2013) | 8 lines

# Исправлена ошибочная установка языка в английский
  у нас void SettingsManager::load зачем-то два раза зовется
  в результате чего if (languageFile.empty()) на втором вызове превращает забранный из реестра ru-RU в en-US

  TODO 
  - разобраться зачем сделано и убрать дубликатный вызов SettingsManager::load при старте и так прога запускается как трактор.
  - Убрать лямду auto getLanguageFileFromOldName = [languageFile]() -> string

------------------------------------------------------------------------
r13042 | pavel.pimenov | 2013-02-26 06:55:35 +0400 (Вт, 26 фев 2013) | 1 line

# Максимально обобщил методы merge_fly_server_info. - подготовка к их слиянию
------------------------------------------------------------------------
r13035 | pavel.pimenov | 2013-02-25 19:38:42 +0400 (Пн, 25 фев 2013) | 1 line

# [r5xx] [public-build] Astyle
------------------------------------------------------------------------
r13032 | pavel.pimenov | 2013-02-25 19:27:54 +0400 (Пн, 25 фев 2013) | 7 lines

# Merged revision(s) 13029 from branches/dev-flylinkdc-r3xx-stable:
  - HttpConnection - не поддерживает Chunked transfer encoding 
    http://code.google.com/p/flylinkdc/issues/detail?id=900
  - Веротяно исправлены падения из-за кривой синхронизации операции обновления IP по таймеру.
    https://crash-server.com/Problem.aspx?ClientID=ppa&ProblemID=5527
  - к getExternalIP добавлен параметр p_timeOut

------------------------------------------------------------------------
r13031 | pavel.pimenov | 2013-02-25 18:45:43 +0400 (Пн, 25 фев 2013) | 2 lines

* [merge] 
 - К getExternalIP добавлен параметр p_timeOut
------------------------------------------------------------------------
r13024 | a.rainman@gmail.com | 2013-02-24 16:35:55 +0400 (Вс, 24 фев 2013) | 1 line

# +r13017
------------------------------------------------------------------------
r13023 | pavel.pimenov | 2013-02-24 16:12:07 +0400 (Вс, 24 фев 2013) | 4 lines

# Уюрал лишние прагмы
 const string l_pragma_cache_size = "PRAGMA cache_size=2048;";
 const string l_pragma_default_cache_size = "PRAGMA default_cache_size=2048;";

------------------------------------------------------------------------
r13019 | a.rainman@gmail.com | 2013-02-24 07:01:39 +0400 (Вс, 24 фев 2013) | 1 line

# Перевёл авто-обновление на ежечасные события. Поскольку пользователи не склонны менять время автоматического обновления в настройках, то данное изменение позволит размазать запросы пользователей не по одной минуте, как было раньше, а по целому часу. Разумеется речь идёт о пользователях в пределах одного часового пояса. С долей шутки: теперь можно смело выпускать Флай на китайском, не опасаясь, что сервер обновок поляжет, да и вообще полезно равномерно распределять нагрузку по времени.
------------------------------------------------------------------------
r13018 | a.rainman@gmail.com | 2013-02-24 07:01:33 +0400 (Вс, 24 фев 2013) | 7 lines

# +r12943 - финальная версия TimerManager.
# Убрал растянутые секунды. При необходимости их можно опционально включить директивой USE_LONG_SECONDS.
# Оставил только логирование в отладочный лог, из системного убрал, полностью отключить логирование можно выключением директивы TIMER_MANAGER_DEBUG.
# Выполнена нормализация минутных событий. Раньше минута была равна 60 циклам, и меж минутные интервалы могли растягиваться непредсказуемо дольше 60 реальных секунд. Теперь минутные события генерируются по времени, и не зависят от количества секундных событий.
# Добавлено ежечасное событие.
# Добавлено не отключаемое отладочное сообщение, отображающее длительность предыдущего цикла если он был длиннее секунды.
# p.s: https://bugs.launchpad.net/dcplusplus/+bug/713742 , также вспомнилось почему туда полез - у нас что то где то сильно глючило - то ли сферические скачки скорости были из-за одинаковых тиков, то ли что то падало.
------------------------------------------------------------------------
r13017 | a.rainman@gmail.com | 2013-02-24 01:54:55 +0400 (Вс, 24 фев 2013) | 1 line

# Косметика.
------------------------------------------------------------------------
r13016 | a.rainman@gmail.com | 2013-02-24 01:54:51 +0400 (Вс, 24 фев 2013) | 2 lines

# Мелкая оптимизация в ShareManager::rebuildMediainfo.
# Косметика кода.
------------------------------------------------------------------------
r13014 | pavel.pimenov | 2013-02-23 21:04:17 +0400 (Сб, 23 фев 2013) | 1 line

# Капслок затесался но работает )
------------------------------------------------------------------------
r13011 | a.rainman@gmail.com | 2013-02-23 19:55:12 +0400 (Сб, 23 фев 2013) | 1 line

# +r13002, r13008 - добавил забытый экран IRAINMAN_USE_READ_WRITE_LOCK.
------------------------------------------------------------------------
r13010 | pavel.pimenov | 2013-02-23 19:53:42 +0400 (Сб, 23 фев 2013) | 1 line

# Косметика
------------------------------------------------------------------------
r13009 | pavel.pimenov | 2013-02-23 18:54:31 +0400 (Сб, 23 фев 2013) | 1 line

# Astyle
------------------------------------------------------------------------
r13008 | pavel.pimenov | 2013-02-23 18:53:44 +0400 (Сб, 23 фев 2013) | 1 line

# В этой области уже есть лог. Еж - при случае посмотри внимательно этот момент. ты зря его тут добавлял.
------------------------------------------------------------------------
r13002 | pavel.pimenov | 2013-02-23 18:23:17 +0400 (Сб, 23 фев 2013) | 1 line

# Ежик! прекращай ставить такие лишние скобки.
------------------------------------------------------------------------
r12991 | pavel.pimenov | 2013-02-23 11:56:00 +0400 (Сб, 23 фев 2013) | 1 line

# Опечатка
------------------------------------------------------------------------
r12990 | pavel.pimenov | 2013-02-23 11:41:47 +0400 (Сб, 23 фев 2013) | 2 lines

# Убрал двойной вызов accept
  Слава! прошу внимательнее мержить изменения
------------------------------------------------------------------------
r12987 | pavel.pimenov | 2013-02-23 07:39:56 +0400 (Сб, 23 фев 2013) | 1 line

# В QueueItem::QueueItem сделал явную инициализацию базового класса Flags
------------------------------------------------------------------------
r12986 | pavel.pimenov | 2013-02-23 07:37:04 +0400 (Сб, 23 фев 2013) | 2 lines

# Заменил хак Ежика int64_t getShareSize() const noexcept на int64_t calcShareSize()
  
------------------------------------------------------------------------
r12982 | a.rainman@gmail.com | 2013-02-22 21:13:49 +0400 (Пт, 22 фев 2013) | 1 line

# log - немного причесал для приведения к одному стилю.
------------------------------------------------------------------------
r12981 | a.rainman@gmail.com | 2013-02-22 20:55:01 +0400 (Пт, 22 фев 2013) | 2 lines

# +r12979 - добавил коммент со ссылкой на коммит, ибо там обсуждение (считай тикет).
# Косметика - свернул код в этом месте.
------------------------------------------------------------------------
r12980 | tret2003 | 2013-02-22 20:40:09 +0400 (Пт, 22 фев 2013) | 1 line

# Обновил версию MediaInfo
------------------------------------------------------------------------
r12979 | tret2003 | 2013-02-22 19:08:52 +0400 (Пт, 22 фев 2013) | 1 line

# Исправлена сортировка админов при старте программы.
------------------------------------------------------------------------
r12976 | a.rainman@gmail.com | 2013-02-22 18:04:50 +0400 (Пт, 22 фев 2013) | 1 line

# log.
------------------------------------------------------------------------
r12975 | a.rainman@gmail.com | 2013-02-22 17:50:35 +0400 (Пт, 22 фев 2013) | 3 lines

# +r12969, r12970 - локализовал исправление в пределах ShareManager::getShareSize().
# Если по хорошему то данное исправление не нужно, поскольку загрузчик кеша шары (списка файлов) зовётся в основном потоке в самом начале старта программы (ещё на сплеше): http://studia2000.sytes.net/image/Flylink/LoadCache-start.png , http://studia2000.sytes.net/image/Flylink/LoadCache-end.png . Если же по каким то причинам не удалось загрузить кеш (он отсутствует, или повреждён), то размер шары будет равен 0, и это честное значение, заданное конструктором. Если же при повреждённом (не читающемся) списке файлов значение размера шары будет установлено не равным 0, а какое то другое, то для проверяющего (хаб,  бот, оператор) это будет означать, что шара у клиента фейковая, и его могут кикнуть или забанить.
# p.s: в ежовой данный фикс отключён.
------------------------------------------------------------------------
r12970 | pavel.pimenov | 2013-02-22 14:16:09 +0400 (Пт, 22 фев 2013) | 2 lines

# При старте иногда получалась шара = -1 (Часть 2)
  ShareManager::getInstance()->getShareSize() возваращал закешированное значение размера которое в свою очередь расчитывается на таймере.
------------------------------------------------------------------------
r12969 | pavel.pimenov | 2013-02-22 14:14:34 +0400 (Пт, 22 фев 2013) | 1 line

# При старте иногда получалась шара = -1
------------------------------------------------------------------------
r12968 | pavel.pimenov | 2013-02-22 14:13:32 +0400 (Пт, 22 фев 2013) | 3 lines

* [merge] [закрыл тикет 755] Исправлено возможность помещения в файл левых символов не валидных для XML
  TODO - Рассмотреть вариант не сохранять левые символы в базе данных при хешировании.
  
------------------------------------------------------------------------
r12961 | pavel.pimenov | 2013-02-22 13:07:36 +0400 (Пт, 22 фев 2013) | 1 line

# С IRAINMAN_INCLUDE_DETECTION_MANAGER видать флай никто не собирал...
------------------------------------------------------------------------
r12951 | pavel.pimenov | 2013-02-21 20:27:50 +0400 (Чт, 21 фев 2013) | 1 line

#
------------------------------------------------------------------------
r12943 | a.rainman@gmail.com | 2013-02-21 18:46:23 +0400 (Чт, 21 фев 2013) | 4 lines

# +r12914, r12915, r12935, r12938.
# Переписана начинка TimerManager::run().
# Добавлена диагностика временных событий, экранирована TIMER_MANAGER_DEBUG, сейчас включена в дебаге. Для нахождения длительных событий возможно стоит включить и в серой ветке.
# [for merge]
------------------------------------------------------------------------
r12939 | pavel.pimenov | 2013-02-21 14:27:48 +0400 (Чт, 21 фев 2013) | 2 lines

# Убрал PRAGMA synchronous=OFF
  
------------------------------------------------------------------------
r12938 | tret2003 | 2013-02-21 12:50:51 +0400 (Чт, 21 фев 2013) | 1 line

# Откатил сомнительынй патчик
------------------------------------------------------------------------
r12937 | pavel.pimenov | 2013-02-21 11:23:21 +0400 (Чт, 21 фев 2013) | 1 line

# В логах везде фиксируем секунды. маска времени по дефолту %H:%M:%S
------------------------------------------------------------------------
r12935 | tret2003 | 2013-02-21 10:51:05 +0400 (Чт, 21 фев 2013) | 1 line

# Откатил r12914 r12915 r12925
------------------------------------------------------------------------
r12933 | tret2003 | 2013-02-21 08:32:34 +0400 (Чт, 21 фев 2013) | 1 line

# Откатил r19213, r19210
------------------------------------------------------------------------
r12930 | pavel.pimenov | 2013-02-21 06:34:07 +0400 (Чт, 21 фев 2013) | 2 lines

# [public-build]
 - r502-beta66
------------------------------------------------------------------------
r12927 | pavel.pimenov | 2013-02-20 23:38:02 +0400 (Ср, 20 фев 2013) | 3 lines

# - BootstrapManager не использует для загрузки HttpConnectionListener а делает это синхронно с таймаутом 0.5сек
  - Добавил подробное логирование работы DHT

------------------------------------------------------------------------
r12926 | pavel.pimenov | 2013-02-20 23:36:20 +0400 (Ср, 20 фев 2013) | 1 line

# Косметика
------------------------------------------------------------------------
r12925 | pavel.pimenov | 2013-02-20 21:44:07 +0400 (Ср, 20 фев 2013) | 1 line

# [public-build] Astyle
------------------------------------------------------------------------
r12924 | pavel.pimenov | 2013-02-20 21:13:56 +0400 (Ср, 20 фев 2013) | 2 lines

# [fly-serve] Оптимизация хранения и обмена информации для файлов содержжащих более 1 звукового канала.
  (пока требует ребилд базы медиаинформации)
------------------------------------------------------------------------
r12923 | pavel.pimenov | 2013-02-20 21:09:39 +0400 (Ср, 20 фев 2013) | 1 line

# Косметика
------------------------------------------------------------------------
r12918 | pavel.pimenov | 2013-02-19 18:54:06 +0400 (Вт, 19 фев 2013) | 2 lines

# К архиву исходников добавлен *.vcxproj.filters

------------------------------------------------------------------------
r12915 | a.rainman@gmail.com | 2013-02-19 06:53:17 +0400 (Вт, 19 фев 2013) | 1 line

# +r12914 мелкая оптимизация.
------------------------------------------------------------------------
r12914 | a.rainman@gmail.com | 2013-02-18 17:55:19 +0400 (Пн, 18 фев 2013) | 1 line

# Переписал генерацию тиков в timermanager - теперь у нас полностью растянутые секунды - т.е. за минуту секундное событие может генерироваться менее 60 ти раз. Минутное событие гарантированно будет происходить не чаще одного раза в минуту, однако разница интервалов так же не гарантируется. По этой причине для любого точного измерения времени обязательно используйте значение тика, передаваемого в качестве параметра обработчикам событий!
------------------------------------------------------------------------
r12913 | tret2003 | 2013-02-18 10:53:14 +0400 (Пн, 18 фев 2013) | 1 line

# Вернул случайно потёртое
------------------------------------------------------------------------
r12912 | pavel.pimenov | 2013-02-18 10:00:24 +0400 (Пн, 18 фев 2013) | 1 line

# Убрал лишние ::EnableWindow
------------------------------------------------------------------------
r12911 | tret2003 | 2013-02-17 16:45:24 +0400 (Вс, 17 фев 2013) | 1 line

# [lang] an auto commit from localization system...
------------------------------------------------------------------------
r12910 | tret2003 | 2013-02-17 16:19:48 +0400 (Вс, 17 фев 2013) | 1 line

# Если обновление уже скачано и готово к установке не напоминаем ещё раз о его наличии и необходимости качать второй раз, а скромно спрашиваем - обновиться или подождать.
------------------------------------------------------------------------
r12909 | scalolaz_scat@mail.ru | 2013-02-17 13:10:16 +0400 (Вс, 17 фев 2013) | 2 lines

# Astyle
# Замена : Размер "Нормально" на "Любой" в поиске
------------------------------------------------------------------------
r12908 | scalolaz_scat@mail.ru | 2013-02-16 16:15:06 +0400 (Сб, 16 фев 2013) | 1 line

# Затемняем контролы размеров при выборе режима поиска "Нормально".
------------------------------------------------------------------------
r12907 | pavel.pimenov | 2013-02-15 23:43:24 +0400 (Пт, 15 фев 2013) | 1 line

# Добавил батник для старта ночной сборки
------------------------------------------------------------------------
r12906 | pavel.pimenov | 2013-02-15 23:42:04 +0400 (Пт, 15 фев 2013) | 1 line

# [public-build] 
------------------------------------------------------------------------
r12905 | pavel.pimenov | 2013-02-15 23:39:35 +0400 (Пт, 15 фев 2013) | 3 lines

# [рефакторинг] Убрал преобразование из Search::SizeModes в int
# Для getShareSize поставил капкан на Ежа 
  - dcassert(m_CurrentShareSize != -1); // TODO - баг. попытка получить размер шары до вызова internal_calcShareSize
------------------------------------------------------------------------
r12904 | pavel.pimenov | 2013-02-15 23:34:38 +0400 (Пт, 15 фев 2013) | 3 lines

# Исправлены падения 
  - https://crash-server.com/Problem.aspx?ClientID=ppa&ProblemID=12626
  удаление листенеров унес из onClose в деструктор
------------------------------------------------------------------------
r12903 | pavel.pimenov | 2013-02-15 23:31:42 +0400 (Пт, 15 фев 2013) | 3 lines

# [fly-server] 
 Ошибочно кидал в лог Error compress query: l_zlib_result =  " + Util::toString(l_zlib_result)
 для случая если сжатый пакет получался больше оригинала.(случай с мелкими размерами входного массива)
------------------------------------------------------------------------
r12902 | pavel.pimenov | 2013-02-15 22:45:21 +0400 (Пт, 15 фев 2013) | 1 line

# Явно прописал BOOST_ALL_NO_LIB
------------------------------------------------------------------------
r12901 | pavel.pimenov | 2013-02-15 22:43:44 +0400 (Пт, 15 фев 2013) | 1 line

# Убрал в игнор странный файл mrgtmp0
------------------------------------------------------------------------
r12900 | pavel.pimenov | 2013-02-15 22:42:33 +0400 (Пт, 15 фев 2013) | 559 lines

# [fly-server] Ускорил формирование JSON пакета для многоконального звука. 
  - TODO собрать повторяюшиеся атрибуты каналов и сохранить в общий блок channet-x

Пример представления файла с болшим количеством Channel-*

{
   "array" : [
      {
         "media" : {
            "fly_audio" : "1h 32mn | AC-3, 5.1, 640 Kbps, Russian | DTS, 5.1, 1 509 Kbps, Russian | DTS, 5.1, 1 509 Kbps, Russian | DTS, 5.1, 1 509 Kbps, Russian | DTS, 5.1, 1 509 Kbps, Russian | DTS, 5.1, 1 509 Kbps, English | AC-3, 5.1, 448 Kbps, Russian | AC-3, 5.1, 448 Kbps, Russian | AC-3, 5.1, 448 Kbps, Russian | AC-3, 2.0, 192 Kbps, Ukrainian | AC-3, 2.0, 192 Kbps, English | AC-3, 2.0, 192 Kbps, English",
            "fly_audio_br" : 1509,
            "fly_video" : "AVC, 9 000 Kbps, 23.976 fps",
            "fly_xy" : "1920x1080"
         },
         "media-ext" : {
            "audio" : {
               "channel-0" : {
                  "BitDepth" : "16",
                  "BitRate" : "640000",
                  "BitRate_Mode" : "CBR",
                  "Channel(s)" : "6",
                  "ChannelPositions" : "Front: L C R, Side: L R, LFE",
                  "Codec" : "AC3",
                  "Codec/Family" : "AC3",
                  "Codec/Info" : "Dolby AC3",
                  "CodecID" : "A_AC3",
                  "Compression_Mode" : "Lossy",
                  "Count" : "248",
                  "Default" : "Yes",
                  "Delay" : "0",
                  "Delay_Source" : "Container",
                  "Duration" : "5544384",
                  "Forced" : "No",
                  "Format" : "AC-3",
                  "Format/Info" : "Audio Coding 3",
                  "Format_Commercial" : "AC-3",
                  "Format_Settings_Endianness" : "Big",
                  "Format_Settings_ModeExtension" : "CM (complete main)",
                  "ID" : "2",
                  "Inform" : "ID : 2\r\nFormat : AC-3\r\nFormat/Info : Audio Coding 3\r\nMode extension : CM (complete main)\r\nFormat settings, Endianness : Big\r\nCodec ID : A_AC3\r\nDuration : 1h 32mn\r\nBit rate mode : Constant\r\nBit rate : 640 Kbps\r\nChannel(s) : 6 channels\r\nChannel positions : Front: L C R, Side: L R, LFE\r\nSampling rate : 48.0 KHz\r\nBit depth : 16 bits\r\nCompression mode : Lossy\r\nStream size : 423 MiB (3%)\r\nTitle : AC3 5.1ch 640 kbps - Дубляж, Blu-ray\r\nLanguage : Russian\r\nDefault : Yes\r\nForced : No\r\n",
                  "Language" : "ru",
                  "Resolution" : "16",
                  "SamplingCount" : "266130432",
                  "SamplingRate" : "48000",
                  "StreamCount" : "12",
                  "StreamKind" : "Audio",
                  "StreamKindID" : "0",
                  "StreamKindPos" : "1",
                  "StreamOrder" : "1",
                  "StreamSize" : "443550720",
                  "Title" : "AC3 5.1ch 640 kbps - Дубляж, Blu-ray",
                  "Video0_Delay" : "0",
                  "Video_Delay" : "0"
               },
               "channel-1" : {
                  "BitDepth" : "24",
                  "BitRate" : "1509000",
                  "BitRate_Mode" : "CBR",
                  "Channel(s)" : "6",
                  "ChannelPositions" : "Front: L C R, Side: L R, LFE",
                  "Codec" : "DTS",
                  "Codec/Family" : "DTS",
                  "CodecID" : "A_DTS",
                  "Compression_Mode" : "Lossy",
                  "Count" : "220",
                  "Default" : "No",
                  "Delay" : "0",
                  "Delay_Source" : "Container",
                  "Duration" : "5544384",
                  "Forced" : "No",
                  "Format" : "DTS",
                  "Format/Info" : "Digital Theater Systems",
                  "Format_Commercial" : "DTS",
                  "Format_Settings_Endianness" : "Big",
                  "Format_Settings_Mode" : "16",
                  "ID" : "3",
                  "Inform" : "ID : 3\r\nFormat : DTS\r\nFormat/Info : Digital Theater Systems\r\nMode : 16\r\nFormat settings, Endianness : Big\r\nCodec ID : A_DTS\r\nDuration : 1h 32mn\r\nBit rate mode : Constant\r\nBit rate : 1 509 Kbps\r\nChannel(s) : 6 channels\r\nChannel positions : Front: L C R, Side: L R, LFE\r\nSampling rate : 48.0 KHz\r\nBit depth : 24 bits\r\nCompression mode : Lossy\r\nStream size : 997 MiB (8%)\r\nTitle : DTS 5.1ch 1510 kbps - Одноголосый, Д.Пучков (Гобя)\r\nLanguage : Russian\r\nDefault : No\r\nForced : No\r\n",
                  "Language" : "ru",
                  "Resolution" : "24",
                  "SamplingCount" : "266130432",
                  "SamplingRate" : "48000",
                  "StreamCount" : "12",
                  "StreamKind" : "Audio",
                  "StreamKindID" : "1",
                  "StreamKindPos" : "2",
                  "StreamOrder" : "2",
                  "StreamSize" : "1045809432",
                  "Title" : "DTS 5.1ch 1510 kbps - Одноголосый, Д.Пучков (Гобя)",
                  "Video0_Delay" : "0",
                  "Video_Delay" : "0"
               },
               "channel-10" : {
                  "BitDepth" : "16",
                  "BitRate" : "192000",
                  "BitRate_Mode" : "CBR",
                  "Channel(s)" : "2",
                  "ChannelPositions" : "Front: L R",
                  "Codec" : "AC3",
                  "Codec/Family" : "AC3",
                  "Codec/Info" : "Dolby AC3",
                  "CodecID" : "A_AC3",
                  "Compression_Mode" : "Lossy",
                  "Count" : "231",
                  "Default" : "No",
                  "Delay" : "0",
                  "Delay_Source" : "Container",
                  "Duration" : "5544384",
                  "Forced" : "No",
                  "Format" : "AC-3",
                  "Format/Info" : "Audio Coding 3",
                  "Format_Commercial" : "AC-3",
                  "Format_Settings_Endianness" : "Big",
                  "Format_Settings_ModeExtension" : "CM (complete main)",
                  "ID" : "12",
                  "Inform" : "ID : 12\r\nFormat : AC-3\r\nFormat/Info : Audio Coding 3\r\nMode extension : CM (complete main)\r\nFormat settings, Endianness : Big\r\nCodec ID : A_AC3\r\nDuration : 1h 32mn\r\nBit rate mode : Constant\r\nBit rate : 192 Kbps\r\nChannel(s) : 2 channels\r\nChannel positions : Front: L R\r\nSampling rate : 48.0 KHz\r\nBit depth : 16 bits\r\nCompression mode : Lossy\r\nStream size : 127 MiB (1%)\r\nTitle : AC3 2.0ch 192 kbps - Commentary\r\nLanguage : English\r\nDefault : No\r\nForced : No\r\n",
                  "Language" : "en",
                  "Resolution" : "16",
                  "SamplingCount" : "266130432",
                  "SamplingRate" : "48000",
                  "StreamCount" : "12",
                  "StreamKind" : "Audio",
                  "StreamKindID" : "10",
                  "StreamKindPos" : "11",
                  "StreamOrder" : "11",
                  "StreamSize" : "133065216",
                  "Title" : "AC3 2.0ch 192 kbps - Commentary",
                  "Video0_Delay" : "0",
                  "Video_Delay" : "0"
               },
               "channel-11" : {
                  "BitDepth" : "16",
                  "BitRate" : "192000",
                  "BitRate_Mode" : "CBR",
                  "Channel(s)" : "2",
                  "ChannelPositions" : "Front: L R",
                  "Codec" : "AC3",
                  "Codec/Family" : "AC3",
                  "Codec/Info" : "Dolby AC3",
                  "CodecID" : "A_AC3",
                  "Compression_Mode" : "Lossy",
                  "Count" : "231",
                  "Default" : "No",
                  "Delay" : "0",
                  "Delay_Source" : "Container",
                  "Duration" : "5544384",
                  "Forced" : "No",
                  "Format" : "AC-3",
                  "Format/Info" : "Audio Coding 3",
                  "Format_Commercial" : "AC-3",
                  "Format_Settings_Endianness" : "Big",
                  "Format_Settings_ModeExtension" : "CM (complete main)",
                  "ID" : "13",
                  "Inform" : "ID : 13\r\nFormat : AC-3\r\nFormat/Info : Audio Coding 3\r\nMode extension : CM (complete main)\r\nFormat settings, Endianness : Big\r\nCodec ID : A_AC3\r\nDuration : 1h 32mn\r\nBit rate mode : Constant\r\nBit rate : 192 Kbps\r\nChannel(s) : 2 channels\r\nChannel positions : Front: L R\r\nSampling rate : 48.0 KHz\r\nBit depth : 16 bits\r\nCompression mode : Lossy\r\nStream size : 127 MiB (1%)\r\nTitle : AC3 2.0ch 192 kbps - Commentary\r\nLanguage : English\r\nDefault : No\r\nForced : No\r\n",
                  "Language" : "en",
                  "Resolution" : "16",
                  "SamplingCount" : "266130432",
                  "SamplingRate" : "48000",
                  "StreamCount" : "12",
                  "StreamKind" : "Audio",
                  "StreamKindID" : "11",
                  "StreamKindPos" : "12",
                  "StreamOrder" : "12",
                  "StreamSize" : "133065216",
                  "Title" : "AC3 2.0ch 192 kbps - Commentary",
                  "Video0_Delay" : "0",
                  "Video_Delay" : "0"
               },
               "channel-2" : {
                  "BitDepth" : "24",
                  "BitRate" : "1509000",
                  "BitRate_Mode" : "CBR",
                  "Channel(s)" : "6",
                  "ChannelPositions" : "Front: L C R, Side: L R, LFE",
                  "Codec" : "DTS",
                  "Codec/Family" : "DTS",
                  "CodecID" : "A_DTS",
                  "Compression_Mode" : "Lossy",
                  "Count" : "220",
                  "Default" : "No",
                  "Delay" : "0",
                  "Delay_Source" : "Container",
                  "Duration" : "5544384",
                  "Forced" : "No",
                  "Format" : "DTS",
                  "Format/Info" : "Digital Theater Systems",
                  "Format_Commercial" : "DTS",
                  "Format_Settings_Endianness" : "Big",
                  "Format_Settings_Mode" : "16",
                  "ID" : "4",
                  "Inform" : "ID : 4\r\nFormat : DTS\r\nFormat/Info : Digital Theater Systems\r\nMode : 16\r\nFormat settings, Endianness : Big\r\nCodec ID : A_DTS\r\nDuration : 1h 32mn\r\nBit rate mode : Constant\r\nBit rate : 1 509 Kbps\r\nChannel(s) : 6 channels\r\nChannel positions : Front: L C R, Side: L R, LFE\r\nSampling rate : 48.0 KHz\r\nBit depth : 24 bits\r\nCompression mode : Lossy\r\nStream size : 997 MiB (8%)\r\nTitle : DTS 5.1ch 1510 kbps - Двухголосый, Tycoon\r\nLanguage : Russian\r\nDefault : No\r\nForced : No\r\n",
                  "Language" : "ru",
                  "Resolution" : "24",
                  "SamplingCount" : "266130432",
                  "SamplingRate" : "48000",
                  "StreamCount" : "12",
                  "StreamKind" : "Audio",
                  "StreamKindID" : "2",
                  "StreamKindPos" : "3",
                  "StreamOrder" : "3",
                  "StreamSize" : "1045809432",
                  "Title" : "DTS 5.1ch 1510 kbps - Двухголосый, Tycoon",
                  "Video0_Delay" : "0",
                  "Video_Delay" : "0"
               },
               "channel-3" : {
                  "BitDepth" : "24",
                  "BitRate" : "1509000",
                  "BitRate_Mode" : "CBR",
                  "Channel(s)" : "6",
                  "ChannelPositions" : "Front: L C R, Side: L R, LFE",
                  "Codec" : "DTS",
                  "Codec/Family" : "DTS",
                  "CodecID" : "A_DTS",
                  "Compression_Mode" : "Lossy",
                  "Count" : "220",
                  "Default" : "No",
                  "Delay" : "0",
                  "Delay_Source" : "Container",
                  "Duration" : "5544384",
                  "Forced" : "No",
                  "Format" : "DTS",
                  "Format/Info" : "Digital Theater Systems",
                  "Format_Commercial" : "DTS",
                  "Format_Settings_Endianness" : "Big",
                  "Format_Settings_Mode" : "16",
                  "ID" : "5",
                  "Inform" : "ID : 5\r\nFormat : DTS\r\nFormat/Info : Digital Theater Systems\r\nMode : 16\r\nFormat settings, Endianness : Big\r\nCodec ID : A_DTS\r\nDuration : 1h 32mn\r\nBit rate mode : Constant\r\nBit rate : 1 509 Kbps\r\nChannel(s) : 6 channels\r\nChannel positions : Front: L C R, Side: L R, LFE\r\nSampling rate : 48.0 KHz\r\nBit depth : 24 bits\r\nCompression mode : Lossy\r\nStream size : 997 MiB (8%)\r\nTitle : DTS 5.1ch 1510 kbps - Двухголосый, П.Гланц, И.Королева\r\nLanguage : Russian\r\nDefault : No\r\nForced : No\r\n",
                  "Language" : "ru",
                  "Resolution" : "24",
                  "SamplingCount" : "266130432",
                  "SamplingRate" : "48000",
                  "StreamCount" : "12",
                  "StreamKind" : "Audio",
                  "StreamKindID" : "3",
                  "StreamKindPos" : "4",
                  "StreamOrder" : "4",
                  "StreamSize" : "1045809432",
                  "Title" : "DTS 5.1ch 1510 kbps - Двухголосый, П.Гланц, И.Королева",
                  "Video0_Delay" : "0",
                  "Video_Delay" : "0"
               },
               "channel-4" : {
                  "BitDepth" : "24",
                  "BitRate" : "1509000",
                  "BitRate_Mode" : "CBR",
                  "Channel(s)" : "6",
                  "ChannelPositions" : "Front: L C R, Side: L R, LFE",
                  "Codec" : "DTS",
                  "Codec/Family" : "DTS",
                  "CodecID" : "A_DTS",
                  "Compression_Mode" : "Lossy",
                  "Count" : "220",
                  "Default" : "No",
                  "Delay" : "0",
                  "Delay_Source" : "Container",
                  "Duration" : "5544384",
                  "Forced" : "No",
                  "Format" : "DTS",
                  "Format/Info" : "Digital Theater Systems",
                  "Format_Commercial" : "DTS",
                  "Format_Settings_Endianness" : "Big",
                  "Format_Settings_Mode" : "16",
                  "ID" : "6",
                  "Inform" : "ID : 6\r\nFormat : DTS\r\nFormat/Info : Digital Theater Systems\r\nMode : 16\r\nFormat settings, Endianness : Big\r\nCodec ID : A_DTS\r\nDuration : 1h 32mn\r\nBit rate mode : Constant\r\nBit rate : 1 509 Kbps\r\nChannel(s) : 6 channels\r\nChannel positions : Front: L C R, Side: L R, LFE\r\nSampling rate : 48.0 KHz\r\nBit depth : 24 bits\r\nCompression mode : Lossy\r\nStream size : 997 MiB (8%)\r\nTitle : DTS 5.1ch 1510 kbps - Одноголосый, А.Гаврилов\r\nLanguage : Russian\r\nDefault : No\r\nForced : No\r\n",
                  "Language" : "ru",
                  "Resolution" : "24",
                  "SamplingCount" : "266130432",
                  "SamplingRate" : "48000",
                  "StreamCount" : "12",
                  "StreamKind" : "Audio",
                  "StreamKindID" : "4",
                  "StreamKindPos" : "5",
                  "StreamOrder" : "5",
                  "StreamSize" : "1045809432",
                  "Title" : "DTS 5.1ch 1510 kbps - Одноголосый, А.Гаврилов",
                  "Video0_Delay" : "0",
                  "Video_Delay" : "0"
               },
               "channel-5" : {
                  "BitDepth" : "24",
                  "BitRate" : "1509000",
                  "BitRate_Mode" : "CBR",
                  "Channel(s)" : "6",
                  "ChannelPositions" : "Front: L C R, Side: L R, LFE",
                  "Codec" : "DTS",
                  "Codec/Family" : "DTS",
                  "CodecID" : "A_DTS",
                  "Compression_Mode" : "Lossy",
                  "Count" : "220",
                  "Default" : "No",
                  "Delay" : "0",
                  "Delay_Source" : "Container",
                  "Duration" : "5544384",
                  "Forced" : "No",
                  "Format" : "DTS",
                  "Format/Info" : "Digital Theater Systems",
                  "Format_Commercial" : "DTS",
                  "Format_Settings_Endianness" : "Big",
                  "Format_Settings_Mode" : "16",
                  "ID" : "7",
                  "Inform" : "ID : 7\r\nFormat : DTS\r\nFormat/Info : Digital Theater Systems\r\nMode : 16\r\nFormat settings, Endianness : Big\r\nCodec ID : A_DTS\r\nDuration : 1h 32mn\r\nBit rate mode : Constant\r\nBit rate : 1 509 Kbps\r\nChannel(s) : 6 channels\r\nChannel positions : Front: L C R, Side: L R, LFE\r\nSampling rate : 48.0 KHz\r\nBit depth : 24 bits\r\nCompression mode : Lossy\r\nStream size : 997 MiB (8%)\r\nTitle : DTS 5.1ch 1510 kbps\r\nLanguage : English\r\nDefault : No\r\nForced : No\r\n",
                  "Language" : "en",
                  "Resolution" : "24",
                  "SamplingCount" : "266130432",
                  "SamplingRate" : "48000",
                  "StreamCount" : "12",
                  "StreamKind" : "Audio",
                  "StreamKindID" : "5",
                  "StreamKindPos" : "6",
                  "StreamOrder" : "6",
                  "StreamSize" : "1045809432",
                  "Title" : "DTS 5.1ch 1510 kbps",
                  "Video0_Delay" : "0",
                  "Video_Delay" : "0"
               },
               "channel-6" : {
                  "BitDepth" : "16",
                  "BitRate" : "448000",
                  "BitRate_Mode" : "CBR",
                  "Channel(s)" : "6",
                  "ChannelPositions" : "Front: L C R, Side: L R, LFE",
                  "Codec" : "AC3",
                  "Codec/Family" : "AC3",
                  "Codec/Info" : "Dolby AC3",
                  "CodecID" : "A_AC3",
                  "Compression_Mode" : "Lossy",
                  "Count" : "230",
                  "Default" : "No",
                  "Delay" : "0",
                  "Delay_Source" : "Container",
                  "Duration" : "5544384",
                  "Forced" : "No",
                  "Format" : "AC-3",
                  "Format/Info" : "Audio Coding 3",
                  "Format_Commercial" : "AC-3",
                  "Format_Settings_Endianness" : "Big",
                  "Format_Settings_ModeExtension" : "CM (complete main)",
                  "ID" : "8",
                  "Inform" : "ID : 8\r\nFormat : AC-3\r\nFormat/Info : Audio Coding 3\r\nMode extension : CM (complete main)\r\nFormat settings, Endianness : Big\r\nCodec ID : A_AC3\r\nDuration : 1h 32mn\r\nBit rate mode : Constant\r\nBit rate : 448 Kbps\r\nChannel(s) : 6 channels\r\nChannel positions : Front: L C R, Side: L R, LFE\r\nSampling rate : 48.0 KHz\r\nBit depth : 16 bits\r\nCompression mode : Lossy\r\nStream size : 296 MiB (2%)\r\nTitle : AC3 5.1ch 448 kbps - Многоголосый, Киномания\r\nLanguage : Russian\r\nDefault : No\r\nForced : No\r\n",
                  "Language" : "ru",
                  "Resolution" : "16",
                  "SamplingCount" : "266130432",
                  "SamplingRate" : "48000",
                  "StreamCount" : "12",
                  "StreamKind" : "Audio",
                  "StreamKindID" : "6",
                  "StreamKindPos" : "7",
                  "StreamOrder" : "7",
                  "StreamSize" : "310485504",
                  "Title" : "AC3 5.1ch 448 kbps - Многоголосый, Киномания",
                  "Video0_Delay" : "0",
                  "Video_Delay" : "0"
               },
               "channel-7" : {
                  "BitDepth" : "16",
                  "BitRate" : "448000",
                  "BitRate_Mode" : "CBR",
                  "Channel(s)" : "6",
                  "ChannelPositions" : "Front: L C R, Side: L R, LFE",
                  "Codec" : "AC3",
                  "Codec/Family" : "AC3",
                  "Codec/Info" : "Dolby AC3",
                  "CodecID" : "A_AC3",
                  "Compression_Mode" : "Lossy",
                  "Count" : "230",
                  "Default" : "No",
                  "Delay" : "0",
                  "Delay_Source" : "Container",
                  "Duration" : "5544384",
                  "Forced" : "No",
                  "Format" : "AC-3",
                  "Format/Info" : "Audio Coding 3",
                  "Format_Commercial" : "AC-3",
                  "Format_Settings_Endianness" : "Big",
                  "Format_Settings_ModeExtension" : "CM (complete main)",
                  "ID" : "9",
                  "Inform" : "ID : 9\r\nFormat : AC-3\r\nFormat/Info : Audio Coding 3\r\nMode extension : CM (complete main)\r\nFormat settings, Endianness : Big\r\nCodec ID : A_AC3\r\nDuration : 1h 32mn\r\nBit rate mode : Constant\r\nBit rate : 448 Kbps\r\nChannel(s) : 6 channels\r\nChannel positions : Front: L C R, Side: L R, LFE\r\nSampling rate : 48.0 KHz\r\nBit depth : 16 bits\r\nCompression mode : Lossy\r\nStream size : 296 MiB (2%)\r\nTitle : AC3 5.1ch 448 kbps - Одноголосый, Д.Пучков (Гобя) #2\r\nLanguage : Russian\r\nDefault : No\r\nForced : No\r\n",
                  "Language" : "ru",
                  "Resolution" : "16",
                  "SamplingCount" : "266130432",
                  "SamplingRate" : "48000",
                  "StreamCount" : "12",
                  "StreamKind" : "Audio",
                  "StreamKindID" : "7",
                  "StreamKindPos" : "8",
                  "StreamOrder" : "8",
                  "StreamSize" : "310485504",
                  "Title" : "AC3 5.1ch 448 kbps - Одноголосый, Д.Пучков (Гобя) #2",
                  "Video0_Delay" : "0",
                  "Video_Delay" : "0"
               },
               "channel-8" : {
                  "BitDepth" : "16",
                  "BitRate" : "448000",
                  "BitRate_Mode" : "CBR",
                  "Channel(s)" : "6",
                  "ChannelPositions" : "Front: L C R, Side: L R, LFE",
                  "Codec" : "AC3",
                  "Codec/Family" : "AC3",
                  "Codec/Info" : "Dolby AC3",
                  "CodecID" : "A_AC3",
                  "Compression_Mode" : "Lossy",
                  "Count" : "230",
                  "Default" : "No",
                  "Delay" : "0",
                  "Delay_Source" : "Container",
                  "Duration" : "5544384",
                  "Forced" : "No",
                  "Format" : "AC-3",
                  "Format/Info" : "Audio Coding 3",
                  "Format_Commercial" : "AC-3",
                  "Format_Settings_Endianness" : "Big",
                  "Format_Settings_ModeExtension" : "CM (complete main)",
                  "ID" : "10",
                  "Inform" : "ID : 10\r\nFormat : AC-3\r\nFormat/Info : Audio Coding 3\r\nMode extension : CM (complete main)\r\nFormat settings, Endianness : Big\r\nCodec ID : A_AC3\r\nDuration : 1h 32mn\r\nBit rate mode : Constant\r\nBit rate : 448 Kbps\r\nChannel(s) : 6 channels\r\nChannel positions : Front: L C R, Side: L R, LFE\r\nSampling rate : 48.0 KHz\r\nBit depth : 16 bits\r\nCompression mode : Lossy\r\nStream size : 296 MiB (2%)\r\nTitle : AC3 5.1ch 448 kbps - Одноголосый, Д.Пучков (Гобя) #3\r\nLanguage : Russian\r\nDefault : No\r\nForced : No\r\n",
                  "Language" : "ru",
                  "Resolution" : "16",
                  "SamplingCount" : "266130432",
                  "SamplingRate" : "48000",
                  "StreamCount" : "12",
                  "StreamKind" : "Audio",
                  "StreamKindID" : "8",
                  "StreamKindPos" : "9",
                  "StreamOrder" : "9",
                  "StreamSize" : "310485504",
                  "Title" : "AC3 5.1ch 448 kbps - Одноголосый, Д.Пучков (Гобя) #3",
                  "Video0_Delay" : "0",
                  "Video_Delay" : "0"
               },
               "channel-9" : {
                  "BitDepth" : "16",
                  "BitRate" : "192000",
                  "BitRate_Mode" : "CBR",
                  "Channel(s)" : "2",
                  "ChannelPositions" : "Front: L R",
                  "Codec" : "AC3",
                  "Codec/Family" : "AC3",
                  "Codec/Info" : "Dolby AC3",
                  "CodecID" : "A_AC3",
                  "Compression_Mode" : "Lossy",
                  "Count" : "231",
                  "Default" : "No",
                  "Delay" : "0",
                  "Delay_Source" : "Container",
                  "Duration" : "5544384",
                  "Forced" : "No",
                  "Format" : "AC-3",
                  "Format/Info" : "Audio Coding 3",
                  "Format_Commercial" : "AC-3",
                  "Format_Settings_Endianness" : "Big",
                  "Format_Settings_ModeExtension" : "CM (complete main)",
                  "ID" : "11",
                  "Inform" : "ID : 11\r\nFormat : AC-3\r\nFormat/Info : Audio Coding 3\r\nMode extension : CM (complete main)\r\nFormat settings, Endianness : Big\r\nCodec ID : A_AC3\r\nDuration : 1h 32mn\r\nBit rate mode : Constant\r\nBit rate : 192 Kbps\r\nChannel(s) : 2 channels\r\nChannel positions : Front: L R\r\nSampling rate : 48.0 KHz\r\nBit depth : 16 bits\r\nCompression mode : Lossy\r\nStream size : 127 MiB (1%)\r\nTitle : AC3 2.0ch 192 kbps - Многоголосый, Новый Канал\r\nLanguage : Ukrainian\r\nDefault : No\r\nForced : No\r\n",
                  "Language" : "uk",
                  "Resolution" : "16",
                  "SamplingCount" : "266130432",
                  "SamplingRate" : "48000",
                  "StreamCount" : "12",
                  "StreamKind" : "Audio",
                  "StreamKindID" : "9",
                  "StreamKindPos" : "10",
                  "StreamOrder" : "10",
                  "StreamSize" : "133065216",
                  "Title" : "AC3 2.0ch 192 kbps - Многоголосый, Новый Канал",
                  "Video0_Delay" : "0",
                  "Video_Delay" : "0"
               }
            },
            "general" : {
               "AudioCount" : "12",
               "Audio_Codec_List" : "AC3 / DTS / DTS / DTS / DTS / DTS / AC3 / AC3 / AC3 / AC3 / AC3 / AC3",
               "Audio_Format_List" : "AC-3 / DTS / DTS / DTS / DTS / DTS / AC-3 / AC-3 / AC-3 / AC-3 / AC-3 / AC-3",
               "Audio_Format_WithHint_List" : "AC-3 / DTS / DTS / DTS / DTS / DTS / AC-3 / AC-3 / AC-3 / AC-3 / AC-3 / AC-3",
               "Audio_Language_List" : "Russian / Russian / Russian / Russian / Russian / English / Russian / Russian / Russian / Ukrainian / English / English",
               "Codec" : "Matroska",
               "Count" : "280",
               "Duration" : "5544384",
               "Encoded_Date" : "UTC 2011-03-22 22:03:47",
               "Encoded_Library" : "libebml v1.2.0 + libmatroska v1.1.0",
               "FileExtension" : "mkv",
               "Format" : "Matroska",
               "Format_Commercial" : "Matroska",
               "Format_Version" : "Version 2",
               "Inform" : "Unique ID : 203255661060539978619997371941752269459 (0x98E99DCC688008C1BB6DA7E70221EA93)\r\nFormat : Matroska\r\nFormat version : Version 2\r\nFile size : 12.3 GiB\r\nDuration : 1h 32mn\r\nOverall bit rate : 19.1 Mbps\r\nWriting application : mkvmerge v4.6.0 ('Still Crazy After All These Years') сборка от Mar 10 2011 02:50:32\r\nWriting library : libebml v1.2.0 + libmatroska v1.1.0\r\n",
               "MenuCount" : "1",
               "OverallBitRate" : "19104981",
               "StreamCount" : "1",
               "StreamKind" : "General",
               "StreamKindID" : "0",
               "StreamSize" : "263495865",
               "TextCount" : "3",
               "Text_Codec_List" : "UTF-8 / UTF-8 / UTF-8",
               "Text_Format_List" : "UTF-8 / UTF-8 / UTF-8",
               "Text_Format_WithHint_List" : "UTF-8 / UTF-8 / UTF-8",
               "Text_Language_List" : "Russian / Ukrainian / English",
               "VideoCount" : "1",
               "Video_Codec_List" : "AVC",
               "Video_Format_List" : "AVC",
               "Video_Format_WithHint_List" : "AVC",
               "Video_Language_List" : "English"
            },
            "video" : {
               "BitDepth" : "8",
               "BitRate" : "9000000",
               "Bits-(Pixel*Frame)" : "0.181",
               "ChromaSubsampling" : "4:2:0",
               "Codec" : "V_MPEG4/ISO/AVC",
               "Codec/Family" : "AVC",
               "Codec/Info" : "Advanced Video Codec",
               "CodecID" : "V_MPEG4/ISO/AVC",
               "Codec_Profile" : "High@L4.1",
               "Codec_Settings" : "CABAC / 4 Ref Frames",
               "Codec_Settings_CABAC" : "Yes",
               "Codec_Settings_RefFrames" : "4",
               "ColorSpace" : "YUV",
               "Colorimetry" : "4:2:0",
               "Count" : "263",
               "Default" : "Yes",
               "Delay" : "0",
               "Delay_Source" : "Container",
               "DisplayAspectRatio" : "1.778",
               "Duration" : "5544378",
               "Encoded_Library" : "x264 - core 114 r1913 5fd3dce",
               "Encoded_Library/Name" : "x264",
               "Encoded_Library/Version" : "core 114 r1913 5fd3dce",
               "Forced" : "No",
               "Format" : "AVC",
               "Format/Info" : "Advanced Video Codec",
               "Format_Commercial" : "AVC",
               "Format_Profile" : "High@L4.1",
               "Format_Settings" : "CABAC / 4 Ref Frames",
               "Format_Settings_CABAC" : "Yes",
               "Format_Settings_RefFrames" : "4",
               "FrameCount" : "132932",
               "FrameRate" : "23.976",
               "FrameRate_Mode" : "CFR",
               "Height" : "1080",
               "ID" : "1",
               "Inform" : "ID : 1\r\nFormat : AVC\r\nFormat/Info : Advanced Video Codec\r\nFormat profile : High@L4.1\r\nFormat settings, CABAC : Yes\r\nFormat settings, ReFrames : 4 frames\r\nCodec ID : V_MPEG4/ISO/AVC\r\nDuration : 1h 32mn\r\nBit rate : 9 000 Kbps\r\nWidth : 1 920 pixels\r\nHeight : 1 080 pixels\r\nDisplay aspect ratio : 16:9\r\nFrame rate mode : Constant\r\nFrame rate : 23.976 fps\r\nColor space : YUV\r\nChroma subsampling : 4:2:0\r\nBit depth : 8 bits\r\nScan type : Progressive\r\nBits/(Pixel*Frame) : 0.181\r\nStream size : 5.56 GiB (45%)\r\nWriting library : x264 core 114 r1913 5fd3dce\r\nLanguage : English\r\nDefault : Yes\r\nForced : No\r\n",
               "Interlacement" : "PPF",
               "InternetMediaType" : "video/H264",
               "Language" : "en",
               "PixelAspectRatio" : "1.000",
               "Resolution" : "8",
               "ScanType" : "Progressive",
               "StreamCount" : "1",
               "StreamKind" : "Video",
               "StreamKindID" : "0",
               "StreamOrder" : "0",
               "StreamSize" : "5973922745",
               "Width" : "1920"
            }
         },
         "size" : "13240668650",
         "tth" : "LIWFBIU5HNQN6XDGDM7OLGXQRVE45P6IN6Q2SDY"
      }
   ]
}

------------------------------------------------------------------------
r12899 | scalolaz_scat@mail.ru | 2013-02-14 22:57:23 +0400 (Чт, 14 фев 2013) | 4 lines

# fix

Прерывистая линия, при нажатии на ALT становится нормальной.
https://dl.dropbox.com/u/76033475/Image%20000%20FLylink%20Line.png
------------------------------------------------------------------------
r12898 | tret2003 | 2013-02-14 21:20:11 +0400 (Чт, 14 фев 2013) | 1 line

# [lang] an auto commit from localization system...
------------------------------------------------------------------------
r12897 | pavel.pimenov | 2013-02-14 17:04:21 +0400 (Чт, 14 фев 2013) | 4 lines

# [fly-server] 
 - Если сервер вернул ответ с медиа-инфой, то затеняем запись в списке на 0.02 (раньше стоял к=0.1f - в блоге жаловались на контраст)
 - В окне поиска реализована колонка "Длительность" по аналогии с окном просмотра файл-листов
 - Обобщил вырезатель длительности из атрибута fly_audio в сервисной функции CFlyMediaInfo::translateDuration
------------------------------------------------------------------------
r12893 | pavel.pimenov | 2013-02-13 20:31:03 +0400 (Ср, 13 фев 2013) | 2 lines

# Перименовал .cmd в .bat
  Свежий фар ветки 2.x почему-то при запуске cmd открывает его в блокноте
------------------------------------------------------------------------
r12891 | pavel.pimenov | 2013-02-13 20:11:50 +0400 (Ср, 13 фев 2013) | 2 lines

# Забыли инициализировать переменную размера шары - иногда возвращали мусор
  <wasd123> с шарой отрицательного размера $MyINFO $ALL deny71 <FlylinkDC++ V:r502-beta63-x64,M:P,H:2/0/0,S:15>$ $50!$$-8102383044816893560$
------------------------------------------------------------------------
r12887 | pavel.pimenov | 2013-02-12 22:52:28 +0400 (Вт, 12 фев 2013) | 1 line

# [public-build] astyle
------------------------------------------------------------------------
r12886 | pavel.pimenov | 2013-02-12 22:34:13 +0400 (Вт, 12 фев 2013) | 1 line

# Убрал статические массивы из h файла. т.к. при каждом включении в cpp порождается отдельная копия для каждого модуля.
------------------------------------------------------------------------
r12885 | pavel.pimenov | 2013-02-12 21:11:26 +0400 (Вт, 12 фев 2013) | 1 line

# Отключил мертвый цикл for (int i = 0; i < ToolbarButtons[0].image; i++) (for merge)
------------------------------------------------------------------------
r12884 | pavel.pimenov | 2013-02-12 19:50:08 +0400 (Вт, 12 фев 2013) | 1 line

# [public-build] astyle
------------------------------------------------------------------------
r12883 | pavel.pimenov | 2013-02-12 17:16:04 +0400 (Вт, 12 фев 2013) | 3 lines

# [fly-server] 
 - Передаем на сервер JSON запросы сжатыми (экономия 3-10x)

------------------------------------------------------------------------
r12882 | pavel.pimenov | 2013-02-12 00:37:00 +0400 (Вт, 12 фев 2013) | 3 lines

# Исправлено падение https://crash-server.com/DumpGroup.aspx?ClientID=ppa&DumpGroupID=29760
  - Попытка сделать ctrlToolbar.AddStrings до ctrlToolbar.AddButtons
  - Текст подсказок у нас достается динамически в обработчике. тут его грузить не нужно (завтра for merge)
------------------------------------------------------------------------
r12881 | pavel.pimenov | 2013-02-12 00:34:21 +0400 (Вт, 12 фев 2013) | 2 lines

# Откатил http://code.google.com/p/flylinkdc/source/detail?r=12866#
  
------------------------------------------------------------------------
r12880 | pavel.pimenov | 2013-02-12 00:33:17 +0400 (Вт, 12 фев 2013) | 1 line

# Поправил кодинг-стиль
------------------------------------------------------------------------
r12869 | pavel.pimenov | 2013-02-11 10:05:46 +0400 (Пн, 11 фев 2013) | 2 lines

# Убрал левый макрос #define checkconnected() if(!isConnected()))
# dcassert(high != 0);  
------------------------------------------------------------------------
r12868 | tret2003 | 2013-02-10 19:04:03 +0400 (Вс, 10 фев 2013) | 10 lines

* Updating the database ISPs
   http://www.assembla.com/spaces/customlocations-greylink
   Build on the base 1210, created 2013-02-10 21:42:37 +0700
   Total in database:
    - ISP - 1385
    - ISPs logo - 1397
    - Address range - 5778
   Archive CustomLocations.rar created by NightOrion


------------------------------------------------------------------------
r12866 | vladimir91.bondar@gmail.com | 2013-02-10 12:34:48 +0400 (Вс, 10 фев 2013) | 1 line

fix для запуска в дебаг ражиме на чистой системе
------------------------------------------------------------------------
r12852 | tret2003 | 2013-02-09 18:00:30 +0400 (Сб, 09 фев 2013) | 1 line

# Дополнение к r12804, добавлены файлы в проект VS2012
------------------------------------------------------------------------
r12849 | pavel.pimenov | 2013-02-09 14:41:54 +0400 (Сб, 09 фев 2013) | 2 lines

# miniupnp 1.8

------------------------------------------------------------------------
r12845 | pavel.pimenov | 2013-02-09 13:56:12 +0400 (Сб, 09 фев 2013) | 1 line

* r502-beta64
------------------------------------------------------------------------
r12844 | pavel.pimenov | 2013-02-09 13:52:14 +0400 (Сб, 09 фев 2013) | 1 line

# TODO - Обобщить декомпрессию zlib в BootstrapManager::on
------------------------------------------------------------------------
r12843 | pavel.pimenov | 2013-02-09 13:51:22 +0400 (Сб, 09 фев 2013) | 1 line

# [merge] Собрал makeDefs - не везде был BOOST_ALL_NO_LIB
------------------------------------------------------------------------
r12840 | tret2003 | 2013-02-09 12:32:04 +0400 (Сб, 09 фев 2013) | 1 line

# Дополнение к r12831
------------------------------------------------------------------------
r12831 | anna.bienne | 2013-02-07 21:16:12 +0400 (Чт, 07 фев 2013) | 8 lines

# Продолжение задачи:
1. делаешь копию этой пары файлов и называешь по другому например FlySQLExplorer.* 
2 . добавялешь в меню рядом с тем пунктом кнопочку вызова этого новго фрейма.
3. добивашься что-бы оно заработало так-же как и просмотр файл-листа.
4. удаляешь все внутринности из того-что скопипастила
оставляя только код создания дерева и грида-пустышки
........

------------------------------------------------------------------------
r12830 | pavel.pimenov | 2013-02-07 20:48:24 +0400 (Чт, 07 фев 2013) | 1 line

# MakeDefs - убрал мертвый файл
------------------------------------------------------------------------
r12827 | pavel.pimenov | 2013-02-07 20:02:18 +0400 (Чт, 07 фев 2013) | 1 line

# [public-build] Astyle
------------------------------------------------------------------------
r12826 | pavel.pimenov | 2013-02-07 19:39:42 +0400 (Чт, 07 фев 2013) | 3 lines

# [fly-server] 
 - Получаем с сервера сжатый json пакет. эконоимия трафика 8-10x
 - TODO - передачу запроса тоже перевести на сжатый вариант (сервер пока не поддерживает)
------------------------------------------------------------------------
r12825 | pavel.pimenov | 2013-02-07 19:11:55 +0400 (Чт, 07 фев 2013) | 1 line

# Подправил стиль кодирования.
------------------------------------------------------------------------
r12822 | tret2003 | 2013-02-07 09:30:01 +0400 (Чт, 07 фев 2013) | 1 line

# Обновил версии внешних проектов
------------------------------------------------------------------------
r12820 | pavel.pimenov | 2013-02-06 21:07:42 +0400 (Ср, 06 фев 2013) | 2 lines

#[fly-server] 
 - Если InternetQueryDataAvailable возвращает dwBytesAvailable - 0 не зовем лишний раз InternetReadFile
------------------------------------------------------------------------
r12819 | anna.bienne | 2013-02-06 20:24:23 +0400 (Ср, 06 фев 2013) | 8 lines

# Продолжение задачи:
1. делаешь копию этой пары файлов и называешь по другому например FlySQLExplorer.* 
2 . добавялешь в меню рядом с тем пунктом кнопочку вызова этого новго фрейма.
3. добивашься что-бы оно заработало так-же как и просмотр файл-листа.
4. удаляешь все внутринности из того-что скопипастила
оставляя только код создания дерева и грида-пустышки
........

------------------------------------------------------------------------
r12815 | pavel.pimenov | 2013-02-05 22:05:42 +0400 (Вт, 05 фев 2013) | 1 line

# Добавлено логирование размеров сжатого/раскрытого размера ответа от DHT-сервера (TODO - может на стороне DHT-сервера нет небходимости сжать с 9-тым уровнем компрессии)
------------------------------------------------------------------------
r12814 | pavel.pimenov | 2013-02-05 20:22:01 +0400 (Вт, 05 фев 2013) | 1 line

# Фикс для сборки флая с новым boost 1.53
------------------------------------------------------------------------
r12813 | pavel.pimenov | 2013-02-05 20:21:19 +0400 (Вт, 05 фев 2013) | 1 line

# test-console.pdb в игнор
------------------------------------------------------------------------
r12811 | anna.bienne | 2013-02-05 19:08:30 +0400 (Вт, 05 фев 2013) | 5 lines

# Поправила замечания:
1. Вот эти дефайны конфликтуют
 #define STATUS_MESSAGE_MAP 20
 #define CONTROL_MESSAGE_MAP 21
2. неймспейс назван абстрактно. 
------------------------------------------------------------------------
r12810 | pavel.pimenov | 2013-02-04 22:31:40 +0400 (Пн, 04 фев 2013) | 4 lines

#[fly-server] Научил клиента обращаться для запросов по чтению на другие сервера-зеркала 
  - Коллекция адресов выкачивается из конфига и выбирается рандомно.
  - TODO - поддержать алгоритм выведения записей из списка если возникает много ошибок обращений (сервер - лежит)

------------------------------------------------------------------------
r12809 | pavel.pimenov | 2013-02-04 22:04:24 +0400 (Пн, 04 фев 2013) | 1 line

# GetItemCount вынес из циклов. (т.к. внутири зовется WinAPI функция)
------------------------------------------------------------------------
r12807 | a.rainman@gmail.com | 2013-02-04 18:34:05 +0400 (Пн, 04 фев 2013) | 1 line

# getCFlyRatioKey и getCFlyDeferredRatioKey - статические функции.
------------------------------------------------------------------------
r12806 | a.rainman@gmail.com | 2013-02-04 18:11:07 +0400 (Пн, 04 фев 2013) | 26 lines

# UserConnection::getUser()->getFirstNick() Бывает пусто если юзер с DHT, нормально это или нет - пока не знаю.
[17:19:00] Третьяков Вячеслав: UserConnection.cpp
line 303
!l_nick.empty()
[17:19:11] Третьяков Вячеслав: тут асерт работает
[18:02:04] Alexey Solomin (Hedgehog in the Fog) Solomin : а в стеке что при этом?
[18:02:50] Третьяков Вячеслав: как повторится, обязательно скажу )
[18:02:58] Alexey Solomin (Hedgehog in the Fog) Solomin : юзер из DHT (т.е. из онлайна) или это просто созданный недавно юзер (только с CID-ом) из базы (для очереди)
[18:03:13] Третьяков Вячеслав: хабы закрыты
[18:03:20] Третьяков Вячеслав: юзер по DHT ломился
[18:04:32] Alexey Solomin (Hedgehog in the Fog) Solomin : юзер по DHT ломится (именно этот объект), или он свеже созданный (если так - то ника там может и не быть,  и это нормально) :)
[18:06:21] Третьяков Вячеслав: если это нормально, зачем асерт ?
[18:06:44] Alexey Solomin (Hedgehog in the Fog) Solomin : потому что может быть и не нормально :)
[18:07:10] Третьяков Вячеслав: и почему там может быть не быть ника ?
[18:07:16] Третьяков Вячеслав: надо его получить
[18:07:17] Третьяков Вячеслав: не ?
[18:08:42] Alexey Solomin (Hedgehog in the Fog) Solomin : не, в DHT используется ADC, там главное CID, а ник так,  для красоты (в строке передач, очереди отдач, и т.д.) т.е. ник получается,  но видимо позже,  в общем не знаю :)
[18:09:17] Третьяков Вячеслав: > FlylinkDC_Debug_x64.exe!UserConnection::on(BufferedSocketListener::X<4> __formal, unsigned __int64 p_Bytes, unsigned __int64 p_Actual)  Строка 303 + 0x50 байт C++
  FlylinkDC_Debug_x64.exe!Speaker<BufferedSocketListener>::fire<BufferedSocketListener::X<4>,unsigned __int64 & __ptr64,unsigned __int64 & __ptr64>(BufferedSocketListener::X<4> && type, unsigned __int64 & p1, unsigned __int64 & p2)  Строка 118 + 0x8b байт C++
  FlylinkDC_Debug_x64.exe!BufferedSocket::threadSendFile(InputStream * file)  Строка 406 C++
  FlylinkDC_Debug_x64.exe!BufferedSocket::checkEvents()  Строка 606 + 0x16 байт C++
  FlylinkDC_Debug_x64.exe!BufferedSocket::run()  Строка 670 + 0x13 байт C++
  FlylinkDC_Debug_x64.exe!Thread::starter(void * p)  Строка 335 C++
  FlylinkDC_Debug_x64.exe!_callthreadstartex()  Строка 314 + 0x17 байт C
  FlylinkDC_Debug_x64.exe!_threadstartex(void * ptd)  Строка 297 C
[18:09:58] Alexey Solomin (Hedgehog in the Fog) Solomin : ага.. очень м.б. что ника там ещё нет
------------------------------------------------------------------------
r12805 | pavel.pimenov | 2013-02-03 23:47:20 +0400 (Вс, 03 фев 2013) | 1 line

#[public-build][fly-server] Не шлем запросы для дочерних элементов результатов поиска.
------------------------------------------------------------------------
r12804 | anna.bienne | 2013-02-03 16:01:45 +0400 (Вс, 03 фев 2013) | 8 lines

# Начало задачи:
1. делаешь копию этой пары файлов и называешь по другому например FlySQLExplorer.* 
2 . добавялешь в меню рядом с тем пунктом кнопочку вызова этого новго фрейма.
3. добивашься что-бы оно заработало так-же как и просмотр файл-листа.
4. удаляешь все внутринности из того-что скопипастила
оставляя только код создания дерева и грида-пустышки
........

------------------------------------------------------------------------
r12801 | tret2003 | 2013-02-03 12:02:55 +0400 (Вс, 03 фев 2013) | 2 lines

# Поправлен интерфейс в настройках
# На всякий случай отрезаем последние два символа перевода строки у тултипа
------------------------------------------------------------------------
r12799 | tret2003 | 2013-02-02 21:43:17 +0400 (Сб, 02 фев 2013) | 1 line

# Исправлено - во всплывающей подсказке (когда наводишь курсор на юзера в списке)отсутствует пробел между ником и шарой. 
------------------------------------------------------------------------
r12797 | a.rainman@gmail.com | 2013-02-02 17:23:22 +0400 (Сб, 02 фев 2013) | 3 lines

# Добавил забытые изменения в список изменений.
# При включении RECURSIVE_READ_WRITE_CRITICAL_SECTION_ENABLED не собиралось.
# В ежовых бета версиях отключено принудительное сохранение системного лога (т.е. как и в релизах поведение программы полностью контролируется настройками).
------------------------------------------------------------------------
r12796 | pavel.pimenov | 2013-02-02 14:35:58 +0400 (Сб, 02 фев 2013) | 1 line

* (issue 907) В бетках всегда активный системный лог (для упрощения анализа проблем)
------------------------------------------------------------------------
r12795 | pavel.pimenov | 2013-02-02 14:20:47 +0400 (Сб, 02 фев 2013) | 1 line

# При чеках на расшаривании курсор превращаем в часы (при толстых папках заполянется долго)
------------------------------------------------------------------------
r12794 | pavel.pimenov | 2013-02-02 14:04:26 +0400 (Сб, 02 фев 2013) | 2 lines

# dcassert(blockSize);
# Метка падения на setPort https://crash-server.com/Problem.aspx?ClientID=ppa&ProblemID=12555 (TODO - не понял как. ждем полный дамп)
------------------------------------------------------------------------
r12792 | anna.bienne | 2013-02-02 12:40:38 +0400 (Сб, 02 фев 2013) | 1 line

# Откатила предыдущий комит назад
------------------------------------------------------------------------
r12791 | pavel.pimenov | 2013-02-02 12:39:26 +0400 (Сб, 02 фев 2013) | 1 line

# Опечатка
------------------------------------------------------------------------
r12790 | pavel.pimenov | 2013-02-02 12:38:29 +0400 (Сб, 02 фев 2013) | 4 lines

# https://crash-server.com/DumpGroup.aspx?ClientID=ppa&DumpGroupID=31115
  Убрал деление на 0 в QueueItem::getPartialInfo + assert в отладке dcassert(p_blockSize)
  причину пока не нашел - дампа полного нет.

------------------------------------------------------------------------
r12789 | anna.bienne | 2013-02-02 12:20:34 +0400 (Сб, 02 фев 2013) | 6 lines

# Начало задачи:
1. делаешь копию этой пары файлов и называешь по другому например FlySQLExplorer.* 
2 . добавялешь в меню рядом с тем пунктом кнопочку вызова этого новго фрейма.
3. добивашься что-бы оно заработало так-же как и просмотр файл-листа.
4. удаляешь все внутринности из того-что скопипастила
оставляя только код создания дерева и грида-пустышки
------------------------------------------------------------------------
r12788 | pavel.pimenov | 2013-02-02 11:34:40 +0400 (Сб, 02 фев 2013) | 1 line

# r502-beta63 - log
------------------------------------------------------------------------
r12787 | tret2003 | 2013-02-02 11:17:42 +0400 (Сб, 02 фев 2013) | 1 line

# Сделал автоматическое переключение отправки на краш-сервер по ключу BETA
------------------------------------------------------------------------
r12783 | pavel.pimenov | 2013-02-02 10:54:23 +0400 (Сб, 02 фев 2013) | 2 lines

# Для r502-бетки завел отдельный канал краш-сервера 910F4B4D-C71C-45BC-A88D-F59FE022525B (часть 2)
# Поправлен возможные конфликты с тортилками http://code.google.com/p/flylinkdc/issues/detail?id=890
------------------------------------------------------------------------
r12781 | pavel.pimenov | 2013-02-02 10:34:38 +0400 (Сб, 02 фев 2013) | 1 line

# r502-beta63
------------------------------------------------------------------------
r12780 | pavel.pimenov | 2013-02-02 10:13:19 +0400 (Сб, 02 фев 2013) | 1 line

#
------------------------------------------------------------------------
r12779 | pavel.pimenov | 2013-02-02 10:07:03 +0400 (Сб, 02 фев 2013) | 1 line

# Ребилд медиаинфы спрятал за экран BETA
------------------------------------------------------------------------
r12778 | pavel.pimenov | 2013-02-02 10:03:31 +0400 (Сб, 02 фев 2013) | 1 line

# Для r502-бетки завел отдельный канал краш-сервера 910F4B4D-C71C-45BC-A88D-F59FE022525B
------------------------------------------------------------------------
r12776 | pavel.pimenov | 2013-02-02 00:59:45 +0400 (Сб, 02 фев 2013) | 1 line

# Вернул сохранение сортировки в окне поиска.
------------------------------------------------------------------------
r12774 | pavel.pimenov | 2013-02-02 00:48:41 +0400 (Сб, 02 фев 2013) | 29 lines

# Добавлен макрос для подсчета кол-ва выполнений.
  - работает тольк в дебаг конфигурации
  - в коцне выводит отчет в файл flylinkdc-profiler-report.txt
  - TODO позапускать у тестеров с большими шарами и разнообразным медиа-контентом

Для контроля достаточно в нужной точке кода проставить макрос  - FLYLINKDC_PROFILER
пока проверил на mediainfo - расставил везде где используется std::map<>::operator[] несколько раз
на моей тестовой музыке и киношках (80 гиг) получилась вот такая статистика
Нижние записи кандидаты для оптимизации CPU

count = 12 file = 		[ d:\vc10\r5xx\mediainfolib\source\mediainfo\multiple\file_mk.cpp  MediaInfoLib::File_Mk::Segment_Tracks_TrackEntry_CodecPrivate]
		[ d:\vc10\r5xx\mediainfolib\source\mediainfo\multiple\file_riff.cpp  MediaInfoLib::File_Riff::Streams_Finish]
count = 17 file = 		[ d:\vc10\r5xx\mediainfolib\source\mediainfo\multiple\file_wm_elements.cpp  MediaInfoLib::File_Wm::Header_HeaderExtension_ExtendedStreamProperties]
count = 26 file = 		[ d:\vc10\r5xx\mediainfolib\source\mediainfo\multiple\file_riff_elements.cpp  MediaInfoLib::File_Riff::AVI__hdlr_strl_strh]
count = 38 file = 		[ d:\vc10\r5xx\mediainfolib\source\mediainfo\multiple\file_mk.cpp  MediaInfoLib::File_Mk::CodecID_Manage]
		[ d:\vc10\r5xx\mediainfolib\source\mediainfo\multiple\file_mk.cpp  MediaInfoLib::File_Mk::Segment_Tracks_TrackEntry_TrackNumber]
		[ d:\vc10\r5xx\mediainfolib\source\mediainfo\multiple\file_mk.cpp  MediaInfoLib::File_Mk::Segment_Tracks_TrackEntry_TrackType]
count = 109 file = 		[ d:\vc10\r5xx\mediainfolib\source\mediainfo\multiple\file_riff_elements.cpp  MediaInfoLib::File_Riff::AVI__hdlr_strl_strf]
count = 259 file = 		[ d:\vc10\r5xx\mediainfolib\source\mediainfo\multiple\file_wm_elements.cpp  MediaInfoLib::File_Wm::Header_StreamBitRate]
count = 325 file = 		[ d:\vc10\r5xx\mediainfolib\source\mediainfo\multiple\file_wm_elements.cpp  MediaInfoLib::File_Wm::Header_StreamProperties]
count = 650 file = 		[ d:\vc10\r5xx\mediainfolib\source\mediainfo\multiple\file_wm_elements.cpp  MediaInfoLib::File_Wm::Data_Packet]
count = 1800 file = 		[ d:\vc10\r5xx\mediainfolib\source\mediainfo\multiple\file_riff_elements.cpp  MediaInfoLib::File_Riff::AVI__movi_xxxx___wb]
count = 3300 file = 		[ d:\vc10\r5xx\mediainfolib\source\mediainfo\multiple\file_riff_elements.cpp  MediaInfoLib::File_Riff::AVI__movi_xxxx___dc]
count = 5100 file = 		[ d:\vc10\r5xx\mediainfolib\source\mediainfo\multiple\file_riff_elements.cpp  MediaInfoLib::File_Riff::AVI__movi_xxxx]
count = 13008 file = 		[ d:\vc10\r5xx\client\util.cpp  Util::formatTime]
count = 16332 file = 		[ d:\vc10\r5xx\mediainfolib\source\mediainfo\multiple\file_mk.cpp  MediaInfoLib::File_Mk::Segment_Cluster_BlockGroup_Block]
count = 197622 file = 		[ d:\vc10\r5xx\mediainfolib\source\mediainfo\multiple\file_ogg.cpp  MediaInfoLib::File_Ogg::Data_Parse]


------------------------------------------------------------------------
r12773 | pavel.pimenov | 2013-02-02 00:21:58 +0400 (Сб, 02 фев 2013) | 3 lines

# В ConnectionManager::store_last_ip иногда getHubID оказывается = 0. дополнительно подгружаем его из базы get_dic_hub_id. (TODO - разобраться почему так получается) 
# User::LoadRatio в случае adc зовется при getHubID не равным нулю (TODO ) 
# В TransferView::on(DownloadManagerListener::Status подавил assert - срабатывает по окончании закачки. (может я что-то сломал)
------------------------------------------------------------------------
r12772 | pavel.pimenov | 2013-02-01 22:18:44 +0400 (Пт, 01 фев 2013) | 7 lines

# Убрал сохранение сортировки в окнах поиска. всегда ставится сорт по Hits
# getBlockSize расчитывает размер блока даже если TTH нет в базе
# assert в store_last_ip
# В CFlylinkDBManager::get_path_id могла ошибочно возвращать 0 из кэш-переменной m_last_path_id
# В QueueItem забыли проинитить m_downloadedBytes 
# QueueItem::calcBlockSize() сделал приватной

------------------------------------------------------------------------
r12771 | a.rainman@gmail.com | 2013-02-01 20:08:46 +0400 (Пт, 01 фев 2013) | 1 line

# +r12754.
------------------------------------------------------------------------
r12770 | a.rainman@gmail.com | 2013-02-01 19:55:49 +0400 (Пт, 01 фев 2013) | 4 lines

# +r12761: почистил реализацию.
# Убрал копипаст расчёта размера блока для частичных источников.
# Исправлена ошибка в QueueManager::FileQueue::add.
# Требуется тестирование.
------------------------------------------------------------------------
r12769 | pavel.pimenov | 2013-02-01 18:25:51 +0400 (Пт, 01 фев 2013) | 2 lines

# Забыли функциям указать пустой тип возврата
# Поправил охранники включения
------------------------------------------------------------------------
r12767 | tret2003 | 2013-02-01 17:53:41 +0400 (Пт, 01 фев 2013) | 2 lines

# [merge] soften a TLS error message
http://bazaar.launchpad.net/~dcplusplus-team/dcplusplus/trunk/revision/3199
------------------------------------------------------------------------
r12762 | scalolaz_scat@mail.ru | 2013-02-01 16:41:52 +0400 (Пт, 01 фев 2013) | 2 lines

# фикс по хинтам местного гуголя.
(Поиск по "Количеству скачиваний" на убывание)
------------------------------------------------------------------------
r12761 | pavel.pimenov | 2013-02-01 14:41:32 +0400 (Пт, 01 фев 2013) | 24 lines

# Исправлен баг с закачками с несколькимх источников (спасибо Pafuntik)
[13:52:15] pavel.pimenov:  Pafuntik пишет...

    Скачал я сборки их этого архива.
    http://flylinkdc.no-ip.org/last-build/bin-src/flylinkdc-r5xx/
    Начал искать проблему в 64-битных версиях, т.к сам такой пользуюсь. Долго искать проблемную сборку не пришлось.

    Начинается проблема тут:
    FlylinkDC-r502-debug-info-beta62-build-12329-2012.12.26-19.03.56.7z

    Потом всё стабилизируется тут:
    FlylinkDC-r501-x64-build-12353-2012.12.27-22.53.03

    Потом снова ломается:
    FlylinkDC-r501-x64-build-12373-2012.12.28-22.22.36

    Ну вот думаю и всё, проблема сохраняется до сих пор. В ночных сборках я проверить нечего не смог, т.к если честно не знаю что делать с файлами формата PDB.
[13:52:28] pavel.pimenov:  Pafuntik пишет...

    Протестировал несколько ночных сборок. Билды с 12191 по 12260 работают нормально в плане скачивания в несколько сегментов, в билде 12266 уже присутствует проблема с скачиванием. Как обстоят дела с другими билдами напишу чуть попозже. Хотя я так думаю другие сборки можно не проверять, ведь та самая первая проблемная сборка найдена.
[13:53:34] pavel.pimenov: Вот сравнение кода
[13:53:36] pavel.pimenov: https://www.box.net/shared/g835y3xmluqz1ao0qf2c
[13:54:28] pavel.pimenov: средняя версия хорошая. слева транк а справа стабильный sp12.2
[13:54:33] pavel.pimenov: туда попал баг
------------------------------------------------------------------------
r12754 | tret2003 | 2013-01-31 19:34:51 +0400 (Чт, 31 янв 2013) | 1 line

* Возвращен пропавший & в именах папок и файлов в окне хеширования и в контекстном меню "Скачать в..."
------------------------------------------------------------------------
r12753 | a.rainman@gmail.com | 2013-01-30 19:43:34 +0400 (Ср, 30 янв 2013) | 1 line

# Ежовая: По умолчанию включён DHT и отключено предупреждение при его включении.
------------------------------------------------------------------------
r12752 | pavel.pimenov | 2013-01-30 13:32:40 +0400 (Ср, 30 янв 2013) | 1 line

# [fly-server] Рефакторинг - часть 2
------------------------------------------------------------------------
r12751 | pavel.pimenov | 2013-01-30 12:21:34 +0400 (Ср, 30 янв 2013) | 1 line

# [fly-server] Обобщена перерисовка колонок в TypedListViewCtrl 
------------------------------------------------------------------------
r12749 | pavel.pimenov | 2013-01-30 06:28:34 +0400 (Ср, 30 янв 2013) | 1 line

# Опечатка
------------------------------------------------------------------------
r12748 | pavel.pimenov | 2013-01-30 06:25:58 +0400 (Ср, 30 янв 2013) | 2 lines

# Маячек к ClientManager::findLegacyUser
  Линейный поиск. но оно не так часто зовется... пусть повисит.
------------------------------------------------------------------------
r12747 | a.rainman@gmail.com | 2013-01-30 01:28:34 +0400 (Ср, 30 янв 2013) | 1 line

# +r12736, r12725, r12719.
------------------------------------------------------------------------
r12746 | a.rainman@gmail.com | 2013-01-30 00:32:40 +0400 (Ср, 30 янв 2013) | 1 line

# oops, comments fix.
------------------------------------------------------------------------
r12745 | a.rainman@gmail.com | 2013-01-30 00:31:04 +0400 (Ср, 30 янв 2013) | 1 line

# ClientManager::getNick fix, thx PPA.
------------------------------------------------------------------------
r12744 | a.rainman@gmail.com | 2013-01-30 00:30:43 +0400 (Ср, 30 янв 2013) | 1 line

# Disable key IRAINMAN_ASYNC_LOAD_CUSTOMLOCATION, MSVC C++11 != C++11.
------------------------------------------------------------------------
r12743 | pavel.pimenov | 2013-01-29 22:57:21 +0400 (Вт, 29 янв 2013) | 1 line

# Фикс падения https://www.crash-server.com/Problem.aspx?ClientID=ppa&ProblemID=12162
------------------------------------------------------------------------
r12742 | pavel.pimenov | 2013-01-29 21:38:14 +0400 (Вт, 29 янв 2013) | 2 lines

#[public-build]

------------------------------------------------------------------------
r12741 | pavel.pimenov | 2013-01-29 21:37:46 +0400 (Вт, 29 янв 2013) | 1 line

# Вернул урл CFlyServerConfig::loadConfig
------------------------------------------------------------------------
r12740 | pavel.pimenov | 2013-01-29 21:34:31 +0400 (Вт, 29 янв 2013) | 3 lines

*[fly-server] [public-build]
  - Тестируем

------------------------------------------------------------------------
r12739 | pavel.pimenov | 2013-01-29 20:23:06 +0400 (Вт, 29 янв 2013) | 1 line

# Опечатка в CFlylinkDBManager::LoadMediaInfo (часть 2)
------------------------------------------------------------------------
r12738 | pavel.pimenov | 2013-01-29 20:16:23 +0400 (Вт, 29 янв 2013) | 1 line

# Опечатка в CFlylinkDBManager::LoadMediaInfo
------------------------------------------------------------------------
r12737 | pavel.pimenov | 2013-01-29 20:08:05 +0400 (Вт, 29 янв 2013) | 5 lines

*[fly-server] 
 - Реализация обмена с сервером из файл-листов. медиа-информация из шары передеается на сервера. взамен получаем выборку с сервера.
 Обрабатываем по аналогии с окном поиска только видиму часть файлов + период запросов = 2 секунды. TODO вынести настройку во внешний конфиг.
 - Если информация найдена в локальной базе - она заполняется из нее (запрос на сервер не идет - в результате чего пока не возвращается рейтинг) TODO - подумать как сделать лучше.
 - TODO - обощить методы merge_fly_server_info во фреймах списка файлов и посика. много общего.
------------------------------------------------------------------------
r12736 | pavel.pimenov | 2013-01-29 20:03:36 +0400 (Вт, 29 янв 2013) | 1 line

# Исправлена работа с параметром CONFIG_VERSION
------------------------------------------------------------------------
r12735 | pavel.pimenov | 2013-01-29 20:02:53 +0400 (Вт, 29 янв 2013) | 2 lines

# Убрал LogManager::isValidInstance()
# Реализацию логов унес в cpp модуль.
------------------------------------------------------------------------
r12734 | pavel.pimenov | 2013-01-29 20:01:43 +0400 (Вт, 29 янв 2013) | 1 line

# Рефактиринг. + TODO убить FLAG_SHARED_OWN
------------------------------------------------------------------------
r12732 | pavel.pimenov | 2013-01-29 19:43:13 +0400 (Вт, 29 янв 2013) | 1 line

# [joson] При форматировании уменьшил лишние пробелы. экономия размера паакета с 14к до 12к
------------------------------------------------------------------------
r12731 | pavel.pimenov | 2013-01-29 19:35:45 +0400 (Вт, 29 янв 2013) | 1 line

# Добавлен RebuildMediainfoProgressDlg - пока не пашет и просто висит. работу перевести в нитку.
------------------------------------------------------------------------
r12730 | pavel.pimenov | 2013-01-29 19:34:39 +0400 (Вт, 29 янв 2013) | 1 line

# Тест падения strftime
------------------------------------------------------------------------
r12729 | pavel.pimenov | 2013-01-29 07:01:43 +0400 (Вт, 29 янв 2013) | 2 lines

# Astyle
# Фильтруем лишние расширения rebuildMediainfo
------------------------------------------------------------------------
r12728 | tret2003 | 2013-01-28 22:37:00 +0400 (Пн, 28 янв 2013) | 1 line

# Добавил забытые файлы в проект VS2012
------------------------------------------------------------------------
r12727 | tret2003 | 2013-01-28 22:16:29 +0400 (Пн, 28 янв 2013) | 1 line

# error atlapp.h requires atlbase.h to be included first
------------------------------------------------------------------------
r12725 | tret2003 | 2013-01-28 20:47:27 +0400 (Пн, 28 янв 2013) | 1 line

# Перевёл циклы с итераторов на auto
------------------------------------------------------------------------
r12723 | pavel.pimenov | 2013-01-28 19:34:14 +0400 (Пн, 28 янв 2013) | 1 line

# Astyle
------------------------------------------------------------------------
r12722 | pavel.pimenov | 2013-01-28 19:29:50 +0400 (Пн, 28 янв 2013) | 1 line

# Добавил assert для ReleaseDC
------------------------------------------------------------------------
r12720 | pavel.pimenov | 2013-01-28 19:23:37 +0400 (Пн, 28 янв 2013) | 3 lines

# Поправил обработку mediainfo для аудио файлов. если нет разрешения по X (Звуковой файл), то разрешение по Y даже не пытаемся забирать.
# Исправил ошибку - если у файла нет Duration/String, то колонка Audio не заполнялась вообще.

------------------------------------------------------------------------
r12719 | pavel.pimenov | 2013-01-28 19:09:25 +0400 (Пн, 28 янв 2013) | 1 line

# Убрал бесполезный вывод размера страницы. TODO - добавить к статистике нормальные параметры.
------------------------------------------------------------------------
r12718 | JhaoDa@gmail.com | 2013-01-28 16:16:03 +0400 (Пн, 28 янв 2013) | 1 line

# Дополнение к r12717. (Голая женщина!!!)
------------------------------------------------------------------------
r12717 | JhaoDa@gmail.com | 2013-01-28 16:12:31 +0400 (Пн, 28 янв 2013) | 1 line

# Дополнение к r12716.
------------------------------------------------------------------------
r12716 | pavel.pimenov | 2013-01-28 15:48:02 +0400 (Пн, 28 янв 2013) | 1 line

# test.php актуализирована версия теста портов.
------------------------------------------------------------------------
r12715 | scalolaz_scat@mail.ru | 2013-01-28 15:41:50 +0400 (Пн, 28 янв 2013) | 1 line

# При установке регуляторов в 0, отключаем ограничение скорости.
------------------------------------------------------------------------
r12714 | pavel.pimenov | 2013-01-28 13:11:59 +0400 (Пн, 28 янв 2013) | 1 line

# [public-build] Исправлено падение CFlylinkDBManager::rebuild_mediainfo (опечатка)
------------------------------------------------------------------------
r12713 | tret2003 | 2013-01-28 07:54:04 +0400 (Пн, 28 янв 2013) | 2 lines

# [merge] socket accept returns the remote port
http://bazaar.launchpad.net/~dcplusplus-team/dcplusplus/trunk/revision/3185
------------------------------------------------------------------------
r12712 | pavel.pimenov | 2013-01-27 21:45:44 +0400 (Вс, 27 янв 2013) | 2 lines

# [public-build] Вернул Default, Убрал Forced

------------------------------------------------------------------------
r12711 | pavel.pimenov | 2013-01-27 21:43:08 +0400 (Вс, 27 янв 2013) | 1 line

# [public-build] Вернул Forced
------------------------------------------------------------------------
r12710 | pavel.pimenov | 2013-01-27 21:40:47 +0400 (Вс, 27 янв 2013) | 2 lines

# Странно создавался таймер в StatsFrame. на вход отдавалась 1-ка (Вероятно копипаст с HashProgressDlg)
# Убрал левый enum { WM_VERSIONDATA = WM_APP + 53 }
------------------------------------------------------------------------
r12709 | pavel.pimenov | 2013-01-27 20:11:39 +0400 (Вс, 27 янв 2013) | 1 line

# Astyle
------------------------------------------------------------------------
r12708 | pavel.pimenov | 2013-01-27 20:04:32 +0400 (Вс, 27 янв 2013) | 1 line

# Исправил падения ребилда медиаинфы (TODO - защитить обход directories критической секцией)
------------------------------------------------------------------------
r12707 | pavel.pimenov | 2013-01-27 19:20:03 +0400 (Вс, 27 янв 2013) | 1 line

#
------------------------------------------------------------------------
r12706 | pavel.pimenov | 2013-01-27 15:51:51 +0400 (Вс, 27 янв 2013) | 1 line

# About  _Napalmik_ - > BlackRiderUA
------------------------------------------------------------------------
r12705 | pavel.pimenov | 2013-01-27 15:27:29 +0400 (Вс, 27 янв 2013) | 1 line

# Astyle
------------------------------------------------------------------------
r12704 | pavel.pimenov | 2013-01-27 15:09:11 +0400 (Вс, 27 янв 2013) | 1 line

# Добавил маркеры времени после ребилда медиаинфой каждого каталога
------------------------------------------------------------------------
r12703 | pavel.pimenov | 2013-01-27 14:56:01 +0400 (Вс, 27 янв 2013) | 1 line

# В лог добавил вывод кол-во отрефрешенный файлов медиаинфы + исправлена баг (делал return вместо continue )
------------------------------------------------------------------------
r12702 | pavel.pimenov | 2013-01-27 14:46:08 +0400 (Вс, 27 янв 2013) | 3 lines

# Добавил обновление медиаинформации через меню (пока может идти долго и замораживать интерфейс) TODO - добавить диалог с прогрессом заодно будет видно где повесился флай.
# Сбор медиаинформации не вырезается экраном USE_MEDIAINFO_EXT_INFO.
# Убрал опцию отлючение поддержки mediainfo. Желающие работу либы могут выключить через указание лимита на размера файла.( по умолчанию стоит 1Mb)
------------------------------------------------------------------------
r12701 | scalolaz_scat@mail.ru | 2013-01-27 14:14:59 +0400 (Вс, 27 янв 2013) | 1 line

# Поправлено обращение к триггеру "Вкл/выкл Ограничения скорости"
------------------------------------------------------------------------
r12700 | a.rainman@gmail.com | 2013-01-27 11:25:32 +0400 (Вс, 27 янв 2013) | 5 lines

* Исправлена сортировка по умолчанию в окнах программы:
* В окне файл листа колонки ошибочно сортировались по имени в обратном порядке, теперь корректно сортируются в прямом.
* В окне передач сортировка была по пользователю, теперь передачи корректно сортируются по состоянию.
# В ежовой по умолчанию включена опция подключения к хабу поддержки.
# TODO: отключение колонок по умолчанию не сработало, надо разобраться.
------------------------------------------------------------------------
r12699 | a.rainman@gmail.com | 2013-01-27 11:24:55 +0400 (Вс, 27 янв 2013) | 1 line

# IRAINMAN_INCLUDE_SMILE - забыл галку автоапдейта смайлов.
------------------------------------------------------------------------
r12698 | a.rainman@gmail.com | 2013-01-27 11:15:49 +0400 (Вс, 27 янв 2013) | 1 line

# Откатил r12687. Фильтр "раззиповщика" %) сохраняется на всё время жизни сокета (т.е. не пересоздаётся при смене режима).
------------------------------------------------------------------------
r12697 | pavel.pimenov | 2013-01-27 10:03:14 +0400 (Вс, 27 янв 2013) | 2 lines

# Добавил пункт меню для обновления медиаинформации (часть 1) расчет и обновления базы пока не делал.
  https://www.box.net/shared/e9868t8le6gt7yqaktc3
------------------------------------------------------------------------
r12696 | pavel.pimenov | 2013-01-26 22:41:04 +0400 (Сб, 26 янв 2013) | 1 line

# Astyle
------------------------------------------------------------------------
r12695 | pavel.pimenov | 2013-01-26 22:19:16 +0400 (Сб, 26 янв 2013) | 1 line

# Добавлено логирование операции получение IP
------------------------------------------------------------------------
r12694 | pavel.pimenov | 2013-01-26 21:34:16 +0400 (Сб, 26 янв 2013) | 1 line

# Заменил левое название контрола с DAA на IDC_TEXT_FAKEPERCENT
------------------------------------------------------------------------
r12693 | pavel.pimenov | 2013-01-26 21:32:06 +0400 (Сб, 26 янв 2013) | 68 lines

# [fly-server] Добавил функцию копирования полной информации полученной с сервера
  https://www.box.net/shared/h1nusey6ftcg71ttcwi1
Полный ответ от сервера для 12-канального звука выглядит так:
{
   "array" : [
      {
         "info" : {
            "count_query" : "11",
            "first_date" : "1359231006"
         },
         "media" : {
            "fly_audio" : "1h 32mn | AC-3, 5.1, 640 Kbps, Russian | DTS, 5.1, 1 509 Kbps, Russian | DTS, 5.1, 1 509 Kbps, Russian | DTS, 5.1, 1 509 Kbps, Russian | DTS, 5.1, 1 509 Kbps, Russian | DTS, 5.1, 1 509 Kbps, English | AC-3, 5.1, 448 Kbps, Russian | AC-3, 5.1, 448 Kbps, Russian | AC-3, 5.1, 448 Kbps, Russian | AC-3, 2.0, 192 Kbps, Ukrainian | AC-3, 2.0, 192 Kbps, English | AC-3, 2.0, 192 Kbps, English",
            "fly_audio_br" : "1509",
            "fly_video" : "AVC, 9 000 Kbps, 23.976 fps",
            "fly_xy" : "1920x1080"
         },
         "media-ext" : {
            "audio" : {
               "channel-0" : {
                  "Inform" : "ID : 2\r\nFormat : AC-3\r\nFormat/Info : Audio Coding 3\r\nMode extension : CM (complete main)\r\nFormat settings, Endianness : Big\r\nCodec ID : A_AC3\r\nDuration : 1h 32mn\r\nBit rate mode : Constant\r\nBit rate : 640 Kbps\r\nChannel(s) : 6 channels\r\nChannel positions : Front: L C R, Side: L R, LFE\r\nSampling rate : 48.0 KHz\r\nBit depth : 16 bits\r\nCompression mode : Lossy\r\nStream size : 423 MiB (3%)\r\nTitle : AC3 5.1ch 640 kbps - Р”СѓР±Р»СЏР¶, Blu-ray\r\nLanguage : Russian\r\nDefault : Yes\r\nForced : No\r\n"
               },
               "channel-1" : {
                  "Inform" : "ID : 3\r\nFormat : DTS\r\nFormat/Info : Digital Theater Systems\r\nMode : 16\r\nFormat settings, Endianness : Big\r\nCodec ID : A_DTS\r\nDuration : 1h 32mn\r\nBit rate mode : Constant\r\nBit rate : 1 509 Kbps\r\nChannel(s) : 6 channels\r\nChannel positions : Front: L C R, Side: L R, LFE\r\nSampling rate : 48.0 KHz\r\nBit depth : 24 bits\r\nCompression mode : Lossy\r\nStream size : 997 MiB (8%)\r\nTitle : DTS 5.1ch 1510 kbps - РћРґРЅРѕРіРѕР»РѕСЃС‹Р№, Р”.РџСѓС‡РєРѕРІ (Р“РѕР±СЏ)\r\nLanguage : Russian\r\nDefault : No\r\nForced : No\r\n"
               },
               "channel-10" : {
                  "Inform" : "ID : 12\r\nFormat : AC-3\r\nFormat/Info : Audio Coding 3\r\nMode extension : CM (complete main)\r\nFormat settings, Endianness : Big\r\nCodec ID : A_AC3\r\nDuration : 1h 32mn\r\nBit rate mode : Constant\r\nBit rate : 192 Kbps\r\nChannel(s) : 2 channels\r\nChannel positions : Front: L R\r\nSampling rate : 48.0 KHz\r\nBit depth : 16 bits\r\nCompression mode : Lossy\r\nStream size : 127 MiB (1%)\r\nTitle : AC3 2.0ch 192 kbps - Commentary\r\nLanguage : English\r\nDefault : No\r\nForced : No\r\n"
               },
               "channel-11" : {
                  "Inform" : "ID : 13\r\nFormat : AC-3\r\nFormat/Info : Audio Coding 3\r\nMode extension : CM (complete main)\r\nFormat settings, Endianness : Big\r\nCodec ID : A_AC3\r\nDuration : 1h 32mn\r\nBit rate mode : Constant\r\nBit rate : 192 Kbps\r\nChannel(s) : 2 channels\r\nChannel positions : Front: L R\r\nSampling rate : 48.0 KHz\r\nBit depth : 16 bits\r\nCompression mode : Lossy\r\nStream size : 127 MiB (1%)\r\nTitle : AC3 2.0ch 192 kbps - Commentary\r\nLanguage : English\r\nDefault : No\r\nForced : No\r\n"
               },
               "channel-2" : {
                  "Inform" : "ID : 4\r\nFormat : DTS\r\nFormat/Info : Digital Theater Systems\r\nMode : 16\r\nFormat settings, Endianness : Big\r\nCodec ID : A_DTS\r\nDuration : 1h 32mn\r\nBit rate mode : Constant\r\nBit rate : 1 509 Kbps\r\nChannel(s) : 6 channels\r\nChannel positions : Front: L C R, Side: L R, LFE\r\nSampling rate : 48.0 KHz\r\nBit depth : 24 bits\r\nCompression mode : Lossy\r\nStream size : 997 MiB (8%)\r\nTitle : DTS 5.1ch 1510 kbps - Р”РІСѓС…РіРѕР»РѕСЃС‹Р№, Tycoon\r\nLanguage : Russian\r\nDefault : No\r\nForced : No\r\n"
               },
               "channel-3" : {
                  "Inform" : "ID : 5\r\nFormat : DTS\r\nFormat/Info : Digital Theater Systems\r\nMode : 16\r\nFormat settings, Endianness : Big\r\nCodec ID : A_DTS\r\nDuration : 1h 32mn\r\nBit rate mode : Constant\r\nBit rate : 1 509 Kbps\r\nChannel(s) : 6 channels\r\nChannel positions : Front: L C R, Side: L R, LFE\r\nSampling rate : 48.0 KHz\r\nBit depth : 24 bits\r\nCompression mode : Lossy\r\nStream size : 997 MiB (8%)\r\nTitle : DTS 5.1ch 1510 kbps - Р”РІСѓС…РіРѕР»РѕСЃС‹Р№, Рџ.Р“Р»Р°РЅС†, Р.РљРѕСЂРѕР»РµРІР°\r\nLanguage : Russian\r\nDefault : No\r\nForced : No\r\n"
               },
               "channel-4" : {
                  "Inform" : "ID : 6\r\nFormat : DTS\r\nFormat/Info : Digital Theater Systems\r\nMode : 16\r\nFormat settings, Endianness : Big\r\nCodec ID : A_DTS\r\nDuration : 1h 32mn\r\nBit rate mode : Constant\r\nBit rate : 1 509 Kbps\r\nChannel(s) : 6 channels\r\nChannel positions : Front: L C R, Side: L R, LFE\r\nSampling rate : 48.0 KHz\r\nBit depth : 24 bits\r\nCompression mode : Lossy\r\nStream size : 997 MiB (8%)\r\nTitle : DTS 5.1ch 1510 kbps - РћРґРЅРѕРіРѕР»РѕСЃС‹Р№, Рђ.Р“Р°РІСЂРёР»РѕРІ\r\nLanguage : Russian\r\nDefault : No\r\nForced : No\r\n"
               },
               "channel-5" : {
                  "Inform" : "ID : 7\r\nFormat : DTS\r\nFormat/Info : Digital Theater Systems\r\nMode : 16\r\nFormat settings, Endianness : Big\r\nCodec ID : A_DTS\r\nDuration : 1h 32mn\r\nBit rate mode : Constant\r\nBit rate : 1 509 Kbps\r\nChannel(s) : 6 channels\r\nChannel positions : Front: L C R, Side: L R, LFE\r\nSampling rate : 48.0 KHz\r\nBit depth : 24 bits\r\nCompression mode : Lossy\r\nStream size : 997 MiB (8%)\r\nTitle : DTS 5.1ch 1510 kbps\r\nLanguage : English\r\nDefault : No\r\nForced : No\r\n"
               },
               "channel-6" : {
                  "Inform" : "ID : 8\r\nFormat : AC-3\r\nFormat/Info : Audio Coding 3\r\nMode extension : CM (complete main)\r\nFormat settings, Endianness : Big\r\nCodec ID : A_AC3\r\nDuration : 1h 32mn\r\nBit rate mode : Constant\r\nBit rate : 448 Kbps\r\nChannel(s) : 6 channels\r\nChannel positions : Front: L C R, Side: L R, LFE\r\nSampling rate : 48.0 KHz\r\nBit depth : 16 bits\r\nCompression mode : Lossy\r\nStream size : 296 MiB (2%)\r\nTitle : AC3 5.1ch 448 kbps - РњРЅРѕРіРѕРіРѕР»РѕСЃС‹Р№, РљРёРЅРѕРјР°РЅРёСЏ\r\nLanguage : Russian\r\nDefault : No\r\nForced : No\r\n"
               },
               "channel-7" : {
                  "Inform" : "ID : 9\r\nFormat : AC-3\r\nFormat/Info : Audio Coding 3\r\nMode extension : CM (complete main)\r\nFormat settings, Endianness : Big\r\nCodec ID : A_AC3\r\nDuration : 1h 32mn\r\nBit rate mode : Constant\r\nBit rate : 448 Kbps\r\nChannel(s) : 6 channels\r\nChannel positions : Front: L C R, Side: L R, LFE\r\nSampling rate : 48.0 KHz\r\nBit depth : 16 bits\r\nCompression mode : Lossy\r\nStream size : 296 MiB (2%)\r\nTitle : AC3 5.1ch 448 kbps - РћРґРЅРѕРіРѕР»РѕСЃС‹Р№, Р”.РџСѓС‡РєРѕРІ (Р“РѕР±СЏ) #2\r\nLanguage : Russian\r\nDefault : No\r\nForced : No\r\n"
               },
               "channel-8" : {
                  "Inform" : "ID : 10\r\nFormat : AC-3\r\nFormat/Info : Audio Coding 3\r\nMode extension : CM (complete main)\r\nFormat settings, Endianness : Big\r\nCodec ID : A_AC3\r\nDuration : 1h 32mn\r\nBit rate mode : Constant\r\nBit rate : 448 Kbps\r\nChannel(s) : 6 channels\r\nChannel positions : Front: L C R, Side: L R, LFE\r\nSampling rate : 48.0 KHz\r\nBit depth : 16 bits\r\nCompression mode : Lossy\r\nStream size : 296 MiB (2%)\r\nTitle : AC3 5.1ch 448 kbps - РћРґРЅРѕРіРѕР»РѕСЃС‹Р№, Р”.РџСѓС‡РєРѕРІ (Р“РѕР±СЏ) #3\r\nLanguage : Russian\r\nDefault : No\r\nForced : No\r\n"
               },
               "channel-9" : {
                  "Inform" : "ID : 11\r\nFormat : AC-3\r\nFormat/Info : Audio Coding 3\r\nMode extension : CM (complete main)\r\nFormat settings, Endianness : Big\r\nCodec ID : A_AC3\r\nDuration : 1h 32mn\r\nBit rate mode : Constant\r\nBit rate : 192 Kbps\r\nChannel(s) : 2 channels\r\nChannel positions : Front: L R\r\nSampling rate : 48.0 KHz\r\nBit depth : 16 bits\r\nCompression mode : Lossy\r\nStream size : 127 MiB (1%)\r\nTitle : AC3 2.0ch 192 kbps - РњРЅРѕРіРѕРіРѕР»РѕСЃС‹Р№, РќРѕРІС‹Р№ РљР°РЅР°Р»\r\nLanguage : Ukrainian\r\nDefault : No\r\nForced : No\r\n"
               }
            },
            "general" : {
               "Inform" : "Unique ID : 203255661060539978619997371941752269459 (0x98E99DCC688008C1BB6DA7E70221EA93)\r\nFormat : Matroska\r\nFormat version : Version 2\r\nFile size : 12.3 GiB\r\nDuration : 1h 32mn\r\nOverall bit rate : 19.1 Mbps\r\nWriting application : mkvmerge v4.6.0 ('Still Crazy After All These Years') СЃР±РѕСЂРєР° РѕС‚ Mar 10 2011 02:50:32\r\nWriting library : libebml v1.2.0   libmatroska v1.1.0\r\n"
            },
            "video" : {
               "Inform" : "ID : 1\r\nFormat : AVC\r\nFormat/Info : Advanced Video Codec\r\nFormat profile : High@L4.1\r\nFormat settings, CABAC : Yes\r\nFormat settings, ReFrames : 4 frames\r\nCodec ID : V_MPEG4/ISO/AVC\r\nDuration : 1h 32mn\r\nBit rate : 9 000 Kbps\r\nWidth : 1 920 pixels\r\nHeight : 1 080 pixels\r\nDisplay aspect ratio : 16:9\r\nFrame rate mode : Constant\r\nFrame rate : 23.976 fps\r\nColor space : YUV\r\nChroma subsampling : 4:2:0\r\nBit depth : 8 bits\r\nScan type : Progressive\r\nBits/(Pixel*Frame) : 0.181\r\nStream size : 5.56 GiB (45%)\r\nWriting library : x264 core 114 r1913 5fd3dce\r\nLanguage : English\r\nDefault : Yes\r\nForced : No\r\n"
            }
         },
         "size" : "13240668650",
         "tth" : "LIWFBIU5HNQN6XDGDM7OLGXQRVE45P6IN6Q2SDY"
      }
   ]
}

------------------------------------------------------------------------
r12692 | tret2003 | 2013-01-26 18:19:29 +0400 (Сб, 26 янв 2013) | 1 line

# Удалил лишние файлы фильтров, добавил фильтры для Visual Studio 2012 
------------------------------------------------------------------------
r12690 | tret2003 | 2013-01-26 13:38:32 +0400 (Сб, 26 янв 2013) | 1 line

# Поправка r12680
------------------------------------------------------------------------
r12689 | a.rainman@gmail.com | 2013-01-26 11:57:17 +0400 (Сб, 26 янв 2013) | 3 lines

# +r12680.
# Включил фичу SCALOLAZ_SPEEDLIMIT_DLG в ежовой.
# Подчистил в области использования Util::toInt, Util::toString, Util::toStringW.
------------------------------------------------------------------------
r12688 | pavel.pimenov | 2013-01-26 07:49:16 +0400 (Сб, 26 янв 2013) | 1 line

# Добавлено внутреннее описание деталей реализации. позже из файле сдать wiki
------------------------------------------------------------------------
r12687 | a.rainman | 2013-01-26 02:23:46 +0400 (Сб, 26 янв 2013) | 1 line

# Исправлена ошибка в BufferedSocket::setMode.
------------------------------------------------------------------------
r12686 | a.rainman | 2013-01-26 02:23:15 +0400 (Сб, 26 янв 2013) | 1 line

# AStyle.
------------------------------------------------------------------------
r12685 | a.rainman@gmail.com | 2013-01-26 01:55:47 +0400 (Сб, 26 янв 2013) | 1 line

# Включаем фичу IRAINMAN_ASYNC_LOAD_CUSTOMLOCATION если собираемся в компиляторе 2012 студии.
------------------------------------------------------------------------
r12684 | a.rainman@gmail.com | 2013-01-26 01:37:46 +0400 (Сб, 26 янв 2013) | 1 line

# Косметика.
------------------------------------------------------------------------
r12683 | a.rainman@gmail.com | 2013-01-26 01:34:08 +0400 (Сб, 26 янв 2013) | 1 line

# В ежовой временно выключил SCALOLAZ_SPEEDLIMIT_DLG, после допила не забыть включить, ибо фича полезная :)
------------------------------------------------------------------------
r12682 | a.rainman@gmail.com | 2013-01-26 01:34:03 +0400 (Сб, 26 янв 2013) | 1 line

# Добавлены реализации toInt и toInt64 для сишных строк.
------------------------------------------------------------------------
r12681 | a.rainman@gmail.com | 2013-01-26 01:08:44 +0400 (Сб, 26 янв 2013) | 1 line

# Унификация MainFrame::onLimiter.
------------------------------------------------------------------------
r12680 | scalolaz_scat@mail.ru | 2013-01-25 22:47:59 +0400 (Пт, 25 янв 2013) | 3 lines

* Speed Limits Controls (Upload/Download) to Status Bar
# Little fix for Limit Control on user (in Transfer)
# Resort 'Settings' control resources for valid Tab walking
------------------------------------------------------------------------
r12678 | pavel.pimenov | 2013-01-25 21:52:58 +0400 (Пт, 25 янв 2013) | 1 line

# auto
------------------------------------------------------------------------
r12677 | scalolaz_scat@mail.ru | 2013-01-25 21:52:13 +0400 (Пт, 25 янв 2013) | 1 line

# Update Folders icon list
------------------------------------------------------------------------
r12676 | tret2003 | 2013-01-25 21:49:53 +0400 (Пт, 25 янв 2013) | 1 line

# [lang] an auto commit from localization system...
------------------------------------------------------------------------
r12675 | scalolaz_scat@mail.ru | 2013-01-25 21:49:11 +0400 (Пт, 25 янв 2013) | 1 line

# Update DCLS icon
------------------------------------------------------------------------
r12674 | a.rainman@gmail.com | 2013-01-25 21:31:42 +0400 (Пт, 25 янв 2013) | 1 line

# Убрано лишнее обновление ника при закрытии хаба.
------------------------------------------------------------------------
r12673 | a.rainman@gmail.com | 2013-01-25 21:27:11 +0400 (Пт, 25 янв 2013) | 1 line

* Исправлена ошибка при добавлении хаба в список недавних хабов, если он был открыт из окна чата.
------------------------------------------------------------------------
r12672 | pavel.pimenov | 2013-01-25 20:52:34 +0400 (Пт, 25 янв 2013) | 1 line

# Добавлен assert чтобы задолбало под отладкой и когда-то поправилась копипаста FavoriteManager::getInstance()->addRecent(r)
------------------------------------------------------------------------
r12671 | a.rainman@gmail.com | 2013-01-25 20:48:00 +0400 (Пт, 25 янв 2013) | 1 line

# куевой хучи падений фикс. -1
------------------------------------------------------------------------
r12670 | pavel.pimenov | 2013-01-25 19:41:41 +0400 (Пт, 25 янв 2013) | 1 line

# Иногда l_mediaXY.m_video может остаться пустым.
------------------------------------------------------------------------
r12669 | pavel.pimenov | 2013-01-25 19:40:06 +0400 (Пт, 25 янв 2013) | 1 line

# Поставил таймаут 1 секунду для определения IP + преваращаю курсор в часики
------------------------------------------------------------------------
r12668 | a.rainman@gmail.com | 2013-01-25 18:55:53 +0400 (Пт, 25 янв 2013) | 1 line

# Добавил директиву IRAINMAN_USE_TEST_NG_TRANSFERS (в ежовой вкл.) с её помощью проще вести диагностику, ибо ссылка на путь запрашивается от Transfer гораздо чаще чем ссылка на UserConnection, по сути это позволит наконец то исправить гейзен баг тянущийся ещё с доисторических версий, который приводит к падениям в случайных местах
------------------------------------------------------------------------
r12667 | pavel.pimenov | 2013-01-25 18:51:40 +0400 (Пт, 25 янв 2013) | 3 lines

# [fly-server] Добавлен вывод признака Inform в окне поиска  https://www.box.com/shared/rhoumadchk0fx8t63d3q
  Пока глючит хинт и почему-то выводит китайские буковки :)
# LRESULT onInfoTip могу падать если кол-во колонок в списке больше 32
------------------------------------------------------------------------
r12666 | a.rainman@gmail.com | 2013-01-25 17:49:18 +0400 (Пт, 25 янв 2013) | 1 line

# +r12600
------------------------------------------------------------------------
r12665 | tret2003 | 2013-01-25 13:07:34 +0400 (Пт, 25 янв 2013) | 2 lines

# Частичный merge fix errno calls
http://bazaar.launchpad.net/~dcplusplus-team/dcplusplus/trunk/revision/3182
------------------------------------------------------------------------
r12662 | pavel.pimenov | 2013-01-24 23:18:42 +0400 (Чт, 24 янв 2013) | 2 lines

# Добавлена функция Util::getExternalIP. 
# Wizard перевел на Util::getExternalIP. (TODO - завтра причесать код - еще немного пахнет копипастой)
------------------------------------------------------------------------
r12661 | tret2003 | 2013-01-24 23:15:38 +0400 (Чт, 24 янв 2013) | 1 line

# Обновим локаль
------------------------------------------------------------------------
r12660 | pavel.pimenov | 2013-01-24 22:53:16 +0400 (Чт, 24 янв 2013) | 2 lines

* Исправлен определение IP адреса если сервер отдает Transfer-Encoding: chunked ( http://dc.2com.net/getip.php ) 
  TODO - завтра влить функционал в Wizard и убрать копипаст
------------------------------------------------------------------------
r12659 | tret2003 | 2013-01-24 22:48:27 +0400 (Чт, 24 янв 2013) | 5 lines

# Merge from DC++
Improve OpenSSL error handling
http://bazaar.launchpad.net/~dcplusplus-team/dcplusplus/trunk/revision/3175
fix TLS errors
http://bazaar.launchpad.net/~dcplusplus-team/dcplusplus/trunk/revision/3176
------------------------------------------------------------------------
r12658 | tret2003 | 2013-01-24 21:37:33 +0400 (Чт, 24 янв 2013) | 5 lines

# Merge from DC++
Revise INF order in c-c connections as advised by ADC 1.0.2
http://bazaar.launchpad.net/~dcplusplus-team/dcplusplus/trunk/revision/3183
send INF before GET
http://bazaar.launchpad.net/~dcplusplus-team/dcplusplus/trunk/revision/3184
------------------------------------------------------------------------
r12657 | pavel.pimenov | 2013-01-24 21:12:09 +0400 (Чт, 24 янв 2013) | 1 line

# В результатах поиска IP может быть пустой - игнорируем
------------------------------------------------------------------------
r12655 | a.rainman@gmail.com | 2013-01-24 19:30:04 +0400 (Чт, 24 янв 2013) | 1 line

# +r12654: очистка, в архитектуре FlylinkDC используется прямое обращение к БД.
------------------------------------------------------------------------
r12654 | a.rainman@gmail.com | 2013-01-24 19:21:37 +0400 (Чт, 24 янв 2013) | 1 line

# Выпилил не использующийся метод в HashManager. TODO - где то ошибка?
------------------------------------------------------------------------
r12653 | a.rainman@gmail.com | 2013-01-24 19:21:21 +0400 (Чт, 24 янв 2013) | 2 lines

# +r12648 (вернул имя метода  set_bit).
# Выпилил пару мелких кусочков от IRAINMAN_INCLUDE_DETECTION_MANAGER.
------------------------------------------------------------------------
r12651 | a.rainman@gmail.com | 2013-01-24 18:16:53 +0400 (Чт, 24 янв 2013) | 2 lines

# +r12646: fix 
# Причесал LineDlg и увеличил его возможности.
------------------------------------------------------------------------
r12650 | a.rainman@gmail.com | 2013-01-24 18:16:45 +0400 (Чт, 24 янв 2013) | 1 line

# +r12648. - мутный однако макрос, больше не буду его юзать.
------------------------------------------------------------------------
r12649 | a.rainman@gmail.com | 2013-01-24 17:49:45 +0400 (Чт, 24 янв 2013) | 1 line

# +r12648.
------------------------------------------------------------------------
r12648 | a.rainman@gmail.com | 2013-01-24 17:12:37 +0400 (Чт, 24 янв 2013) | 1 line

# +r12600.
------------------------------------------------------------------------
r12647 | a.rainman@gmail.com | 2013-01-24 17:12:21 +0400 (Чт, 24 янв 2013) | 1 line

# CFlylinkDBManager::LoadMediaInfo fix. Паш, без обид, просто обрати внимание к чему приводит привычка избегать висячих переменных ;)
------------------------------------------------------------------------
r12646 | a.rainman@gmail.com | 2013-01-24 16:40:23 +0400 (Чт, 24 янв 2013) | 2 lines

* Closed Issue 894: Отсутствует галка "Сохранить пароль".
# +r12013.
------------------------------------------------------------------------
r12645 | a.rainman@gmail.com | 2013-01-24 16:40:15 +0400 (Чт, 24 янв 2013) | 3 lines

# +r12625, странно, но функция нигде не используется. Просьба функцию не удалять,  ибо она м.б. полезна для диагностики.


------------------------------------------------------------------------
r12644 | pavel.pimenov | 2013-01-24 16:38:38 +0400 (Чт, 24 янв 2013) | 3 lines

# [fly-server] 
 - Проброс обобщенного параметра Inform на сервер + упаковка и фильтрация лишних признаков для оптимзации трафика.
 - Добавил assert-ов в Identity::set_bit
------------------------------------------------------------------------
r12643 | pavel.pimenov | 2013-01-23 22:39:24 +0400 (Ср, 23 янв 2013) | 2 lines

* [merge] Влил функциональность fly-server из ветки https://flylinkdc.googlecode.com/svn/branches-dev/ppa/issue-843-fly-server
  Для более активного тестирования в серой ветке.
------------------------------------------------------------------------
r12640 | tret2003 | 2013-01-23 21:35:24 +0400 (Ср, 23 янв 2013) | 1 line

# Дополнение r12638
------------------------------------------------------------------------
r12638 | a.rainman@gmail.com | 2013-01-23 20:27:05 +0400 (Ср, 23 янв 2013) | 1 line

# +r12635, r12632, r12627: cleanup.
------------------------------------------------------------------------
r12635 | pavel.pimenov | 2013-01-23 19:59:10 +0400 (Ср, 23 янв 2013) | 1 line

# Исправлено возможное падение в void Identity::set_bit
------------------------------------------------------------------------
r12632 | tret2003 | 2013-01-23 17:37:47 +0400 (Ср, 23 янв 2013) | 1 line

# Дополнение к r12627
------------------------------------------------------------------------
r12628 | pavel.pimenov | 2013-01-23 14:42:43 +0400 (Ср, 23 янв 2013) | 2 lines

# Повесил логи в natpmp
# Ошибка компиляции если в релизе не определен NDEBUG 
------------------------------------------------------------------------
r12627 | pavel.pimenov | 2013-01-23 14:39:30 +0400 (Ср, 23 янв 2013) | 3 lines

# Для всех релизных конфигураций прописал NDEBUG (for merge)
  - Падало в релизной конфигурации на closenatpmp https://www.crash-server.com/DumpGroup.aspx?ClientID=ppa&DumpGroupID=28616
    вероятно команда initnatpmp в p->s = socket(PF_INET, SOCK_DGRAM, 0); вернула 0
------------------------------------------------------------------------
r12626 | tret2003 | 2013-01-23 12:06:09 +0400 (Ср, 23 янв 2013) | 1 line

# Дополнение к r12625, Перевод слова Abort!
------------------------------------------------------------------------
r12625 | pavel.pimenov | 2013-01-23 09:06:04 +0400 (Ср, 23 янв 2013) | 4 lines

# Запретил кидать исключения без текстового сообщения
# TODO - перевести слово Abort
# Добавил макрос STANDARD_EXCEPTION_ADD_INFO - получается два параметра для вывода дополнительной информации об исключении.
# При ShareException добавил в качестве второго параметра путь к проблемному файлу/каталогу
------------------------------------------------------------------------
r12624 | pavel.pimenov | 2013-01-23 07:55:35 +0400 (Ср, 23 янв 2013) | 1 line

# Прикольная опечатка
------------------------------------------------------------------------
r12619 | pavel.pimenov | 2013-01-22 19:11:12 +0400 (Вт, 22 янв 2013) | 1 line

# Удаляем перед генерацией автообновления бинарники
------------------------------------------------------------------------
r12614 | pavel.pimenov | 2013-01-22 06:29:44 +0400 (Вт, 22 янв 2013) | 1 line

# [test] Проверял работу toString с reserve
------------------------------------------------------------------------
r12612 | a.rainman@gmail.com | 2013-01-21 21:26:07 +0400 (Пн, 21 янв 2013) | 1 line

# +r12600: opt.
------------------------------------------------------------------------
r12611 | a.rainman@gmail.com | 2013-01-21 21:21:24 +0400 (Пн, 21 янв 2013) | 1 line

# +r12600.
------------------------------------------------------------------------
r12606 | pavel.pimenov | 2013-01-21 20:37:35 +0400 (Пн, 21 янв 2013) | 1 line

* К анализу медиаинфо добавлено расширение m2ts
------------------------------------------------------------------------
r12605 | pavel.pimenov | 2013-01-21 20:35:08 +0400 (Пн, 21 янв 2013) | 1 line

# Исправлен показ медиаинформации даже если нет тэга битрейта
------------------------------------------------------------------------
r12602 | pavel.pimenov | 2013-01-21 16:46:20 +0400 (Пн, 21 янв 2013) | 1 line

# StringTokenizer<> -> const StringTokenizer<>
------------------------------------------------------------------------
r12600 | pavel.pimenov | 2013-01-21 16:34:55 +0400 (Пн, 21 янв 2013) | 1 line

# (Closed issue 897) Добавлен метод установки/сброса битов set_bit (пока используется для "FC") (for merge)
------------------------------------------------------------------------
r12599 | pavel.pimenov | 2013-01-21 16:05:11 +0400 (Пн, 21 янв 2013) | 1 line

# iterator -> auto
------------------------------------------------------------------------
r12598 | pavel.pimenov | 2013-01-21 15:49:58 +0400 (Пн, 21 янв 2013) | 1 line

# Убрал лишний вызов Util::toInt(ui->getIdentity().get("FC"))
------------------------------------------------------------------------
r12597 | pavel.pimenov | 2013-01-21 15:47:56 +0400 (Пн, 21 янв 2013) | 1 line

# Забытые const_iterator-ы
------------------------------------------------------------------------
r12596 | pavel.pimenov | 2013-01-21 14:56:07 +0400 (Пн, 21 янв 2013) | 1 line

# Ошибка в поиске "LFE" сравнивать нужно с string::npos а не с tstring::npos
------------------------------------------------------------------------
r12593 | pavel.pimenov | 2013-01-21 11:52:51 +0400 (Пн, 21 янв 2013) | 2 lines

* (Closed issue 892) Убрал пробел в конце $Supports + убрал дубль кода через дополнительную функцию Util::toSupportsCommand
  TODO - посмотреть на реакцию т.к. оригинальный DC++ отказался убирать пробел.
------------------------------------------------------------------------
r12582 | a.rainman@gmail.com | 2013-01-19 23:34:48 +0400 (Сб, 19 янв 2013) | 1 line

# +r12581: opt.
------------------------------------------------------------------------
r12581 | anna.bienne | 2013-01-19 21:49:03 +0400 (Сб, 19 янв 2013) | 1 line

* добавлено отображение DVD и Blu Ray дисков
------------------------------------------------------------------------
r12580 | tret2003 | 2013-01-19 17:55:29 +0400 (Сб, 19 янв 2013) | 1 line

# [lang] an auto commit from localization system...
------------------------------------------------------------------------
r12579 | a.rainman@gmail.com | 2013-01-19 17:14:50 +0400 (Сб, 19 янв 2013) | 1 line

# small opt.
------------------------------------------------------------------------
r12577 | tret2003 | 2013-01-19 13:05:36 +0400 (Сб, 19 янв 2013) | 1 line

# Замена const_iterator на auto
------------------------------------------------------------------------
r12572 | pavel.pimenov | 2013-01-18 16:38:10 +0400 (Пт, 18 янв 2013) | 2 lines

# Убрал clear-resize в BloomFilter. 
  - TODO заменить std::vector<bool> на bit_vector (найти быструю реализацию)
------------------------------------------------------------------------
r12571 | pavel.pimenov | 2013-01-18 16:15:27 +0400 (Пт, 18 янв 2013) | 3 lines

# Тест std::vector<bool>
# Для теста включил генерацию asm-листинга

------------------------------------------------------------------------
r12568 | pavel.pimenov | 2013-01-18 06:16:37 +0400 (Пт, 18 янв 2013) | 1 line

# Astyle
